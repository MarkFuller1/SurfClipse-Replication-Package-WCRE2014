<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>JaCoCo and EclEmma Users ()</TITLE>
<BASE href="http://comments.gmane.org">
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<link rel="SHORTCUT ICON" href="http://gmane.org/favicon.ico">
<link rel="Up" href="/gmane.comp.java.jacoco.user>">
<LINK href="http://gmane.org/img/leftmenu.css" type="text/css" rel="stylesheet">
<LINK href="http://gmane.org/img/blog.css" type="text/css" rel="stylesheet">
<style type="text/css" media="screen">
h1.name {
  background-image:  url(http://gmane.org/paint-blog-id.php?group=gmane.comp.java.jacoco.user);
}
</style>
</HEAD>
<BODY>
<div id=banner>
<h1 class=name>&nbsp;</h1>
<span class=description>JaCoCo and EclEmma Users ()</span>
</div>
<script src="http://gmane.org/img/jsblog.js" type="text/javascript"></script>

<DIV id=content>
<DIV class=blog>
<div class=posting>
<DIV class=entry>
<DIV class=date>
<div class=options><a rel=nofollow href="#" onclick="return toggle('o1');">headers</a></div>
<span class=author>
<a href="http://search.gmane.org/?author=andredasilvapinto&amp;sort=date" rel=nofollow>andredasilvapinto</a>
 | </span>
<SPAN class=day>20 Jul 2013 19:03</SPAN>
</DIV>
<DIV class=blogbody><A name=5></A>
<div class=face>
<a target="_top" href="http://ftp.cs.indiana.edu/pub/faces/picons/"><img border=0 alt="Picon" src="http://cache.gmane.org//gmane/comp/java/jacoco/user/133-picon-001.gif"></a>
<br>
</div>
<H2 class=title>Re: [java code coverage] JaCoCo and Aspectj</h2><div id="o1" class="hidden">&lt;<a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a>&gt;<br>
2013-07-20 17:03:40 GMT<br>
</div>
<pre>
Hi,

I'm using Java 1.7, AspectJ 1.7.3 (for load-time weaving), Jacoco Maven plugin 0.6.3.201306030806 and
Maven Surefire Plugin 2.15 to run the tests. In these conditions Jacoco doesn't work correctly.

If Jacoco's Java agent is set as the second Java agent (after AspectJ weaver agent), the build produces
these errors:

java.lang.instrument.IllegalClassFormatException: Error while instrumenting class CLASS_NAME.
	at org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:89)
	at sun.instrument.TransformerManager.transform(TransformerManager.java:188)
...
Caused by: java.io.IOException: Error while instrumenting class CLASS_NAME.
	at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrumentError(Instrumenter.java:147)
	at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:98)
	at org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:87)
	... 64 more
Caused by: java.lang.IllegalStateException: Missing or invalid stackmap frames.
	at org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.assertValidFrames(FrameTracker.java:613)
	at org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.pop(FrameTracker.java:602)
	at org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.visitVarInsn(FrameTracker.java:386)
	at org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown Source)
	at org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown Source)
	at org.jacoco.agent.rt.internal_9dd1198.asm.tree.VarInsnNode.accept(Unknown Source)
	at org.jacoco.agent.rt.internal_9dd1198.asm.tree.InsnList.accept(Unknown Source)
	at org.jacoco.agent.rt.internal_9dd1198.asm.tree.MethodNode.accept(Unknown Source)
	at org.jacoco.agent.rt.internal_9dd1198.core.internal.flow.ClassProbesAdapter$1.visitEnd(ClassProbesAdapter.java:124)
	at org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.b(Unknown Source)
	at org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown Source)
	at org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown Source)
</pre><a href="http://permalink.gmane.org/gmane.comp.java.jacoco.user/133">(Continue reading)</a><br><br>
<DIV class=posted>
<form class="spam" method="post" action="http://spam.gmane.org/gmane.comp.java.jacoco.user:133:unconfirmed" onsubmit="openSpamFrame(this); return false;">
<A href="http://permalink.gmane.org/gmane.comp.java.jacoco.user/133">Permalink</A>
| <a href="http://post.gmane.org/post.php?group=gmane.comp.java.jacoco.user&amp;followup=133" rel=nofollow>Reply</a>
| <input class="spam" type="submit" value="Report this as spam">
</form>
</DIV>  

</DIV>  
</DIV>  

<div class=posting>
<DIV class=entry>
<DIV class=date>
<div class=options><a rel=nofollow href="#" onclick="return toggle('o2');">headers</a></div>
<span class=author>
<a href="http://search.gmane.org/?author=Marc+R.+Hoffmann&amp;sort=date" rel=nofollow>Marc R. Hoffmann</a>
 | </span>
<SPAN class=day>21 Jul 2013 17:58</SPAN>
</DIV>
<DIV class=blogbody><A name=5></A>
<H3 class=title>Re: [java code coverage] JaCoCo and Aspectj</h3><div id="o2" class="hidden">Marc R. Hoffmann &lt;<a target="_top" href="http://gmane.org/get-address.php?address=hoffmann%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoffmann@...</a>&gt;<br>
2013-07-21 15:58:22 GMT<br>
</div>
<pre>
Hi André,

this strange. If the JaCoCo agent really is the very first agent in the 
command line it should see the class files (or JARs) from the file 
system. So if the report is created based on the exact same file the 
report should show coverage for all executed classes.

In the JaCoCo HTML report can you please check whether the classes in 
question are listed on the sessions page (link in the top right corner).

Thanks,
-marc

On 20.07.13 19:03, <a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a> wrote:
&gt; Hi,
&gt;
&gt; I'm using Java 1.7, AspectJ 1.7.3 (for load-time weaving), Jacoco Maven plugin 0.6.3.201306030806 and
Maven Surefire Plugin 2.15 to run the tests. In these conditions Jacoco doesn't work correctly.
&gt;
&gt; If Jacoco's Java agent is set as the second Java agent (after AspectJ weaver agent), the build produces
these errors:
&gt;
&gt; java.lang.instrument.IllegalClassFormatException: Error while instrumenting class CLASS_NAME.
&gt; 	at org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:89)
&gt; 	at sun.instrument.TransformerManager.transform(TransformerManager.java:188)
&gt; ...
&gt; Caused by: java.io.IOException: Error while instrumenting class CLASS_NAME.
&gt; 	at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrumentError(Instrumenter.java:147)
&gt; 	at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:98)
&gt; 	at org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:87)
</pre><a href="http://permalink.gmane.org/gmane.comp.java.jacoco.user/134">(Continue reading)</a><br><br>
<DIV class=posted>
<form class="spam" method="post" action="http://spam.gmane.org/gmane.comp.java.jacoco.user:134:unconfirmed" onsubmit="openSpamFrame(this); return false;">
<A href="http://permalink.gmane.org/gmane.comp.java.jacoco.user/134">Permalink</A>
| <a href="http://post.gmane.org/post.php?group=gmane.comp.java.jacoco.user&amp;followup=134" rel=nofollow>Reply</a>
| <input class="spam" type="submit" value="Report this as spam">
</form>
</DIV>  

</DIV>  
</DIV>  

<div class=posting>
<DIV class=entry>
<DIV class=date>
<div class=options><a rel=nofollow href="#" onclick="return toggle('o3');">headers</a></div>
<span class=author>
<a href="http://search.gmane.org/?author=Andr%C3%A9+Pinto&amp;sort=date" rel=nofollow>André Pinto</a>
 | </span>
<SPAN class=day>21 Jul 2013 18:42</SPAN>
</DIV>
<DIV class=blogbody><A name=5></A>
<div class=face>
<a target="_top" href="http://ftp.cs.indiana.edu/pub/faces/picons/"><img border=0 alt="Picon" src="http://cache.gmane.org//gmane/comp/java/jacoco/user/135-picon-001.gif"></a>
<br>
</div>
<H3 class=title>Re: [java code coverage] JaCoCo and Aspectj</h3><div id="o3" class="hidden">André Pinto &lt;<a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a>&gt;<br>
2013-07-21 16:42:34 GMT<br>
</div>
<p>
<div>
<div dir="ltr">
<div>Hi Marc,<br><br>
</div>
<div>thanks for replying so quickly.<br><br>
</div>
<div>Right now I'm only testing a specific problematic class in order to perform faster clean install iterations while trying different approaches.<br><br>
</div>
<div>
<br>The class that I'm testing does not appear on the Sessions page when I have AspectJ weaver agent enabled. In its place there are two AjcClosure classes from AspectJ:<br><br>CLASS_NAME.AjcClosure1&nbsp;&nbsp;&nbsp; 8b30d747616523a0<br>
CLASS_NAME.AjcClosure3&nbsp;&nbsp;&nbsp; b62aad26ee5ff4eb<br>CLASS_NAME.Result [nested class with link] &nbsp;&nbsp; 27ec6335c32de676<br>CLASS_NAMEIntTest&nbsp;&nbsp;&nbsp; c508b26e62564a2b<br>CLASS_NAMETest&nbsp;&nbsp;&nbsp; d101cb5455c0b79d<br>CLASS_NAMETest.TestDelegate&nbsp;&nbsp;&nbsp; 89770d1905c6d466<br><br><br>When not using AspectJ LTW the class appears in the session page (I needed to comment the tests that used AOP for this to work so the nested class does not appear now):<br><br>CLASS_NAME [with link] &nbsp;&nbsp; 9be84e8927495ca6<br>
CLASS_NAMEIntTest&nbsp;&nbsp;&nbsp; 6e56338794a364f2<br>CLASS_NAMETest&nbsp;&nbsp;&nbsp; d101cb5455c0b79d<br>CLASS_NAMETest.TestDelegate&nbsp;&nbsp;&nbsp; 89770d1905c6d466<br><br>
</div>
<div>
<br><br>This is my Jacoco Maven plugin configuration:<br><br>&lt;plugin&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.jacoco&lt;/groupId&gt;<br>&nbsp;&nbsp;&nbsp; &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;<br>&nbsp;&nbsp;&nbsp; &lt;version&gt;0.6.3.201306030806&lt;/version&gt;<br>&nbsp;&nbsp;&nbsp; &lt;configuration&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;propertyName&gt;coverageAgent&lt;/propertyName&gt;<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;skip&gt;false&lt;/skip&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;excludes&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; EXCLUDES LIST<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/excludes&gt;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;classDumpDir&gt;${basedir}/target/jacoco-classes&lt;/classDumpDir&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/configuration&gt;<br><br>&nbsp;&nbsp;&nbsp; &lt;executions&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;execution&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;id&gt;prepare-agent&lt;/id&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goals&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goal&gt;prepare-agent&lt;/goal&gt;<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/goals&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/execution&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;execution&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;id&gt;report&lt;/id&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;phase&gt;prepare-package&lt;/phase&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goals&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goal&gt;report&lt;/goal&gt;<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/goals&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/execution&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;execution&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;id&gt;check&lt;/id&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goals&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goal&gt;check&lt;/goal&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/goals&gt;<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;configuration&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;rules&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; RULES LIST<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/rules&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/configuration&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/execution&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/executions&gt;<br>
&lt;/plugin&gt;<br><br><br><br>
</div>
<div>and my Maven Surefire plugin configuration:<br><br>&lt;plugin&gt;<br>&nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br>&nbsp;&nbsp;&nbsp; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;version&gt;2.15&lt;/version&gt;<br><br>&nbsp;&nbsp;&nbsp; &lt;configuration&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;groups&gt;specific_test_group&lt;/groups&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;argLine&gt;-Xmx1024m -XX:MaxPermSize=256m ${coverageAgent} -javaagent:"${aspectj.agent.jar}"&lt;/argLine&gt;<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;properties&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;property&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;name&gt;listener&lt;/name&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;value&gt;SOME_TESTNG_LISTENERS&lt;/value&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/property&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/properties&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/configuration&gt;<br>&lt;/plugin&gt;<br>
</div>
<div><br></div>
<div>
<br><br>Thanks,<br>
</div>
<div>Andr&eacute;<br>
</div>
</div>
<div class="gmail_extra">
<br><br><div class="gmail_quote">On Sun, Jul 21, 2013 at 4:58 PM, Marc R. Hoffmann <span dir="ltr">&lt;<a href="mailto:hoffmann &lt;at&gt; mountainminds.com" target="_blank">hoffmann-a8GzhnWS74BMKzkbnucVRwC/G2K4zDHf@public.gmane.org</a>&gt;</span> wrote:<br><blockquote class="gmail_quote">Hi Andr&eacute;,<br><br>
this strange. If the JaCoCo agent really is the very first agent in the command line it should see the class files (or JARs) from the file system. So if the report is created based on the exact same file the report should show coverage for all executed classes.<br><br>
In the JaCoCo HTML report can you please check whether the classes in question are listed on the sessions page (link in the top right corner).<br><br>
Thanks,<br>
-marc<div class="HOEnZb"><div class="h5">
<br><br>
On 20.07.13 19:03, <a href="mailto:andredasilvapinto-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org" target="_blank">andredasilvapinto-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org</a> wrote:<br><blockquote class="gmail_quote">
Hi,<br><br>
I'm using Java 1.7, AspectJ 1.7.3 (for load-time weaving), Jacoco Maven plugin 0.6.3.201306030806 and Maven Surefire Plugin 2.15 to run the tests. In these conditions Jacoco doesn't work correctly.<br><br>
If Jacoco's Java agent is set as the second Java agent (after AspectJ weaver agent), the build produces these errors:<br><br>
java.lang.instrument.IllegalClassFormatException: Error while instrumenting class CLASS_NAME.<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:89)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at sun.instrument.TransformerManager.transform(TransformerManager.java:188)<br>
...<br>
Caused by: java.io.IOException: Error while instrumenting class CLASS_NAME.<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrumentError(Instrumenter.java:147)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:98)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:87)<br>
&nbsp; &nbsp; &nbsp; &nbsp; ... 64 more<br>
Caused by: java.lang.IllegalStateException: Missing or invalid stackmap frames.<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.assertValidFrames(FrameTracker.java:613)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.pop(FrameTracker.java:602)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.visitVarInsn(FrameTracker.java:386)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.tree.VarInsnNode.accept(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.tree.InsnList.accept(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.tree.MethodNode.accept(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.internal.flow.ClassProbesAdapter$1.visitEnd(ClassProbesAdapter.java:124)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.b(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:78)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:96)<br>
&nbsp; &nbsp; &nbsp; &nbsp; ... 65 more<br><br><br>
if it is set as the first Java Agent (before AspectJ) it works for most classes, but fails to produce correct coverage reports for weaved classes (all the lines appear as not covered even though I have tests covering them).<br><br>
I tried to use the classdumpdir solution presented here: <a href="https://github.com/jacoco/eclemma/issues/33" target="_blank">https://github.com/jacoco/eclemma/issues/33</a> but I can't find a equivalent Maven configuration for the setting the check and report Jacoco goals to use the classdumpdir directory.<br><br>
Does anyone have a solution for this?<br><br>
Thanks,<br>
Andr&eacute;.<br><br><br><br>
On Wednesday, March 6, 2013 8:52:36 AM UTC, Erik Vande Velde wrote:<br><blockquote class="gmail_quote">
Hi Henrik,<br><br><br>
This did indeed solve my problem, thanks !!!<br><br><br>
2013/3/6 Henrik Horneber &lt;<a href="mailto:horn...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org" target="_blank">horn...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org</a>&gt;<br><br><br>
Hi,<br><br><br>
I've successfully used JaCoCo together with AspectJ.<br><br><br>
You need to make sure<br><br><br>
* you use AspectJ version &gt;= 1.7<br><br>
* java source and target are also set to 1.7<br><br><br><br>
Then AspectJ will generate class files JaCoCo can use.<br><br><br>
Best regards,<br><br>
Henrik<br><br><br><br><br><br><br>
On Wed, Mar 6, 2013 at 8:02 AM, Erik Vande Velde &lt;<a href="mailto:vandeve...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org" target="_blank">vandeve...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org</a>&gt; wrote:<br><br><br><br><br>
Hello Marc,<br><br><br>
Thanks for your reaction! I'll put your question on the Aspectj forum today.<br><br><br><br><br>
Kind Regards,<br>
&nbsp; &nbsp; Erik<br><br><br>
2013/3/5 Marc Hoffmann &lt;<a href="mailto:hoff...-a8GzhnWS74BMKzkbnucVRwC/G2K4zDHf@public.gmane.org" target="_blank">hoff...-a8GzhnWS74BMKzkbnucVRwC/G2K4zDHf@public.gmane.org</a>&gt;<br><br><br><br><br><br>
Hi,<br><br><br><br>
in any case JaCoCo requires valid classfiles as input. This implies that class files from version 1.6 on need to contain valid stackmap frames. If this is not the case JaCoCo will fail with exactly this message.<br><br><br><br>
Have you reported the problem to AspectJ?<br><br><br><br>
Best regards,<br><br>
-marc<br><br><br><br><br><br><br><br>
On 2013-03-05 16:50, <a href="mailto:vandeve...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org" target="_blank">vandeve...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org</a> wrote:<br><br><br>
I downloaded JaCoCo today, and got the ant + maven examples going<br><br>
immediately.<br><br>
But when I change the pom.xml of our project in a similar way as the<br><br>
examples I'm in trouble, almost certainly because we use Aspectj in<br><br>
that project:<br><br><br><br>
1) offline modus:<br><br>
Here I get the following error message:<br><br>
[ERROR] Failed to execute goal<br><br>
org.jacoco:jacoco-maven-plugin:0.6.2.201302030002:instrument (default)<br><br>
&nbsp; on project com.fugro.gwf.server.core: Execution default of goal<br><br>
org.jacoco:jacoco-maven-plugin:0.6.2.201302030002:instrument failed:<br><br>
&nbsp; Missing or invalid stackmap frames. -&gt; [Help 1]<br><br><br><br>
2) on the fly modus:<br><br>
Running com.fugro.gwf.server.core.synchronisation.Synchronise1Test<br><br>
Start java.lang.instrument.IllegalClassFormatException:<br><br>
Error while instrumenting class<br><br>
com/fugro/gwf/server/core/referencing/ReferencingAspect.<br><br>
Underneath this message the stack trace once more shows:<br><br>
Caused by: java.lang.IllegalStateException: Missing or invalid<br><br>
stackmap frames.<br><br><br><br>
My questions:<br><br>
1) Is there a way to get coverage information for an aspectj project<br><br>
in JaCoCo?<br><br>
2) If not, do you know an alternative tool that can deal with aspectj<br><br>
projects. I tried clover, but they simply say they don't support<br><br>
aspectj projects. I also tried Coburtera and emma, but assumed JaCoCo<br><br>
is a more recent (and better supported) tool<br>
</blockquote>
</blockquote>
<br>
-- <br>
You received this message because you are subscribed to a topic in the Google Groups "JaCoCo and EclEmma Users" group.<br>
</div></div>
<div class="HOEnZb"><div class="h5">
To unsubscribe from this topic, visit <a href="https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe" target="_blank">https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe</a>.<br>
To unsubscribe from this group and all its topics, send an email to <a href="mailto:jacoco%2Bunsubscribe-/JYPxA39Uh5TLH3MbocFFw@public.gmane.org" target="_blank">jacoco+unsubscribe &lt;at&gt; googlegroups.com</a>.<br>
For more options, visit <a href="https://groups.google.com/groups/opt_out" target="_blank">https://groups.google.com/groups/opt_out</a>.<br><br><br>
</div></div>
</blockquote>
</div>
<br>
</div>

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups "JaCoCo and EclEmma Users" group.<br>
To unsubscribe from this group and stop receiving emails from it, send an email to jacoco+unsubscribe-/JYPxA39Uh5TLH3MbocFF+G/Ez6ZCGd0@public.gmane.org<br>
For more options, visit <a href="https://groups.google.com/groups/opt_out">https://groups.google.com/groups/opt_out</a>.<br>
&nbsp;<br>
&nbsp;<br>
</div>
<DIV class=posted>
<form class="spam" method="post" action="http://spam.gmane.org/gmane.comp.java.jacoco.user:135:unconfirmed" onsubmit="openSpamFrame(this); return false;">
<A href="http://permalink.gmane.org/gmane.comp.java.jacoco.user/135">Permalink</A>
| <a href="http://post.gmane.org/post.php?group=gmane.comp.java.jacoco.user&amp;followup=135" rel=nofollow>Reply</a>
| <input class="spam" type="submit" value="Report this as spam">
</form>
</DIV>  

</DIV>  
</DIV>  

<div class=posting>
<DIV class=entry>
<DIV class=date>
<div class=options><a rel=nofollow href="#" onclick="return toggle('o4');">headers</a></div>
<span class=author>
<a href="http://search.gmane.org/?author=Andr%C3%A9+Pinto&amp;sort=date" rel=nofollow>André Pinto</a>
 | </span>
<SPAN class=day>21 Jul 2013 18:51</SPAN>
</DIV>
<DIV class=blogbody><A name=5></A>
<div class=face>
<a target="_top" href="http://ftp.cs.indiana.edu/pub/faces/picons/"><img border=0 alt="Picon" src="http://cache.gmane.org//gmane/comp/java/jacoco/user/136-picon-001.gif"></a>
<br>
</div>
<H3 class=title>Re: [java code coverage] JaCoCo and Aspectj</h3><div id="o4" class="hidden">André Pinto &lt;<a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a>&gt;<br>
2013-07-21 16:51:34 GMT<br>
</div>
<p>
<div>
<div dir="ltr">I forgot to say that the problematic test that I'm running is CLASS_NAMEIntTest (Integration test that requires AOP) and that's the one that I needed to edit to remove the AOP-dependent tests (that's why its hashcode changed).<br><br>CLASS_NAMETest is a unit test that is not running right now (because I limited the running tests to the integration test). Per our implementation, unit tests don't use AOP so they are not a concern here. CLASS_NAMETest.TestDelegate is a nested class of that unit test. Both of these classes keep their hash codes because I didn't change them.<br>
</div>
<div class="gmail_extra">
<br><br><div class="gmail_quote">On Sun, Jul 21, 2013 at 5:42 PM, Andr&eacute; Pinto <span dir="ltr">&lt;<a href="mailto:andredasilvapinto-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org" target="_blank">andredasilvapinto &lt;at&gt; gmail.com</a>&gt;</span> wrote:<br><blockquote class="gmail_quote">
<div dir="ltr">
<div>Hi Marc,<br><br>
</div>
<div>thanks for replying so quickly.<br><br>
</div>
<div>Right now I'm only testing a specific problematic class in order to perform faster clean install iterations while trying different approaches.<br><br>
</div>
<div>
<br>The class that I'm testing does not appear on the Sessions page when I have AspectJ weaver agent enabled. In its place there are two AjcClosure classes from AspectJ:<br><br>CLASS_NAME.AjcClosure1&nbsp;&nbsp;&nbsp; 8b30d747616523a0<br>

CLASS_NAME.AjcClosure3&nbsp;&nbsp;&nbsp; b62aad26ee5ff4eb<br>CLASS_NAME.Result [nested class with link] &nbsp;&nbsp; 27ec6335c32de676<br>CLASS_NAMEIntTest&nbsp;&nbsp;&nbsp; c508b26e62564a2b<br>CLASS_NAMETest&nbsp;&nbsp;&nbsp; d101cb5455c0b79d<br>CLASS_NAMETest.TestDelegate&nbsp;&nbsp;&nbsp; 89770d1905c6d466<br><br><br>When not using AspectJ LTW the class appears in the session page (I needed to comment the tests that used AOP for this to work so the nested class does not appear now):<br><br>CLASS_NAME [with link] &nbsp;&nbsp; 9be84e8927495ca6<br>

CLASS_NAMEIntTest&nbsp;&nbsp;&nbsp; 6e56338794a364f2<br>CLASS_NAMETest&nbsp;&nbsp;&nbsp; d101cb5455c0b79d<br>CLASS_NAMETest.TestDelegate&nbsp;&nbsp;&nbsp; 89770d1905c6d466<br><br>
</div>
<div>
<br><br>This is my Jacoco Maven plugin configuration:<br><br>&lt;plugin&gt;<br>

&nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.jacoco&lt;/groupId&gt;<br>&nbsp;&nbsp;&nbsp; &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;<br>&nbsp;&nbsp;&nbsp; &lt;version&gt;0.6.3.201306030806&lt;/version&gt;<br>&nbsp;&nbsp;&nbsp; &lt;configuration&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;propertyName&gt;coverageAgent&lt;/propertyName&gt;<br>

&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;skip&gt;false&lt;/skip&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;excludes&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; EXCLUDES LIST<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/excludes&gt;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;classDumpDir&gt;${basedir}/target/jacoco-classes&lt;/classDumpDir&gt;<br>

&nbsp;&nbsp;&nbsp; &lt;/configuration&gt;<br><br>&nbsp;&nbsp;&nbsp; &lt;executions&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;execution&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;id&gt;prepare-agent&lt;/id&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goals&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goal&gt;prepare-agent&lt;/goal&gt;<br>

&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/goals&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/execution&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;execution&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;id&gt;report&lt;/id&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;phase&gt;prepare-package&lt;/phase&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goals&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goal&gt;report&lt;/goal&gt;<br>

&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/goals&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/execution&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;execution&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;id&gt;check&lt;/id&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goals&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;goal&gt;check&lt;/goal&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/goals&gt;<br>

&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;configuration&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;rules&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; RULES LIST<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/rules&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/configuration&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/execution&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/executions&gt;<br>

&lt;/plugin&gt;<br><br><br><br>
</div>
<div>and my Maven Surefire plugin configuration:<br><br>&lt;plugin&gt;<br>&nbsp;&nbsp;&nbsp; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br>&nbsp;&nbsp;&nbsp; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;<br>

&nbsp;&nbsp;&nbsp; &lt;version&gt;2.15&lt;/version&gt;<br><br>&nbsp;&nbsp;&nbsp; &lt;configuration&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;groups&gt;specific_test_group&lt;/groups&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;argLine&gt;-Xmx1024m -XX:MaxPermSize=256m ${coverageAgent} -javaagent:"${aspectj.agent.jar}"&lt;/argLine&gt;<br>

&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;properties&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;property&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;name&gt;listener&lt;/name&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;value&gt;SOME_TESTNG_LISTENERS&lt;/value&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/property&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/properties&gt;<br>

&nbsp;&nbsp;&nbsp; &lt;/configuration&gt;<br>&lt;/plugin&gt;<br>
</div>
<div><br></div>
<div>
<br><br>Thanks,<br>
</div>
<div>Andr&eacute;<br>
</div>
</div>
<div class="HOEnZb"><div class="h5">
<div class="gmail_extra">
<br><br><div class="gmail_quote">
On Sun, Jul 21, 2013 at 4:58 PM, Marc R. Hoffmann <span dir="ltr">&lt;<a href="mailto:hoffmann-a8GzhnWS74BMKzkbnucVRwC/G2K4zDHf@public.gmane.org" target="_blank">hoffmann &lt;at&gt; mountainminds.com</a>&gt;</span> wrote:<br><blockquote class="gmail_quote">Hi Andr&eacute;,<br><br>
this strange. If the JaCoCo agent really is the very first agent in the command line it should see the class files (or JARs) from the file system. So if the report is created based on the exact same file the report should show coverage for all executed classes.<br><br>
In the JaCoCo HTML report can you please check whether the classes in question are listed on the sessions page (link in the top right corner).<br><br>
Thanks,<br>
-marc<div><div>
<br><br>
On 20.07.13 19:03, <a href="mailto:andredasilvapinto-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org" target="_blank">andredasilvapinto-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org</a> wrote:<br><blockquote class="gmail_quote">
Hi,<br><br>
I'm using Java 1.7, AspectJ 1.7.3 (for load-time weaving), Jacoco Maven plugin 0.6.3.201306030806 and Maven Surefire Plugin 2.15 to run the tests. In these conditions Jacoco doesn't work correctly.<br><br>
If Jacoco's Java agent is set as the second Java agent (after AspectJ weaver agent), the build produces these errors:<br><br>
java.lang.instrument.IllegalClassFormatException: Error while instrumenting class CLASS_NAME.<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:89)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at sun.instrument.TransformerManager.transform(TransformerManager.java:188)<br>
...<br>
Caused by: java.io.IOException: Error while instrumenting class CLASS_NAME.<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrumentError(Instrumenter.java:147)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:98)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:87)<br>
&nbsp; &nbsp; &nbsp; &nbsp; ... 64 more<br>
Caused by: java.lang.IllegalStateException: Missing or invalid stackmap frames.<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.assertValidFrames(FrameTracker.java:613)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.pop(FrameTracker.java:602)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.visitVarInsn(FrameTracker.java:386)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.tree.VarInsnNode.accept(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.tree.InsnList.accept(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.tree.MethodNode.accept(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.internal.flow.ClassProbesAdapter$1.visitEnd(ClassProbesAdapter.java:124)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.b(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown Source)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:78)<br>
&nbsp; &nbsp; &nbsp; &nbsp; at org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:96)<br>
&nbsp; &nbsp; &nbsp; &nbsp; ... 65 more<br><br><br>
if it is set as the first Java Agent (before AspectJ) it works for most classes, but fails to produce correct coverage reports for weaved classes (all the lines appear as not covered even though I have tests covering them).<br><br>
I tried to use the classdumpdir solution presented here: <a href="https://github.com/jacoco/eclemma/issues/33" target="_blank">https://github.com/jacoco/eclemma/issues/33</a> but I can't find a equivalent Maven configuration for the setting the check and report Jacoco goals to use the classdumpdir directory.<br><br>
Does anyone have a solution for this?<br><br>
Thanks,<br>
Andr&eacute;.<br><br><br><br>
On Wednesday, March 6, 2013 8:52:36 AM UTC, Erik Vande Velde wrote:<br><blockquote class="gmail_quote">
Hi Henrik,<br><br><br>
This did indeed solve my problem, thanks !!!<br><br><br>
2013/3/6 Henrik Horneber &lt;<a href="mailto:horn...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org" target="_blank">horn...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org</a>&gt;<br><br><br>
Hi,<br><br><br>
I've successfully used JaCoCo together with AspectJ.<br><br><br>
You need to make sure<br><br><br>
* you use AspectJ version &gt;= 1.7<br><br>
* java source and target are also set to 1.7<br><br><br><br>
Then AspectJ will generate class files JaCoCo can use.<br><br><br>
Best regards,<br><br>
Henrik<br><br><br><br><br><br><br>
On Wed, Mar 6, 2013 at 8:02 AM, Erik Vande Velde &lt;<a href="mailto:vandeve...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org" target="_blank">vandeve...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org</a>&gt; wrote:<br><br><br><br><br>
Hello Marc,<br><br><br>
Thanks for your reaction! I'll put your question on the Aspectj forum today.<br><br><br><br><br>
Kind Regards,<br>
&nbsp; &nbsp; Erik<br><br><br>
2013/3/5 Marc Hoffmann &lt;<a href="mailto:hoff...-a8GzhnWS74BMKzkbnucVRwC/G2K4zDHf@public.gmane.org" target="_blank">hoff...-a8GzhnWS74BMKzkbnucVRwC/G2K4zDHf@public.gmane.org</a>&gt;<br><br><br><br><br><br>
Hi,<br><br><br><br>
in any case JaCoCo requires valid classfiles as input. This implies that class files from version 1.6 on need to contain valid stackmap frames. If this is not the case JaCoCo will fail with exactly this message.<br><br><br><br>
Have you reported the problem to AspectJ?<br><br><br><br>
Best regards,<br><br>
-marc<br><br><br><br><br><br><br><br>
On 2013-03-05 16:50, <a href="mailto:vandeve...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org" target="_blank">vandeve...-Re5JQEeQqe8AvxtiuMwx3w@public.gmane.org</a> wrote:<br><br><br>
I downloaded JaCoCo today, and got the ant + maven examples going<br><br>
immediately.<br><br>
But when I change the pom.xml of our project in a similar way as the<br><br>
examples I'm in trouble, almost certainly because we use Aspectj in<br><br>
that project:<br><br><br><br>
1) offline modus:<br><br>
Here I get the following error message:<br><br>
[ERROR] Failed to execute goal<br><br>
org.jacoco:jacoco-maven-plugin:0.6.2.201302030002:instrument (default)<br><br>
&nbsp; on project com.fugro.gwf.server.core: Execution default of goal<br><br>
org.jacoco:jacoco-maven-plugin:0.6.2.201302030002:instrument failed:<br><br>
&nbsp; Missing or invalid stackmap frames. -&gt; [Help 1]<br><br><br><br>
2) on the fly modus:<br><br>
Running com.fugro.gwf.server.core.synchronisation.Synchronise1Test<br><br>
Start java.lang.instrument.IllegalClassFormatException:<br><br>
Error while instrumenting class<br><br>
com/fugro/gwf/server/core/referencing/ReferencingAspect.<br><br>
Underneath this message the stack trace once more shows:<br><br>
Caused by: java.lang.IllegalStateException: Missing or invalid<br><br>
stackmap frames.<br><br><br><br>
My questions:<br><br>
1) Is there a way to get coverage information for an aspectj project<br><br>
in JaCoCo?<br><br>
2) If not, do you know an alternative tool that can deal with aspectj<br><br>
projects. I tried clover, but they simply say they don't support<br><br>
aspectj projects. I also tried Coburtera and emma, but assumed JaCoCo<br><br>
is a more recent (and better supported) tool<br>
</blockquote>
</blockquote>
<br>
-- <br>
You received this message because you are subscribed to a topic in the Google Groups "JaCoCo and EclEmma Users" group.<br>
</div></div>
<div><div>
To unsubscribe from this topic, visit <a href="https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe" target="_blank">https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe</a>.<br>
To unsubscribe from this group and all its topics, send an email to <a href="mailto:jacoco%2Bunsubscribe-/JYPxA39Uh5TLH3MbocFFw@public.gmane.org" target="_blank">jacoco+unsubscribe &lt;at&gt; googlegroups.com</a>.<br>
For more options, visit <a href="https://groups.google.com/groups/opt_out" target="_blank">https://groups.google.com/groups/opt_out</a>.<br><br><br>
</div></div>
</blockquote>
</div>
<br>
</div>
</div></div>
</blockquote>
</div>
<br>
</div>

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups "JaCoCo and EclEmma Users" group.<br>
To unsubscribe from this group and stop receiving emails from it, send an email to jacoco+unsubscribe-/JYPxA39Uh5TLH3MbocFF+G/Ez6ZCGd0@public.gmane.org<br>
For more options, visit <a href="https://groups.google.com/groups/opt_out">https://groups.google.com/groups/opt_out</a>.<br>
&nbsp;<br>
&nbsp;<br>
</div>
<DIV class=posted>
<form class="spam" method="post" action="http://spam.gmane.org/gmane.comp.java.jacoco.user:136:unconfirmed" onsubmit="openSpamFrame(this); return false;">
<A href="http://permalink.gmane.org/gmane.comp.java.jacoco.user/136">Permalink</A>
| <a href="http://post.gmane.org/post.php?group=gmane.comp.java.jacoco.user&amp;followup=136" rel=nofollow>Reply</a>
| <input class="spam" type="submit" value="Report this as spam">
</form>
</DIV>  

</DIV>  
</DIV>  

</div>
<div class=posting>
<DIV class=entry>
<DIV class=date>
<div class=options><a rel=nofollow href="#" onclick="return toggle('o5');">headers</a></div>
<span class=author>
<a href="http://search.gmane.org/?author=Marc+Hoffmann&amp;sort=date" rel=nofollow>Marc Hoffmann</a>
 | </span>
<SPAN class=day>22 Jul 2013 09:43</SPAN>
</DIV>
<DIV class=blogbody><A name=5></A>
<H3 class=title>Re: [java code coverage] JaCoCo and Aspectj</h3><div id="o5" class="hidden">Marc Hoffmann &lt;<a target="_top" href="http://gmane.org/get-address.php?address=hoffmann%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoffmann@...</a>&gt;<br>
2013-07-22 07:43:31 GMT<br>
</div>
<pre>
Hi André,

if AspectJ replaces classes with other differently named classes things 
get tricky. As you already proposed you might try to dump these extra 
classes and create a report including those classes (although the 
original class probably still renders at not covered). I'm not a Maven 
expert but a possible setup might look like this:

   1) Backup original classes in target/classes
   2) specify classDumpDir for the prepare-agent goal to dump classes to 
target/classes
   2) Create JaCoCo report
   3) Restore target/classes from backup

See documentation of JaCoCo Maven goals: 
<a rel="nofollow" href="http://www.eclemma.org/jacoco/trunk/doc/maven.html" target="_top">http://www.eclemma.org/jacoco/trunk/doc/maven.html</a>

Cheers,
-marc

On 2013-07-21 18:42, André Pinto wrote:
&gt; Hi Marc,
&gt;
&gt; thanks for replying so quickly.
&gt;
&gt; Right now I'm only testing a specific problematic class in order to
&gt; perform faster clean install iterations while trying different
&gt; approaches.
&gt;
&gt; The class that I'm testing does not appear on the Sessions page when 
&gt; I
&gt; have AspectJ weaver agent enabled. In its place there are two
&gt; AjcClosure classes from AspectJ:
&gt;
&gt; CLASS_NAME.AjcClosure1    8b30d747616523a0
&gt;  CLASS_NAME.AjcClosure3    b62aad26ee5ff4eb
&gt; CLASS_NAME.Result [nested class with link]    27ec6335c32de676
&gt; CLASS_NAMEIntTest    c508b26e62564a2b
&gt; CLASS_NAMETest    d101cb5455c0b79d
&gt; CLASS_NAMETest.TestDelegate    89770d1905c6d466
&gt;
&gt; When not using AspectJ LTW the class appears in the session page (I
&gt; needed to comment the tests that used AOP for this to work so the
&gt; nested class does not appear now):
&gt;
&gt; CLASS_NAME [with link]    9be84e8927495ca6
&gt;  CLASS_NAMEIntTest    6e56338794a364f2
&gt; CLASS_NAMETest    d101cb5455c0b79d
&gt; CLASS_NAMETest.TestDelegate    89770d1905c6d466
&gt;
&gt; This is my Jacoco Maven plugin configuration:
&gt;
&gt; &lt;plugin&gt;
&gt;      &lt;groupId&gt;org.jacoco&lt;/groupId&gt;
&gt;     &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;
&gt;     &lt;version&gt;0.6.3.201306030806&lt;/version&gt;
&gt;     &lt;configuration&gt;
&gt;         &lt;propertyName&gt;coverageAgent&lt;/propertyName&gt;
&gt;          &lt;skip&gt;false&lt;/skip&gt;
&gt;         &lt;excludes&gt;
&gt;                 EXCLUDES LIST
&gt;         &lt;/excludes&gt;
&gt;
&gt;        
&gt; &lt;classDumpDir&gt;${basedir}/target/jacoco-classes&lt;/classDumpDir&gt;
&gt;      &lt;/configuration&gt;
&gt;
&gt;     &lt;executions&gt;
&gt;         &lt;execution&gt;
&gt;             &lt;id&gt;prepare-agent&lt;/id&gt;
&gt;             &lt;goals&gt;
&gt;                 &lt;goal&gt;prepare-agent&lt;/goal&gt;
&gt;              &lt;/goals&gt;
&gt;         &lt;/execution&gt;
&gt;         &lt;execution&gt;
&gt;             &lt;id&gt;report&lt;/id&gt;
&gt;             &lt;phase&gt;prepare-package&lt;/phase&gt;
&gt;             &lt;goals&gt;
&gt;                 &lt;goal&gt;report&lt;/goal&gt;
&gt;              &lt;/goals&gt;
&gt;         &lt;/execution&gt;
&gt;         &lt;execution&gt;
&gt;             &lt;id&gt;check&lt;/id&gt;
&gt;             &lt;goals&gt;
&gt;                 &lt;goal&gt;check&lt;/goal&gt;
&gt;             &lt;/goals&gt;
&gt;              &lt;configuration&gt;
&gt;                 &lt;rules&gt;
&gt;                     RULES LIST
&gt;                 &lt;/rules&gt;
&gt;             &lt;/configuration&gt;
&gt;         &lt;/execution&gt;
&gt;     &lt;/executions&gt;
&gt;  &lt;/plugin&gt;
&gt;
&gt; and my Maven Surefire plugin configuration:
&gt;
&gt; &lt;plugin&gt;
&gt;     &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
&gt;     &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
&gt;      &lt;version&gt;2.15&lt;/version&gt;
&gt;
&gt;     &lt;configuration&gt;
&gt;         &lt;groups&gt;specific_test_group&lt;/groups&gt;
&gt;         &lt;argLine&gt;-Xmx1024m -XX:MaxPermSize=256m ${coverageAgent}
&gt; -javaagent:"${aspectj.agent.jar}"&lt;/argLine&gt;
&gt;          &lt;properties&gt;
&gt;             &lt;property&gt;
&gt;                 &lt;name&gt;listener&lt;/name&gt;
&gt;                 &lt;value&gt;SOME_TESTNG_LISTENERS&lt;/value&gt;
&gt;             &lt;/property&gt;
&gt;         &lt;/properties&gt;
&gt;      &lt;/configuration&gt;
&gt; &lt;/plugin&gt;
&gt;
&gt; Thanks,
&gt;
&gt; André
&gt;
&gt; On Sun, Jul 21, 2013 at 4:58 PM, Marc R. Hoffmann
&gt; &lt;<a target="_top" href="http://gmane.org/get-address.php?address=hoffmann%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoffmann@...</a> [10]&gt; wrote:
&gt;
&gt;&gt; Hi André,
&gt;&gt;
&gt;&gt; this strange. If the JaCoCo agent really is the very first agent in
&gt;&gt; the command line it should see the class files (or JARs) from the
&gt;&gt; file system. So if the report is created based on the exact same
&gt;&gt; file the report should show coverage for all executed classes.
&gt;&gt;
&gt;&gt; In the JaCoCo HTML report can you please check whether the classes
&gt;&gt; in question are listed on the sessions page (link in the top right
&gt;&gt; corner).
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; -marc
&gt;&gt;
&gt;&gt; On 20.07.13 19:03, <a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a> [6] wrote:
&gt;&gt;
&gt;&gt;&gt; Hi,
&gt;&gt;&gt;
&gt;&gt;&gt; I'm using Java 1.7, AspectJ 1.7.3 (for load-time weaving), Jacoco
&gt;&gt;&gt; Maven plugin 0.6.3.201306030806 and Maven Surefire Plugin 2.15 to
&gt;&gt;&gt; run the tests. In these conditions Jacoco doesn't work correctly.
&gt;&gt;&gt;
&gt;&gt;&gt; If Jacoco's Java agent is set as the second Java agent (after
&gt;&gt;&gt; AspectJ weaver agent), the build produces these errors:
&gt;&gt;&gt;
&gt;&gt;&gt; java.lang.instrument.IllegalClassFormatException: Error while
&gt;&gt;&gt; instrumenting class CLASS_NAME.
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:89)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; sun.instrument.TransformerManager.transform(TransformerManager.java:188)
&gt;&gt;&gt; ...
&gt;&gt;&gt; Caused by: java.io.IOException: Error while instrumenting class
&gt;&gt;&gt; CLASS_NAME.
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrumentError(Instrumenter.java:147)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:98)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:87)
&gt;&gt;&gt;         ... 64 more
&gt;&gt;&gt; Caused by: java.lang.IllegalStateException: Missing or invalid
&gt;&gt;&gt; stackmap frames.
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.assertValidFrames(FrameTracker.java:613)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.pop(FrameTracker.java:602)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.visitVarInsn(FrameTracker.java:386)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown
&gt;&gt;&gt; Source)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown
&gt;&gt;&gt; Source)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.asm.tree.VarInsnNode.accept(Unknown
&gt;&gt;&gt; Source)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; org.jacoco.agent.rt.internal_9dd1198.asm.tree.InsnList.accept(Unknown
&gt;&gt;&gt; Source)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.asm.tree.MethodNode.accept(Unknown
&gt;&gt;&gt; Source)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.flow.ClassProbesAdapter$1.visitEnd(ClassProbesAdapter.java:124)
&gt;&gt;&gt;         at
&gt;&gt;&gt; org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.b(Unknown
&gt;&gt;&gt; Source)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt; org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown
&gt;&gt;&gt; Source)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt; org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown
&gt;&gt;&gt; Source)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:78)
&gt;&gt;&gt;         at
&gt;&gt;&gt;
&gt;&gt;
&gt; 
&gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:96)
&gt;&gt;&gt;         ... 65 more
&gt;&gt;&gt;
&gt;&gt;&gt; if it is set as the first Java Agent (before AspectJ) it works
&gt;&gt;&gt; for most classes, but fails to produce correct coverage reports
&gt;&gt;&gt; for weaved classes (all the lines appear as not covered even
&gt;&gt;&gt; though I have tests covering them).
&gt;&gt;&gt;
&gt;&gt;&gt; I tried to use the classdumpdir solution presented here:
&gt;&gt;&gt; <a rel="nofollow" href="https://github.com/jacoco/eclemma/issues/33" target="_top">https://github.com/jacoco/eclemma/issues/33</a> [5] but I can't find a
&gt;&gt;&gt; equivalent Maven configuration for the setting the check and
&gt;&gt;&gt; report Jacoco goals to use the classdumpdir directory.
&gt;&gt;&gt;
&gt;&gt;&gt; Does anyone have a solution for this?
&gt;&gt;&gt;
&gt;&gt;&gt; Thanks,
&gt;&gt;&gt; André.
&gt;&gt;&gt;
&gt;&gt;&gt; On Wednesday, March 6, 2013 8:52:36 AM UTC, Erik Vande Velde
&gt;&gt;&gt; wrote:
&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi Henrik,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; This did indeed solve my problem, thanks !!!
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2013/3/6 Henrik Horneber &lt;<a target="_top" href="http://gmane.org/get-address.php?address=horn...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">horn...@...</a> [1]&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I've successfully used JaCoCo together with AspectJ.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; You need to make sure
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; * you use AspectJ version &gt;= 1.7
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; * java source and target are also set to 1.7
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Then AspectJ will generate class files JaCoCo can use.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Best regards,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Henrik
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On Wed, Mar 6, 2013 at 8:02 AM, Erik Vande Velde
&gt;&gt;&gt;&gt; &lt;<a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a> [2]&gt; wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hello Marc,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks for your reaction! I'll put your question on the Aspectj
&gt;&gt;&gt;&gt; forum today.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Kind Regards,
&gt;&gt;&gt;&gt;     Erik
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2013/3/5 Marc Hoffmann &lt;<a target="_top" href="http://gmane.org/get-address.php?address=hoff...%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoff...@...</a> [3]&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Hi,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; in any case JaCoCo requires valid classfiles as input. This
&gt;&gt;&gt;&gt; implies that class files from version 1.6 on need to contain
&gt;&gt;&gt;&gt; valid stackmap frames. If this is not the case JaCoCo will fail
&gt;&gt;&gt;&gt; with exactly this message.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Have you reported the problem to AspectJ?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Best regards,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; -marc
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; On 2013-03-05 16:50, <a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a> [4] wrote:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I downloaded JaCoCo today, and got the ant + maven examples
&gt;&gt;&gt;&gt; going
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; immediately.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; But when I change the pom.xml of our project in a similar way
&gt;&gt;&gt;&gt; as the
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; examples I'm in trouble, almost certainly because we use
&gt;&gt;&gt;&gt; Aspectj in
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; that project:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 1) offline modus:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Here I get the following error message:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; [ERROR] Failed to execute goal
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; org.jacoco:jacoco-maven-plugin:0.6.2.201302030002:instrument
&gt;&gt;&gt;&gt; (default)
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;   on project com.fugro.gwf.server.core: Execution default of
&gt;&gt;&gt;&gt; goal
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; org.jacoco:jacoco-maven-plugin:0.6.2.201302030002:instrument
&gt;&gt;&gt;&gt; failed:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;   Missing or invalid stackmap frames. -&gt; [Help 1]
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2) on the fly modus:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Running
&gt;&gt;&gt;&gt; com.fugro.gwf.server.core.synchronisation.Synchronise1Test
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Start java.lang.instrument.IllegalClassFormatException:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Error while instrumenting class
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; com/fugro/gwf/server/core/referencing/ReferencingAspect.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Underneath this message the stack trace once more shows:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Caused by: java.lang.IllegalStateException: Missing or invalid
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; stackmap frames.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; My questions:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 1) Is there a way to get coverage information for an aspectj
&gt;&gt;&gt;&gt; project
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; in JaCoCo?
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; 2) If not, do you know an alternative tool that can deal with
&gt;&gt;&gt;&gt; aspectj
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; projects. I tried clover, but they simply say they don't
&gt;&gt;&gt;&gt; support
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; aspectj projects. I also tried Coburtera and emma, but assumed
&gt;&gt;&gt;&gt; JaCoCo
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; is a more recent (and better supported) tool
&gt;&gt;
&gt;&gt; --
&gt;&gt; You received this message because you are subscribed to a topic in
&gt;&gt; the Google Groups "JaCoCo and EclEmma Users" group.
&gt;&gt;
&gt;&gt; To unsubscribe from this topic, visit
&gt;&gt; <a rel="nofollow" href="https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe" target="_top">https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe</a>
&gt;&gt; [7].
&gt;&gt; To unsubscribe from this group and all its topics, send an email to
&gt;&gt; <a target="_top" href="http://gmane.org/get-address.php?address=jacoco%2bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFFw%40public.gmane.org" rel="nofollow">jacoco+unsubscribe@...</a> [8].
&gt;&gt; For more options, visit <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>
&gt;&gt; [9].
&gt;
&gt;  --
&gt;  You received this message because you are subscribed to the Google
&gt; Groups "JaCoCo and EclEmma Users" group.
&gt;  To unsubscribe from this group and stop receiving emails from it,
&gt; send an email to <a target="_top" href="http://gmane.org/get-address.php?address=jacoco%2bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFF%2bG%2fEz6ZCGd0%40public.gmane.org" rel="nofollow">jacoco+unsubscribe@...</a>
&gt;  For more options, visit <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>
&gt; [11].
&gt;
&gt;
&gt;
&gt; Links:
&gt; ------
&gt; [1] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=horn...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">horn...@...</a>
&gt; [2] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a>
&gt; [3] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=hoff...%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoff...@...</a>
&gt; [4] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a>
&gt; [5] <a rel="nofollow" href="https://github.com/jacoco/eclemma/issues/33" target="_top">https://github.com/jacoco/eclemma/issues/33</a>
&gt; [6] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a>
&gt; [7] <a rel="nofollow" href="https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe" target="_top">https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe</a>
&gt; [8] mailto:jacoco%<a target="_top" href="http://gmane.org/get-address.php?address=2Bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFFw%40public.gmane.org" rel="nofollow">2Bunsubscribe@...</a>
&gt; [9] <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>
&gt; [10] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=hoffmann%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoffmann@...</a>
&gt; [11] <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>

<span class="togsig"><a rel=nofollow href="#" onclick="return toggle('sig5')">--</a></span>
<span id="sig5" class=signature>
-- 
You received this message because you are subscribed to the Google Groups "JaCoCo and EclEmma Users" group.
To unsubscribe from this group and stop receiving emails from it, send an email to <a target="_top" href="http://gmane.org/get-address.php?address=jacoco%2bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFF%2bG%2fEz6ZCGd0%40public.gmane.org" rel="nofollow">jacoco+unsubscribe@...</a>
For more options, visit <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>.

</span></pre>
<DIV class=posted>
<form class="spam" method="post" action="http://spam.gmane.org/gmane.comp.java.jacoco.user:137:unconfirmed" onsubmit="openSpamFrame(this); return false;">
<A href="http://permalink.gmane.org/gmane.comp.java.jacoco.user/137">Permalink</A>
| <a href="http://post.gmane.org/post.php?group=gmane.comp.java.jacoco.user&amp;followup=137" rel=nofollow>Reply</a>
| <input class="spam" type="submit" value="Report this as spam">
</form>
</DIV>  

</DIV>  
</DIV>  

<div class=posting>
<DIV class=entry>
<DIV class=date>
<div class=options><a rel=nofollow href="#" onclick="return toggle('o6');">headers</a></div>
<span class=author>
<a href="http://search.gmane.org/?author=andredasilvapinto&amp;sort=date" rel=nofollow>andredasilvapinto</a>
 | </span>
<SPAN class=day>23 Jul 2013 01:53</SPAN>
</DIV>
<DIV class=blogbody><A name=5></A>
<div class=face>
<a target="_top" href="http://ftp.cs.indiana.edu/pub/faces/picons/"><img border=0 alt="Picon" src="http://cache.gmane.org//gmane/comp/java/jacoco/user/141-picon-001.gif"></a>
<br>
</div>
<H3 class=title>Re: [java code coverage] JaCoCo and Aspectj</h3><div id="o6" class="hidden">&lt;<a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a>&gt;<br>
2013-07-22 23:53:07 GMT<br>
</div>
<pre>
Hi Marc,

thanks again for your reply.

I think AspectJ doesn't change the name of the class, but actually creates those additional classes to
serve as support for AOP advices. If I set a breakpoint in a method of that class, during the build I can see it
is still reached and the call trace looks something like this:

METHOD_NAME_aroundBody0():76, CLASS_NAME
run():1, CLASS_NAME$AjcClosure1

... (aspect methods)

METHOD_NAME():76, CLASS_NAME
TEST_NAME

so both the AjcClosure and the actual class are present and called.

Today I've tried to use offline instrumentation and it appears to have solved the problem. I know this is not
the recommended approach and that it introduces additional issues, like not being able to run a maven
test-goal-only phase after a failed test goal without manually running the
restore-instrumented-classes goal; but I think I will have to use it while the run time instrumentation
doesn't work (or if it is actually impossible to do the same thing with run time instrumentation).  

Thanks,
André.

On Monday, July 22, 2013 8:43:31 AM UTC+1, Marc R. Hoffmann wrote:
&gt; Hi André,
&gt; 
&gt; 
&gt; 
&gt; if AspectJ replaces classes with other differently named classes things 
&gt; 
&gt; get tricky. As you already proposed you might try to dump these extra 
&gt; 
&gt; classes and create a report including those classes (although the 
&gt; 
&gt; original class probably still renders at not covered). I'm not a Maven 
&gt; 
&gt; expert but a possible setup might look like this:
&gt; 
&gt; 
&gt; 
&gt;    1) Backup original classes in target/classes
&gt; 
&gt;    2) specify classDumpDir for the prepare-agent goal to dump classes to 
&gt; 
&gt; target/classes
&gt; 
&gt;    2) Create JaCoCo report
&gt; 
&gt;    3) Restore target/classes from backup
&gt; 
&gt; 
&gt; 
&gt; See documentation of JaCoCo Maven goals: 
&gt; 
&gt; <a rel="nofollow" href="http://www.eclemma.org/jacoco/trunk/doc/maven.html" target="_top">http://www.eclemma.org/jacoco/trunk/doc/maven.html</a>
&gt; 
&gt; 
&gt; 
&gt; Cheers,
&gt; 
&gt; -marc
&gt; 
&gt; 
&gt; 
&gt; On 2013-07-21 18:42, André Pinto wrote:
&gt; 
&gt; &gt; Hi Marc,
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; thanks for replying so quickly.
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; Right now I'm only testing a specific problematic class in order to
&gt; 
&gt; &gt; perform faster clean install iterations while trying different
&gt; 
&gt; &gt; approaches.
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; The class that I'm testing does not appear on the Sessions page when 
&gt; 
&gt; &gt; I
&gt; 
&gt; &gt; have AspectJ weaver agent enabled. In its place there are two
&gt; 
&gt; &gt; AjcClosure classes from AspectJ:
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; CLASS_NAME.AjcClosure1    8b30d747616523a0
&gt; 
&gt; &gt;  CLASS_NAME.AjcClosure3    b62aad26ee5ff4eb
&gt; 
&gt; &gt; CLASS_NAME.Result [nested class with link]    27ec6335c32de676
&gt; 
&gt; &gt; CLASS_NAMEIntTest    c508b26e62564a2b
&gt; 
&gt; &gt; CLASS_NAMETest    d101cb5455c0b79d
&gt; 
&gt; &gt; CLASS_NAMETest.TestDelegate    89770d1905c6d466
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; When not using AspectJ LTW the class appears in the session page (I
&gt; 
&gt; &gt; needed to comment the tests that used AOP for this to work so the
&gt; 
&gt; &gt; nested class does not appear now):
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; CLASS_NAME [with link]    9be84e8927495ca6
&gt; 
&gt; &gt;  CLASS_NAMEIntTest    6e56338794a364f2
&gt; 
&gt; &gt; CLASS_NAMETest    d101cb5455c0b79d
&gt; 
&gt; &gt; CLASS_NAMETest.TestDelegate    89770d1905c6d466
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; This is my Jacoco Maven plugin configuration:
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; &lt;plugin&gt;
&gt; 
&gt; &gt;      &lt;groupId&gt;org.jacoco&lt;/groupId&gt;
&gt; 
&gt; &gt;     &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;
&gt; 
&gt; &gt;     &lt;version&gt;0.6.3.201306030806&lt;/version&gt;
&gt; 
&gt; &gt;     &lt;configuration&gt;
&gt; 
&gt; &gt;         &lt;propertyName&gt;coverageAgent&lt;/propertyName&gt;
&gt; 
&gt; &gt;          &lt;skip&gt;false&lt;/skip&gt;
&gt; 
&gt; &gt;         &lt;excludes&gt;
&gt; 
&gt; &gt;                 EXCLUDES LIST
&gt; 
&gt; &gt;         &lt;/excludes&gt;
&gt; 
&gt; &gt;
&gt; 
&gt; &gt;        
&gt; 
&gt; &gt; &lt;classDumpDir&gt;${basedir}/target/jacoco-classes&lt;/classDumpDir&gt;
&gt; 
&gt; &gt;      &lt;/configuration&gt;
&gt; 
&gt; &gt;
&gt; 
&gt; &gt;     &lt;executions&gt;
&gt; 
&gt; &gt;         &lt;execution&gt;
&gt; 
&gt; &gt;             &lt;id&gt;prepare-agent&lt;/id&gt;
&gt; 
&gt; &gt;             &lt;goals&gt;
&gt; 
&gt; &gt;                 &lt;goal&gt;prepare-agent&lt;/goal&gt;
&gt; 
&gt; &gt;              &lt;/goals&gt;
&gt; 
&gt; &gt;         &lt;/execution&gt;
&gt; 
&gt; &gt;         &lt;execution&gt;
&gt; 
&gt; &gt;             &lt;id&gt;report&lt;/id&gt;
&gt; 
&gt; &gt;             &lt;phase&gt;prepare-package&lt;/phase&gt;
&gt; 
&gt; &gt;             &lt;goals&gt;
&gt; 
&gt; &gt;                 &lt;goal&gt;report&lt;/goal&gt;
&gt; 
&gt; &gt;              &lt;/goals&gt;
&gt; 
&gt; &gt;         &lt;/execution&gt;
&gt; 
&gt; &gt;         &lt;execution&gt;
&gt; 
&gt; &gt;             &lt;id&gt;check&lt;/id&gt;
&gt; 
&gt; &gt;             &lt;goals&gt;
&gt; 
&gt; &gt;                 &lt;goal&gt;check&lt;/goal&gt;
&gt; 
&gt; &gt;             &lt;/goals&gt;
&gt; 
&gt; &gt;              &lt;configuration&gt;
&gt; 
&gt; &gt;                 &lt;rules&gt;
&gt; 
&gt; &gt;                     RULES LIST
&gt; 
&gt; &gt;                 &lt;/rules&gt;
&gt; 
&gt; &gt;             &lt;/configuration&gt;
&gt; 
&gt; &gt;         &lt;/execution&gt;
&gt; 
&gt; &gt;     &lt;/executions&gt;
&gt; 
&gt; &gt;  &lt;/plugin&gt;
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; and my Maven Surefire plugin configuration:
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; &lt;plugin&gt;
&gt; 
&gt; &gt;     &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
&gt; 
&gt; &gt;     &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
&gt; 
&gt; &gt;      &lt;version&gt;2.15&lt;/version&gt;
&gt; 
&gt; &gt;
&gt; 
&gt; &gt;     &lt;configuration&gt;
&gt; 
&gt; &gt;         &lt;groups&gt;specific_test_group&lt;/groups&gt;
&gt; 
&gt; &gt;         &lt;argLine&gt;-Xmx1024m -XX:MaxPermSize=256m ${coverageAgent}
&gt; 
&gt; &gt; -javaagent:"${aspectj.agent.jar}"&lt;/argLine&gt;
&gt; 
&gt; &gt;          &lt;properties&gt;
&gt; 
&gt; &gt;             &lt;property&gt;
&gt; 
&gt; &gt;                 &lt;name&gt;listener&lt;/name&gt;
&gt; 
&gt; &gt;                 &lt;value&gt;SOME_TESTNG_LISTENERS&lt;/value&gt;
&gt; 
&gt; &gt;             &lt;/property&gt;
&gt; 
&gt; &gt;         &lt;/properties&gt;
&gt; 
&gt; &gt;      &lt;/configuration&gt;
&gt; 
&gt; &gt; &lt;/plugin&gt;
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; Thanks,
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; André
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; On Sun, Jul 21, 2013 at 4:58 PM, Marc R. Hoffmann
&gt; 
&gt; &gt; &lt;<a target="_top" href="http://gmane.org/get-address.php?address=hoffmann%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoffmann@...</a> [10]&gt; wrote:
&gt; 
&gt; &gt;
&gt; 
&gt; &gt;&gt; Hi André,
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt;&gt; this strange. If the JaCoCo agent really is the very first agent in
&gt; 
&gt; &gt;&gt; the command line it should see the class files (or JARs) from the
&gt; 
&gt; &gt;&gt; file system. So if the report is created based on the exact same
&gt; 
&gt; &gt;&gt; file the report should show coverage for all executed classes.
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt;&gt; In the JaCoCo HTML report can you please check whether the classes
&gt; 
&gt; &gt;&gt; in question are listed on the sessions page (link in the top right
&gt; 
&gt; &gt;&gt; corner).
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt;&gt; Thanks,
&gt; 
&gt; &gt;&gt; -marc
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt;&gt; On 20.07.13 19:03, <a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a> [6] wrote:
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt;&gt;&gt; Hi,
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt; I'm using Java 1.7, AspectJ 1.7.3 (for load-time weaving), Jacoco
&gt; 
&gt; &gt;&gt;&gt; Maven plugin 0.6.3.201306030806 and Maven Surefire Plugin 2.15 to
&gt; 
&gt; &gt;&gt;&gt; run the tests. In these conditions Jacoco doesn't work correctly.
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt; If Jacoco's Java agent is set as the second Java agent (after
&gt; 
&gt; &gt;&gt;&gt; AspectJ weaver agent), the build produces these errors:
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt; java.lang.instrument.IllegalClassFormatException: Error while
&gt; 
&gt; &gt;&gt;&gt; instrumenting class CLASS_NAME.
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:89)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; sun.instrument.TransformerManager.transform(TransformerManager.java:188)
&gt; 
&gt; &gt;&gt;&gt; ...
&gt; 
&gt; &gt;&gt;&gt; Caused by: java.io.IOException: Error while instrumenting class
&gt; 
&gt; &gt;&gt;&gt; CLASS_NAME.
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrumentError(Instrumenter.java:147)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:98)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:87)
&gt; 
&gt; &gt;&gt;&gt;         ... 64 more
&gt; 
&gt; &gt;&gt;&gt; Caused by: java.lang.IllegalStateException: Missing or invalid
&gt; 
&gt; &gt;&gt;&gt; stackmap frames.
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.assertValidFrames(FrameTracker.java:613)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.pop(FrameTracker.java:602)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.visitVarInsn(FrameTracker.java:386)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown
&gt; 
&gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown
&gt; 
&gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.asm.tree.VarInsnNode.accept(Unknown
&gt; 
&gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.asm.tree.InsnList.accept(Unknown
&gt; 
&gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.asm.tree.MethodNode.accept(Unknown
&gt; 
&gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.flow.ClassProbesAdapter$1.visitEnd(ClassProbesAdapter.java:124)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt; org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.b(Unknown
&gt; 
&gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt; org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown
&gt; 
&gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt; org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown
&gt; 
&gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:78)
&gt; 
&gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:96)
&gt; 
&gt; &gt;&gt;&gt;         ... 65 more
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt; if it is set as the first Java Agent (before AspectJ) it works
&gt; 
&gt; &gt;&gt;&gt; for most classes, but fails to produce correct coverage reports
&gt; 
&gt; &gt;&gt;&gt; for weaved classes (all the lines appear as not covered even
&gt; 
&gt; &gt;&gt;&gt; though I have tests covering them).
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt; I tried to use the classdumpdir solution presented here:
&gt; 
&gt; &gt;&gt;&gt; <a rel="nofollow" href="https://github.com/jacoco/eclemma/issues/33" target="_top">https://github.com/jacoco/eclemma/issues/33</a> [5] but I can't find a
&gt; 
&gt; &gt;&gt;&gt; equivalent Maven configuration for the setting the check and
&gt; 
&gt; &gt;&gt;&gt; report Jacoco goals to use the classdumpdir directory.
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt; Does anyone have a solution for this?
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt; Thanks,
&gt; 
&gt; &gt;&gt;&gt; André.
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt; On Wednesday, March 6, 2013 8:52:36 AM UTC, Erik Vande Velde
&gt; 
&gt; &gt;&gt;&gt; wrote:
&gt; 
&gt; &gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Hi Henrik,
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; This did indeed solve my problem, thanks !!!
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; 2013/3/6 Henrik Horneber &lt;<a target="_top" href="http://gmane.org/get-address.php?address=horn...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">horn...@...</a> [1]&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Hi,
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; I've successfully used JaCoCo together with AspectJ.
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; You need to make sure
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; * you use AspectJ version &gt;= 1.7
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; * java source and target are also set to 1.7
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Then AspectJ will generate class files JaCoCo can use.
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Best regards,
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Henrik
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; On Wed, Mar 6, 2013 at 8:02 AM, Erik Vande Velde
&gt; 
&gt; &gt;&gt;&gt;&gt; &lt;<a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a> [2]&gt; wrote:
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Hello Marc,
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Thanks for your reaction! I'll put your question on the Aspectj
&gt; 
&gt; &gt;&gt;&gt;&gt; forum today.
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Kind Regards,
&gt; 
&gt; &gt;&gt;&gt;&gt;     Erik
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; 2013/3/5 Marc Hoffmann &lt;<a target="_top" href="http://gmane.org/get-address.php?address=hoff...%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoff...@...</a> [3]&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Hi,
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; in any case JaCoCo requires valid classfiles as input. This
&gt; 
&gt; &gt;&gt;&gt;&gt; implies that class files from version 1.6 on need to contain
&gt; 
&gt; &gt;&gt;&gt;&gt; valid stackmap frames. If this is not the case JaCoCo will fail
&gt; 
&gt; &gt;&gt;&gt;&gt; with exactly this message.
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Have you reported the problem to AspectJ?
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Best regards,
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; -marc
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; On 2013-03-05 16:50, <a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a> [4] wrote:
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; I downloaded JaCoCo today, and got the ant + maven examples
&gt; 
&gt; &gt;&gt;&gt;&gt; going
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; immediately.
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; But when I change the pom.xml of our project in a similar way
&gt; 
&gt; &gt;&gt;&gt;&gt; as the
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; examples I'm in trouble, almost certainly because we use
&gt; 
&gt; &gt;&gt;&gt;&gt; Aspectj in
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; that project:
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; 1) offline modus:
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Here I get the following error message:
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; [ERROR] Failed to execute goal
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; org.jacoco:jacoco-maven-plugin:0.6.2.201302030002:instrument
&gt; 
&gt; &gt;&gt;&gt;&gt; (default)
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt;   on project com.fugro.gwf.server.core: Execution default of
&gt; 
&gt; &gt;&gt;&gt;&gt; goal
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; org.jacoco:jacoco-maven-plugin:0.6.2.201302030002:instrument
&gt; 
&gt; &gt;&gt;&gt;&gt; failed:
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt;   Missing or invalid stackmap frames. -&gt; [Help 1]
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; 2) on the fly modus:
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Running
&gt; 
&gt; &gt;&gt;&gt;&gt; com.fugro.gwf.server.core.synchronisation.Synchronise1Test
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Start java.lang.instrument.IllegalClassFormatException:
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Error while instrumenting class
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; com/fugro/gwf/server/core/referencing/ReferencingAspect.
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Underneath this message the stack trace once more shows:
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; Caused by: java.lang.IllegalStateException: Missing or invalid
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; stackmap frames.
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; My questions:
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; 1) Is there a way to get coverage information for an aspectj
&gt; 
&gt; &gt;&gt;&gt;&gt; project
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; in JaCoCo?
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; 2) If not, do you know an alternative tool that can deal with
&gt; 
&gt; &gt;&gt;&gt;&gt; aspectj
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; projects. I tried clover, but they simply say they don't
&gt; 
&gt; &gt;&gt;&gt;&gt; support
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; aspectj projects. I also tried Coburtera and emma, but assumed
&gt; 
&gt; &gt;&gt;&gt;&gt; JaCoCo
&gt; 
&gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt;&gt;&gt;&gt; is a more recent (and better supported) tool
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt;&gt; --
&gt; 
&gt; &gt;&gt; You received this message because you are subscribed to a topic in
&gt; 
&gt; &gt;&gt; the Google Groups "JaCoCo and EclEmma Users" group.
&gt; 
&gt; &gt;&gt;
&gt; 
&gt; &gt;&gt; To unsubscribe from this topic, visit
&gt; 
&gt; &gt;&gt; <a rel="nofollow" href="https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe" target="_top">https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe</a>
&gt; 
&gt; &gt;&gt; [7].
&gt; 
&gt; &gt;&gt; To unsubscribe from this group and all its topics, send an email to
&gt; 
&gt; &gt;&gt; <a target="_top" href="http://gmane.org/get-address.php?address=jacoco%2bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFFw%40public.gmane.org" rel="nofollow">jacoco+unsubscribe@...</a> [8].
&gt; 
&gt; &gt;&gt; For more options, visit <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>
&gt; 
&gt; &gt;&gt; [9].
&gt; 
&gt; &gt;
&gt; 
&gt; &gt;  --
&gt; 
&gt; &gt;  You received this message because you are subscribed to the Google
&gt; 
&gt; &gt; Groups "JaCoCo and EclEmma Users" group.
&gt; 
&gt; &gt;  To unsubscribe from this group and stop receiving emails from it,
&gt; 
&gt; &gt; send an email to <a target="_top" href="http://gmane.org/get-address.php?address=jacoco%2bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFF%2bG%2fEz6ZCGd0%40public.gmane.org" rel="nofollow">jacoco+unsubscribe@...</a>
&gt; 
&gt; &gt;  For more options, visit <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>
&gt; 
&gt; &gt; [11].
&gt; 
&gt; &gt;
&gt; 
&gt; &gt;
&gt; 
&gt; &gt;
&gt; 
&gt; &gt; Links:
&gt; 
&gt; &gt; ------
&gt; 
&gt; &gt; [1] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=horn...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">horn...@...</a>
&gt; 
&gt; &gt; [2] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a>
&gt; 
&gt; &gt; [3] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=hoff...%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoff...@...</a>
&gt; 
&gt; &gt; [4] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a>
&gt; 
&gt; &gt; [5] <a rel="nofollow" href="https://github.com/jacoco/eclemma/issues/33" target="_top">https://github.com/jacoco/eclemma/issues/33</a>
&gt; 
&gt; &gt; [6] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a>
&gt; 
&gt; &gt; [7] <a rel="nofollow" href="https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe" target="_top">https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe</a>
&gt; 
&gt; &gt; [8] mailto:jacoco%<a target="_top" href="http://gmane.org/get-address.php?address=2Bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFFw%40public.gmane.org" rel="nofollow">2Bunsubscribe@...</a>
&gt; 
&gt; &gt; [9] <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>
&gt; 
&gt; &gt; [10] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=hoffmann%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoffmann@...</a>
&gt; 
&gt; &gt; [11] <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>

<span class="togsig"><a rel=nofollow href="#" onclick="return toggle('sig6')">--</a></span>
<span id="sig6" class=signature>
-- 
You received this message because you are subscribed to the Google Groups "JaCoCo and EclEmma Users" group.
To unsubscribe from this group and stop receiving emails from it, send an email to <a target="_top" href="http://gmane.org/get-address.php?address=jacoco%2bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFF%2bG%2fEz6ZCGd0%40public.gmane.org" rel="nofollow">jacoco+unsubscribe@...</a>
For more options, visit <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>.

</span></pre>
<DIV class=posted>
<form class="spam" method="post" action="http://spam.gmane.org/gmane.comp.java.jacoco.user:141:unconfirmed" onsubmit="openSpamFrame(this); return false;">
<A href="http://permalink.gmane.org/gmane.comp.java.jacoco.user/141">Permalink</A>
| <a href="http://post.gmane.org/post.php?group=gmane.comp.java.jacoco.user&amp;followup=141" rel=nofollow>Reply</a>
| <input class="spam" type="submit" value="Report this as spam">
</form>
</DIV>  

</DIV>  
</DIV>  

<div class=posting>
<DIV class=entry>
<DIV class=date>
<div class=options><a rel=nofollow href="#" onclick="return toggle('o7');">headers</a></div>
<span class=author>
<a href="http://search.gmane.org/?author=reinhardt.martin&amp;sort=date" rel=nofollow>reinhardt.martin</a>
 | </span>
<SPAN class=day>7 Aug 2013 11:09</SPAN>
</DIV>
<DIV class=blogbody><A name=5></A>
<div class=face>
<a target="_top" href="http://ftp.cs.indiana.edu/pub/faces/picons/"><img border=0 alt="Picon" src="http://cache.gmane.org//gmane/comp/java/jacoco/user/161-picon-001.gif"></a>
<br>
</div>
<H3 class=title>Re: JaCoCo and Aspectj</h3><div id="o7" class="hidden">&lt;<a target="_top" href="http://gmane.org/get-address.php?address=reinhardt.martin%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">reinhardt.martin@...</a>&gt;<br>
2013-08-07 09:09:10 GMT<br>
</div>
<pre>
Did anybody have a valid pom.xml to use jacoco within an aspectJ project?

Am Dienstag, 23. Juli 2013 01:53:07 UTC+2 schrieb <a target="_top" href="http://gmane.org/get-address.php?address=andredas...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredas...@...</a>:
&gt; Hi Marc,
&gt; 
&gt; 
&gt; 
&gt; thanks again for your reply.
&gt; 
&gt; 
&gt; 
&gt; I think AspectJ doesn't change the name of the class, but actually creates those additional classes to
serve as support for AOP advices. If I set a breakpoint in a method of that class, during the build I can see it
is still reached and the call trace looks something like this:
&gt; 
&gt; 
&gt; 
&gt; METHOD_NAME_aroundBody0():76, CLASS_NAME
&gt; 
&gt; run():1, CLASS_NAME$AjcClosure1
&gt; 
&gt; 
&gt; 
&gt; ... (aspect methods)
&gt; 
&gt; 
&gt; 
&gt; METHOD_NAME():76, CLASS_NAME
&gt; 
&gt; TEST_NAME
&gt; 
&gt; 
&gt; 
&gt; so both the AjcClosure and the actual class are present and called.
&gt; 
&gt; 
&gt; 
&gt; Today I've tried to use offline instrumentation and it appears to have solved the problem. I know this is
not the recommended approach and that it introduces additional issues, like not being able to run a maven
test-goal-only phase after a failed test goal without manually running the
restore-instrumented-classes goal; but I think I will have to use it while the run time instrumentation
doesn't work (or if it is actually impossible to do the same thing with run time instrumentation).  
&gt; 
&gt; 
&gt; 
&gt; Thanks,
&gt; 
&gt; André.
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; On Monday, July 22, 2013 8:43:31 AM UTC+1, Marc R. Hoffmann wrote:
&gt; 
&gt; &gt; Hi André,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; if AspectJ replaces classes with other differently named classes things 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; get tricky. As you already proposed you might try to dump these extra 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; classes and create a report including those classes (although the 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; original class probably still renders at not covered). I'm not a Maven 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; expert but a possible setup might look like this:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt;    1) Backup original classes in target/classes
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt;    2) specify classDumpDir for the prepare-agent goal to dump classes to 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; target/classes
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt;    2) Create JaCoCo report
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt;    3) Restore target/classes from backup
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; See documentation of JaCoCo Maven goals: 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; <a rel="nofollow" href="http://www.eclemma.org/jacoco/trunk/doc/maven.html" target="_top">http://www.eclemma.org/jacoco/trunk/doc/maven.html</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; Cheers,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; -marc
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; On 2013-07-21 18:42, André Pinto wrote:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; Hi Marc,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; thanks for replying so quickly.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; Right now I'm only testing a specific problematic class in order to
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; perform faster clean install iterations while trying different
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; approaches.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; The class that I'm testing does not appear on the Sessions page when 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; I
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; have AspectJ weaver agent enabled. In its place there are two
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; AjcClosure classes from AspectJ:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; CLASS_NAME.AjcClosure1    8b30d747616523a0
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;  CLASS_NAME.AjcClosure3    b62aad26ee5ff4eb
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; CLASS_NAME.Result [nested class with link]    27ec6335c32de676
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; CLASS_NAMEIntTest    c508b26e62564a2b
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; CLASS_NAMETest    d101cb5455c0b79d
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; CLASS_NAMETest.TestDelegate    89770d1905c6d466
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; When not using AspectJ LTW the class appears in the session page (I
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; needed to comment the tests that used AOP for this to work so the
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; nested class does not appear now):
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; CLASS_NAME [with link]    9be84e8927495ca6
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;  CLASS_NAMEIntTest    6e56338794a364f2
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; CLASS_NAMETest    d101cb5455c0b79d
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; CLASS_NAMETest.TestDelegate    89770d1905c6d466
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; This is my Jacoco Maven plugin configuration:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; &lt;plugin&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;      &lt;groupId&gt;org.jacoco&lt;/groupId&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;     &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;     &lt;version&gt;0.6.3.201306030806&lt;/version&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;     &lt;configuration&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;propertyName&gt;coverageAgent&lt;/propertyName&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;          &lt;skip&gt;false&lt;/skip&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;excludes&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;                 EXCLUDES LIST
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;/excludes&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;        
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; &lt;classDumpDir&gt;${basedir}/target/jacoco-classes&lt;/classDumpDir&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;      &lt;/configuration&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;     &lt;executions&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;execution&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;id&gt;prepare-agent&lt;/id&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;goals&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;                 &lt;goal&gt;prepare-agent&lt;/goal&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;              &lt;/goals&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;/execution&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;execution&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;id&gt;report&lt;/id&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;phase&gt;prepare-package&lt;/phase&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;goals&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;                 &lt;goal&gt;report&lt;/goal&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;              &lt;/goals&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;/execution&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;execution&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;id&gt;check&lt;/id&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;goals&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;                 &lt;goal&gt;check&lt;/goal&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;/goals&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;              &lt;configuration&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;                 &lt;rules&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;                     RULES LIST
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;                 &lt;/rules&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;/configuration&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;/execution&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;     &lt;/executions&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;  &lt;/plugin&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; and my Maven Surefire plugin configuration:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; &lt;plugin&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;     &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;     &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;      &lt;version&gt;2.15&lt;/version&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;     &lt;configuration&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;groups&gt;specific_test_group&lt;/groups&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;argLine&gt;-Xmx1024m -XX:MaxPermSize=256m ${coverageAgent}
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; -javaagent:"${aspectj.agent.jar}"&lt;/argLine&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;          &lt;properties&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;property&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;                 &lt;name&gt;listener&lt;/name&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;                 &lt;value&gt;SOME_TESTNG_LISTENERS&lt;/value&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;             &lt;/property&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;         &lt;/properties&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;      &lt;/configuration&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; &lt;/plugin&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; Thanks,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; André
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; On Sun, Jul 21, 2013 at 4:58 PM, Marc R. Hoffmann
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; &lt;<a target="_top" href="http://gmane.org/get-address.php?address=hoffmann%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoffmann@...</a> [10]&gt; wrote:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; Hi André,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; this strange. If the JaCoCo agent really is the very first agent in
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; the command line it should see the class files (or JARs) from the
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; file system. So if the report is created based on the exact same
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; file the report should show coverage for all executed classes.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; In the JaCoCo HTML report can you please check whether the classes
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; in question are listed on the sessions page (link in the top right
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; corner).
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; Thanks,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; -marc
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; On 20.07.13 19:03, <a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a> [6] wrote:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Hi,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; I'm using Java 1.7, AspectJ 1.7.3 (for load-time weaving), Jacoco
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Maven plugin 0.6.3.201306030806 and Maven Surefire Plugin 2.15 to
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; run the tests. In these conditions Jacoco doesn't work correctly.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; If Jacoco's Java agent is set as the second Java agent (after
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; AspectJ weaver agent), the build produces these errors:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; java.lang.instrument.IllegalClassFormatException: Error while
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; instrumenting class CLASS_NAME.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:89)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; sun.instrument.TransformerManager.transform(TransformerManager.java:188)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; ...
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Caused by: java.io.IOException: Error while instrumenting class
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; CLASS_NAME.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrumentError(Instrumenter.java:147)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:98)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.CoverageTransformer.transform(CoverageTransformer.java:87)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         ... 64 more
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Caused by: java.lang.IllegalStateException: Missing or invalid
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; stackmap frames.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.assertValidFrames(FrameTracker.java:613)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.pop(FrameTracker.java:602)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.instr.FrameTracker.visitVarInsn(FrameTracker.java:386)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.asm.MethodVisitor.visitVarInsn(Unknown
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.asm.tree.VarInsnNode.accept(Unknown
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.asm.tree.InsnList.accept(Unknown
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.asm.tree.MethodNode.accept(Unknown
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.internal.flow.ClassProbesAdapter$1.visitEnd(ClassProbesAdapter.java:124)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.b(Unknown
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; org.jacoco.agent.rt.internal_9dd1198.asm.ClassReader.accept(Unknown
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Source)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:78)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         at
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; 
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; org.jacoco.agent.rt.internal_9dd1198.core.instr.Instrumenter.instrument(Instrumenter.java:96)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;         ... 65 more
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; if it is set as the first Java Agent (before AspectJ) it works
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; for most classes, but fails to produce correct coverage reports
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; for weaved classes (all the lines appear as not covered even
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; though I have tests covering them).
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; I tried to use the classdumpdir solution presented here:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; <a rel="nofollow" href="https://github.com/jacoco/eclemma/issues/33" target="_top">https://github.com/jacoco/eclemma/issues/33</a> [5] but I can't find a
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; equivalent Maven configuration for the setting the check and
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; report Jacoco goals to use the classdumpdir directory.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Does anyone have a solution for this?
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; Thanks,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; André.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; On Wednesday, March 6, 2013 8:52:36 AM UTC, Erik Vande Velde
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt; wrote:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Hi Henrik,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; This did indeed solve my problem, thanks !!!
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; 2013/3/6 Henrik Horneber &lt;<a target="_top" href="http://gmane.org/get-address.php?address=horn...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">horn...@...</a> [1]&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Hi,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; I've successfully used JaCoCo together with AspectJ.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; You need to make sure
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; * you use AspectJ version &gt;= 1.7
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; * java source and target are also set to 1.7
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Then AspectJ will generate class files JaCoCo can use.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Best regards,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Henrik
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; On Wed, Mar 6, 2013 at 8:02 AM, Erik Vande Velde
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; &lt;<a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a> [2]&gt; wrote:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Hello Marc,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Thanks for your reaction! I'll put your question on the Aspectj
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; forum today.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Kind Regards,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;     Erik
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; 2013/3/5 Marc Hoffmann &lt;<a target="_top" href="http://gmane.org/get-address.php?address=hoff...%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoff...@...</a> [3]&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Hi,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; in any case JaCoCo requires valid classfiles as input. This
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; implies that class files from version 1.6 on need to contain
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; valid stackmap frames. If this is not the case JaCoCo will fail
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; with exactly this message.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Have you reported the problem to AspectJ?
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Best regards,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; -marc
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; On 2013-03-05 16:50, <a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a> [4] wrote:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; I downloaded JaCoCo today, and got the ant + maven examples
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; going
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; immediately.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; But when I change the pom.xml of our project in a similar way
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; as the
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; examples I'm in trouble, almost certainly because we use
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Aspectj in
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; that project:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; 1) offline modus:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Here I get the following error message:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; [ERROR] Failed to execute goal
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; org.jacoco:jacoco-maven-plugin:0.6.2.201302030002:instrument
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; (default)
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;   on project com.fugro.gwf.server.core: Execution default of
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; goal
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; org.jacoco:jacoco-maven-plugin:0.6.2.201302030002:instrument
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; failed:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;   Missing or invalid stackmap frames. -&gt; [Help 1]
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; 2) on the fly modus:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Running
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; com.fugro.gwf.server.core.synchronisation.Synchronise1Test
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Start java.lang.instrument.IllegalClassFormatException:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Error while instrumenting class
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; com/fugro/gwf/server/core/referencing/ReferencingAspect.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Underneath this message the stack trace once more shows:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; Caused by: java.lang.IllegalStateException: Missing or invalid
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; stackmap frames.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; My questions:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; 1) Is there a way to get coverage information for an aspectj
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; project
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; in JaCoCo?
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; 2) If not, do you know an alternative tool that can deal with
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; aspectj
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; projects. I tried clover, but they simply say they don't
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; support
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; aspectj projects. I also tried Coburtera and emma, but assumed
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; JaCoCo
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;&gt;&gt; is a more recent (and better supported) tool
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; --
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; You received this message because you are subscribed to a topic in
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; the Google Groups "JaCoCo and EclEmma Users" group.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; To unsubscribe from this topic, visit
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; <a rel="nofollow" href="https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe" target="_top">https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; [7].
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; To unsubscribe from this group and all its topics, send an email to
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; <a target="_top" href="http://gmane.org/get-address.php?address=jacoco%2bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFFw%40public.gmane.org" rel="nofollow">jacoco+unsubscribe@...</a> [8].
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; For more options, visit <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;&gt; [9].
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;  --
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;  You received this message because you are subscribed to the Google
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; Groups "JaCoCo and EclEmma Users" group.
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;  To unsubscribe from this group and stop receiving emails from it,
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; send an email to <a target="_top" href="http://gmane.org/get-address.php?address=jacoco%2bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFF%2bG%2fEz6ZCGd0%40public.gmane.org" rel="nofollow">jacoco+unsubscribe@...</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;  For more options, visit <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [11].
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt;
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; Links:
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; ------
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [1] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=horn...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">horn...@...</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [2] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [3] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=hoff...%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoff...@...</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [4] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=vandeve...%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">vandeve...@...</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [5] <a rel="nofollow" href="https://github.com/jacoco/eclemma/issues/33" target="_top">https://github.com/jacoco/eclemma/issues/33</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [6] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=andredasilvapinto%2dRe5JQEeQqe8AvxtiuMwx3w%40public.gmane.org" rel="nofollow">andredasilvapinto@...</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [7] <a rel="nofollow" href="https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe" target="_top">https://groups.google.com/d/topic/jacoco/Zb_MOFXIUn0/unsubscribe</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [8] mailto:jacoco%<a target="_top" href="http://gmane.org/get-address.php?address=2Bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFFw%40public.gmane.org" rel="nofollow">2Bunsubscribe@...</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [9] <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [10] mailto:<a target="_top" href="http://gmane.org/get-address.php?address=hoffmann%2da8GzhnWS74BMKzkbnucVRwC%2fG2K4zDHf%40public.gmane.org" rel="nofollow">hoffmann@...</a>
&gt; 
&gt; &gt; 
&gt; 
&gt; &gt; &gt; [11] <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>

<span class="togsig"><a rel=nofollow href="#" onclick="return toggle('sig7')">--</a></span>
<span id="sig7" class=signature>
-- 
You received this message because you are subscribed to the Google Groups "JaCoCo and EclEmma Users" group.
To unsubscribe from this group and stop receiving emails from it, send an email to <a target="_top" href="http://gmane.org/get-address.php?address=jacoco%2bunsubscribe%2d%2fJYPxA39Uh5TLH3MbocFF%2bG%2fEz6ZCGd0%40public.gmane.org" rel="nofollow">jacoco+unsubscribe@...</a>
For more options, visit <a rel="nofollow" href="https://groups.google.com/groups/opt_out" target="_top">https://groups.google.com/groups/opt_out</a>.

</span></pre>
<DIV class=posted>
<form class="spam" method="post" action="http://spam.gmane.org/gmane.comp.java.jacoco.user:161:unconfirmed" onsubmit="openSpamFrame(this); return false;">
<A href="http://permalink.gmane.org/gmane.comp.java.jacoco.user/161">Permalink</A>
| <a href="http://post.gmane.org/post.php?group=gmane.comp.java.jacoco.user&amp;followup=161" rel=nofollow>Reply</a>
| <input class="spam" type="submit" value="Report this as spam">
</form>
</DIV>  

</DIV>  
</DIV>  

</div>
</div>
</div>
</div>
</div>
</div>
</div>
</DIV>  

</div>

<div id="sidebox">

<div class="sidetitle">Return</div>
<div class="side">
Return to <a href="http://blog.gmane.org/gmane.comp.java.jacoco.user">gmane.comp.java.jacoco.user</a>.
</div>


<div class="sidetitle">Advertisement</div>
<div class="side" align="center">
<script type="text/javascript"><!--
amazon_ad_tag = "gmane-20"; amazon_ad_width = "300"; amazon_ad_height = "250";//--></script>
<script type="text/javascript" src="http://www.assoc-amazon.com/s/ads.js"></script>
</div>

<div class="sidetitle">Project Web Page</div>
<div class="side">
   <a href="http://www.eclemma.org/jacoco/">JaCoCo and EclEmma Users ()</a>
</div>

<div class="sidetitle">Search Archive</div>
<div class="side">
<div align="center">
<br/>
<form action="http://search.gmane.org" method="get">
<input name="query" value="" title="search_text"/><input type="submit" title="SUBMIT" value="Search"/>
<input type=hidden name="group" value="gmane.comp.java.jacoco.user">
</form>
</div>
</div>





<div class="sidetitle">Language</div>
<div class="side">
   <a rel=nofollow href="http://gmane.org/language.php">Change language</a>
</div>


<div class="sidetitle">Options</div>
<div class="side">
Current view: 
Threads only / Showing 
whole messages /
 Not hiding cited text.<br/>
    Change to 
<a rel=nofollow href="/gmane.comp.java.jacoco.user?set_blog_all=yes">All messages, </a><a rel=nofollow href="/gmane.comp.java.jacoco.user?set_lines=20">shortened messages</a>, or 
<a rel=nofollow href="/gmane.comp.java.jacoco.user?set_cite=hide">hide cited text</a>.<br /><br />

<a href="http://post.gmane.org/post.php?group=gmane.comp.java.jacoco.user" rel=nofollow>Post a message</a><br/>
<a href="nntp://news.gmane.org/gmane.comp.java.jacoco.user">NNTP Newsgroup</a><br/>
<a rel=nofollow href="http://news.gmane.org/find-root.php?message_id=%3c45b1274f%2d5083%2d4bc8%2d898c%2d7952fb183e79%40googlegroups.com%3e">Classic Gmane web interface</a><br/>

<a href="http://rss.gmane.org/gmane.comp.java.jacoco.user"><img src="http://gmane.org/img/xml.gif" alt="XML" border=0>&nbsp;RSS Feed</a><br/>
<a href="http://dir.gmane.org/gmane.comp.java.jacoco.user">List Information</a><br/><br/>
<a href="http://gmane.org/faq.php">About Gmane</a><br/>
</div>

</div>

    <br clear="all" />

<div class="bottombox"><p class="bottomtext"><a href="http://gmane.org/">Gmane</a></p></div>
  </body>
</html>


