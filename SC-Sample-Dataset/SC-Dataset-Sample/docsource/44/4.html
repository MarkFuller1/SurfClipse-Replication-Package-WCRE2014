


















<html>
<head>
   <title>MokaByte MokaForum 1.0</title>
   <link rel="stylesheet" href="images/template.css" type="text/css">
</head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body bgcolor="#eef5ee">
<br>
<table width="600" border="0" align="center" cellpadding="2" cellspacing="0">
  <tr>
    <td bgcolor="#006600" width="300"><B><font size=-1 color="#FFFFFF">MokaForum
      - Il forum di MokaByte</font></b></td>
    <td align="right">








<table cellpadding="3" cellspacing="0" border="0" width="150">
  
  <tr>

<td align="right" width="50%">
  <font size="-2"
    face="arial">
     <a href="auth.jsp" title="Login">Login</a> 
  </td>


      <td align="right" width="50%">
        <font size="-2" face="arial">
          <a href="settings.jsp" title="Modifica le tue impostazioni"> Impostazioni
          </a>
        </font>
      </td>

      <td align="right" width="50%">
        <font size="-2" face="arial">
          <a href="index.jsp">
            Home
          </a>
        </font>
      </td>
      <td align="right" width="50%">
        <font size="-2" face="arial">
          <a href="http://www.mokabyte.it" title="Esci e torna alla Home page MokaByte ">
            Esci
          </a>
        </font>
      </td>


  </tr>
  
</table>





</td>

  </tr>
  <tr valign="top">
    <td bgcolor="#006600" colspan="2">
      <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="#FFFFFF">
        <tr >
          <td> 




<html>
<head>
    <title>Forums - Thread & SwingUtilities</title>
    <meta http-equiv="content-type" content="text/html; charset=ISO8859_1">
    <style type="text/css">
    PRE {
        font-size : 9pt;
    }
    A {
        font-weight : bold;
        text-decoration : none;
    }
    A:hover {
        text-decoration : underline;
    }
    </style>
</head>

<body bgcolor="#ffffff"
 text="#006600"
 link="#006600" 
 vlink="#006600"
 alink="#ffff00">

<table bgcolor="#ffffff"
align="center" cellpadding="1" cellspacing="0" border="0" width="700">
  <tr><td>
<table bgcolor="#ffffff"
 cellpadding="6" cellspacing="0" border="0" width="100%">
<tr>

    
          <td width="1%"><a href="index.jsp"><img src="images/logo_it.gif"  border="0"></a></td>          
          <td>
            <div align="left"><font size="8">Forum MokaByte</font></div>
          </td>

    

    
</tr>
</table>
</td></tr>
</table>

 </td>
        </tr>
        <tr >
          <td> <img src="images/blank.gif" width="100" height="5"> </td>
        </tr>
        <tr >
          <td  align="center"> 
<table cellpadding="0" cellspacing="0" border="0" width="100%">
  <tr>
    <td background="images/bannerseparator.jpg" align="center">
    	<a href="http://www2.mokabyte.it/banner/b?config=config_file.properties&mode=2&id=1" target="_blank">
		 <img alt="banner" src="http://www2.mokabyte.it/banner/b?config=config_file.properties&mode=1&id=1" />
		</a>
	</td>
  </tr>
  <tr>
    <td align="center">
<BR>
    </td>
  </tr>

</table></td>
        </tr>
        <tr >
          <td  align="center"><br><br></td>
        </tr>
        <tr>
          <td>




<table cellpadding="0" cellspacing="0" border="0" width="98%" align="center">
<tr>
    <td width="99%" valign="top">

    <font face="arial" color="#006600">
    <b>Thread & SwingUtilities</b>
    </font>
    <br>

    

    <font size="-1" face="arial" color="#006600">
    <b>
    <a href="index.jsp"
    >Home</a>
    &raquo;
    <a href="index.jsp" title="Torna alla lista dei forum"
    >Forums</a>
    &raquo;
    <a href="forum.jsp?forum=15" title="Torna alla lista dei topic"
    >Swing</a>
    </b>
    </font>

    <p>

    <font size="-1"
     face="arial">
     Risposte: <b>1</b>
    &nbsp;

    

    <a href="thread.jsp?forum=15&thread=3174&message=12571#latest"
     title=""
    ><img src="images/go_to.gif" width="13" height="10" border="0" hspace="2"></a>
    Ultima risposta inviata da:
    
        pgi
    
    (31-ott-2005 15.35)

    
    </font>

    </td>
</tr>
</table>


<p>






<table cellpadding="0" cellspacing="2" border="0">
<tr>
    
	<td><a href="post.jsp?forum=15&thread=3174&reply=true">
          <img src="images/reply.gif" width="17" height="17" title="Rispondi al messaggio" border="0"></a></td>
	<td nowrap><font size="-2" face="arial">
        &nbsp;<a href="post.jsp?forum=15&thread=3174&reply=true" title="Rispondi al messaggio">Rispondi</a>
        </font>
    </td>
    <td><img src="images/blank.gif" width="10" height="1" border="0"></td>
    
	<td><a href="post.jsp?forum=15"><img src="images/post.gif" width="17" height="17" title="Attiva il watch" border="0"></a></td>
	<td nowrap><font size="-2" face="arial">
        &nbsp;<a href="post.jsp?forum=15" title="Crea un nuovo Topic">Crea un nuovo Topic</a>
        </font>
    </td>
    <td><img src="images/blank.gif" width="10" height="1" border="0"></td>
    
	<td><a href="search.jsp?forums=15"><img src="images/search.gif" width="17" height="17" title="Cerca un messaggio nel forum" border="0"></a></td>
	<td nowrap><font size="-2" face="arial">
        &nbsp;<a href="search.jsp?forums=15" title="Cerca un messaggio nel forum">Cerca</a>
        </font>
    </td>
    <td><img src="images/blank.gif" width="10" height="1" border="0"></td>
    
    
</tr>
</table>
<table cellpadding="0" cellspacing="2" border="0" width="98%" align="center">
              <tr>
                <td colspan="3"><img src="images/blank.gif" width="1" height="5" border="0"></td>
              </tr>
              <tr>
                <td width="1%" nowrap>  &nbsp;  </td>
                <td width="98%" align="center">
                  <table cellpadding="0" cellspacing="2" border="0">
                    <tr>
                      <td><a href="forum.jsp?forum=15"><img src="images/back_to.gif" width="12" height="12" title="Torna alla lista dei topic" border="0"></a></td>
                      <td nowrap> <font size="-2"
         face="arial">
                        &nbsp; <a href="forum.jsp?forum=15" title="Torna alla lista dei topic">Lista dei Topic</a>
                        </font> </td>
                    </tr>
                  </table>
                </td>
                <td width="1%" nowrap>  &nbsp;  </td>
              </tr>
            </table>
             <a name="12557"></a> 
            <table bgcolor="#cccccc"
 cellpadding="0" cellspacing="0" border="0" width="98%" align="center">
<tr>
	<td>
    <table bgcolor="#cccccc"
     cellpadding="4" cellspacing="1" border="0" width="100%">
    <tr bgcolor="#eeeeee">
        <td width="1%" rowspan="2" valign="top">
        <table cellpadding="0" cellspacing="0" border="0" width="140">
        <tr><td>
            <font size="-1" face="arial"
            color="#006600">

			<a href="profile.jsp?user=27583" title=""
             ><b>eroZeo</b></a>
            </font>

            <font size="-2" face="arial"
            color="#006600">
            <br><br>
              Messaggi inviati:36
            <br>
            
            Registrato: ott, 2005
            <br><br>

            </font>
            </td>
        </tr>
        </table>
        </td>
        <td width="98%">
            <table cellpadding="2" cellspacing="0" border="0" width="100%">
            <tr><td width="99%" valign="top">
            <font size="-1" face="arial"
            color="#006600">
            <b>Thread & SwingUtilities</b>
            </font>
            </td>
            <td width="1%" nowrap>
            <font size="-1" face="arial"
            color="#006600">
            Inviato:30-ott-2005 21.24
            </font>
            </td></tr>
            </table>
        </td>

        <td width="1%" nowrap align="center">
            <table cellpadding="2" cellspacing="0" border="0">
            <tr>
                <td><a href="post.jsp?forum=15&thread=3174&message=12557&reply=true"
                     title="Rispondi al messaggio"><img src="images/reply.gif" width="17" height="17" title="Rispondi al messaggio" hspace="3" border="0"
                     ></a></td>
                <td>
                <font size="-1" face="arial">
                <a href="post.jsp?forum=15&thread=3174&message=12557&reply=true"
                 title="Rispondi al messaggio">Rispondi</a>
                </font>
                </td>
            </tr>
            </table>
        </td>
    </tr>
    <tr bgcolor="#eeeeee">
        <td width="99%" colspan="3" valign="top">
        <font size="-1" face="arial"
         color="#006600">
        Ciao a tutti,<BR>sto realizzando un'applicazione con interfaccia grafica che visualizzi delle animazioni, che consistono semplicemente in disegni su un JPanel.<BR>Per evitare di bloccare l'intera applicazione mentre avviene l'animazione ho pensato di utilizzare i thread. In particolare ho fatto si che il JPanel dove vengono realizzate le animazioni implementasse l'interfaccia Runnable. <BR>Va tutto bene ma ho la seguente eccezione:<BR><BR>javax.swing.text.StateInvariantError: GlyphView: Stale view: javax.swing.text.BadLocationException: Invalid location<BR>	at javax.swing.text.GlyphView.getText(GlyphView.java:106)<BR>	at javax.swing.text.GlyphPainter1.paint(GlyphPainter1.java:95)<BR>	at javax.swing.text.GlyphView.paintTextUsingColor(GlyphView.java:439)<BR>	at javax.swing.text.GlyphView.paint(GlyphView.java:430)<BR>	at javax.swing.text.BoxView.paintChild(BoxView.java:144)<BR>	at javax.swing.text.BoxView.paint(BoxView.java:407)<BR>	at javax.swing.text.BoxView.paintChild(BoxView.java:144)<BR>	at javax.swing.text.BoxView.paint(BoxView.java:407)<BR>	at javax.swing.text.ParagraphView.paint(ParagraphView.java:569)<BR>	at javax.swing.text.html.ParagraphView.paint(ParagraphView.java:220)<BR>	at javax.swing.text.BoxView.paintChild(BoxView.java:144)<BR>	at javax.swing.text.BoxView.paint(BoxView.java:407)<BR>	at javax.swing.text.html.BlockView.paint(BlockView.java:264)<BR>	at javax.swing.text.BoxView.paintChild(BoxView.java:144)<BR>	at javax.swing.text.html.ListView.paintChild(ListView.java:96)<BR>	at javax.swing.text.BoxView.paint(BoxView.java:407)<BR>	at javax.swing.text.html.BlockView.paint(BlockView.java:264)<BR>	at javax.swing.text.html.ListView.paint(ListView.java:56)<BR>	at javax.swing.text.BoxView.paintChild(BoxView.java:144)<BR>	at javax.swing.text.BoxView.paint(BoxView.java:407)<BR>	at javax.swing.text.html.BlockView.paint(BlockView.java:264)<BR>	at javax.swing.text.BoxView.paintChild(BoxView.java:144)<BR>	at javax.swing.text.BoxView.paint(BoxView.java:407)<BR>	at javax.swing.text.html.BlockView.paint(BlockView.java:264)<BR>	at javax.swing.plaf.basic.BasicTextUI$RootView.paint(BasicTextUI.java:1319)<BR>	at javax.swing.plaf.basic.BasicTextUI.paintSafely(BasicTextUI.java:636)<BR>	at javax.swing.plaf.basic.BasicTextUI.paint(BasicTextUI.java:770)<BR>	at javax.swing.plaf.basic.BasicTextUI.update(BasicTextUI.java:749)<BR>	at javax.swing.JComponent.paintComponent(JComponent.java:541)<BR>	at javax.swing.JComponent.paint(JComponent.java:808)<BR>	at javax.swing.JComponent.paintWithOffscreenBuffer(JComponent.java:4787)<BR>	at javax.swing.JComponent.paintDoubleBuffered(JComponent.java:4740)<BR>	at javax.swing.JComponent._paintImmediately(JComponent.java:4685)<BR>	at javax.swing.JComponent.paintImmediately(JComponent.java:4488)<BR>	at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:410)<BR>	at javax.swing.SystemEventQueueUtilities$ComponentWorkRequest.run(SystemEventQueueUtilities.java:117)<BR>	at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:178)<BR>	at java.awt.EventQueue.dispatchEvent(EventQueue.java:454)<BR>	at java.awt.EventDispatchThread.pumpOneEventForHierarchy(EventDispatchThread.java:201)<BR>	at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151)<BR>	at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:145)<BR>	at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:137)<BR>	at java.awt.EventDispatchThread.run(EventDispatchThread.java:100)<BR><BR>Cercando un pò in giro ho letto che bisogna utlizzare come Thread Dispatcher la classe SwingUtilities, in particolare ho provato con il metodo invokeLater.<BR>E' giusto così?<BR>Confido nel mio santo protettore Pierluigi e in chiunque voglia aiutarmi, ed una eventuale chiarimento tecnico sull'intera faccenda.<BR>Grazie mille.<BR>Saluti<BR>                                 Gianluca
        </font><p>
        </td>
    </tr>
    </table>
</td></tr>
</table>


<br>




 <a name="12571"></a> 

<table bgcolor="#cccccc"
 cellpadding="0" cellspacing="0" border="0" width="98%" align="center">
<tr>
    <td width="1%" bgcolor="#ffffff"
        ><img src="images/blank.gif" width="30" height="1" border="0"
        ></td>
	<td width="99%">
    <table bgcolor="#cccccc"
     cellpadding="4" cellspacing="1" border="0" width="100%">
    <tr bgcolor="#eeffee">


        <td width="99%">
            <table cellpadding="2" cellspacing="0" border="0" width="100%">
            <tr><td width="99%" valign="top">
            <font size="-1" face="arial"
            color="#006600">
            <b>Re: Thread & SwingUtilities</b>
            </font>
            </td>
            <td width="1%" nowrap>
            <font size="-1" face="arial"
            color="#006600">
            Inviato: 31-ott-2005 15.35
            </font>
            </td></tr>
            </table>
        </td>

        <td width="1%" nowrap align="center">
            <table cellpadding="2" cellspacing="0" border="0">
            <tr>
                <td><a href="post.jsp?forum=15&thread=3174&message=12571&reply=true"
                     title="Rispondi al messaggio"><img src="images/reply.gif" width="17" height="17" title="Rispondi al messaggio" hspace="3" border="0"
                     ></a></td>
                <td>
                <font size="-1" face="arial">
                <a href="post.jsp?forum=15&thread=3174&message=12571&reply=true"
                 title="Rispondi al messaggio">Rispondi</a>
                </font>
                </td>
            </tr>
            </table>
        </td>
    </tr>
    <tr bgcolor="#eeffee">
        <td colspan="3" valign="top">
        <font size="-1" face="arial"
         color="#006600">
        Inserito da:
        
            <a href="profile.jsp?user=18030"><b>pgi</b></a>
        </font>
        &nbsp;&nbsp;
        <font size="-2" face="arial"
         color="#006600">
         Messaggi inviati: 2.303\
        
        Registrato: nov, 2003
        </font>
        
        </td>
    </tr>
    <tr bgcolor="#eeffee">
        <td colspan="3" valign="top">
        <font size="-1" face="arial"
         color="#006600">
        Quattro frustate per l'evocazione ad personam :D.<BR><BR>Scrivo un mezzo trattato ma la questione può interessare ad altri e merita di essere esplicitata.<BR><BR><b>La moltiplicazione dei pani e dei processi</b><BR><BR>Moltissimi strumenti per lo sviluppo di interfacce grafiche, tra cui AWT/Swing, adottano una strategia a processo singolo per produzione di quelle interfacce. Intendo per produzione la presentazione grafica e la reazione agli eventi generati dall'interazione utente.<BR><BR>Ciò significa che esiste un solo Thread che si occupa sia del disegno di ogni componente dell'interfaccia (pannelli, pulsanti, barre eccetera) sia della propagazione degli eventi (es. ActionEvent) agli ascolatatori registrati (es. vari figli di ActionListener).<BR><BR>Avere un solo Thread che gestisca il tutto rende più semplice il sistema e, per macchine con un solo processore, idealmente più efficiente.<BR><BR>L'aver deciso di usare un modello a processo singolo autorizza l'assunzione di un certo volume di precondizioni. Ad esempio, se un solo processo si occupi di gestire ogni componente allora sarà lecito trattare come immutabili dei valori che, in un modello a più processi, sarebbero sensibili a mutamenti di valore "in corso d'opera".<BR><BR>Prendiamo, per rendere più chiara la questione, questo simulacro di componente:<BR><BR><pre> 1.public class AComponent {<BR> 2.    private String text;<BR> 3.<BR> 4.    public void setText(String t) {<BR> 5.        text = t;<BR> 6.    }<BR> 7.<BR> 8.    public void paint(Graphics g) {<BR> 9.        for(int i = 0; i &lt; text.length(); i++) {<BR>10.            char c = text.charAt(i);<BR>11.            g.drawString(String.valueOf(c), ...);<BR>12.        }<BR>13.    }<BR>14.}</pre><BR><BR>Se assumiamo che un solo Thread possa disegnare e modificare questo componente (cioè invocare paint e setText) allora siamo in una botte di ferro.<BR><BR>Se i processi in grado di modificare e disegnare quel componente fosser più d'uno allora saremmo in un sacco di iuta tra serpenti, scorpioni e animali vari, pronti ad esser gettati in un fiume (i romani la chiamavano <i>poena cullei</i>).<BR><BR>Ecco perchè. Il metodo paint assume come precondizione che la lunghezza della stringa "text" sia sempre maggiore di "i" quando è eseguita l'istruzione di linea 10. Questo è sempre vero se un solo processo si occupi di tutto, perchè  l'unico processo non può esegure contemporaneamente "paint" e "setText". Se i processi diventino due, allora uno potrebbe eseguire "paint" e l'altro modificare la stringa "text". Se un Thread sostituisse la stringa "text" con una di lunghezza minore della precedente mentre il secondo Thread fosse in procinto di eseguire la linea 10, allora il secondo Thread avrebbe per le mani un indice i, perfettamente valido fino ad un istante prima, maggiore della lunghezza della stringa text.<BR><BR>Dunque esistono delle precondizione perfettamente valide in un contesto a processo singolo che diventano perfettamente invalide quando i processi si moltiplichino.<BR><BR><b>SwingUtilities</b><BR><BR>Abbiamo per le mani un <i>GUI Toolkit</i> a processo singolo (AWT/Swing). E abbiamo un mare di casi in cui più di un processo sia in esecuzione nelle nostre applicazioni (al minimo, ogni volta che accedi ad una risorsa esterna tipo file, connessioni di rete o a database e tutti gli altri in cui vuoi eseguire delle operazioni in parallelo per sfruttare più processori). Sappiamo di essere <b>obbligati</b> a delegare ad un solo processo la produzione e le modifiche di componenti della GUI. Non è una scelta, qualcosa che "ogni tanto si può fare e ogni tanto no": o si fa o si sbaglia.<BR><BR>Bene, lo strumento che ci toglie dall'empasse è la coda degli eventi AWT. E' lo stesso attraverso cui è realizzato il modello a processo singolo. Quando qualcuno voglia modificare un componente AWT/Swing o desideri sparare un evento derivante dalla modifica di un componente AWT/Swing o dall'interazione utente, genera un evento e lo preme nella coda degli eventi AWT. <BR><BR>La coda è una struttura dati lineare (gli elementi si succedono l'uno con l'altro) caratterizzata da una politica di inserimento-estrazione il cui acronimo è FIFO (<i>first in first out</i>, il primo che entra è il primo ad uscire). Più in generale, l'elemento che permane da più tempo all'interno della struttura dati sarà il primo ad esserne estratto.<BR><BR>L'unico processo che deve "gestire la questione GUI AWT/Swing" consuma questa coda degli eventi AWT: estrae un elemento dalla coda ed esegue le istruzione che vi siano state incapsulate. Trova una richiesta "paint"? La esegue, disegnando il componente collegato. Trova un "setText"? Imposta il testo per quel componente. E così via.<BR><BR>L'insieme di coda, eventi e processo di consumazione degli eventi nella coda è la base dell'architettura a processo singolo.<BR><BR>La coda è accessibile attraverso il metodo getSystemEventQueue di Toolkit, per gli scopi più turpi. Due metodi ad hoc in EventQueue consentono approcci più quieti.<BR><BR>Uno è<BR><BR>EventQueue.invokeAndWait(Runnable);<BR><BR>l'altro<BR><BR>EventQueue.invokeLater(Runnable);<BR><BR>I due sono direttamente invocati, rispettivamente, dai metodi:<BR><BR>SwingUtilities.invokeLater(Runnable);<BR>SwingUtilities.invokeAndWait(Runnable);<BR><BR>E' come se fossero sinonimi (ma nulla vieta che in futuro si separino, quindi usa SwingUtilities per interfacce Swing).<BR><BR>I due metodi, invokeLater ed invokeAndWait, prendono il Runnable in argomento e lo premono nella coda degli eventi AWT. Quando sarà il loro turno, questi "Runnable" saranno eseguiti da quell'unico Thread che si occupa delle interfacce utente.<BR><BR>Tra i due metodi la differenza è che invokeLater "restituisce immediatamente il controllo" mentre invokeAndWait attende finchè il Runnable non sia stato effettivamente invocato dall'unico Thread che consuma la coda degli eventi.<BR><BR>A titolo di casi d'uso dei due metodi, possiamo prendere il caricamento di un file.<BR><BR>1. carico un file e periodicamente aggiorno una barra di stato:<BR><BR><pre>new Thread() {<BR>    public void run() {<BR>        InputStream in = ...<BR>        byte[] buffer = new byte[64];<BR>        int read = 0;<BR>        while(buffer.read(in) != -1) {<BR>            SwingUtilities.invokeAndWait(new Runnable() {<BR>                label.setText("letti N byte");<BR>            });<BR>        }<BR>    }<BR>}.start();</pre><BR><BR>Qui leggo un tot di byte, aggiorno un'etichetta, attendo che effettivamente l'etichetta sia aggiornata e poi proseguo nella lettura. Usando invokeLater il testo dell'etichetta non sarebbe consistente con lo stato effettivo della lettura.<BR><BR>2. Leggo un file e poi visualizzo un messaggio di fine lettura:<BR><BR><pre>new Thread() {<BR>    public void run() {<BR>        InputStream in = ...<BR>        //...lettura<BR>        SwingUtilities.invokeLater(new Runnable() {<BR>            public void run() {<BR>                JOptionPane.showMessageDialog(...);<BR>            }<BR>        });<BR>    }<BR>}.start();</pre><BR><BR>Qui è evidente come non vi sia nulla da coordinare: dopo aver completato la lettura il Thread rilascia un evento nella coda AWT e poi termina.<BR><BR><b>Quando</b><BR><BR>Quando usare il sistema della coda degli eventi? Sempre se tu non possa garantire che un certo metodo sia necessariamente eseguito all'interno dell'AWT Event Dispatcher (nomignolo del Thread che consuma la coda degli eventi AWT) e quel metodo (o quel blocco di istruzioni) muti un componente Swing "vivo", cioè connesso ad un albero di componenti la cui radice sia stata realizzata, anche se non visibile. <BR><BR>Per "connessione ad una radice realizzata" intendo l'inserimento del componente in un contenitore che sia a sua volta inserito, anche mediatamente, in una finestra primaria o secondaria, direttamente (Frame, Window, Dialog) o attraverso il pannello del contenuto di quest'ultima (JFrame, JWindow, JDialog) laddove questa finestra primaria sia stata resa visualizzabile (con un pack(), setVisible(true), o il desueto show(), non preceduti da un dispose()). Per una definizione più rigorosa vedi la documentazione Java del metodo "isDisplayable" della classe java.awt.Component.<BR><BR>Quando puoi garantire che un blocco di istruzioni sia invocato dallo AWT Event Dispatcher.<BR><BR>Un primo caso (particolare) è quello del corpo dei metodi predefiniti negli ascoltatori di evento AWT/Swing. Prendiamo un actionListener:<BR><BR><pre>ActionListener x = new ActionListener() {<BR>    public void actionPerformed(ActionEvent e) {<BR>        //qualcosa<BR>    }<BR>};</pre><BR><BR>Tanti componenti accettano un ActionListener come ascoltatore di eventi. Questi invocano il metodo actionPerformed di tutti i loro ActionListener registrati quando capiti qualcosa di particolare (l'utente preme un pulsante, uno JComboBox muta il suo contenuto eccetera). Queste "invocazioni riflesse" sono eseguite dall'AWT Event Dispatcher. Io premo un pulsante e l'AWT Event Dispatcher esegue il contenuto dei metodi actionPerformed di ogni ActionListener registrato presso quel pulsante. Lo stesso vale per ogni ascoltatore di eventi AWT/Swing (KeyListener, MouseListener...tutto quello che finisce in Listener ed è collegato ad un componente AWT/Swing).<BR><BR>Occorre tener conto dell'accessibilità dei metodi di ascolto dei vari ...Listener. Sono tutti pubblici e, quindi, invocabili anche in via diretta.<BR><BR>Prendendo quell'ActionListener "x" di prima, se il metodo acionPerformed sia invocato "dietro le quinte", in reazione alla pressione del pulsante, abbiamo la certezza che il processo invocante sia il Thread AWT Event Dispatcher. Se invece scrivessimo:<BR><BR>x.actionPerformed(unActionEvent);<BR><BR>allora il processo invocante potrebbe anche non essere quello giusto. In genere non è mai una buona idea invocare direttamente il metodo di un ...Listener AWT/Swing anche se è raro che questi restino esposti al pubblico ludibrio.<BR><BR>Un'altro caso è l'invocazione di "repaint". Puoi chiamarlo da qualsiasi Thread. Il suo effetto è l'accodamento di una richiesta di aggiornamento grafico nella coda degli eventi e l'aggiornamento sarà eseguito dall'AWT Event Dispatcher Thread.<BR><BR><b>Il tuo caso particolare.</b><BR><BR>L'errore che hai rilevato si verifica per via del mancato rispetto dell'architettura a processo singolo?<BR><BR>E' molto facile che lo sia e, in ogni caso, sei obbligato a rispettarla anche se non lo fosse.<BR><BR>Per controllare basta eseguire più volte l'applicazione e osservare...quando non capiti.<BR><BR>Se il codice sia completamente privo di sincronizzazione, dato il comportamento non deterministico dei Thread concorrenti, almeno per quanto ci riguarda in questa occasione, allora l'eccezione deve essere occasionale. Cioè a volte capita e a volte no. E' solo un sintomo e non è neache detto che sia causato dai tuoi Thread ma è un discreto indizio.<BR><BR>Se invece si verifichi puntualmente, nello stesso istante, ogni volta che esegui l'applicazione, allora è un bug delle librerie.<BR><BR>Per risolvere il problema dei Thread, puoi affidare l'animazione ad un javax.swing.Timer. E' un Thread che anzichè prendere un Runnable come compito da eseguire piglia un ActionListener (ed esegue periodicamente il contenuto del metodo actionPerformed anzichè di run). Timer garantisce l'esecuzione periodica da parte dell'AWT Event Dispatcher.<BR><BR>Ciao.<BR><BR>Pierluigi.
        </font><p>
        </td>
    </tr>
    </table>
</td></tr>
</table>


<br>






<table cellpadding="0" cellspacing="2" border="0" width="100%" align="center">
<tr>
    <td width="1%" nowrap valign="top">

    &nbsp;

    </td>
    <td width="98%" align="center">

<table cellpadding="0" cellspacing="2" border="0">
<tr>
	<td><a href="forum.jsp?forum=15"><img src="images/back_to.gif" width="12" height="12" title="Torna alla lista dei topic" border="0"></a></td>
	<td nowrap>
        <font size="-2"
         face="arial">
        &nbsp;
        <a href="forum.jsp?forum=15" title="Torna alla lista dei topic">Lista dei Topic</a>
        </font>
    </td>
    <td nowrap>&nbsp;&nbsp;</td>
	<td><a href="#top"><img src="images/up_to.gif" width="12" height="12" title="Vai all'inizio pagina" border="0"></a></td>
	<td nowrap>
        <font size="-2"
         face="arial">
        &nbsp;
        <a href="#top" title="Vai all'inizio pagina">Inizio pagina</a>
        </font>
    </td>
</tr>
</table>

    </td>
    <td width="1%" nowrap valign="top">

    &nbsp;

    </td>
</tr>
</table>


 </td>
        </tr>

        <tr>
          <td> <br><br><br> </td>
        </tr>
        <tr>
          <td> 
<table cellpadding="0" cellspacing="0" border="0" width="100%">
  <tr>
    <td background="images/bannerseparator.jpg" align="center">
       <a href="http://www2.mokabyte.it/banner/b?config=config_file.properties&mode=2&id=2" target="_blank">
	    	<img alt="banner" src="http://www2.mokabyte.it/banner/b?config=config_file.properties&mode=1&id=2" />
	   </a>	
	</td>
  </tr>
  <tr>
    <td align="center">
<BR>
    </td>
  </tr>

</table> </td>
        </tr>
        <tr>
          <td> 


<table cellpadding="6" cellspacing="0" border="0" width="100%">
<tr>
    <td align="center"> <font size="-2"
     face="arial"> 
      <a href="index.jsp"
     >Forum Home</a> 
       | 
      <a href="auth.jsp">Login</a> 
       
      | <a href="search.jsp">Cerca</a> 
       <br>
      <br>

    
    
    
    
    
    [
    <a href="http://www.jivesoftware.com/poweredby/" target="_new"
     style="color:#006600;"
     title="Maggiori informazioni su Jive Forums"
     >MokaForum è basato su Jive Forums</a>
    ]
    </font>
    </td>
</tr>
</table>

</body>
</html>  </td>

        </tr>
        <tr>
          <td></td>
        </tr>
      </table>
    </td>
  </tr>
  <tr valign="top">
    <td align="center" colspan="2"> <font size="-2">MokaByte&reg; &egrave; un
      marchio registrato da MokaByte s.r.l.<br>
      Java&reg; Jini&reg; e tutti i nomi derivati sono marchi registrati da Sun
      Microsystems. <br>
      Tutti i diritti sono riservati. E' vietata la riproduzione anche parziale.
      <br>
      Per comunicazioni inviare una mail a <a href="mailto:info@mokabyte.it">info@mokabyte.it</a></font></td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
