<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>

<title>Java: Skipping a lost packet?, objectinputstream, rts2</title>
<meta NAME=keywords CONTENT="objectinputstream, rts2, stack trace, exception java, import java, Java, Skipping a lost packet?">
<meta NAME=description CONTENT="objectinputstream, rts2, stack trace: Josh,    I sent you a long answer to this question several days  ago, but AllExperts appears to have lost it.  I don t know  whether you received it or not.    Anyway, the short version is that the following line in  your code is wrong:        ByteArrayInputStream...">
<meta http-equiv="Set-Cookie" content="TMog=DCDNNK03OkWAXxiR;Path=/;Domain=.allexperts.com;Expires=Fri, 31-Dec-37 23:59:59 GMT"><meta http-equiv="Set-Cookie" content="Mint=DCDNNK03OkWAXxiR;Path=/; Domain=.allexperts.com;Expires=Fri, 13-Dec-13 23:53:20 GMT"><meta http-equiv="Set-Cookie" content="zBT=5;Path=/;Domain=.allexperts.com;Expires=Fri, 13-Dec-13 23:53:20 GMT"><meta http-equiv="Set-Cookie" content="zBsT=1;Path=/;Domain=.allexperts.com;Expires=Fri, 13-Dec-13 23:53:20 GMT"><link rel="stylesheet" href="http://0.tqn.com/f/f/a32/a.css" media="all"><meta charset="ISO-8859-1"><meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="ROBOTS" content="NOODP">
<meta name="pd" content="Tuesday, 30-Aug-2011 20:02:26 UTC">
<script>var ziRfw=0;zobt="";zOBT=" Ads";function zIpSS(u){zpu(0,u,280,375,"ssWin")}function zIlb(l,t,f){zT(l,'18/1Pp/wX')}function rsi(i,h,w){if(gEI(i)){if(h)gEI(i).height=h;if(w)gEI(i).width=w}}</script><link rel="stylesheet" type="text/css" href="http://0.tqn.com/5/dc/aer.css" media="all"><link rel="shortcut icon" href="http://0.tqn.com/d/ae09.ico"><script>zGRH=1</script><meta http-equiv="pics-Label" content='(pics-1.1 "http://www.icra.org/pics/vocabularyv03/" l gen true for "http://en.about.com" r (n 0 s 0 v 0 l 0 oa 0 ob 0 oc 0 od 0 oe 0 of 0 og 0 oh 0 c 0) gen true for "http://en.about.com" r (n 0 s 0 v 0 l 0 oa 0 ob 0 oc 0 od 0 oe 0 of 0 og 0 oh 0 c 0))'>
<script class="kxct" data-id="Itttdt64" data-timing="async" data-version="1.9" type="text/javascript">window.Krux||((Krux=function(){Krux.q.push(arguments)}).q=[]);(function(){var k=document.createElement('script');k.type='text/javascript';k.async=true;var m,src=(m=location.href.match(/\bkxsrc=([^&]+)/))&&decodeURIComponent(m[1]);k.src=/^https?:\/\/([^\/]+\.)?krxd\.net(:\d{1,5})?\//i.test(src) ? src : src === "disable" ? "" :(location.protocol==="https:"?"https:":"http:")+"//cdn.krxd.net/controltag?confid=Itttdt64";var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(k,s);}());</script>
<meta name="docset" content="6"><style>#oF{-moz-border-radius: 10px 10px 10px 10px;background-color:#EBF9FF;background-origin:padding-box;border-bottom-left-radius:10px;border-bottom-right-radius:10px;border-top-left-radius:10px;border-top-right-radius:10px;color:#333;display:block;float:left;font-family:Verdana;font-size:11px;line-height:16px;margin:0 0 18px 8px;padding:9px 11px;text-align:left;text-decoration:none;width:171px}#oF b{color:#666;display:block;font: 12px/1.2 Georgia;text-decoration:none}#oF ul{list-style-type:none}#oF li a{background:url(http://0.tqn.com/d/d/spae.gif) 0 -34px no-repeat;color:#36C;font:11px/1.2 Verdana;margin-top:.75em;display:block;padding: 1px 0 1px 10px;text-decoration:underline;}</style>
</head>
<body class="gt1">
 

<script language="JavaScript">
<!--
zSt='';zGz=''
ch='specials';gs='en';xg="Experts";zcs='';
zFDT='0'
zFST='0'
zKwR=''
zOr='DCDNNK03OkWAXxiR';zTbO=zRQO=1;zp0=zp1=zp2=zp3=zfs=0;zDc=1;
zSm=zSu=zhc=zpb=zgs=zdn='';zD336=11;zFS='DCD10DC0110D00101';zFD='DCD10DC0110D00101'
zDO=zis=1;zpid=zi=zRf=ztp=zpo=0;zdx=20;zfx=100;zJs=0;
uy='allexperts.com';zi=1;zz='46860=1-1-1150;125125=2-1-12-1;120600=2-1-1250;11=1-1-1150;336280=2-1-1299;72890=2-1-1299';zx='3-1-1';zde=15;zdp=1440;zds=43200;zfp=0;zfs=0;zfd=100;zdd=20;zpb='';zhc='';zDO=1;if(!this.zGR)zGR="ca-about-allexperts_js";if(!this.zGL)zGL=5;zGTH=1;zAS=1
if(isNaN(this.zGL))zGL=8;zGCID=this.zGCID?zGCID+" test5":" test5"
zGL=8;
zObT="Related Java";zRad=5;



zGOW=0;xd=0;zap="";zAth='';zAthG='';zTt='0';zir=''
zBT=5
zBTS=5
zBsT=1
zBTds=''
zBTr='5'
zCT=1
zGo=0;zG=33;zTac=0;zDot=0;
//-->
</script>
<script language="JavaScript" src="http://0.tqn.com/0/js/cj018x1t6e14.js?rdv=j25"></script>
<script language="JavaScript">zJs=10</script>
<script language="JavaScript1.1">zJs=11</script>
<script language="JavaScript1.2">zJs=12</script>
<script language="JavaScript1.3">zJs=13</script>
<script>zc(5,'jsc',zJs,9999999,'')</script>
<script language="JavaScript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
  <div id="aew">
    <div id="aem">			
		<div id="sl">
		<script>
<!--
google_ad_width=728
google_ad_height=90
google_ad_type='text_image_flash_html'
google_ad_client='ca-about-allexperts_html'
google_ad_channel='test7'
google_safe='medium'
google_skip=6
if(this.zGH)google_hints=zGH
google_color_bg='ffffff';google_color_border='cc0000'
zIaw=728;zIah=90;z728=1;zIach=zIah+8;wt('100%','',0,0,0);w(xe+qh+zIach+'>')
// -->
</script>
<script language="JavaScript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<script>
<!--
w(qd+qc)
//-->
</script>
		</div>
	       
                                                                                    
<div id="ct"><p>You are here:</p><ul><li class="f"><a href="/">Home</a></li><li><a href="/c/computing/">Computing/Technology</a></li><li><a href="/c/computing/470.htm">Focus on Java</a></li><li><a href="/q/Java-1046/">Java</a></li><li>Skipping a lost packet?</li></ul></div>
		
	
<div id="aec" class="qa">
<div id="aet"><h1><span>Java</span>/<strong>Skipping a lost packet?</strong></h1></div>
			
<div id="adB">
<p>Advertisement</p>
<script type="text/javascript">
<!--
google_ad_width=300
google_ad_height=250
google_ad_type='text_image_flash_html'
google_ad_client='ca-about-allexperts_html'
google_ad_channel='test6'
google_safe='medium'
if(this.zGH)google_hints=zGH
z336=1;google_color_bg='ffffff';google_color_border='ebf9ff';google_color_line='ebf9ff';google_color_text='666666'
// -->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</div>
	

<!--gc-->

 <p class="byline"><strong>Expert: </strong>Neal Ziring - 9/27/2006</p>
 


<br><B>Question</B><BR>ok, lets see if I can be more specific.. so I followed the stack trace back to where it was causing the nullPointerException in my code.. so I fixed it, and it caused another error.. and I fixed that and so on until it lead me to this error<br>
<br>
Exception: java.io.EOFException<br>
java.io.EOFException<br>
at java.io.ObjectInputStream$PeekInputStream.readFully(ObjectInputStream<br>
.java:2232)<br>
at java.io.ObjectInputStream$BlockDataInputStream.readInt(ObjectInputStr<br>
eam.java:2722)<br>
at java.io.ObjectInputStream.readHandle(ObjectInputStream.java:1398)<br>
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1279)<br>
at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:19<br>
12)<br>
at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1836)<br>
<br>
at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1<br>
713)<br>
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1299)<br>
at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1628)<br>
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1293)<br>
at java.io.ObjectInputStream.readObject(ObjectInputStream.java:339)<br>
at PacketClient.recvObjFrom(PacketClient.java:54)<br>
at PacketClient.main(PacketClient.java:28) <br>
<br>
<br>
and here is the code for PacketClient<br>
<br>
import java.io.*;<br>
import java.net.*;<br>
import java.util.*;<br>
<br>
public class PacketClient<br>
{<br>
 &nbsp;&nbsp;public static MulticastSocket socket = null;<br>
 &nbsp;&nbsp;public static InetAddress address = null;<br>
 &nbsp;&nbsp;public static boolean gameOn = true;<br>
 &nbsp;&nbsp;static RTS2 rts = new RTS2(0);<br>
 &nbsp;&nbsp;<br>
 &nbsp;&nbsp;public static void main(String[] args) throws Exception<br>
 &nbsp;&nbsp;{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socket = new MulticastSocket(5454);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address = InetAddress.getByName("225.0.0.13");<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socket.joinGroup(address);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// receive object<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (gameOn)<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.print(".");<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendTo(rts.getCompany(), &nbsp;&nbsp;"225.0.0.13", 5453);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rts.setEnemy((Men[])recvObjFrom());<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// leave multicast group<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socket.leaveGroup(address);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socket.close();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;}<br>
 &nbsp;&nbsp;public static Object recvObjFrom() &nbsp;&nbsp;<br>
 &nbsp;&nbsp;{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[] recvBuf = new byte[5000];<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DatagramPacket packet = new DatagramPacket(recvBuf,<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recvBuf.length);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socket.receive(packet);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int byteCount = packet.getLength();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteArrayInputStream byteStream = new<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteArrayInputStream(recvBuf);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ObjectInputStream is = new<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ObjectInputStream(new BufferedInputStream(byteStream));<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object o = is.readObject();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is.close();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(o);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch (IOException e)<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println("Exception: &nbsp;" + e);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch (ClassNotFoundException e)<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return(null);<br>
 &nbsp;&nbsp;}<br>
 &nbsp;&nbsp;public static void sendTo(Object o, String hostName, int desPort)<br>
 &nbsp;&nbsp;{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InetAddress address = InetAddress.getByName(hostName);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteArrayOutputStream byteStream = new<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteArrayOutputStream(4096);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ObjectOutputStream os = new ObjectOutputStream(new<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedOutputStream(byteStream));<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.flush();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.writeObject(o);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.flush();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//retrieves byte array<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;byte[] sendBuf = byteStream.toByteArray();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DatagramPacket packet = new DatagramPacket(<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sendBuf, sendBuf.length, address, desPort);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;socket.send(packet);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.close();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}catch (BindException e)<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println("Exception: &nbsp;" + e);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch (UnknownHostException e)<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println("Exception: &nbsp;" + e);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch (IOException e)<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.printStackTrace();<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
 &nbsp;&nbsp;}<br>
<br>
}<br>
<br>
now I haven't heard/seen checking the packet length, I believe my gets the length but never checks it to see if its the correct length. &nbsp;So if you can, can you give me any ideas on why/how to fix that error? &nbsp;Also, can you explain to me or add it in the my code I just gave to check the length of the packet so if its an incorrect length it won't set it? &nbsp;<br>
Thanks for your help so far!<br>
-------------------------<br>
<br>
Followup To<br>
<br>
Question - <br>
Ok, me and a friend are making a game that is LAN. &nbsp;We are using MulticastSockets to connect. &nbsp;Kinda like a lan p2p. &nbsp;So we send the objects as packets back and forth and set the object we received and what not and it works like a dream.. except at some point a random null pointer exception will occur... and we have been through are code time and time again and have came to the conclusion that it can't be the actual game code.. &nbsp;But we read on the java.sun site that delivery of a packet isn't guarenteed... <br>
<br>
so we think that is the problem, that when we try to receive the packet and set the object to the object received it causes the null pointer error.. so is there a way to check and see if its null before we set it. so if it is null we can just skip it basically and not set it?<br>
<br>
Answer - <br>
Josh,<br>
<br>
Well, I don't think that dropping packets could be<br>
the root cause of your problem. &nbsp;When the network<br>
drops a packet, the destination computer never knows<br>
that the packet was even sent. &nbsp;So, the MulticastSocket<br>
receive() method doesn't return, it just waits for the<br>
next packet or it throws an exception.<br>
<br>
You should always check the length of the packet you<br>
receive before you attempt to use it for anything.<br>
Also, you need to set the length of the DatagramPacket<br>
object to the length of its internal buffer before you<br>
call receive(). &nbsp;Also, you must always pay attention to<br>
any exceptions that receive() throws. &nbsp;The proper code<br>
would look something like this:<br>
<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message = null;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try {<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dp.setLength(dp.getData().length);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msock.receive(dp);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (dp.getLength() != EXPECTED_LENGTH) {<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;badPacketCount += 1;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message = new Message(dp.getData(),<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dp.getLength());<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} catch (IOException ie) {<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println("IO Exception in multicast receive: " + ie);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (message != null) {<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;game.processMessage(message);<br>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
<br>
BTW, if you are getting NullPointerExceptions thrown, have<br>
you tried using a stack backtrace to see where they are<br>
occurring? &nbsp;Remember, you can use the Exception <br>
printStackTrace() method to print out the entire stack<br>
from the point where the Exception was thrown.<br>
<br>
Sorry I can't tell you anything more; your description was<br>
rather vague. &nbsp;Good luck...<br>
<br>
...nz<br>
 <br><br>
<script type="text/javascript">if(zs>0){w('<span id="gBt">'+x2+'#b">Get the answer below</a><br></span><a name=b></a>');zSB(1,3);w('<br>')}</script><div id="p1" style="float:right"><g:plusone></g:plusone></div><B>Answer</B><br>Josh,<br>
<br>
I sent you a long answer to this question several days<br>
ago, but AllExperts appears to have lost it. &nbsp;I don't know<br>
whether you received it or not.<br>
<br>
Anyway, the short version is that the following line in<br>
your code is wrong:<br>
<br>
 &nbsp;&nbsp;&nbsp;ByteArrayInputStream byteStream = new<br>
ByteArrayInputStream(recvBuf);<br>
<br>
The way you have coded it will have the wrong length, and<br>
confuse the deserialization processing in the <br>
ObjectInputStream class. &nbsp;<br>
<br>
To fix it, you must supply the amount of data actually<br>
received in the packet to the ByteArrayInputStream<br>
constructor. &nbsp;The correct way to code it is shown below:<br>
<br>
 &nbsp;&nbsp;&nbsp;&nbsp;ByteArrayInputStream byteStream;<br>
 &nbsp;&nbsp;&nbsp;&nbsp;byteStream = new<br>
ByteArrayInputStream(recvBuf, 0, byteCount);<br>
<br>
<br>
That should fix the problem. &nbsp;Good luck...<br>
<br>
...nz<br>
 <br>
	    <!--/gc-->
	    </div>
	    		<ul id="a_util" class="hlist">
      
      <li><a href="http://www.allexperts.com/user.cgi?m=12&catID=1046&qID=4578201" rel="nofollow" target="popup" onClick="window.open(this.href, this.target, 'status=no,scrollbars=yes,resizable=yes,width=600,height=850'); return false;">Add to this Answer</a></li><li class="last"><a href="http://www.allexperts.com/el/Java/">Ask a Question</a></li></ul>

		<div id="rel"><h5>Related Articles</h5><ul><li><a href="http://linux.about.com/library/cmd/blcmdl3_feclearexcept.htm" zT="18/yX')">feclearexcept - Linux Command - Unix Command</a></li><li><a href="http://linux.about.com/library/cmd/blcmdl3_fesetexceptflag.htm" zT="18/yX')">fesetexceptflag - Linux Command - Unix Command</a></li><li><a href="http://linux.about.com/library/cmd/blcmdl3_fesetenv.htm" zT="18/yX')">fesetenv - Linux Command - Unix Command</a></li><li><a href="http://linux.about.com/library/cmd/blcmdl3_fesetround.htm" zT="18/yX')">fesetround - Linux Command - Unix Command</a></li><li><a href="http://linux.about.com/library/cmd/blcmdl3_fenv.htm" zT="18/yX')">fenv - Linux Command - Unix Command</a></li></ul></div>	    				
	    		<script>zSB(2)</script>			     		
				<noscript><a href="http://ad.doubleclick.net/jump/abt.specials/specials_experts;kw=;site=experts;chan=specials;pos=vmslot1;sz=160x600;ord=1DCDNNK03OkWAXxiR" target="_top"><img src="http://ad.doubleclick.net/ad/abt.specials/specials_experts;kw=;site=experts;chan=specials;pos=vmslot1;sz=160x600;ord=1DCDNNK03OkWAXxiR" width=160 height=600 border=0></a></noscript>
						    </div>
    	<script>if(this.zOfs&&zOfs){zob()}</script>			<div id="util"><p><div class="leadheader2">Java</div><br></p><p><a href="http://en.allexperts.com/q/Java-1046/">All Answers</a></p><hr><div><p>Answers by Expert:</p><ul><li><a href="http://en.allexperts.com/q/Java-1046/indexExp_56558.htm">Artemus Harper</a></li><li><a href="http://en.allexperts.com/q/Java-1046/indexExp_72216.htm">Brian Ngure</a></li><li><a href="http://en.allexperts.com/q/Java-1046/indexExp_108818.htm">Ziv Ben-Eliahu</a></li><li><a href="http://en.allexperts.com/q/Java-1046/indexExp_113672.htm">Neeraj A. Shah</a></li></ul></div>
<hr><p><a href="http://www.allexperts.com/el/Java/">Ask Experts</a></p><p><a href="http://www.allexperts.com/user.cgi?m=2&catID=1046">Volunteer</a></p><hr><!--<p><a href="/e/a/">Wiki</a></p>--></div>
		<div id="te">
			<h4>Neal Ziring</h4>
		
	<h5>Expertise</h5><p>Almost anything about the core Java platform, with an emphasis on networking.  Not familiar with JDBC or the new Java graphics APIs. [Sun Certified Java Programmer, JDK 1.1]</p>	<h5>Experience</h5><p>Certified Java Programmer for JDK 1.1 and 2.0.<BR></p></div>
	    	<div id="aef"><a class="logo" href="/"><img src="http://0.tqn.com/d/lg/ae152.gif" alt="AllExperts"></a><div id="ael"><ul class="hlist"></li><li><a href="http://www.allexperts.com/central/user_agreement.htm">User Agreement</a></li><li><a href="http://www.allexperts.com/central/privacy_policy.htm">Privacy Policy</a></li></ul><p>&copy;2013 About.com. All rights reserved.</p></div></div>
    <div id="aeh"><ul class="hlist"><li><a href="http://www.allexperts.com/central/service.htm">About Us</a></li><li><a href="http://www.allexperts.com/user.cgi?m=5">Tell Friends</a></li><li><a href="http://www.allexperts.com/central/howtoask.htm">How to Ask</a></li><li><a href="http://www.allexperts.com/central/expert.htm">How to Volunteer</a></li><li><a href="http://www.allexperts.com/central/userfaq.htm">FAQ</a></li><li><a href="http://www.allexperts.com/central/feedback.htm">Tech Support</a></li><li><a href="http://www.allexperts.com/central/awards/top_volunteers.htm">Top Experts</a></li><li class="last"><a href="http://www.allexperts.com/expertx.cgi">Expert Login</a></li></ul><a class="logo" href="/"><img src="http://0.tqn.com/d/lg/ae152.gif" alt="AllExperts"></a><div id="browse"><p>Browse Answers:</p><ul><li id="bc"><a href="http://en.allexperts.com/">By Category</a></li><li id="ba"><a href="http://en.allexperts.com/q/a.htm">Alphabetically</a></li></ul></div><form id="srch" name="search" method="get" action="http://en.allexperts.com/sitesearch.htm"><fieldset><label for="s">Find expert answers to:</label><div><input id="s" type="text" name="terms" value="" maxlength="64"><input type="hidden" name="cnl" value="Java-1046"><input type="hidden" name="sdn" value="en"><button type="submit" class="find">Find</button></div></fieldset></form></div>
  </div>
<script>if(this.zKW&&gEI('sv'))gEI('sv').value=zE(zE(zKW,1),1).replace(new RegExp('\\+','g'),' ');
if(!this.zOfs&&gEI('oF')){if(document.getElementsByClassName('tr')[0]){clone=gEI('oF').cloneNode(true);clone.id="labels";document.getElementsByClassName('tr')[0].appendChild(clone)}};
adclose()</script>
<noscript><img src="http://b.scorecardresearch.com/p?c1=2&c2=6036459&c7=http%3a%2f%2fen%2eallexperts%2ecom%2fq%2fJava%2d1046%2fSkipping%2dlost%2dpacket%2ehtm&c9=&cv=2.0&cj=1" class="hide"/></noscript><script type="text/javascript" src="https://apis.google.com/js/plusone.js">{"parsetags": "explicit"}</script>
<script type="text/javascript">gapi.plusone.go("p1")</script>
</body>
</html>

