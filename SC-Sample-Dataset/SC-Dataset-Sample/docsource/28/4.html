<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>Developer support list for Wireshark ()</TITLE>
<BASE href="http://comments.gmane.org">
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<link rel="SHORTCUT ICON" href="http://gmane.org/favicon.ico">
<link rel="Up" href="/gmane.network.wireshark.devel>">
<LINK href="http://gmane.org/img/leftmenu.css" type="text/css" rel="stylesheet">
<LINK href="http://gmane.org/img/blog.css" type="text/css" rel="stylesheet">
<style type="text/css" media="screen">
h1.name {
  background-image:  url(http://gmane.org/paint-blog-id.php?group=gmane.network.wireshark.devel);
}
</style>
</HEAD>
<BODY>
<div id=banner>
<h1 class=name>&nbsp;</h1>
<span class=description>Developer support list for Wireshark ()</span>
</div>
<script src="http://gmane.org/img/jsblog.js" type="text/javascript"></script>

<DIV id=content>
<DIV class=blog>
<div class=posting>
<DIV class=entry>
<DIV class=date>
<div class=options><a rel=nofollow href="#" onclick="return toggle('o1');">headers</a></div>
<span class=author>
<a href="http://search.gmane.org/?author=Stephen+Fisher&amp;sort=date" rel=nofollow>Stephen Fisher</a>
 | </span>
<SPAN class=day>31 Aug 2010 01:33</SPAN>
</DIV>
<DIV class=blogbody><A name=5></A>
<H2 class=title>Can asn2wrs handle BER &amp; PER in same protocol?</h2><div id="o1" class="hidden">Stephen Fisher &lt;<a target="_top" href="http://gmane.org/get-address.php?address=steve%2dcOXOJo%2fIntlNDt%2fiz0mmUNBPR1lH4CV8%40public.gmane.org" rel="nofollow">steve@...</a>&gt;<br>
2010-08-30 23:33:09 GMT<br>
</div>
<pre>
I'm making my first serious attempt at working with an asn2wrs generated 
dissector, T.125.  I noticed (when looking at RDP traffic) that only the 
Connect Initial/Reponse packets are decoded.  The rest of the packets 
simply say "T.125 payload" because t125.cnf doesn't support them.

The next packet in an RDP session after the MCS connection response is 
Erect Domain.  DomainMCSPDU is commented out in t125.cnf presumably 
because it doesn't work yet.  Although I barely know the difference in 
BER and PER, I'm guessing that the problem is being caused by the 
connect packets being BER encoded and the domain packets being PER.  Is 
it possible to switch between them when using asn2wrs?  Glancing at all 
of the other .cnf files seems to indicate that each protocol is one or 
the other.

___________________________________________________________________________
Sent via:    Wireshark-dev mailing list &lt;<a target="_top" href="http://gmane.org/get-address.php?address=wireshark%2ddev%2dIZ8446WsY0%2fdtAWm4Da02A%40public.gmane.org" rel="nofollow">wireshark-dev@...</a>&gt;
Archives:    <a rel="nofollow" href="http://www.wireshark.org/lists/wireshark-dev" target="_top">http://www.wireshark.org/lists/wireshark-dev</a>
Unsubscribe: <a rel="nofollow" href="https://wireshark.org/mailman/options/wireshark-dev" target="_top">https://wireshark.org/mailman/options/wireshark-dev</a>
             mailto:<a target="_top" href="http://gmane.org/get-address.php?address=wireshark%2ddev%2drequest%2dIZ8446WsY0%2fdtAWm4Da02A%40public.gmane.org" rel="nofollow">wireshark-dev-request@...</a>?subject=unsubscribe

</pre>
<DIV class=posted>
<form class="spam" method="post" action="http://spam.gmane.org/gmane.network.wireshark.devel:19079:unconfirmed" onsubmit="openSpamFrame(this); return false;">
<A href="http://permalink.gmane.org/gmane.network.wireshark.devel/19079">Permalink</A>
| <a href="http://post.gmane.org/post.php?group=gmane.network.wireshark.devel&amp;followup=19079" rel=nofollow>Reply</a>
| <input class="spam" type="submit" value="Report this as spam">
</form>
</DIV>  

</DIV>  
</DIV>  

<div class=posting>
<DIV class=entry>
<DIV class=date>
<div class=options><a rel=nofollow href="#" onclick="return toggle('o2');">headers</a></div>
<span class=author>
<a href="http://search.gmane.org/?author=Anders+Broman&amp;sort=date" rel=nofollow>Anders Broman</a>
 | </span>
<SPAN class=day>31 Aug 2010 07:15</SPAN>
</DIV>
<DIV class=blogbody><A name=5></A>
<div class=face>
<a target="_top" href="http://ftp.cs.indiana.edu/pub/faces/picons/"><img border=0 alt="Picon" src="http://cache.gmane.org//gmane/network/wireshark/devel/19081-picon-001.gif"></a>
<br>
</div>
<H3 class=title>Re: Can asn2wrs handle BER &amp; PER in same protocol?</h3><div id="o2" class="hidden">Anders Broman &lt;<a target="_top" href="http://gmane.org/get-address.php?address=a.broman%2dzq6IREYz3ykAvxtiuMwx3w%40public.gmane.org" rel="nofollow">a.broman@...</a>&gt;<br>
2010-08-31 05:15:26 GMT<br>
</div>
<pre>
  Stephen Fisher skrev 2010-08-31 01:33:
&gt; I'm making my first serious attempt at working with an asn2wrs generated
&gt; dissector, T.125.  I noticed (when looking at RDP traffic) that only the
&gt; Connect Initial/Reponse packets are decoded.  The rest of the packets
&gt; simply say "T.125 payload" because t125.cnf doesn't support them.
&gt;
&gt; The next packet in an RDP session after the MCS connection response is
&gt; Erect Domain.  DomainMCSPDU is commented out in t125.cnf presumably
&gt; because it doesn't work yet.  Although I barely know the difference in
&gt; BER and PER, I'm guessing that the problem is being caused by the
&gt; connect packets being BER encoded and the domain packets being PER.  Is
&gt; it possible to switch between them when using asn2wrs?  Glancing at all
&gt; of the other .cnf files seems to indicate that each protocol is one or
&gt; the other.
&gt;
I don't think asn2wrs can handle a mix but looking at T.125 it may be a 
bit more complicated:
<a rel="nofollow" href="http://www.itu.int/itu-t/recommendations/index.aspx?ser=T" target="_top">http://www.itu.int/itu-t/recommendations/index.aspx?ser=T</a>
9 Encoding of MCSPDUs
Each MCSPDU is transported as one TSDU across a TC belonging to an MCS 
connection. Connect
MCSPDUs are unlimited in size. Domain MCSPDUs are limited in size by a 
parameter of the MCS
domain.
A standard ASN.1 data value encoding is used to transfer MCSPDUs between 
peer MCS providers.
Encoding rules are selected as part of protocol version negotiation. 
This negotiation involves the
exchange of a Connect-Initial and a Connect-Response MCSPDU over the 
initial TC. Three
</pre><a href="http://permalink.gmane.org/gmane.network.wireshark.devel/19081">(Continue reading)</a><br><br>
<DIV class=posted>
<form class="spam" method="post" action="http://spam.gmane.org/gmane.network.wireshark.devel:19081:unconfirmed" onsubmit="openSpamFrame(this); return false;">
<A href="http://permalink.gmane.org/gmane.network.wireshark.devel/19081">Permalink</A>
| <a href="http://post.gmane.org/post.php?group=gmane.network.wireshark.devel&amp;followup=19081" rel=nofollow>Reply</a>
| <input class="spam" type="submit" value="Report this as spam">
</form>
</DIV>  

</DIV>  
</DIV>  

<div class=posting>
<DIV class=entry>
<DIV class=date>
<div class=options><a rel=nofollow href="#" onclick="return toggle('o3');">headers</a></div>
<span class=author>
<a href="http://search.gmane.org/?author=Kukosa%2C+Tomas&amp;sort=date" rel=nofollow>Kukosa, Tomas</a>
 | </span>
<SPAN class=day>31 Aug 2010 08:18</SPAN>
</DIV>
<DIV class=blogbody><A name=5></A>
<H3 class=title>Re: Can asn2wrs handle BER &amp; PER in same protocol?</h3><div id="o3" class="hidden">Kukosa, Tomas &lt;<a target="_top" href="http://gmane.org/get-address.php?address=tomas.kukosa%2dgtF%2fdg1N09I9ruZUYCyO%2fyPlML9JkKWw%40public.gmane.org" rel="nofollow">tomas.kukosa@...</a>&gt;<br>
2010-08-31 06:18:56 GMT<br>
</div>
<pre>
Hi,

yes, it is not possible to generate BER end PER code in one asn2wrs calling.
But you can call it more times for one protocol. 

Using asn2wrs with -s option (Single file output from template) and generating packet-proto.c with one
asn2wrs calling is just one simple way how to use it.

You can call asn2wrs more times without -s option and then combine generated source fragments in the way
which you need.

Regards,
  Tomas

-----Original Message-----
From: <a target="_top" href="http://gmane.org/get-address.php?address=wireshark%2ddev%2dbounces%2dIZ8446WsY0%2fdtAWm4Da02A%40public.gmane.org" rel="nofollow">wireshark-dev-bounces@...</a>
[mailto:<a target="_top" href="http://gmane.org/get-address.php?address=wireshark%2ddev%2dbounces%2dIZ8446WsY0%2fdtAWm4Da02A%40public.gmane.org" rel="nofollow">wireshark-dev-bounces@...</a>] On Behalf Of Anders Broman
Sent: Tuesday, August 31, 2010 7:15 AM
To: Developer support list for Wireshark
Subject: Re: [Wireshark-dev] Can asn2wrs handle BER &amp; PER in same protocol?

  Stephen Fisher skrev 2010-08-31 01:33:
&gt; I'm making my first serious attempt at working with an asn2wrs generated
&gt; dissector, T.125.  I noticed (when looking at RDP traffic) that only the
&gt; Connect Initial/Reponse packets are decoded.  The rest of the packets
&gt; simply say "T.125 payload" because t125.cnf doesn't support them.
&gt;
&gt; The next packet in an RDP session after the MCS connection response is
&gt; Erect Domain.  DomainMCSPDU is commented out in t125.cnf presumably
&gt; because it doesn't work yet.  Although I barely know the difference in
</pre><a href="http://permalink.gmane.org/gmane.network.wireshark.devel/19083">(Continue reading)</a><br><br>
<DIV class=posted>
<form class="spam" method="post" action="http://spam.gmane.org/gmane.network.wireshark.devel:19083:unconfirmed" onsubmit="openSpamFrame(this); return false;">
<A href="http://permalink.gmane.org/gmane.network.wireshark.devel/19083">Permalink</A>
| <a href="http://post.gmane.org/post.php?group=gmane.network.wireshark.devel&amp;followup=19083" rel=nofollow>Reply</a>
| <input class="spam" type="submit" value="Report this as spam">
</form>
</DIV>  

</DIV>  
</DIV>  

</div>
</div>
</div>
</div>
</DIV>  

</div>

<div id="sidebox">

<div class="sidetitle">Return</div>
<div class="side">
Return to <a href="http://blog.gmane.org/gmane.network.wireshark.devel">gmane.network.wireshark.devel</a>.
</div>


<div class="sidetitle">Advertisement</div>
<div class="side" align="center">
<script type="text/javascript"><!--
amazon_ad_tag = "gmane-20"; amazon_ad_width = "300"; amazon_ad_height = "250";//--></script>
<script type="text/javascript" src="http://www.assoc-amazon.com/s/ads.js"></script>
</div>

<div class="sidetitle">Project Web Page</div>
<div class="side">
   <a href="http://www.wireshark.org">Developer support list for Wireshark ()</a>
</div>

<div class="sidetitle">Search Archive</div>
<div class="side">
<div align="center">
<br/>
<form action="http://search.gmane.org" method="get">
<input name="query" value="" title="search_text"/><input type="submit" title="SUBMIT" value="Search"/>
<input type=hidden name="group" value="gmane.network.wireshark.devel">
</form>
</div>
</div>





<div class="sidetitle">Language</div>
<div class="side">
   <a rel=nofollow href="http://gmane.org/language.php">Change language</a>
</div>


<div class="sidetitle">Options</div>
<div class="side">
Current view: 
Threads only / Showing 
 only 20 lines /
 Not hiding cited text.<br/>
    Change to 
<a rel=nofollow href="/gmane.network.wireshark.devel?set_blog_all=yes">All messages, </a><a rel=nofollow href="/gmane.network.wireshark.devel?set_lines=100000">whole messages</a>, or 
<a rel=nofollow href="/gmane.network.wireshark.devel?set_cite=hide">hide cited text</a>.<br /><br />

<a href="http://post.gmane.org/post.php?group=gmane.network.wireshark.devel" rel=nofollow>Post a message</a><br/>
<a href="nntp://news.gmane.org/gmane.network.wireshark.devel">NNTP Newsgroup</a><br/>
<a rel=nofollow href="http://news.gmane.org/find-root.php?message_id=%3cEC24CA2C319E8D47ACA5E181ABEC3E7B076DD0469F%40MCHP058A.global%2dad.net%3e">Classic Gmane web interface</a><br/>

<a href="http://rss.gmane.org/gmane.network.wireshark.devel"><img src="http://gmane.org/img/xml.gif" alt="XML" border=0>&nbsp;RSS Feed</a><br/>
<a href="http://dir.gmane.org/gmane.network.wireshark.devel">List Information</a><br/><br/>
<a href="http://gmane.org/faq.php">About Gmane</a><br/>
</div>

</div>

    <br clear="all" />

<div class="bottombox"><p class="bottomtext"><a href="http://gmane.org/">Gmane</a></p></div>
  </body>
</html>


