<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="-1" />
<style type="text/css">
@import url( /templates/default/mobile/styles/mobile.css?1386831159603 ) ;
</style>

<meta name="viewport" content="width = 320" />

<title>Adding To An ArrayList (Beginning Java forum at JavaRanch)</title>
<link rel="canonical" href="http://www.coderanch.com/t/567474/java/java/Adding-ArrayList"/>
<link rel="alternate" media="handheld" href="http://www.coderanch.com/mobile/t/567474/java/java/Adding-ArrayList?foo=a">
</head>
<body class="en_US">

<a name="top"></a>
<table cellspacing="0" cellpadding="0" border="0">
    <tr>
        <td align="center">
                <a href="/forums/list"><img
                src="/templates/default/mobile/images/mobile-moose.gif"
                vspace="1" border="0" alt="[Logo]" width="100" height="100" /></a>
		</td>
        <td class="logo" valign="center">
          A friendly place for programming greenhorns!
        <a href="#bottom"><img src="/templates/default/mobile/images/down_arrow.gif" width="10" height="10" alt="Jump to bottom of page" /></a>
        </td>
    </tr>
</table>

<p>
  <a id="register" class="mainmenu" href="/forums/user/insert">Register</a> /
  <a id="login" class="mainmenu" href="/forums/user/login">Login</a>
</p>
<a class="maintitle" href="http://www.coderanch.com/forums">Java Forums</a>



&raquo; <a class="maintitle" href="/forums/c/1/java">Java</a> &raquo;
<a class="maintitle" href="/forums/f-33/java">Beginning Java</a>
<div class="subject">Adding To An ArrayList</div>


  
  <div class="mobilePostBody">
  

  Post by: Jude Wyatt, Greenhorn<br />
  on <span class="lastPostTime">Feb 15, 2012 07:42:51</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">Hello all-
<br /> 
<br />      This is my first post here.  I've been taking courses to learn Java for almost a year now.  I really enjoy it and love it when I make a breakthrough.  However, I'm struggling pretty hard right now with this one thing.
<br /> 
<br /> I have an ArrayList of objects in my Driver Program.  I am required to pass this array to a method called "mate", which is located in another class.  Inside this "mate" method, I'm required to check some conditions and if true, add additional objects to the ArrayList located in main.  However, the method is not suppossed to return any value.  The code I'm currently using is below:
<br /> 
<br /> This is my driver with the ArrayList, as well as the Main Method:   <b>(NOTE: there is quite a bit of other code that I have omitted because all I'm concerned with is learning how to add an additional object to my ArrayList, from the mate method.)</b>
<br /> 
<br /> <textarea name="code" class="java" cols="60" rows="10">import java.util.*;

public class CatMouse
{
     public static void main(String [] args)
     {
        ArrayList&lt;Mouse&gt; mice = new ArrayList&lt;Mouse&gt;();
        mice.add(new Mouse());
        mice.add(new Mouse());
        mice.add(new Mouse());
        
         for (Mouse m:mice)
         {
           m.grow();
           Mouse.mate(mice);
         }
}</textarea>
<br /> 
<br /> and here is my Mouse class which holds the grow() and mate() methods:  <b>(NOTE:  Again, code omitted because all I'm concerned with is learning how to add an additional object to my ArrayList, from within the mate method.)</b>   
<br /> 
<br /> <textarea name="code" class="java" cols="60" rows="10">import java.util.*;

public class Mouse extends Mammal
{

      private static ArrayList&lt;Mouse&gt; miceModified = new ArrayList&lt;Mouse&gt;();

      public void grow()
      {
        super.grow();
        this.setWeight(this.getWeight() * .01);
      }

      public static void mate(ArrayList &lt;Mouse&gt; m)
      {
         miceModified = m;
         miceModified.add(new Mouse()); 
//anytime I add this line anywhere in this or any of my other classes, it causes the Main method to error-out upon execution.
      }
}</textarea>
<br /> 
<br /> So, basically I need to know why this line <b>miceModified.add(new Mouse());</b>  is causing the error and what I need to do instead of this line in order to add an additional Mouse Object to my ArrayList, while I'm inside of this mate() method.
<br /> 
<br /> Here is the error that I receive:
<br /> 
<br /> <textarea name="code" class="java" cols="60" rows="10">Exception in thread "main" java.util.ConcurrentModificationException
        at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:819)
        at java.util.ArrayList$Itr.next(ArrayList.java:791)
        at CatMouse.main(CatMouse.java:18)

Press any key to continue . . .</textarea>
<br /> 
<br /> Any help anyone could provide would be awesome!
<br /> 
<br /> Thanks,
<br /> chief
<br /> 
<br /> 
<br />    </span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Jeff Verdegan, Bartender<br />
  on <span class="lastPostTime">Feb 15, 2012 07:55:48</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">Hi, and welcome to the Ranch!
<br /> 
<br /> When you post code, UseCodeTags(&lArr;click) so it will be readable.
<br /> 
<br /> ItDoesntWorkIsUseless.(&lArr;click) You need to copy/paste the exact, complete error message.
<br /> 
<br /> As it is, skimming your unformatted code and with no details about the error, I don't see anything that should be causing a problem, so please follow the above suggestions and then we'll see what the problem is.</span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Joanne Neal, Rancher<br />
  on <span class="lastPostTime">Feb 15, 2012 07:56:59</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">&nbsp;<blockquote>
			<div>
				<cite>chief warpaint wrote:</cite>So, basically I need to know why this line <b>miceModified.add(new Mouse());</b>  is causing the error </div>
		</blockquote>
<br /> What error ?</span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Jude Wyatt, Greenhorn<br />
  on <span class="lastPostTime">Feb 15, 2012 08:01:38</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">&nbsp;<blockquote>
			<div>
				<cite>Jeff Verdegan wrote:</cite>Hi, and welcome to the Ranch!
<br /> 
<br /> When you post code, UseCodeTags(&lArr;click) so it will be readable.
<br /> 
<br /> ItDoesntWorkIsUseless.(&lArr;click) You need to copy/paste the exact, complete error message.
<br /> 
<br /> As it is, skimming your unformatted code and with no details about the error, I don't see anything that should be causing a problem, so please follow the above suggestions and then we'll see what the problem is.</div>
		</blockquote>
<br /> 
<br /> Jeff-
<br /> 
<br />      My apologies and thanks for the heads up.  I edited the post to reflect java code, but is there anyway to post the error message without having to type it all out?  Copy/Paste doesn't seem to work.</span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Jeff Verdegan, Bartender<br />
  on <span class="lastPostTime">Feb 15, 2012 08:06:41</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">&nbsp;<blockquote>
			<div>
				<cite>chief warpaint wrote:</cite>is there anyway to post the error message without having to type it all out?  Copy/Paste doesn't seem to work.</div>
		</blockquote>
<br /> 
<br /> Windows cmd.exe?
<br /> Either just select it and hit Enter to copy, or, if not in quick-edit mode, right click, and choose "Select" or whatever is appropriate from the popup menu, then, I think, hit Enter to copy.
<br /> 
<br /> Linux terminal?
<br /> Just select the text to copy it.
<br /> 
<br /> Console in an IDE such as Eclipse or NetBeans?
<br /> You shouldn't be using an IDE yet, but I'm sure there's a way to copy its output. See its docs or help section.
<br /> 
<br /> Also, please re-edit your post so that the long comment is above the line in question, not at the end of it. Code doesn't line-wrap, so it makess the text area very wide and I have to scroll right to read everything. Thanks.
<br /> </span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Jude Wyatt, Greenhorn<br />
  on <span class="lastPostTime">Feb 15, 2012 08:12:09</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">&nbsp;<blockquote>
			<div>
				<cite>Jeff Verdegan wrote:</cite><blockquote>
			<div>
				<cite>chief warpaint wrote:</cite>is there anyway to post the error message without having to type it all out?  Copy/Paste doesn't seem to work.</div>
		</blockquote>
<br /> 
<br /> Windows cmd.exe?
<br /> Either just select it and hit Enter to copy, or, if not in quick-edit mode, right click, and choose "Select" or whatever is appropriate from the popup menu, then, I think, hit Enter to copy.
<br /> 
<br /> Linux terminal?
<br /> Just select the text to copy it.
<br /> 
<br /> Console in an IDE such as Eclipse or NetBeans?
<br /> You shouldn't be using an IDE yet, but I'm sure there's a way to copy its output. See its docs or help section.
<br /> 
<br /> Also, please re-edit your post so that the long comment is above the line in question, not at the end of it. Code doesn't line-wrap, so it makess the text area very wide and I have to scroll right to read everything. Thanks.
<br /> </div>
		</blockquote>
<br /> 
<br /> Jeff-
<br /> 
<br />      Thanks.  That worked perfectly!  I posted the error message into the original post.</span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Jeff Verdegan, Bartender<br />
  on <span class="lastPostTime">Feb 15, 2012 08:17:38</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">&nbsp;<blockquote class="uncited">
			<div>
<br /> <textarea name="code" class="java" cols="60" rows="10">
Exception in thread "main" java.util.ConcurrentModificationException  
        at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:819)  
        at java.util.ArrayList$Itr.next(ArrayList.java:791)  
        at CatMouse.main(CatMouse.java:18)  
  </textarea></div>
		</blockquote>
<br /> 
<br /> Did you read the docs for <a href="http://download.oracle.com/javase/7/docs/api/java/util/ConcurrentModificationException.html" target="_blank" >java.util.ConcurrentModificationException</a>?(&lArr;click)
<br /> "For example, if a thread modifies a collection directly while it is iterating over the collection with a fail-fast iterator, the iterator will throw this exception."
<br /> 
<br /> I didn't see any multithreading in your code, so probably you're doing this:
<br /> 
<br /> <textarea name="code" class="java" cols="60" rows="10">
for (iteration over list) {
  list.add(something);
  // or
  list.remove(something);
}
</textarea>
<br /> 
<br /> While an iteration is in progress, you can only modify the list via the iterator. Plain old Iterator has a remove() method. ListIterator has an add() method as well. 
<br /> 
<br /> So, you either need to use a ListIterator and call its add() method, rather than the List's add() method; or you need to collect all the stuff to add in a separate List, and then, after the iteration is complete, add everything from the new list into the original.</span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Joanne Neal, Rancher<br />
  on <span class="lastPostTime">Feb 15, 2012 08:22:12</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">The foreach loop is just syntactic sugar for looping over a collection with an Iterator (see <a class="snap_shots" href="http://www.coderanch.com/t/567271/java/java/difference-between-foreach" target="_new" >this thread</a> for an example). And modifying a collection when it is being iterated using anything other than the itearor is not allowed.
<br /> As it says in the javadoc for ArrayList
<br /> <blockquote class="uncited">
			<div>The iterators returned by this class's iterator and listIterator methods are fail-fast: if the list is structurally modified at any time after the iterator is created, in any way except through the iterator's own remove or add methods, the iterator will throw a ConcurrentModificationException. </div>
		</blockquote>&nbsp;</span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Campbell Ritchie, Sheriff<br />
  on <span class="lastPostTime">Feb 15, 2012 08:24:51</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">That grow method, if you have the same in the Cat class, will have <a class="snap_shots" href="http://www.youtube.com/watch?v=5B_BPN-WF1E" target="_new" >this effect</a> <img src="http://cache-www.coderanch.com/images/smilies/8a80c6485cd926be453217d59a84a888.gif" /></span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Campbell Ritchie, Sheriff<br />
  on <span class="lastPostTime">Feb 15, 2012 08:34:43</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">I had to introduce some new lines into your code because the comment made it too wide for a screen.
<br /> Why is the<tt> mouseModified </tt>List<tt> static</tt>? Why are you replacing it in your<tt> mate() </tt>method? Both those things look like very iffy design to me.
<br /> 
<br /> You can only suffer <u>that</u> exception if you have an Iterator elsewhere. It must be that in the for-each loop in the main method, passed on to mate() method. If you do need Iterators, you should almost always declare them as loop-local variables, not fields, otherwise you are setting yourself up for a ConcurrentModificationException. In the case where you wish to alter the List, you should consider using an old-fashioned<tt> for </tt>loop, not for-each. Also read about the RandomAccess [â†?link] interface, and see whether ArrayList implements RandomAccess.</span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Jude Wyatt, Greenhorn<br />
  on <span class="lastPostTime">Feb 15, 2012 08:52:11</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">&nbsp;<blockquote class="uncited">
			<div> ...Why is the<tt> mouseModified </tt>List<tt> static</tt>? Why are you replacing it in your<tt> mate() </tt>method? Both those things look like very iffy design to me...</div>
		</blockquote>
<br /> 
<br /> Campbell-
<br /> 
<br />      That is from a result of me tinkering.  We're not suppossed to return anything from the mate() method.  So , essentially I tried making a copy of the ArrayList and adding new Mouse Objects to the copy.  Then at a later time, I would pull the copied ArrayedList for generating screen output.  Like the title of the post says, I'm a newb and am still learning all of this.  I'm sure there is probably a better way to do this.  I just haven't learned it yet.
<br /> 
<br /> 
<br /> </span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Rob Spoor, Sheriff<br />
  on <span class="lastPostTime">Feb 15, 2012 09:15:26</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">Line 16 of your Mouse class does not create a copy of <tt>m</tt>, it creates a new reference to the existing List object.</span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Campbell Ritchie, Sheriff<br />
  on <span class="lastPostTime">Feb 15, 2012 09:30:52</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">You need to get a pencil and paper (and an eraser, probably the most important piece of equipment) and draw a diagram with your classes on. Draw a List of Mice; a square labelled mouseList containing M1, M2, M3, will do. Now decide where to put that. <li>Does it belong to a particuar mouse (instance field of the mouse class)?</li><li>Does it belong to the application as a whole (passed from outside the Mouse class)?</li><li>Does it belong to the Mouse class (rather than to a particular Mouse), being shared between all Mice (probably<tt> static </tt>field of the mouse class)?</li>Altering the field because a List is passed as an argument sounds iffy to me. Maybe you should have a method like this:-<textarea name="code" class="java" cols="60" rows="10">/**
 * Adds mice objects to the List of Mice
 * More stuff which you usually find in a documentation comment
 */
 // Whether it is static depends on whether the List is static.
public maybeStaticMaybeNot void addMouse(Mouse m)
{
   // work it out yourself
}</textarea>
<br /> If you search these fora, you will find discussion about whether things should be<tt> static </tt>or not; there seem to have been lots of such discussion in the last week or two. Making something<tt> static </tt>&#x201c;because it works&#x201d; sounds dubious, but making something<tt> static </tt>because you have worked out it ought to be<tt> static </tt>is good practice.
<br /> You are right not to return something from the mate() method. A method should do one thing and one thing only.
<br /> There are ways of granting access to the List of mice from outside the class; you create a method which returns a reference to it (or, better still, you find <a class="snap_shots" href="http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#unmodifiableList(java.util.List)" target="_new" >this</a>, which copies it in a read-only form, to return from your method). By the way: if you are using a<tt> static </tt>member, you should call it by the name of the class, not an object. If you have a method which returns something<tt> static</tt>, you will most likely want that method to be<tt> static</tt>, too.</span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Jude Wyatt, Greenhorn<br />
  on <span class="lastPostTime">Feb 15, 2012 18:47:01</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">&nbsp;<blockquote>
			<div>
				<cite>Campbell Ritchie wrote:</cite>That grow method, if you have the same in the Cat class, will have <a class="snap_shots" href="http://www.youtube.com/watch?v=5B_BPN-WF1E" target="_new" >this effect</a> <img src="http://cache-www.coderanch.com/images/smilies/8a80c6485cd926be453217d59a84a888.gif" /></div>
		</blockquote>
<br /> 
<br /> Campbell-
<br /> 
<br />      Hahaha you were right.  The kitty sure does get big pretty quick.  Any way you could explain to me why it is happening and how I can correct it?  I do have a grow method in both classes, but I thought that I was telling them to call their appropriate classes grow methods.
<br /> 
<br /> Thanks,
<br /> Jeff</span>
    </div>
 <br />



  
  <div class="mobilePostBody">
  

  Post by: Campbell Ritchie, Sheriff<br />
  on <span class="lastPostTime">Feb 16, 2012 03:51:32</span>
  


    
  </div>
  
  
    <div class="mobilePostText">
                        
        <span class="postbody">I actually meant the effect at the end of the clip.</span>
    </div>
 <br />



<br />


               <input type="button" value="Reply" onclick="location.href='/forums/posts/reply/0/567474'" />
	

    <input type="button" value="New Topic" onclick="location.href='/jforum?module=posts&amp;action=insert&amp;forum_id=33'" />






<br /><br />


<br />

<div class="gensmall center">
All times above are in ranch (not your local) time.<br />
The current ranch time is <br />
<span class="mobileLabel">Dec 13, 2013 16:19:38</span>.
</div>
<br />
<div>
  <a id="search" href="/forums/search/filters/33"><span class="mobileLabel">Search</span></a>
  |
<a href="/forums/recentTopics/list"><span class="mobileLabel">Recent Topics</span></a>
</div>

 <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ?  "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
 <script type="text/javascript">
    if (typeof _gat !== "undefined") {
        var pageTracker = _gat._getTracker("UA-2371260-2");
        pageTracker._trackPageview();

        dt = new Date();
        pageTracker._setVar("hour: " + dt.getHours());
    }
</script>

<br />
<div>Copyright &copy; 1998-2013 <a href="http://www.javaranch.com/paul-wheaton.jsp">Paul Wheaton</a></div>
<br />
<a name="bottom"></a>
<a href="#top"><img src="/templates/default/mobile/images/up_arrow.gif" width="10" height="10" alt="Jump to top of page" /></a>
<br />
<a href="http://www.coderanch.com/t/567474/java/java/Adding-ArrayList?nonMobile=true">Or visit our non-mobile (full) site</a>
</body>
</html>
