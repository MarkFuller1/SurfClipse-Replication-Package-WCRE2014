<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head><script type="text/javascript">var NREUMQ=NREUMQ||[];NREUMQ.push(["mark","firstbyte",new Date().getTime()]);</script>
	<title>Learning Java</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="http://dwn0odqttrkhc.cloudfront.net/assets/book-e6243cc4cc3595e325ee635b31c10604.css" media="screen" rel="stylesheet" type="text/css" />
	<link href="http://dwn0odqttrkhc.cloudfront.net/assets/default-9bd75a59838b84de4e4348e3a0a35694.css" media="screen" rel="stylesheet" type="text/css" />
	<script src="http://dwn0odqttrkhc.cloudfront.net/assets/application-984298d79dbc8412cdf579684d9338f6.js" type="text/javascript"></script>
	<script src="http://dwn0odqttrkhc.cloudfront.net/assets/book-756862b9ed04d945ca53de5b8f106a83.js" type="text/javascript"></script>
	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	<link href="http://dwn0odqttrkhc.cloudfront.net/assets/janrain-53eb5abed55992e21943b9d3373923e8.css" media="all" rel="stylesheet" type="text/css" />
	<meta content="authenticity_token" name="csrf-param" />
<meta content="CvaJe1cWQsNi766GWOv6whypSLfoEDPu8M/L+s0yJXA=" name="csrf-token" />
	<script type="text/javascript" charset="utf-8">
  	
		app.data = new classes.Data({"controller":{"controller":"books","action":"html"},"capturable":{"capture_server":"https://oreilly.janraincapture.com","client_id":"6n5q2k9vesqgn93k3mhevka6c3c3rsre","app_url":"https://login.oreilly.com","app_id":"xsnca5wmqe9vxv97ygh5vfejkd","load_js":"d16s8pqtk4uodx.cloudfront.net/login.oreilly.com/load.js"},"user":{"id":null,"account":"LoggedOutAccount","email":"","name":null,"gravatar_url":"http://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=40&d=identicon"},"book":{"isbn":"1234000001805","chapter":"ch11.html","toc_url":"/books/1234000001805/toc_html","metadata_url":"http://d4bb7yl96lyl1.cloudfront.net/1234000001805/metadata/metadata_9db2a74acefa69c1a828180428c77a831e176dc8.json"},"abilities":{"can_destroy_all_comments":false,"can_create_comments":false},"advertisement":{"body":"<style>      \r\n.ad-profile-image {\r\n  padding: 0;\r\n  margin: 0;\r\n  max-height: 30px;\r\n }\r\n\r\n.top-banner {\r\n  position: absolute;\r\n  right: 0;\r\n  top: 34px;\r\n  z-index: 99999;\r\n}\r\n\r\np.banner-text {\r\n  margin: 0;\r\n  text-align: center;\r\n  padding-right: 10px;\r\n  width: 400px;\r\n}\r\n\r\n@media screen and (max-width: 600px) {\r\n   p.banner-text {\r\n     width: 100%;\r\n     text-align: center;\r\n  }\r\n}\r\n\r\nspan.ebook-advantage {\r\n  font-size: smaller;\r\n  display: block;\r\n}\r\n\r\ndiv.banner-container {\r\n  margin: 0 auto;\r\n}\r\n\r\ndiv.banner-container ul {\r\n  margin: 0 auto;\r\n}\r\n\r\ndiv.topad { padding-bottom: 5px; }\r\n\r\ndiv.banner-container ul li {\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n}\r\n\r\ndiv.banner-container li p {\r\n  padding-top: 0;\r\n  margin-top: 0;\r\n}\r\n\r\ndiv.banner-container li.sponsor {\r\n  border-right: 1px solid rgb(125, 154, 180);\r\n  margin-right: 5px;\r\n  padding-right: 10px;\r\n}\r\n\r\ndiv.banner-container .webbutton {\r\n  background-color: #3994b6;\r\n  display: inline-block;\r\n  padding: 10px;\r\n  -webkit-border-radius: 5px;\r\n  -moz-border-radius: 5px;\r\n  border-radius: 5px;\r\n  color: #FFF;\r\n  text-align: center;\r\n  text-decoration: none;\r\n  font-size: 12px;\r\n  font-weight: bold;\r\n}\r\n\r\n</style>\r\n   \r\n<div style=\"color: rgb(125, 154, 180);\">\r\n\r\n<div class=\"banner-container\">\r\n\r\n<ul>\r\n\r\n<li class=\"sponsor\">\r\n<!--CONFERENCE SPONSOR IMAGE-->\r\n<a href=\"http://www.oscon.com/oscon2013\">\r\n<!--<img src=\"http://orm-other.s3.amazonaws.com/fluent_logo.png\" class=\"ad-profile-image\"/>-->\r\n<img src=\"http://orm-other.s3.amazonaws.com/oscon_logo.png\" class=\"ad-profile-image\"/>\r\n<!--<img src=\"http://orm-other.s3.amazonaws.com/strata_logo.png\" class=\"ad-profile-image\"/>\r\n<img src=\"http://orm-other.s3.amazonaws.com/StrataRx_logo.png\" class=\"ad-profile-image\"/>\r\n<img src=\"http://orm-other.s3.amazonaws.com/velocity_logo.png\" class=\"ad-profile-image\"/>-->\r\n</a>\r\n</li>\r\n\r\n<li>\r\n<!--AD TEXT, 2 LINES, REPLACE LINK URL AS WELL-->\r\n<p class=\"banner-text\">Enjoy this online version of <em>Learning Java</em>. Purchase and download the DRM-free ebook on <a href=\"http://shop.oreilly.com/product/0636920023463.do\">oreilly.com</a>.<span class=\"ebook-advantage\">Learn more about the Oâ€™Reilly <a href=\"http://shop.oreilly.com/category/ebooks.do\">Ebook Advantage</a>.</span></p>\r\n</li>\r\n\r\n<li>\r\n<!--BUY BUTTON-->\r\n<a class=\"webbutton\" href=\"http://shop.oreilly.com/product/0636920023463.do\">Buy the Ebook</a>\r\n</li> \r\n\r\n</ul>\r\n\r\n</div>\r\n\r\n<!--CORNER BANNER (IF NEEDED)-->\r\n<!--<a href=\"http://shop.oreilly.com/product/0636920025245.do\" class=\"top-banner\"><img src=\"http://orm-other.s3.amazonaws.com/banner.png\" /></a>-->\r\n\r\n</div>"}});

		/* Janrain setup */
  	var janrainModal = new JanrainView();
  	$("head").append(janrainModal.render().el);

  	/* segment.io setup */
  	var analytics=analytics||[];analytics.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+e+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);var r=function(e){return function(){analytics.push([e].concat(Array.prototype.slice.call(arguments,0)))}},i=["identify","track","trackLink","trackForm","trackClick","trackSubmit","pageview","ab","alias","ready"];for(var s=0;s<i.length;s++)analytics[i[s]]=r(i[s])};
  	
  	analytics.load("hg9h6b9pae");

  	$(function() {
			app.bookapp = new BookApp();
		});
	
	</script>
</head>
<body>
	<div id="menu">
	
		<ul id="menu-left">
			<li id="home-link"><a href="/"><i class="icon-house"></i></a></li>
			<li><a href="/books/1234000001805">Learning Java</a></li>
			<div class="clear"></div>
		</ul>
	
		<ul id="menu-right">
			<li id="comments-link"><a>&nbsp;</a></li>
			<li>
				<a href="#" class="dropdown-toggle" data-toggle="dropdown">Chapters</a>
				<div id="toc-popup" class="dropdown-menu"></div>
			</li>
				<li><a href="#" class="capture_modal_open" id="capture_signin_link">Log In / Sign Up</a></li>
			<li id="search-li">
				<form accept-charset="UTF-8" action="/searches" id="search-form" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /></div>
	<input name='search[q]' type="text" placeholder="Search book..." id="book-search" />

	<input id="search_bookId" name="search[bookId]" type="hidden" value="1234000001805" />
	
	<div style='display:none'>
		sorted by: 
		<select name='search[sort]' >
			<option value='relevance'>Relevance</option>
			<option value='authors'>Author(s)</option>
			<option value='title'>Title</option>
		</select>
		returning
		<select name='search[limit]' >
			<option value='5'>5</option>
			<option value='10'>10</option>
			<option value='20'>20</option>
			<option selected="selected" value='50'>50</option>
			<option value='100'>100</option>
		</select>
		values at a time.
	</div>
</form>
			</li>
			<div class="clear"></div>
		</ul>
		<div class="clear"></div>
	
</div>
	<header><div class="navheader">
<table style="width: 100%; ">
<tr><td style="text-align: center; " colspan="3">ChapterÂ 11.Â Core Utilities</td></tr>
<tr>
<td style="width: 20%; text-align: left; ">
<a accesskey="p" href="ch10.html">Prev</a>Â </td>
<td style="width: 60%; text-align: center; ">Â </td>
<td style="width: 20%; text-align: right; ">Â <a accesskey="n" href="ch12.html">Next</a>
</td>
</tr>
</table>
<hr>
</div></header><section class="chapter" data-original-filename="ch11.xml" id="learnjava3-CHP-11"><div class="titlepage"><div><div><h1 class="title">ChapterÂ 11.Â Core Utilities</h1></div></div></div>
<p id="in_this_chapter_id2">In this chapter, weâ€™ll continue our look at the core Java APIs,
  covering more of the tools of the <code class="literal">java.util</code> package. The <a id="id712286" class="indexterm"></a><code class="literal">java.util</code> package includes
  a wide range of utilities including tools for mathematical operations,
  fundamental data structures (collections), working with dates and times,
  storing user preference data, and logging.</p>
<div class="sect1" data-original-filename="ch11.xml" id="learnjava3-CHP-11-SECT-1">
<div class="titlepage"><div><div><h2 class="title">Math Utilities</h2></div></div></div>
<p id="java_supports_i">Java supports integer and floating-point arithmetic directly in the
    language. Higher-level math operations are supported through the
    <a id="id712318" class="indexterm"></a><code class="literal">java.lang.Math</code> class. As
    you may have seen by now, wrapper classes for primitive data types allow
    you to treat them as objects. Wrapper classes also hold some methods for
    basic conversions.</p>
<p id="first_a_few_wo">First, a few words about built-in arithmetic in Java. Java handles
    errors in integer arithmetic by throwing an <a id="id712338" class="indexterm"></a><code class="literal">ArithmeticException</code>:</p>
<pre class="programlisting" data-language="java" id="I_11_tt681">    <code class="kt">int</code> <code class="n">zero</code> <code class="o">=</code> <code class="mi">0</code><code class="o">;</code>

    <code class="k">try</code> <code class="o">{</code>
        <code class="kt">int</code> <code class="n">i</code> <code class="o">=</code> <code class="mi">72</code> <code class="o">/</code> <code class="n">zero</code><code class="o">;</code>
    <code class="o">}</code> <code class="k">catch</code> <code class="o">(</code> <code class="n">ArithmeticException</code> <code class="n">e</code> <code class="o">)</code> <code class="o">{</code>
        <code class="c1">// division by zero</code>
    <code class="o">}</code></pre>
<p id="to_generate_the_id1">To generate the error in this example, we created the intermediate
    variable <code class="literal">zero</code>. The compiler is somewhat
    crafty and would have caught us if we had blatantly tried to perform
    division by a literal zero.</p>
<p id="floatingpoint_">Floating-point arithmetic expressions, on the other hand, donâ€™t
    throw exceptions. Instead, they take on the special out-of-range values
    shown in <a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-1" title="TableÂ 11-1.Â Special floating-point values">TableÂ 11-1</a>.</p>
<div class="table" id="learnjava3-CHP-11-TABLE-1">
<div class="table-title">TableÂ 11-1.Â Special floating-point values</div>
<div class="table-contents"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<colgroup>
<col class="col1">
<col class="col2">
</colgroup>
<thead><tr>
<td style="text-align: left; "><p id="value">Value</p></td>
<td style="text-align: left; "><p id="mathematical_re">Mathematical
            representation</p></td>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left; "><p id="positive_infini"> <a id="id712568" class="indexterm"></a> <code class="literal">POSITIVE_INFINITY</code> </p></td>
<td style="text-align: left; "><p id="para_id46">1.0/0.0</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="negative_infini"> <a id="id712600" class="indexterm"></a> <code class="literal">NEGATIVE_INFINITY</code> </p></td>
<td style="text-align: left; "><p id="para_id47">-1.0/0.0</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="nan_notanumb_id1"> <a id="id712633" class="indexterm"></a> <a id="id712639" class="indexterm"></a> <code class="literal">NaN</code>
            </p></td>
<td style="text-align: left; "><p id="para_id48">0.0/0.0</p></td>
</tr>
</tbody>
</table></div>
</div>
<p id="the_following_e_id3">The following example generates an infinite result:</p>
<pre class="programlisting" data-language="java" id="I_11_tt682">    <code class="kt">double</code> <code class="n">zero</code> <code class="o">=</code> <code class="mf">0.0</code><code class="o">;</code>
    <code class="kt">double</code> <code class="n">d</code> <code class="o">=</code> <code class="mf">1.0</code><code class="o">/</code><code class="n">zero</code><code class="o">;</code>

    <code class="k">if</code> <code class="o">(</code> <code class="n">d</code> <code class="o">==</code> <code class="n">Double</code><code class="o">.</code><code class="na">POSITIVE_INFINITY</code> <code class="o">)</code>
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="s">"Division by zero"</code> <code class="o">);</code></pre>
<p id="the_special_val">The special value <code class="literal">NaN</code> (not a
    number) indicates the result of dividing zero by zero. This value has the
    special mathematical distinction of not being equal to itself (<code class="literal">NaN != NaN</code> evaluates to <code class="literal">true</code>). Use <code class="literal">Float.isNaN()</code> or <code class="literal">Double.isNaN()</code> to test for <code class="literal">NaN</code>.</p>
<div class="sect2" id="learnjava3-CHP-11-SECT-1.1">
<div class="titlepage"><div><div><h3 class="title">The java.lang.Math Class</h3></div></div></div>
<p id="core_utilitiesm_id1"><a id="idx10630" class="indexterm"></a> <a id="idx10661" class="indexterm"></a>The <code class="literal">java.lang.Math</code>
      class is Javaâ€™s math library. It holds a suite of static methods
      covering all of the usual mathematical operations like <a id="id712911" class="indexterm"></a><code class="literal">sin()</code>, <a id="id712923" class="indexterm"></a><code class="literal">cos()</code>, and <a id="id712934" class="indexterm"></a><code class="literal">sqrt()</code>. The <code class="literal">Math</code> class isnâ€™t very object-oriented (you
      canâ€™t create an instance of <code class="literal">Math</code>).
      Instead, itâ€™s really just a convenient holder for static methods that
      are more like global functions. As we saw in <a class="xref" href="ch06.html" title="ChapterÂ 6.Â Relationships Among Classes">ChapterÂ 6</a>, itâ€™s possible to use the static import
      functionality to import the names of static methods and constants like
      this directly into the scope of our class and use them by their simple,
      unqualified names.</p>
<p id="summarizes_the__id2"><a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-2" title="TableÂ 11-2.Â Methods in java.lang.Math">TableÂ 11-2</a> summarizes the
      methods in <code class="literal">java.lang.Math</code>.</p>
<div class="table" id="learnjava3-CHP-11-TABLE-2">
<div class="table-title">TableÂ 11-2.Â Methods in java.lang.Math</div>
<div class="table-contents"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<colgroup>
<col class="col1">
<col class="col2">
<col class="col3">
</colgroup>
<thead><tr>
<td style="text-align: left; "><p id="method_id5">Method</p></td>
<td style="text-align: left; "><p id="argument_types">Argument type(s)</p></td>
<td style="text-align: left; "><p id="functionality_id2">Functionality</p></td>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left; "><p id="abs_method_ma"> <a id="id713065" class="indexterm"></a> <code class="literal">Math.abs(a)</code>
              </p></td>
<td style="text-align: left; "><p id="int_long_floa_id1"> <code class="literal">int</code>, <code class="literal">long</code>, <code class="literal">float</code>, <code class="literal">double</code></p></td>
<td style="text-align: left; "><p id="absolute_value">Absolute value</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="acos_method_m"> <a id="id713128" class="indexterm"></a> <code class="literal">Math.acos(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id1"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="arc_cosine">Arc cosine</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="asin_method_m"> <a id="id713176" class="indexterm"></a> <code class="literal">Math.asin(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id2"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="arc_sine">Arc sine</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="atan_method_m"> <a id="id713223" class="indexterm"></a> <code class="literal">Math.atan(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id3"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="arc_tangent">Arc tangent</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="mathatanab"> <code class="literal">Math.atan2(a,b)</code> </p></td>
<td style="text-align: left; "><p id="double_id4"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="angle_part_of_r">Angle part of rectangular-to-polar
              coordinate transform</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="ceil_method_m"> <a id="id713312" class="indexterm"></a> <code class="literal">Math.ceil(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id5"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="smallest_whole_">Smallest whole number greater than or
              equal to <code class="literal">a</code></p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="cbrt_method_m"> <a id="id713365" class="indexterm"></a> <code class="literal">Math.cbrt(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id6"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="cube_root_of_a">Cube root of <code class="literal">a</code></p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="mathcosa"> <code class="literal">Math.cos(a)</code> </p></td>
<td style="text-align: left; "><p id="double_id7"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="cosine">Cosine</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="cosh_method_m"> <a id="id713458" class="indexterm"></a> <code class="literal">Math.cosh(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id8"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="hyperbolic_cosi">Hyperbolic cosine</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="exp_method_ma"> <a id="id713506" class="indexterm"></a> <code class="literal">Math.exp(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id9"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="mathe_to_the_p"> <code class="literal">Math.E</code> to the power <code class="literal">a</code></p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="floor_method_"> <a id="id713563" class="indexterm"></a> <code class="literal">Math.floor(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id10"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="largest_whole_n">Largest whole number less than or
              equal to <code class="literal">a</code></p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="hypot_method_"> <a id="id713616" class="indexterm"></a> <code class="literal">Math.hypot(a,b)</code> </p></td>
<td style="text-align: left; "><p id="double_id11"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="precision_calcu">Precision calculation of the <code class="literal">sqrt()</code> of <code class="literal">a</code>2 + <code class="literal">b</code>2</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="mathloga_id1"><code class="literal">Math.log(a)</code> </p></td>
<td style="text-align: left; "><p id="double_id12"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="natural_logarit">Natural logarithm of <code class="literal">a</code></p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="mathloga_id2"> <code class="literal">Math.log10(a)</code> </p></td>
<td style="text-align: left; "><p id="double_id13"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="log_base__of_">Log base 10 of <code class="literal">a</code></p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="mathmaxa_b"><code class="literal">Math.max(a,
              b)</code> </p></td>
<td style="text-align: left; "><p id="int_long_floa_id2"> <code class="literal">int</code>, <code class="literal">long</code>, <code class="literal">float</code>, <code class="literal">double</code></p></td>
<td style="text-align: left; "><p id="the_value_a_or__id1">The value <code class="literal">a</code> or <code class="literal">b</code> closer to <code class="literal">Long.MAX_VALUE</code></p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="min_method_ma"> <a id="id713842" class="indexterm"></a> <code class="literal">Math.min(a, b)</code>
              </p></td>
<td style="text-align: left; "><p id="int_long_floa_id3"> <code class="literal">int</code>, <code class="literal">long</code>, <code class="literal">float</code>, <code class="literal">double</code></p></td>
<td style="text-align: left; "><p id="the_value_a_or__id2">The value <code class="literal">a</code> or <code class="literal">b</code> closer to <code class="literal">Long.MIN_VALUE</code></p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="pow_method_ma"> <a id="id713921" class="indexterm"></a> <code class="literal">Math.pow(a, b)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id14"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="a_to_the_power_"> <code class="literal">a</code>
              to the power <code class="literal">b</code></p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="random_method"> <a id="id713979" class="indexterm"></a> <code class="literal">Math.random()</code>
              </p></td>
<td style="text-align: left; "><p id="none_id2"> <code class="literal">None</code> </p></td>
<td style="text-align: left; "><p id="randomnumber_g">Random-number generator</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="rint_method_m"> <a id="id714027" class="indexterm"></a> <code class="literal">Math.rint(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id15"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="converts_double">Converts double value to integral
              value in double format</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="round_method_"> <a id="id714075" class="indexterm"></a> <code class="literal">Math.round(a)</code>
              </p></td>
<td style="text-align: left; "><p id="float_double"> <code class="literal">float</code>, <code class="literal">double</code></p></td>
<td style="text-align: left; "><p id="rounds_to_whole">Rounds to whole number</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="signum_method"> <a id="id714128" class="indexterm"></a> <code class="literal">Math.signum(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_float"> <code class="literal">double</code>, <code class="literal">float</code></p></td>
<td style="text-align: left; "><p id="get_the_sign_of">Get the sign of the number at 1.0,
              â€“1.0, or 0</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="sin_method_ma"> <a id="id714179" class="indexterm"></a> <code class="literal">Math.sin(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id16"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="sine">Sine</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="mathsinha"> <code class="literal">Math.sinh(a)</code> </p></td>
<td style="text-align: left; "><p id="double_id17"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="hyperbolic_sine">Hyperbolic sine</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="sqrt_method_m"> <a id="id714268" class="indexterm"></a> <code class="literal">Math.sqrt(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id18"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="square_root">Square root</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="tan_method_ma"> <a id="id714315" class="indexterm"></a> <code class="literal">Math.tan(a)</code>
              </p></td>
<td style="text-align: left; "><p id="double_id19"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="tangent">Tangent</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="mathtanha"> <code class="literal">Math.tanh(a)</code> </p></td>
<td style="text-align: left; "><p id="double_id20"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="hyperbolic_tang">Hyperbolic tangent</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="todegrees_met"> <a id="id714404" class="indexterm"></a> <code class="literal">Math.toDegrees(a)</code> </p></td>
<td style="text-align: left; "><p id="double_id21"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="convert_radians">Convert radians to
              degrees</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="toradians_met"> <a id="id714452" class="indexterm"></a> <code class="literal">Math.toRadians(a)</code> </p></td>
<td style="text-align: left; "><p id="double_id22"> <code class="literal">double</code> </p></td>
<td style="text-align: left; "><p id="convert_degrees">Convert degrees to
              radians</p></td>
</tr>
</tbody>
</table></div>
</div>
<p id="log_method_lo"><a id="id714494" class="indexterm"></a> <code class="literal">log()</code>, <a id="id714506" class="indexterm"></a><code class="literal">pow()</code>, and <code class="literal">sqrt()</code> can throw a runtime <a id="id714524" class="indexterm"></a><code class="literal">ArithmeticException</code>.
      <a id="id714536" class="indexterm"></a><code class="literal">abs()</code>, <a id="id714547" class="indexterm"></a><code class="literal">max()</code>, and <code class="literal">min()</code> are overloaded for all the scalar
      values, <code class="literal">int</code>, <code class="literal">long</code>, <code class="literal">float</code>, or <code class="literal">double</code>, and return the corresponding type.
      Versions of <a id="id714588" class="indexterm"></a><code class="literal">Math.round()</code> accept
      either <code class="literal">float</code> or <code class="literal">double</code> and return <code class="literal">int</code> or <code class="literal">long</code>, respectively. The rest of the methods
      operate on and return <code class="literal">double</code>
      values:</p>
<pre class="programlisting" data-language="java" id="I_11_tt683">    <code class="kt">double</code> <code class="n">irrational</code> <code class="o">=</code> <code class="n">Math</code><code class="o">.</code><code class="na">sqrt</code><code class="o">(</code> <code class="mf">2.0</code> <code class="o">);</code> <code class="c1">// 1.414...</code>
    <code class="kt">int</code> <code class="n">bigger</code> <code class="o">=</code> <code class="n">Math</code><code class="o">.</code><code class="na">max</code><code class="o">(</code> <code class="mi">3</code><code class="o">,</code> <code class="mi">4</code> <code class="o">);</code>  <code class="c1">// 4</code>
    <code class="kt">long</code> <code class="n">one</code> <code class="o">=</code> <code class="n">Math</code><code class="o">.</code><code class="na">round</code><code class="o">(</code> <code class="mf">1.125798</code> <code class="o">);</code> <code class="c1">// 1</code></pre>
<p id="for_convenience_id3">For convenience, <code class="literal">Math</code> also
      contains the static final double values <a id="id714812" class="indexterm"></a><code class="literal">E</code> and <code class="literal">PI</code>:<a id="id714829" class="indexterm"></a><a id="id714839" class="indexterm"></a></p>
<pre class="programlisting" data-language="java" id="I_11_tt684">    <code class="kt">double</code> <code class="n">circumference</code> <code class="o">=</code> <code class="n">diameter</code>  <code class="o">*</code> <code class="n">Math</code><code class="o">.</code><code class="na">PI</code><code class="o">;</code></pre>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-1.2">
<div class="titlepage"><div><div><h3 class="title">Big/Precise Numbers</h3></div></div></div>
<p id="core_utilitiesm_id2"><a id="idx10628" class="indexterm"></a> <a id="idx10659" class="indexterm"></a>If the <code class="literal">long</code> and
      <code class="literal">double</code> types are not large or precise
      enough for you, the <code class="literal">java.math</code> package
      provides two classes, <a id="id714968" class="indexterm"></a><code class="literal">BigInteger</code> and
      <a id="id714979" class="indexterm"></a><code class="literal">BigDecimal</code>, that
      support arbitrary-precision numbers. These full-featured classes have a
      bevy of methods for performing arbitrary-precision math and precisely
      controlling rounding of remainders. In the following example, we use
      <code class="literal">BigDecimal</code> to add two very large
      numbers and then create a fraction with a 100-digit result:</p>
<pre class="programlisting" data-language="java" id="I_11_tt685">    <code class="kt">long</code> <code class="n">l1</code> <code class="o">=</code> <code class="mi">9223372036854775807L</code><code class="o">;</code> <code class="c1">// Long.MAX_VALUE</code>
    <code class="kt">long</code> <code class="n">l2</code> <code class="o">=</code> <code class="mi">9223372036854775807L</code><code class="o">;</code>
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="n">l1</code> <code class="o">+</code> <code class="n">l2</code> <code class="o">);</code> <code class="c1">// -2 ! Not good.</code>
    <code class="err">Â </code>
    <code class="k">try</code> <code class="o">{</code>
        <code class="n">BigDecimal</code> <code class="n">bd1</code> <code class="o">=</code> <code class="k">new</code> <code class="n">BigDecimal</code><code class="o">(</code> <code class="s">"9223372036854775807"</code> <code class="o">);</code>
        <code class="n">BigDecimal</code> <code class="n">bd2</code> <code class="o">=</code> <code class="k">new</code> <code class="n">BigDecimal</code><code class="o">(</code> <code class="mi">9223372036854775807L</code> <code class="o">);</code>
        <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="n">bd1</code><code class="o">.</code><code class="na">add</code><code class="o">(</code> <code class="n">bd2</code> <code class="o">)</code> <code class="o">);</code> <code class="c1">// 18446744073709551614</code>
    <code class="err">Â </code>
        <code class="n">BigDecimal</code> <code class="n">numerator</code> <code class="o">=</code> <code class="k">new</code> <code class="n">BigDecimal</code><code class="o">(</code><code class="mi">1</code><code class="o">);</code>
        <code class="n">BigDecimal</code> <code class="n">denominator</code> <code class="o">=</code> <code class="k">new</code> <code class="n">BigDecimal</code><code class="o">(</code><code class="mi">3</code><code class="o">);</code>
        <code class="n">BigDecimal</code> <code class="n">fraction</code> <code class="o">=</code>
            <code class="n">numerator</code><code class="o">.</code><code class="na">divide</code><code class="o">(</code> <code class="n">denominator</code><code class="o">,</code> <code class="mi">100</code><code class="o">,</code> <code class="n">BigDecimal</code><code class="o">.</code><code class="na">ROUND_UP</code> <code class="o">);</code>
        <code class="c1">// 100 digit fraction = 0.333333 ... 3334</code>
    <code class="o">}</code>
    <code class="k">catch</code> <code class="o">(</code><code class="n">NumberFormatException</code> <code class="n">nfe</code><code class="o">)</code> <code class="o">{</code> <code class="o">}</code>
    <code class="k">catch</code> <code class="o">(</code><code class="n">ArithmeticException</code> <code class="n">ae</code><code class="o">)</code> <code class="o">{</code> <code class="o">}</code></pre>
<p id="if_you_implemen">If you implement cryptographic or scientific algorithms for fun,
      <code class="literal">BigInteger</code> is crucial. Other than
      that, youâ€™re not likely to need these classes.<a id="id715534" class="indexterm"></a><a id="id715544" class="indexterm"></a></p>
</div>
<div class="sect2" id="floatingpoint_components">
<div class="titlepage"><div><div><h3 class="title">Floating-Point Components</h3></div></div></div>
<p id="core_utilitiesm_id3"><a id="idx10629" class="indexterm"></a> <a id="idx10660" class="indexterm"></a>As we mentioned in <a class="xref" href="ch04.html" title="ChapterÂ 4.Â The Java Language">ChapterÂ 4</a>, Java uses the IEEE 754 standard to
      represent floating-point numbers (float and double types) internally.
      Those of you familiar with how floating-point math works will already
      know that â€œdecimalâ€? numbers are represented in binary in this standard
      by separating the number into three components: a sign (positive or
      negative), an exponent representing the <a id="id715615" class="indexterm"></a><span class="emphasis"><em>magnitude</em></span> in powers of 2 of the
      number, and a <a id="id715625" class="indexterm"></a><span class="emphasis"><em>mantissa</em></span> using up most of the bits to
      represent the precise value irrespective of its magnitude. While for
      most applications the precision of float and double-type floating-point
      numbers is sufficient enough that we donâ€™t need to worry about running
      into limitations, there are times when specialized apps may wish to work
      with the floating-point values more directly.</p>
<p id="by_definition_">By definition, floating-point numbers trade off precision and
      scale. Even the smallest Java floating-point type, <a id="id715648" class="indexterm"></a><code class="literal">float</code>, can represent
      (literally) astronomical numbers ranging from negative
      10<sup>â€“45</sup> to positive
      10<sup>38</sup>. This is accomplished, put in decimal
      terms, by having the mantissa part of the floating-point value represent
      a fixed number of â€œdigitsâ€? and the exponent tell us where to put the
      decimal point. As the numbers get larger in magnitude, the â€œprecisionâ€?
      therefore gets shifted to the â€œleftâ€? as more digits appear to the left
      of the decimal point. What this means is that floating-point numbers can
      very precisly (with a large number of digits) represent small values
      like pi, but for bigger numbers (in the billions and trillions)
      those digits will be taken up with the more signifcant digits.
      Therefore, the gap between any two consecutive numbers that can be
      represented by a floating-point value grows larger as the numbers get
      bigger.</p>
<p id="for_some_applic">For some applications, knowing the limitations may be important.
      The <code class="literal">java.lang.Math</code> class therefore
      provides a few methods for interrogating floats and doubles about their
      precision. The <a id="id715699" class="indexterm"></a><code class="literal">Math.ulp()</code> method
      retrieves the â€œunit of least precisionâ€? for a given floating-point
      number, which is the smallest value that bits in the mantissa represent
      at their current exponent. Another way to say this is that the <code class="literal">ulp()</code> is the approximate distance from the
      floating-point number to the next closest higher or lower floating-point
      number that can be represented. Adding positive values smaller than half
      the ULP to a float will not yield a new number. Adding values between
      half and the full ULP will result in the value plus the ULP. The
      <a id="id715723" class="indexterm"></a><code class="literal">Math.nextUp()</code> method is
      a convenience that will take a float and tell you the next number that
      can be represented by adding the ULP.</p>
<pre class="programlisting" data-language="java" id="float_trillioni">        <code class="kt">float</code> <code class="n">trillionish</code> <code class="o">=</code> <code class="o">(</code><code class="kt">float</code><code class="o">)</code><code class="mi">1</code><code class="n">e12</code><code class="o">;</code> <code class="c1">// trillionish ~= 999,999,995,904</code>
        <code class="kt">float</code> <code class="n">ulp</code> <code class="o">=</code> <code class="n">Math</code><code class="o">.</code><code class="na">ulp</code><code class="o">(</code> <code class="n">f</code> <code class="o">);</code> <code class="c1">// ulp = 65536</code>
        <code class="kt">float</code> <code class="n">next</code> <code class="o">=</code> <code class="n">Math</code><code class="o">.</code><code class="na">nextUp</code><code class="o">(</code> <code class="n">f</code> <code class="o">);</code> <code class="c1">// next ~= 1000000061440</code>
        <code class="n">trillionish</code> <code class="o">+=</code> <code class="mi">32767</code><code class="o">;</code> <code class="c1">// trillionish still ~= 999,999,995,904. No change!</code></pre>
<p id="additionally_t_id1">Additionally, the <code class="literal">java.lang.Math</code> class contains the method
      <a id="id715933" class="indexterm"></a><code class="literal">getExponent()</code>, which
      retrieves the exponent part of a floating-point number (and from there
      one could determine the mantissa by division). It is also possible to
      get the raw bits of a float or double using their corresponding wrapper
      class methods <a id="id715946" class="indexterm"></a><code class="literal">floatToIntBits()</code> and
      <a id="id715958" class="indexterm"></a><code class="literal">doubleTo</code><code class="literal">RawLongBits()</code> and pick out the (IEEE
      standard) bits yourself.<a id="id715979" class="indexterm"></a><a id="id715989" class="indexterm"></a></p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-1.3">
<div class="titlepage"><div><div><h3 class="title">Random Numbers</h3></div></div></div>
<p id="core_utilitiesm_id4"><a id="idx10631" class="indexterm"></a> <a id="idx10662" class="indexterm"></a> <a id="id716045" class="indexterm"></a>You can use the <a id="id716052" class="indexterm"></a><code class="literal">java.util.Random</code> class
      to generate random values. Itâ€™s a pseudorandom-number generator that is
      initialized with a 48-bit seed.<a href="#ftn.learnjava3-CHP-11-FN-1" class="footnote"><sup class="footnote" id="learnjava3-CHP-11-FN-1">[31]</sup></a> Because itâ€™s a pseudorandom algorithm, youâ€™ll get the same
      series of values every time you use the same seed value. The default
      constructor uses the current time to produce a seed, but you can specify
      your own value in the constructor:</p>
<pre class="programlisting" data-language="java" id="I_11_tt686">    <code class="kt">long</code> <code class="n">seed</code> <code class="o">=</code> <code class="n">mySeed</code><code class="o">;</code>
    <code class="n">Random</code> <code class="n">rnums</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Random</code><code class="o">(</code> <code class="n">seed</code> <code class="o">);</code></pre>
<p id="after_you_have__id1">After you have a generator, you can ask for one or more random
      values of various types using the methods listed in <a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-3" title="TableÂ 11-3.Â Random-number methods">TableÂ 11-3</a>.</p>
<div class="table" id="learnjava3-CHP-11-TABLE-3">
<div class="table-title">TableÂ 11-3.Â Random-number methods</div>
<div class="table-contents"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<colgroup>
<col class="col1">
<col class="col2">
</colgroup>
<thead><tr>
<td style="text-align: left; "><p id="method_id6">Method</p></td>
<td style="text-align: left; "><p id="range">Range</p></td>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left; "><p id="nextboolean_m"> <a id="id716250" class="indexterm"></a> <code class="literal">nextBoolean()</code>
              </p></td>
<td style="text-align: left; "><p id="true_or_false_id2"> <code class="literal">true</code> or <code class="literal">false</code></p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="nextint_metho"> <a id="id716293" class="indexterm"></a> <code class="literal">nextInt()</code>
              </p></td>
<td style="text-align: left; "><p id="to_">â€“2147483648 to
              2147483647</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="nextintint_n_"> <code class="literal">nextInt(int</code>
              <em class="replaceable"><code>n</code></em> <code class="literal">)</code> </p></td>
<td style="text-align: left; "><p id="to_n___in">0 to (n â€“ 1) inclusive</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="nextlong_meth"> <a id="id716361" class="indexterm"></a> <code class="literal">nextLong()</code>
              </p></td>
<td style="text-align: left; "><p id="para_id49">â€“9223372036854775808 to
              9223372036854775807</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="nextfloat_met"> <a id="id716394" class="indexterm"></a> <code class="literal">nextFloat()</code>
              </p></td>
<td style="text-align: left; "><p id="inclusive_t_id1">0.0 inclusive to 1.0
              exclusive</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="nextdouble_me"> <a id="id716427" class="indexterm"></a> <code class="literal">nextDouble()</code>
              </p></td>
<td style="text-align: left; "><p id="inclusive_t_id2">0.0 inclusive to 1.0
              exclusive</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="nextgaussian_"> <a id="id716460" class="indexterm"></a> <code class="literal">nextGaussian()</code>
              </p></td>
<td style="text-align: left; "><p id="gaussian_distri">Gaussian distributed double with mean
              0.0 and standard deviation of 1.0</p></td>
</tr>
</tbody>
</table></div>
</div>
<p id="by_default_the_id1">By default, the values are uniformly distributed. You can use the
      <code class="literal">nextGaussian()</code> method to create a
      Gaussian (bell curve) distribution of <code class="literal">double</code> values, with a mean of 0.0 and a
      standard deviation of 1.0. (Lots of natural phenomena follow a Gaussian
      distribution rather than a strictly uniform random one.)</p>
<p id="the_static_meth_id2">The <code class="literal">static</code> method <code class="literal">Math.random()</code> retrieves a random <code class="literal">double</code> value. This method initializes a
      <code class="literal">private</code> random-number generator in
      the <code class="literal">Math</code> class the first time itâ€™s
      used, using the default <code class="literal">Random</code>
      constructor. Thus, every call to <code class="literal">Math.random()</code> corresponds to a call to
      <code class="literal">nextDouble()</code> on that random-number
      generator.<a id="id716559" class="indexterm"></a><a id="id716569" class="indexterm"></a></p>
</div>
</div>
<div class="sect1" data-original-filename="ch11.xml" id="learnjava3-CHP-11-SECT-2">
<div class="titlepage"><div><div><h2 class="title">Dates and Times</h2></div></div></div>
<p id="working_with_da">Working with dates and times without the proper tools can be a
    chore. Fortunately, Java has three classes that handle most of the work
    for you. The <a id="id716596" class="indexterm"></a><code class="literal">java.util.Date</code> class
    encapsulates a point in time. The <a id="id716608" class="indexterm"></a><code class="literal">java.util.GregorianCalendar</code> class, which extends
    the abstract <a id="id716620" class="indexterm"></a><code class="literal">java.util.Calendar</code>,
    translates between a point in time and calendar fields like month, day,
    and year. Finally, the <code class="literal">java.text.DateFormat</code> class knows how to generate
    and parse string representations of dates and times in many
    languages.<a href="#ftn.learnjava3-CHP-11-FN-2" class="footnote"><sup class="footnote" id="learnjava3-CHP-11-FN-2">[32]</sup></a></p>
<p id="the_separation_">The separation of the <code class="literal">Date</code> and
    <code class="literal">Calendar</code> classes is analogous to having
    a class representing temperature and a class that translates that
    temperature to Celsius units. A <code class="literal">Date</code>
    represents an absolute point in time as defined by a number of
    milliseconds from the reference point: midnight, Jan 1, 1970, GMT. This is
    the same frame of reference used by the <a id="id716687" class="indexterm"></a><code class="literal">System.currentTimeMillis()</code> call. A <code class="literal">Calendar</code> encapsulates a point in time and maps
    it to higher-level (and messier) notions like years, months, weeks, and
    days, and deals with discontinuities like leap years. Conceivably, we
    could define subclasses of <code class="literal">Calendar</code>
    other than the default <code class="literal">GregorianCalendar</code>, say <code class="literal">JulianCalendar</code> or <code class="literal">LunarCalendar</code>, that map time using other
    sociological or cultural conventions.<a href="#ftn.learnjava3-CHP-11-FN-3" class="footnote"><sup class="footnote" id="learnjava3-CHP-11-FN-3">[33]</sup></a></p>
<div class="sect2" id="learnjava3-CHP-11-SECT-2.1">
<div class="titlepage"><div><div><h3 class="title">Working with Calendars</h3></div></div></div>
<p id="calendars_core_"><a id="idx10596" class="indexterm"></a> <a id="idx10619" class="indexterm"></a> <a id="idx10638" class="indexterm"></a>The default <code class="literal">GregorianCalendar</code> constructor creates a
      calendar initialized to the current time, in the current time
      zone:</p>
<pre class="programlisting" data-language="java" id="I_11_tt687">    <code class="n">GregorianCalendar</code> <code class="n">now</code> <code class="o">=</code> <code class="k">new</code> <code class="n">GregorianCalendar</code><code class="o">();</code></pre>
<p id="however_more_g">However, more generally we can just ask the <code class="literal">Calendar</code> class for an appropriate calendar
      instance without worrying about what type of calendar system the world
      is using this century:</p>
<pre class="programlisting" data-language="java" id="I_11_tt688">    <code class="n">Calendar</code> <code class="n">now</code> <code class="o">=</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">getInstance</code><code class="o">();</code></pre>
<p id="in_either_case_id2">In either case, all the real work is done through the main
      <a id="id716928" class="indexterm"></a><code class="literal">set()</code> and <a id="id716939" class="indexterm"></a><code class="literal">get()</code> methods of
      <code class="literal">Calendar</code>. These methods use static
      identifiers to refer to calendar fields and values. For example:</p>
<pre class="programlisting" data-language="java" id="I_11_tt689">    <code class="n">Calendar</code> <code class="n">birthday</code> <code class="o">=</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">getInstance</code><code class="o">();</code>
    <code class="n">birthday</code><code class="o">.</code><code class="na">set</code><code class="o">(</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">YEAR</code><code class="o">,</code> <code class="mi">1972</code> <code class="o">);</code>
    <code class="n">birthday</code><code class="o">.</code><code class="na">set</code><code class="o">(</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">MONTH</code><code class="o">,</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">MAY</code> <code class="o">);</code>
    <code class="n">birthday</code><code class="o">.</code><code class="na">set</code><code class="o">(</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">DATE</code><code class="o">,</code> <code class="mi">20</code> <code class="o">);</code></pre>
<p id="here_we_set_th">Here, we set the year, month, and day values on the calendar,
      altering the internal <code class="literal">Date</code> of the
      <code class="literal">Calendar</code> object. Any remaining fields
      that we did not set are left as they were initialized (to the current
      date and time when it was constructed). In this case, we did not really
      specify a full date and time; we simply overrode individual fields in
      the <span class="keep-together">calendar</span>.</p>
<p id="the_calendar_cl">The <code class="literal">Calendar</code> class contains
      identifiers for all of the standard date and time fields, as well as
      values such as days of the week and months of the year. The following
      are the most common identifiers:</p>
<div class="itemizedlist" id="month_identifie_id1"><ul class="itemizedlist">
<li class="listitem"><p id="month_identifie_id2"><a id="id717204" class="indexterm"></a> <a id="id717210" class="indexterm"></a> <code class="literal">YEAR</code>, <code class="literal">MONTH</code></p></li>
<li class="listitem"><p id="week_of_month_i"><a id="id717234" class="indexterm"></a> <a id="id717240" class="indexterm"></a> <code class="literal">WEEK_OF_YEAR</code>,
          <code class="literal">WEEK_OF_MONTH</code></p></li>
<li class="listitem"><p id="date_identifier"><a id="id717264" class="indexterm"></a> <code class="literal">DATE</code>, <a id="id717277" class="indexterm"></a><code class="literal">DAY_OF_YEAR</code>,
          <a id="id717288" class="indexterm"></a><a id="id717294" class="indexterm"></a><code class="literal">DAY_OF_MONTH</code>,
          <code class="literal">DAY_OF_WEEK</code></p></li>
<li class="listitem"><p id="hour_identifier"><a id="id717317" class="indexterm"></a> <code class="literal">HOUR</code>, <a id="id717329" class="indexterm"></a><a id="id717335" class="indexterm"></a><code class="literal">HOUR_OF_DAY</code>,
          <code class="literal">AM_PM</code></p></li>
<li class="listitem"><p id="minute_value_mi"><a id="id717358" class="indexterm"></a> <code class="literal">MINUTE</code>, <a id="id717370" class="indexterm"></a><a id="id717376" class="indexterm"></a><code class="literal">SECOND</code>, <code class="literal">MILLISECOND</code></p></li>
<li class="listitem"><p id="dst_offset_iden"><a id="id717398" class="indexterm"></a> <a id="id717405" class="indexterm"></a> <code class="literal">ZONE_OFFSET</code>,
          <code class="literal">DST_OFFSET</code></p></li>
</ul></div>
<p id="date_and_day_of"><code class="literal">DATE</code> and <code class="literal">DAY_OF_MONTH</code> are synonymous. <code class="literal">HOUR</code> is a 12-hour clock that can be combined
      with <code class="literal">AM_PM</code>. The values are just what
      you would expect, as shown in the following:</p>
<div class="itemizedlist" id="sunday_monday_id1"><ul class="itemizedlist">
<li class="listitem"><p id="sunday_monday_id2"><code class="literal">SUNDAY</code>, <code class="literal">MONDAY</code>, <code class="literal">TUESDAY</code>...</p></li>
<li class="listitem"><p id="january_februa_id1"><code class="literal">JANUARY</code>, <code class="literal">FEBRUARY</code>, <code class="literal">MARCH</code>...</p></li>
<li class="listitem"><p id="am_pm_id1"><code class="literal">AM</code>, <code class="literal">PM</code></p></li>
</ul></div>
<p id="in_addition_to__id7">In addition to the <code class="literal">set()</code> method
      for changing field values, the <code class="literal">Calendar</code> class has two additional methods for
      performing date math, <a id="id717538" class="indexterm"></a><code class="literal">add()</code> and <a id="id717552" class="indexterm"></a><code class="literal">roll()</code>. Using <code class="literal">add()</code>, you can move a calendar forward or
      backward in any unit of time easily, without having to calculate the
      other fields. For example, we can move our calendar forward four
      weeks:</p>
<pre class="programlisting" data-language="java" id="I_11_tt690">    <code class="n">Calendar</code> <code class="n">cal</code> <code class="o">=</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">getInstance</code><code class="o">();</code>
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="n">cal</code><code class="o">.</code><code class="na">getTime</code><code class="o">()</code> <code class="o">);</code>
    <code class="c1">// Thu Nov 04 16:39:06 CST 2004</code>
    <code class="err">Â </code>
    <code class="n">cal</code><code class="o">.</code><code class="na">add</code><code class="o">(</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">WEEK_OF_YEAR</code><code class="o">,</code> <code class="mi">4</code> <code class="o">);</code>
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="n">cal</code><code class="o">.</code><code class="na">getTime</code><code class="o">()</code> <code class="o">);</code>
    <code class="c1">// Thu Dec 02 16:39:06 CST 2004</code></pre>
<p id="the_roll_meth">The <code class="literal">roll()</code> method, by contrast,
      does not alter the other fields of the calendar, but arbitrarily adjusts
      individual fields. See the <code class="literal">Spinner</code>
      example in <a class="xref" href="ch17.html" title="ChapterÂ 17.Â Using Swing Components">ChapterÂ 17</a> for additional
      information about adding and subtracting time periods using the <code class="literal">add()</code> method.</p>
<p id="finally_you_ca_id2">Finally, you can always get the internal <code class="literal">Date</code> of the <code class="literal">Calendar</code> object or reinitialize the calendar
      to a specific <code class="literal">Date</code> using the
      <a id="id717834" class="indexterm"></a><code class="literal">getTime()</code> and
      <a id="id717846" class="indexterm"></a><code class="literal">setTime()</code>
      method:<a id="id717857" class="indexterm"></a><a id="id717867" class="indexterm"></a><a id="id717877" class="indexterm"></a></p>
<pre class="programlisting" data-language="java" id="I_11_tt691">    <code class="c1">// Get the absolute time the Calendar references</code>
    <code class="n">Date</code> <code class="n">date</code> <code class="o">=</code> <code class="n">calendar</code><code class="o">.</code><code class="na">getTime</code><code class="o">();</code>
    <code class="err">Â </code>
    <code class="c1">// Reinitialize this calendar to the current date and time</code>
    <code class="n">Date</code> <code class="n">now</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Date</code><code class="o">();</code>
    <code class="n">calendar</code><code class="o">.</code><code class="na">setTime</code><code class="o">(</code> <code class="n">now</code> <code class="o">);</code></pre>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-2.2">
<div class="titlepage"><div><div><h3 class="title">Time Zones</h3></div></div></div>
<p id="core_utilitiesd_id1"><a id="idx10622" class="indexterm"></a> <a id="idx10641" class="indexterm"></a> <a id="idx10673" class="indexterm"></a>An instance of the <a id="id718066" class="indexterm"></a><code class="literal">TimeZone</code> class
      represents a time zone and the knowledge of daylight savings time at
      that location. You can construct a time zone from a string specifier in
      a number of ways. The most general approach is to use an offset from
      GMT, but many human-readable formats are included. (For a list, use
      <a id="id718080" class="indexterm"></a><code class="literal">TimeZone.getAvailableIDs()</code>.)</p>
<pre class="programlisting" data-language="java" id="I_11_tt692">    <code class="n">TimeZone</code><code class="o">.</code><code class="na">getTimeZone</code><code class="o">(</code><code class="s">"US/Central"</code><code class="o">);</code>       <code class="c1">// CST</code>
    <code class="n">TimeZone</code><code class="o">.</code><code class="na">getTimeZone</code><code class="o">(</code><code class="s">"GMT-06"</code><code class="o">);</code>           <code class="c1">// CST</code>
    <code class="n">TimeZone</code><code class="o">.</code><code class="na">getTimeZone</code><code class="o">(</code><code class="s">"America/Chicago"</code><code class="o">);</code>  <code class="c1">// CST</code></pre>
<p id="a_calendar_inhe">A <code class="literal">Calendar</code> inherits the default
      time zone from the platform on which it was created. You can set a
      different time zone with the <a id="id718210" class="indexterm"></a><code class="literal">setTimeZone()</code>
      method:</p>
<pre class="programlisting" data-language="java" id="I_11_tt693">    <code class="n">GregorianCalendar</code> <code class="n">smokey</code> <code class="o">=</code> <code class="k">new</code>
    <code class="n">GregorianCalendar</code><code class="o">();</code>
    <code class="n">smokey</code><code class="o">.</code><code class="na">setTimeZone</code><code class="o">(</code> <code class="n">TimeZone</code><code class="o">.</code><code class="na">getTimeZone</code><code class="o">(</code><code class="s">"US/Mountain"</code><code class="o">)</code> <code class="o">);</code></pre>
<p id="its_important__id2">Itâ€™s important to think about dates and time zones in the right
      way. Remember that a <a id="id718321" class="indexterm"></a><code class="literal">Date</code> is an absolute
      point in time, while a <a id="id718332" class="indexterm"></a><code class="literal">Calendar</code> translates
      that <code class="literal">Date</code> into localized fields that
      may depend on where you are. In a sense, it is meaningless to talk about
      the date â€œNov 1, 2004,â€? without specifying a time zone because at any
      given moment on earth, â€œnowâ€? could be one of two different calendar
      days. Even specifying a date and time such as â€œNov 1, 2004, 9:01 pmâ€? is
      ambiguous, because that particular combination of calendar and time
      fields occurs at 24 separate times over the span of a day as the world
      turns (see <a class="xref" href="ch11.html#learnjava3-CHP-11-FIG-1" title="FigureÂ 11-1.Â Calendars translate an absolute point in time to a localized data and time">FigureÂ 11-1</a>). Only a complete
      date, time, and time zone specifies an absolute point in time, such as
      â€œNov 1, 2004, 9:01 pm EST.â€? So itâ€™s important to remember that the
      <code class="literal">Calendar</code> class defaults all of these
      fields for you even if you havenâ€™t set them.</p>
<div class="figure" id="learnjava3-CHP-11-FIG-1">
<div class="figure-contents"><div class="mediaobject" id="I_11_tt694"><img src="http://orm-chimera-prod.s3.amazonaws.com/1234000001805/figs/lj4e_1101.png" alt="Calendars translate an absolute point in time to a localized data and time"></div></div>
<div class="figure-title">FigureÂ 11-1.Â Calendars translate an absolute point in time to a localized
        data and time</div>
</div>
<p id="the_following_e_id4">The following example prints the day of the week for the same
      <code class="literal">Date</code> object in two different time
      zones:</p>
<pre class="programlisting" data-language="java" id="I_11_tt695">    <code class="n">Date</code> <code class="n">date</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Date</code><code class="o">();</code> <code class="c1">// point in time</code>
    <code class="err">Â </code>
    <code class="n">TimeZone</code> <code class="n">CST</code> <code class="o">=</code> <code class="n">TimeZone</code><code class="o">.</code><code class="na">getTimeZone</code><code class="o">(</code> <code class="s">"America/Chicago"</code> <code class="o">);</code>
    <code class="n">Calendar</code> <code class="n">usa</code> <code class="o">=</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">getInstance</code><code class="o">(</code> <code class="n">CST</code> <code class="o">);</code>
    <code class="n">usa</code><code class="o">.</code><code class="na">setTime</code><code class="o">(</code> <code class="n">date</code> <code class="o">);</code>
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="n">usa</code><code class="o">.</code><code class="na">get</code><code class="o">(</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">DAY_OF_WEEK</code> <code class="o">)</code> <code class="o">);</code>  <code class="c1">// 1</code>
    <code class="err">Â </code>
    <code class="n">TimeZone</code> <code class="n">GMT8</code> <code class="o">=</code> <code class="n">TimeZone</code><code class="o">.</code><code class="na">getTimeZone</code><code class="o">(</code> <code class="s">"GMT+08"</code><code class="o">);</code> <code class="c1">// Beijing</code>
    <code class="n">Calendar</code> <code class="n">china</code> <code class="o">=</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">getInstance</code><code class="o">(</code> <code class="n">GMT8</code> <code class="o">);</code>
    <code class="n">china</code><code class="o">.</code><code class="na">setTime</code><code class="o">(</code> <code class="n">date</code> <code class="o">);</code>
    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="n">china</code><code class="o">.</code><code class="na">get</code><code class="o">(</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">DAY_OF_WEEK</code> <code class="o">)</code> <code class="o">);</code> <code class="c1">// 2</code></pre>
<p id="in_this_example_id23">In this example, we could also have simply changed the time zone
      on the calendar <code class="literal">usa</code> using the
      <code class="literal">setTimeZone()</code> method. Unlike the
      field <code class="literal">set()</code> methods, setting the time
      zone does not change the underlying <code class="literal">Date</code> value of the calendar, only the
      interpretation of the fields.</p>
<p id="the_meaning_of_">The meaning of the <a id="id718893" class="indexterm"></a><code class="literal">Date</code> object and its
      relationship to <a id="id718905" class="indexterm"></a><code class="literal">Calendar</code> become
      particularly important when dealing with APIs for things such as
      databases that construct dates from incomplete date and time fields. If,
      as is entirely possible, you end up sending your <code class="literal">Date</code> object from a client application in one
      part of the world to a server in another, you may be surprised that the
      calendar fields have changed. In these situations, itâ€™s important to
      work with <code class="literal">Calendar</code>s to translate the
      date fields and avoid the temptation to â€œfixâ€? the problem by adding or
      subtracting real time from the date.</p>
<div class="sect3" id="learnjava3-CHP-11-SECT-2.2.1">
<div class="titlepage"><div><div><h4 class="title">Locale</h4></div></div></div>
<p id="localeit_should"><a id="id718949" class="indexterm"></a>It should be clear now that <code class="literal">Calendar</code> is not just a fancy <code class="literal">Date</code>, but rather is something in between a
        time-keeping device and a time-formatting device. This point is
        brought home by the fact that the <code class="literal">Calendar</code> class is also locale-sensitive. In
        addition to the notion of a time zone, a <code class="literal">Calendar</code> has a <code class="literal">Locale</code> that governs conventions such as on
        which day the week begins and ends. You can specify an alternate
        locale with the <code class="literal">setLocale()</code> method.
        Most locale-specific details, however, are handled by the <code class="literal">DateFormat</code> class, which weâ€™ll discuss
        next.<a id="id719002" class="indexterm"></a><a id="id719012" class="indexterm"></a><a id="id719021" class="indexterm"></a></p>
</div>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-2.3">
<div class="titlepage"><div><div><h3 class="title">Parsing and Formatting with DateFormat</h3></div></div></div>
<p id="core_utilitiesd_id2"><a id="idx10620" class="indexterm"></a> <a id="idx10637" class="indexterm"></a> <a id="idx10639" class="indexterm"></a> <a id="idx10664" class="indexterm"></a>As its name suggests, the <code class="literal">DateFormat</code> class formats <code class="literal">Date</code> objects and not <code class="literal">Calendars</code>, so the first step in formatting
      dates and times from a <code class="literal">Calendar</code> is to
      get back to a <code class="literal">Date</code> with the <code class="literal">getTime()</code> method:</p>
<pre class="programlisting" data-language="java" id="I_11_tt696">    <code class="n">Date</code> <code class="n">birthDate</code> <code class="o">=</code> <code class="n">calendar</code><code class="o">.</code><code class="na">getTime</code><code class="o">();</code></pre>
<p id="to_create_strin">To create string representations of dates and times, create a
      <code class="literal">DateFormat</code> object and apply its
      <a id="id719202" class="indexterm"></a><code class="literal">format()</code> method to a
      <code class="literal">Date</code> object. Like the <code class="literal">NumberFormat</code> object we looked at in the
      previous chapter, <code class="literal">DateFormat</code> itself
      is abstract, but it has several static (â€œfactoryâ€?) methods that return
      useful <code class="literal">DateFormat</code> subclass instances.
      To get a default <code class="literal">DateFormat</code>, simply
      call <code class="literal">getInstance()</code>:</p>
<pre class="programlisting" data-language="java" id="I_11_tt697">    <code class="n">DateFormat</code> <code class="n">simple</code> <code class="o">=</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">getInstance</code><code class="o">();</code>
    <code class="n">String</code> <code class="n">now</code> <code class="o">=</code> <code class="n">simple</code><code class="o">.</code><code class="na">format</code><code class="o">(</code> <code class="k">new</code> <code class="n">Date</code><code class="o">()</code> <code class="o">);</code>         <code class="c1">// 4/12/06 6:06 AM</code></pre>
<p id="you_can_generat">You can generate a date string or a time string, or both, using
      the <a id="id719362" class="indexterm"></a><code class="literal">getDateInstance()</code>,
      <a id="id719374" class="indexterm"></a><code class="literal">getTimeInstance()</code>, and
      <a id="id719386" class="indexterm"></a><code class="literal">getDateTimeInstance()</code>
      factory methods. The argument to these methods describes what level of
      detail youâ€™d like to see. <code class="literal">DateFormat</code>
      defines four constants representing detail levels: they are <a id="id719406" class="indexterm"></a><code class="literal">SHORT</code>, <a id="id719417" class="indexterm"></a><code class="literal">MEDIUM</code>, <a id="id719429" class="indexterm"></a><code class="literal">LONG</code>, and <a id="id719441" class="indexterm"></a><code class="literal">FULL</code>. There is also a
      <a id="id719452" class="indexterm"></a><code class="literal">DEFAULT</code>, which is the
      same as <code class="literal">MEDIUM</code>. The following code
      creates three <code class="literal">DateFormat</code> instances:
      one to format a date, one to format a time, and one to format a date and
      time together. <a id="id719477" class="indexterm"></a><code class="literal">getDateTimeInstance()</code>
      requires two arguments: the first specifies how to format the date, the
      second how to format the time:</p>
<pre class="programlisting" data-language="java" id="I_11_tt698">    <code class="c1">// 12-Apr-06</code>
    <code class="n">DateFormat</code> <code class="n">df</code>  <code class="o">=</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">getDateInstance</code><code class="o">(</code><code class="n">DateFormat</code><code class="o">.</code><code class="na">DEFAULT</code><code class="o">);</code>

    <code class="c1">// 9:18:27 AM</code>
    <code class="n">DateFormat</code> <code class="n">tf</code>  <code class="o">=</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">getTimeInstance</code><code class="o">(</code><code class="n">DateFormat</code><code class="o">.</code><code class="na">DEFAULT</code><code class="o">);</code>

    <code class="c1">// Wednesday, April 12, 2006 9:18:27 o'clock AM EDT</code>
    <code class="n">DateFormat</code> <code class="n">dtf</code> <code class="o">=</code>
      <code class="n">DateFormat</code><code class="o">.</code><code class="na">getDateTimeInstance</code><code class="o">(</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">FULL</code><code class="o">,</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">FULL</code> <code class="o">);</code></pre>
<p id="were_showing_o">Weâ€™re showing only how to create the <code class="literal">DateFormat</code> objects here. In order to actually
      generate a <code class="literal">String</code> from a date, youâ€™ll
      need to call the <code class="literal">format()</code> method of
      these objects, passing a <code class="literal">Date</code> as an
      argument.</p>
<p id="formatting_date">Formatting dates and times for other countries is just as easy.
      Overloaded factory methods accept a <code class="literal">Locale</code> argument:</p>
<pre class="programlisting" data-language="java" id="I_11_tt699">    <code class="c1">// 12 avr. 06</code>
    <code class="n">DateFormat</code> <code class="n">df</code> <code class="o">=</code>
      <code class="n">DateFormat</code><code class="o">.</code><code class="na">getDateInstance</code><code class="o">(</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">DEFAULT</code><code class="o">,</code> <code class="n">Locale</code><code class="o">.</code><code class="na">FRANCE</code> <code class="o">);</code>

    <code class="c1">// 9:27:49</code>
    <code class="n">DateFormat</code> <code class="n">tf</code> <code class="o">=</code>
      <code class="n">DateFormat</code><code class="o">.</code><code class="na">getTimeInstance</code><code class="o">(</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">DEFAULT</code><code class="o">,</code> <code class="n">Locale</code><code class="o">.</code><code class="na">GERMANY</code> <code class="o">);</code>

    <code class="c1">// mercoledi 12 aprile 2006 9.27.49 GMT-04:00</code>
    <code class="n">DateFormat</code> <code class="n">dtf</code> <code class="o">=</code>
        <code class="n">DateFormat</code><code class="o">.</code><code class="na">getDateTimeInstance</code><code class="o">(</code>
            <code class="n">DateFormat</code><code class="o">.</code><code class="na">FULL</code><code class="o">,</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">FULL</code><code class="o">,</code> <code class="n">Locale</code><code class="o">.</code><code class="na">ITALY</code> <code class="o">);</code></pre>
<p id="to_parse_a_stri">To parse a string representing a date, we use the <code class="literal">parse()</code> method of the <code class="literal">DateFormat</code> class. The result is a <code class="literal">Date</code> object. The parsing algorithms are
      finicky, so itâ€™s safest to parse dates and times that are in the same
      format produced by the <code class="literal">DateFormat</code>.
      The <a id="id720026" class="indexterm"></a><code class="literal">parse()</code> method throws a
      <a id="id720038" class="indexterm"></a><code class="literal">ParseException</code> if it
      doesnâ€™t understand the string you give it. All of the following calls to
      <code class="literal">parse()</code> succeed except the last; we
      donâ€™t supply a time zone, but the format for the time is <code class="literal">LONG</code>. Other exceptions are occasionally thrown
      from the <code class="literal">parse()</code> method. To cover all
      the bases, catch <a id="id720072" class="indexterm"></a><code class="literal">NullPointerExceptions</code>
      and <a id="id720083" class="indexterm"></a><code class="literal">StringIndexOutOfBoundsExceptions</code>
      also:<a id="id720095" class="indexterm"></a><a id="id720105" class="indexterm"></a><a id="id720115" class="indexterm"></a><a id="id720125" class="indexterm"></a></p>
<pre class="programlisting" data-language="java" id="I_11_tt700">    <code class="k">try</code> <code class="o">{</code>
      <code class="n">Date</code> <code class="n">d</code><code class="o">;</code>
      <code class="n">DateFormat</code> <code class="n">df</code><code class="o">;</code>

      <code class="n">df</code> <code class="o">=</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">getDateTimeInstance</code><code class="o">(</code>
               <code class="n">DateFormat</code><code class="o">.</code><code class="na">FULL</code><code class="o">,</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">FULL</code><code class="o">);</code>
      <code class="n">d</code> <code class="o">=</code> <code class="n">df</code><code class="o">.</code><code class="na">parse</code><code class="o">(</code><code class="s">"Wednesday, April 12, 2006 2:22:22 o'clock PM EDT"</code><code class="o">);</code>

      <code class="n">df</code> <code class="o">=</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">getDateTimeInstance</code><code class="o">(</code>
               <code class="n">DateFormat</code><code class="o">.</code><code class="na">MEDIUM</code><code class="o">,</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">MEDIUM</code><code class="o">);</code>
      <code class="n">d</code> <code class="o">=</code> <code class="n">df</code><code class="o">.</code><code class="na">parse</code><code class="o">(</code><code class="s">"12-Apr-06 2:22:22 PM"</code><code class="o">);</code>

      <code class="n">df</code> <code class="o">=</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">getDateTimeInstance</code><code class="o">(</code>
               <code class="n">DateFormat</code><code class="o">.</code><code class="na">LONG</code><code class="o">,</code> <code class="n">DateFormat</code><code class="o">.</code><code class="na">LONG</code><code class="o">);</code>
      <code class="n">d</code> <code class="o">=</code> <code class="n">df</code><code class="o">.</code><code class="na">parse</code><code class="o">(</code><code class="s">"April 12, 2006 2:22:22 PM EDT"</code><code class="o">);</code>

      <code class="c1">// throws a ParseException; detail level mismatch</code>
      <code class="n">d</code> <code class="o">=</code> <code class="n">df</code><code class="o">.</code><code class="na">parse</code><code class="o">(</code><code class="s">"12-Apr-06 2:22:22 PM"</code><code class="o">);</code>
    <code class="o">}</code>
    <code class="k">catch</code> <code class="o">(</code><code class="n">Exception</code> <code class="n">e</code><code class="o">)</code> <code class="o">{</code> <code class="o">...</code> <code class="o">}</code></pre>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-2.4">
<div class="titlepage"><div><div><h3 class="title">Printf-Style Date and Time Formatting</h3></div></div></div>
<p id="core_utilitiesd_id3"><a id="idx10621" class="indexterm"></a> <a id="idx10640" class="indexterm"></a> <a id="idx10666" class="indexterm"></a>The printf-style formatting covered in <a class="xref" href="ch10.html" title="ChapterÂ 10.Â Working with Text">ChapterÂ 10</a> can render dates and times to strings in
      completely arbitrary ways, without having to resort to <code class="literal">Calendar</code> methods to get components.</p>
<p id="all_date_and_ti">All date and time format strings use the same conversion
      character, <a id="id720658" class="indexterm"></a><code class="literal">t</code> or <a id="id720670" class="indexterm"></a><code class="literal">T</code>, followed by a suffix
      character that identifies the actual format or date/time component to be
      generated. For example, the format string <code class="literal">%tc</code> turns a <code class="literal">Date</code> argument into the string equivalent of
      what you get with the standard <code class="literal">Date
      toString()</code> method:</p>
<pre class="programlisting" data-language="java" id="I_11_tt701">    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code> <code class="s">"The date is %tc\n"</code><code class="o">,</code> <code class="k">new</code> <code class="n">Date</code><code class="o">()</code> <code class="o">);</code>
    <code class="c1">// The date is Thu Nov 04 22:32:00 CST 2004</code></pre>
<p id="as_with_other_c">As with other conversion characters, the only difference between
      <code class="literal">t</code> and <code class="literal">T</code> is that the latter forces all of the output
      to uppercase. All time and date formatting is locale-sensitive,
      including the names of days and months and the A.M./P.M. identifier. To
      format a <code class="literal">Date</code> for another language,
      simply pass the <code class="literal">Locale</code> as the first
      argument:</p>
<pre class="programlisting" data-language="java" id="I_11_tt702">    <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">printf</code><code class="o">(</code> <code class="n">Locale</code><code class="o">.</code><code class="na">ITALIAN</code><code class="o">,</code> <code class="s">"The date is %tc\n"</code><code class="o">,</code> <code class="k">new</code> <code class="n">Date</code><code class="o">()</code> <code class="o">);</code>
    <code class="c1">// The date is gio nov 04 22:32:00 CST 2004</code></pre>
<p id="there_are_two_a_id1">There are two additional composite, date-only formats and three
      composite time-only formats, as shown in the following table. The format
      string description in the third column of <a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-4" title="TableÂ 11-4.Â Composite date and time formats">TableÂ 11-4</a> refers to date and time component
      formats discussed in Tables <a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-5" title="TableÂ 11-5.Â Date component formats">11-5</a> and <a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-6" title="TableÂ 11-6.Â Time component formats">11-6</a>.</p>
<div class="table" id="learnjava3-CHP-11-TABLE-4">
<div class="table-title">TableÂ 11-4.Â Composite date and time formats</div>
<div class="table-contents"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<colgroup>
<col class="col1">
<col class="col2">
<col class="col3">
</colgroup>
<thead><tr>
<td style="text-align: left; "><p id="format_suffix_id1">Format suffix</p></td>
<td style="text-align: left; "><p id="example_id2">Example</p></td>
<td style="text-align: left; "><p id="components">Components</p></td>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left; "><p id="c_format_suffix_id1"> <a id="id721003" class="indexterm"></a> <code class="literal">c</code>
              </p></td>
<td style="text-align: left; "><p id="thu_nov__">Thu Nov 04 22:32:00 CST
              2004</p></td>
<td style="text-align: left; "><p id="ta_tb_td_tt"> <code class="literal">%ta %tb %td
              %tT %tZ %tY</code> </p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="d_format_suffix_id1"> <a id="id721051" class="indexterm"></a> <code class="literal">D</code>
              </p></td>
<td style="text-align: left; "><p id="para_id50">11/04/04</p></td>
<td style="text-align: left; "><p id="tmtdty"> <code class="literal">%tm/%td/%ty</code> </p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="f_format_suffix"> <a id="id721098" class="indexterm"></a> <code class="literal">F</code>
              </p></td>
<td style="text-align: left; "><p id="para_id51">2004-11-04</p></td>
<td style="text-align: left; "><p id="tytmtd"> <code class="literal">%tY-%tm-%td</code> </p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="r_format_suffix_id1"> <a id="id721145" class="indexterm"></a> <code class="literal">r</code>
              </p></td>
<td style="text-align: left; "><p id="pm">10:32:00 PM</p></td>
<td style="text-align: left; "><p id="titmts_tp"> <code class="literal">%tI:%tM:%tS
              %Tp</code> </p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="r_format_suffix_id2"> <a id="id721192" class="indexterm"></a> <code class="literal">R</code>
              </p></td>
<td style="text-align: left; "><p id="para_id52">22:32</p></td>
<td style="text-align: left; "><p id="thtm"> <code class="literal">%tH:%tM</code> </p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="t_format_suffix"> <a id="id721241" class="indexterm"></a> <code class="literal">T</code>
              </p></td>
<td style="text-align: left; "><p id="para_id53">22:32:00</p></td>
<td style="text-align: left; "><p id="thtmts"> <code class="literal">%tH:%tM:%tS</code> </p></td>
</tr>
</tbody>
</table></div>
</div>
<p id="lists_formats_f_id1"><a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-5" title="TableÂ 11-5.Â Date component formats">TableÂ 11-5</a> lists formats for
      accessing date components.</p>
<div class="table" id="learnjava3-CHP-11-TABLE-5">
<div class="table-title">TableÂ 11-5.Â Date component formats</div>
<div class="table-contents"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<colgroup>
<col class="col1">
<col class="col2">
<col class="col3">
</colgroup>
<thead><tr>
<td style="text-align: left; "><p id="format_suffix_id2">Format suffix</p></td>
<td style="text-align: left; "><p id="examples_id1">Examples</p></td>
<td style="text-align: left; "><p id="description_id10">Description</p></td>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left; "><p id="a_format_suffix_id1"> <a id="id721363" class="indexterm"></a> <code class="literal">a</code>
              </p></td>
<td style="text-align: left; "><p id="sun_mon_tue">Sun, Mon, Tue...</p></td>
<td style="text-align: left; "><p id="abbreviated_day">Abbreviated day of week</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="a_format_suffix_id2"> <a id="id721406" class="indexterm"></a> <code class="literal">A</code>
              </p></td>
<td style="text-align: left; "><p id="sunday_monday_id3">Sunday, Monday...</p></td>
<td style="text-align: left; "><p id="full_day_of_wee">Full day of week</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="b_format_suffix_id1"> <a id="id721446" class="indexterm"></a> <code class="literal">b</code>
              </p></td>
<td style="text-align: left; "><p id="jan_feb_mar_">Jan, Feb, Mar, ...</p></td>
<td style="text-align: left; "><p id="abbreviated_mon">Abbreviated month</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="b_format_suffix_id2"> <a id="id721488" class="indexterm"></a> <code class="literal">B</code>
              </p></td>
<td style="text-align: left; "><p id="january_februa_id2">January, February, ...</p></td>
<td style="text-align: left; "><p id="full_month">Full month</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="y"> Y </p></td>
<td style="text-align: left; "><p id="para_id54">1999, 2004</p></td>
<td style="text-align: left; "><p id="fourdigit_year">Four-digit year</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="c_format_suffix_id2"> <a id="id721558" class="indexterm"></a> <code class="literal">C</code>
              </p></td>
<td style="text-align: left; "><p id="__id1">2004 = 20</p></td>
<td style="text-align: left; "><p id="high_two_digits">High two digits of year</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="y_format_suffix"> <a id="id721601" class="indexterm"></a> <code class="literal">y</code>
              </p></td>
<td style="text-align: left; "><p id="__id2">1999 = 99</p></td>
<td style="text-align: left; "><p id="low_two_digits_">Low two digits of year</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="j"> <code class="literal">j</code>
              </p></td>
<td style="text-align: left; "><p id="__id3">001 ... 366</p></td>
<td style="text-align: left; "><p id="day_of_year">Day of year</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="m_format_suffix_id1"> <a id="id721677" class="indexterm"></a> <code class="literal">m</code>
              </p></td>
<td style="text-align: left; "><p id="__id4">01 ... 13</p></td>
<td style="text-align: left; "><p id="month_of_year">Month of year</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="d_format_suffix_id2"> <a id="id721719" class="indexterm"></a> <code class="literal">d</code>
              </p></td>
<td style="text-align: left; "><p id="__id5">01 ... 31</p></td>
<td style="text-align: left; "><p id="day_of_month">Day of month</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="e_format_suffix"> <a id="id721761" class="indexterm"></a> <code class="literal">e</code>
              </p></td>
<td style="text-align: left; "><p id="__id6">1 ... 31</p></td>
<td style="text-align: left; "><p id="day_of_month_n">Day of month, no leading
              zeros</p></td>
</tr>
</tbody>
</table></div>
</div>
<p id="lists_formats_f_id2"><a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-6" title="TableÂ 11-6.Â Time component formats">TableÂ 11-6</a> lists formats for
      accessing time components.</p>
<div class="table" id="learnjava3-CHP-11-TABLE-6">
<div class="table-title">TableÂ 11-6.Â Time component formats</div>
<div class="table-contents"><table style="border-collapse: collapse;border-top: 0.5pt solid ; ">
<colgroup>
<col class="col1">
<col class="col2">
<col class="col3">
</colgroup>
<thead><tr>
<td style="text-align: left; "><p id="format_suffix_id3">Format suffix</p></td>
<td style="text-align: left; "><p id="examples_id2">Examples</p></td>
<td style="text-align: left; "><p id="description_id11">Description</p></td>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left; "><p id="h_format_suffix"> <a id="id721878" class="indexterm"></a> <code class="literal">H</code>
              </p></td>
<td style="text-align: left; "><p id="__id7">00 ... 23</p></td>
<td style="text-align: left; "><p id="hour_clock_id1">24-hour clock</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="k_format_suffix"> <a id="id721920" class="indexterm"></a> <code class="literal">k</code>
              </p></td>
<td style="text-align: left; "><p id="__id8">0 ... 23</p></td>
<td style="text-align: left; "><p id="hour_clock__id1">24-hour clock, no leading
              zeros</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="i_format_suffix"> <a id="id721962" class="indexterm"></a> <code class="literal">I</code>
              </p></td>
<td style="text-align: left; "><p id="__id9">01 ... 12</p></td>
<td style="text-align: left; "><p id="hour_clock_id2">12-hour clock</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="l_format_suffix_id1"> <a id="id722004" class="indexterm"></a> <code class="literal">l</code>
              </p></td>
<td style="text-align: left; "><p id="__id10">1 ... 12</p></td>
<td style="text-align: left; "><p id="hour_clock__id2">12-hour clock, no leading
              zeros</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="m_format_suffix_id2"> <a id="id722046" class="indexterm"></a> <code class="literal">M</code>
              </p></td>
<td style="text-align: left; "><p id="__id11">00 ... 59</p></td>
<td style="text-align: left; "><p id="minute">Minute</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="s_format_suffix"> <a id="id722088" class="indexterm"></a> <code class="literal">S</code>
              </p></td>
<td style="text-align: left; "><p id="_the_se">00 ... 60<a href="#ftn.id722110" class="footnote"><sup class="footnote" id="id722110">[a]</sup></a></p></td>
<td style="text-align: left; "><p id="second">Second</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="l_format_suffix_id2"> <a id="id722139" class="indexterm"></a> <code class="literal">L</code>
              </p></td>
<td style="text-align: left; "><p id="__id12">000 ... 999</p></td>
<td style="text-align: left; "><p id="millisecond">Millisecond</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="p_format_suffix"> <a id="id722181" class="indexterm"></a> <code class="literal">p</code>
              </p></td>
<td style="text-align: left; "><p id="am_pm_id2">am, pm</p></td>
<td style="text-align: left; "><p id="morning_or_afte">Morning or afternoon
              designator</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="z_format_suffix_id1"> <a id="id722223" class="indexterm"></a> <code class="literal">Z</code>
              </p></td>
<td style="text-align: left; "><p id="cst_est">CST, EST</p></td>
<td style="text-align: left; "><p id="time_zone_name">Time zone name</p></td>
</tr>
<tr>
<td style="text-align: left; "><p id="z_format_suffix_id2"> <a id="id722266" class="indexterm"></a> <code class="literal">z</code>
              </p></td>
<td style="text-align: left; "><p id="para_id55">-0600</p></td>
<td style="text-align: left; "><p id="time_zone_gmt_o">Time zone GMT offset<a id="id722296" class="indexterm"></a><a id="id722306" class="indexterm"></a><a id="id722316" class="indexterm"></a></p></td>
</tr>
</tbody>
<tbody class="footnotes"><tr><td colspan="3"><div id="ftn.id722110" class="footnote"><p><a href="#id722110" class="para"><sup class="para">[a] </sup></a>The second value (<code class="literal">60</code>) is a convention used to
                  support leap seconds.</p></div></td></tr></tbody>
</table></div>
</div>
</div>
</div>
<div class="sect1" data-original-filename="ch11.xml" id="learnjava3-CHP-11-SECT-3">
<div class="titlepage"><div><div><h2 class="title">Timers</h2></div></div></div>
<p id="core_utilitiest"><a id="idx10636" class="indexterm"></a> <a id="idx10674" class="indexterm"></a>Java includes two handy classes for timed code execution. If
    you write a clock application, for example, you might want to update the
    display every second. You might want to play an alarm sound at some
    predetermined time. You could accomplish these tasks using multiple
    threads and calls to <code class="literal">Thread.sleep()</code>.
    But the <a id="id722377" class="indexterm"></a><code class="literal">java.util.Timer</code> and
    <a id="id722389" class="indexterm"></a><code class="literal">java.util.TimerTask</code>
    classes handle this for you.</p>
<p id="the_timer_class">The <code class="literal">Timer</code> class is a scheduler.
    Each instance of <code class="literal">Timer</code> has a single
    thread that runs in the background, watching the clock and executing one
    or more <code class="literal">TimerTask</code>s at appropriate
    times. You could, for example, schedule a task to run once at a specific
    time like this:</p>
<pre class="programlisting" data-language="java" id="I_11_tt703">    <code class="kn">import</code> <code class="nn">java.util.*</code><code class="o">;</code>

    <code class="kd">public</code> <code class="kd">class</code> <code class="nc">Y2K</code> <code class="o">{</code>
      <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="o">{</code>
        <code class="n">Timer</code> <code class="n">timer</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Timer</code><code class="o">();</code>

        <code class="n">TimerTask</code> <code class="n">task</code> <code class="o">=</code> <code class="k">new</code> <code class="n">TimerTask</code><code class="o">()</code> <code class="o">{</code>
          <code class="kd">public</code> <code class="kt">void</code> <code class="nf">run</code><code class="o">()</code> <code class="o">{</code>
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Y2K!"</code><code class="o">);</code>
          <code class="o">}</code>
        <code class="o">};</code>

        <code class="n">Calendar</code> <code class="n">cal</code> <code class="o">=</code> <code class="k">new</code> <code class="n">GregorianCalendar</code><code class="o">(</code> <code class="mi">2000</code><code class="o">,</code> <code class="n">Calendar</code><code class="o">.</code><code class="na">JANUARY</code><code class="o">,</code> <code class="mi">1</code> <code class="o">);</code>
        <code class="n">timer</code><code class="o">.</code><code class="na">schedule</code><code class="o">(</code> <code class="n">task</code><code class="o">,</code> <code class="n">cal</code><code class="o">.</code><code class="na">getTime</code><code class="o">());</code>
      <code class="o">}</code>
    <code class="o">}</code></pre>
<p id="timertask_imple"><code class="literal">TimerTask</code> implements the <code class="literal">Runnable</code> interface. To create a task, you can
    simply subclass <code class="literal">TimerTask</code> and supply a
    <code class="literal">run()</code> method. Here, weâ€™ve created a
    simple anonymous subclass of <code class="literal">TimerTask</code>
    that prints a message to <code class="literal">System.out</code>.
    Using the <a id="id722828" class="indexterm"></a><code class="literal">schedule()</code> method of
    <code class="literal">Timer</code>, weâ€™ve asked that the task be run
    on January 1, 2000. If the scheduled time has already passed (as in our
    example), the task is run immediately.</p>
<p id="there_are_some_">There are some other varieties of <a id="id722854" class="indexterm"></a><code class="literal">schedule()</code>; you can run
    tasks once or at recurring intervals. There are two kinds of recurring
    tasksâ€”fixed delay and fixed rate. <span class="emphasis"><em>Fixed delay</em></span> means
    that a fixed amount of time elapses between the end of the taskâ€™s
    execution and the beginning of the next execution. <span class="emphasis"><em>Fixed
    rate</em></span> means that the task should begin execution at fixed time
    intervals. The difference comes into play when the time to execute the
    task is long relative to the interval. Keep in mind that tasks are
    executed by the <code class="literal">Timer</code>â€™s single
    scheduler thread. If one task takes a very long time, other tasks may be
    delayed, in which case they run as soon as the thread becomes
    available.</p>
<p id="you_could_for_">You could, for example, update a clock display every second with
    code like this:</p>
<pre class="programlisting" data-language="java" id="I_11_tt704">    <code class="n">Timer</code> <code class="n">timer</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Timer</code><code class="o">();</code>

    <code class="n">TimerTask</code> <code class="n">task</code> <code class="o">=</code> <code class="k">new</code> <code class="n">TimerTask</code><code class="o">()</code> <code class="o">{</code>
        <code class="kd">public</code> <code class="kt">void</code> <code class="nf">run</code><code class="o">()</code> <code class="o">{</code>
            <code class="n">repaint</code><code class="o">();</code> <code class="c1">// update the clock display</code>
        <code class="o">}</code>
    <code class="o">};</code>

    <code class="n">timer</code><code class="o">.</code><code class="na">scheduleAtFixedRate</code><code class="o">(</code> <code class="n">task</code><code class="o">,</code> <code class="mi">0</code><code class="o">,</code> <code class="mi">1000</code> <code class="o">);</code></pre>
<p id="a_timertask_can">A <code class="literal">TimerTask</code> can be canceled
    before its execution with its <a id="id723081" class="indexterm"></a><code class="literal">cancel()</code>
    method.<a id="id723093" class="indexterm"></a><a id="id723102" class="indexterm"></a></p>
</div>
<div class="sect1" data-original-filename="ch11.xml" id="learnjava3-CHP-11-SECT-4">
<div class="titlepage"><div><div><h2 class="title">Collections</h2></div></div></div>
<p id="collectionsdefi"><a id="id723128" class="indexterm"></a> <span class="emphasis"><em>Collections</em></span> are data structures that
    are fundamental to all types of programming. Whenever we need to refer to
    a group of objects, we have some kind of collection. At the core language
    level, Java supports collections in the form of arrays. But arrays are
    static and because they have a fixed length, they are awkward for groups
    of things that grow and shrink over the lifetime of an application. Arrays
    also do not represent abstract relationships between objects well. In the
    early days, the Java platform had only two basic classes to address these
    needs: the <code class="literal">java.util.Vector</code> class,
    which represents a dynamic list of objects, and the <code class="literal">java.util.Hashtable</code> class, which holds a map of
    key/value pairs. Today, Java has a more comprehensive approach to
    collections called the Collections Framework. The older classes still
    exist, but they have been retrofitted into the framework (with some
    eccentricities) and are generally no longer used.</p>
<p id="though_conceptu">Though conceptually simple, collections are one of the most powerful
    parts of any programming language. Collections implement data structures
    that lie at the heart of managing complex problems. A great deal of basic
    computer science is devoted to describing the most efficient ways to
    implement certain types of algorithms over collections. Having these tools
    at your disposal and understanding how to use them can make your code both
    much smaller and faster. It can also save you from reinventing the
    wheel.</p>
<p id="prior_to_java__id3">Prior to Java 5, the Collections Framework had two major drawbacks.
    The first was thatâ€”not having generic types to work withâ€”collections were
    by necessity untyped and worked only with anonymous <code class="literal">Object</code>s instead of real types like <code class="literal">Date</code>s and <code class="literal">String</code>s. This meant that you had to perform a
    type cast every time you took an object out of a collection. This flew in
    the face of Javaâ€™s compile-time type safety. But in practice, this was
    less a problem than it was just plain cumbersome and tedious. The second
    issue was that, for practical reasons, collections could work only with
    objects and not with primitive types. This meant that any time you wanted
    to put a number or other primitive type into a collection, you had to
    store it in a wrapper class first and unpack it later upon retrieving it.
    The combination of these factors made code working with collections less
    readable and more dangerous to boot.</p>
<p id="this_all_change">This all changed with the introduction of generic types and
    autoboxing of primitive values. First, the introduction of generic types,
    as we described in <a class="xref" href="ch08.html" title="ChapterÂ 8.Â Generics">ChapterÂ 8</a>, has made it
    possible for truly typesafe collections to be under the control of the
    programmer. Second, the introduction of autoboxing and unboxing of
    primitive types means that you can generally treat objects and primitives
    as equals where collections are concerned. The combination of these new
    features can significantly reduce the amount of code you write and add
    safety as well. As weâ€™ll see, all of the collections classes now take
    advantage of these features.</p>
<p id="the_collections">The Collections Framework is based around a handful of interfaces in
    the <code class="literal">java.util</code> package. These interfaces
    are divided into two hierarchies. The first hierarchy descends from the
    <code class="literal">Collection</code> interface. This interface
    (and its descendants) represents a container that holds other objects. The
    second, separate hierarchy is based on the <code class="literal">Map</code> interface, which represents a group of
    key/value pairs where the key can be used to retrieve the value in an
    efficient way.</p>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.1">
<div class="titlepage"><div><div><h3 class="title">The Collection Interface</h3></div></div></div>
<p id="core_utilitiesc_id1"><a id="idx10612" class="indexterm"></a>The mother of all collections is an interface
      appropriately named <code class="literal">Collection</code>. It
      serves as a container that holds other objects, its
      <span class="emphasis"><em>elements</em></span>. It doesnâ€™t specify exactly how the
      objects are organized; it doesnâ€™t say, for example, whether duplicate
      objects are allowed or whether the objects are ordered in any way. These
      kinds of details are left to child interfaces. Nevertheless, the
      <code class="literal">Collection</code> interface defines some
      basic operations common to all collections:</p>
<div class="variablelist" id="public_boolean__id1"><dl class="variablelist">
<dt><span class="term"><code class="literal">public boolean add(</code>
          <em class="replaceable"><code>element</code></em> <code class="literal">)</code></span></dt>
<dd><p id="add_methodcol"><a id="id723333" class="indexterm"></a>This method adds the supplied object to this
            collection. If the operation succeeds, this method returns
            <code class="literal">true</code>. If the object already
            exists in this collection and the collection does not permit
            duplicates, <code class="literal">false</code> is returned.
            Furthermore, some collections are read-only. Those collections
            throw an <code class="literal">UnsupportedOperationException</code> if this
            method is called.</p></dd>
<dt><span class="term"><code class="literal">public boolean remove(</code>
          <em class="replaceable"><code>element</code></em> <code class="literal">)</code></span></dt>
<dd><p id="remove_method_id1"><a id="id723384" class="indexterm"></a>This method removes the specified object from this
            collection. Like the <code class="literal">add()</code>
            method, this method returns <code class="literal">true</code> if the object is removed from the
            collection. If the object doesnâ€™t exist in this collection,
            <code class="literal">false</code> is returned. Read-only
            collections throw an <code class="literal">UnsupportedOperationException</code> if this
            method is called.</p></dd>
<dt><span class="term"><code class="literal">public boolean contains(</code>
          <em class="replaceable"><code>element</code></em> <code class="literal">)</code></span></dt>
<dd><p id="contains_meth_id2"><a id="id723443" class="indexterm"></a>This method returns <code class="literal">true</code> if the collection contains the
            specified object.</p></dd>
<dt><span class="term"><code class="literal">public int size()</code></span></dt>
<dd><p id="use_this_method_id1">Use this method to find the number of elements in this
            collection.</p></dd>
<dt><span class="term"><code class="literal">public boolean
          isEmpty()</code></span></dt>
<dd><p id="size_methodco"><a id="id723484" class="indexterm"></a>This method returns <code class="literal">true</code> if this collection has no
            elements.</p></dd>
<dt><span class="term"><code class="literal">public Iterator
          iterator()</code></span></dt>
<dd><p id="iterator_meth"><a id="id723513" class="indexterm"></a>Use this method to examine all the elements in this
            collection. This method returns an <code class="literal">Iterator</code>, which is an object you can use
            to step through the collectionâ€™s elements. Weâ€™ll talk more about
            iterators in the next section.</p></dd>
</dl></div>
<p id="additionally_t_id2">Additionally, the methods <a id="id723535" class="indexterm"></a><code class="literal">addAll()</code>, <a id="id723547" class="indexterm"></a><code class="literal">removeAll()</code>, and
      <a id="id723558" class="indexterm"></a><code class="literal">containsAll()</code> accept
      another <code class="literal">Collection</code> and add, remove,
      or test for all of the elements of the supplied collection.</p>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.1.1">
<div class="titlepage"><div><div><h4 class="title">Generics and collections</h4></div></div></div>
<p id="collectionscoll_id1"><a id="id723590" class="indexterm"></a> <a id="id723601" class="indexterm"></a>When using generics, the <code class="literal">Collection</code> type is parameterized with a
        specific type of element that the collection will hold. This makes a
        generic collection of â€œanythingâ€? into a specific collection of some
        type of element. The parameter type becomes the compile-time type of
        the <code class="literal">element</code> arguments in all of the
        methods of <code class="literal">Collection</code> (in this
        case, the <code class="literal">add()</code>, <code class="literal">remove()</code>, and <code class="literal">contains()</code> methods listed earlier). For
        example, in the following code, we create a <code class="literal">Collection</code> that works with <code class="literal">Date</code>s:</p>
<pre class="programlisting" data-language="java" id="I_11_tt705">    <code class="n">Collection</code><code class="o">&lt;</code><code class="n">Date</code><code class="o">&gt;</code> <code class="n">dates</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayList</code><code class="o">&lt;</code><code class="n">Date</code><code class="o">&gt;();</code> <code class="c1">// = new ArrayList&lt;&gt;() would </code>
                                                        <code class="c1">// also work.</code>
    <code class="n">dates</code><code class="o">.</code><code class="na">add</code><code class="o">(</code> <code class="k">new</code> <code class="n">Date</code><code class="o">()</code> <code class="o">);</code>
    <code class="n">dates</code><code class="o">.</code><code class="na">add</code><code class="o">(</code> <code class="s">"foo"</code> <code class="o">)</code> <code class="c1">// Error; string type where Date expected!!</code></pre>
<p id="arraylist_is_ju"><code class="literal">ArrayList</code> is just one
        implementation of <code class="literal">Collection</code>; weâ€™ll
        talk about it a bit later. The important thing is that weâ€™ve declared
        the variable <code class="literal">dates</code> to be of the
        type <code class="literal">Collection&lt;Date&gt;</code>; that
        is, a collection of <code class="literal">Date</code>s, and
        weâ€™ve allocated our <code class="literal">ArrayList</code> to
        match. Because our collection has been parameterized with the type
        <code class="literal">Date</code>, the <code class="literal">add()</code> method of the collection becomes
        <code class="literal">add( Date date )</code> and attempting to
        add any type of object other than a <code class="literal">Date</code> to the list would have caused a
        compile-time error.</p>
<p id="if_you_are_work">If you are working with very old Java code that predates
        generics, you can simply drop the types and perform the appropriate
        casts. For example:</p>
<pre class="programlisting" data-language="java" id="I_11_tt706">    <code class="n">Collection</code> <code class="n">dates</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayList</code><code class="o">();</code>
    <code class="n">dates</code><code class="o">.</code><code class="na">add</code><code class="o">(</code> <code class="k">new</code> <code class="n">Date</code><code class="o">()</code> <code class="o">);</code>  <code class="c1">// unchecked, compile-time warning</code>
    <code class="n">Date</code> <code class="n">date</code> <code class="o">=</code> <code class="o">(</code><code class="n">Date</code><code class="o">)</code><code class="n">dates</code><code class="o">.</code><code class="na">get</code><code class="o">(</code> <code class="mi">0</code> <code class="o">);</code></pre>
<p id="in_this_case_w_id2">In this case, weâ€™ll get a compile time warning that weâ€™re using
        <code class="literal">ArrayList </code>in a potentially unsafe
        (nongeneric typesafe) way.</p>
<p id="as_weve_descri">As weâ€™ve described earlier in the book, this is essentially what
        the Java compiler is doing for us with generics. When using
        collections (or any generic classes) in this way under Java 5 or
        later, you will get compile-time warnings indicating that the usage is
        unchecked, meaning that it is possible to get an error at runtime if
        you have made a mistake. In this example, a mistake would not be
        caught until someone tried to retrieve the object from the collection
        and cast it to the expected type.</p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.1.2">
<div class="titlepage"><div><div><h4 class="title">Legacy code and runtime type safety</h4></div></div></div>
<p id="collectionscoll_id2"><a id="idx10597" class="indexterm"></a> <a id="idx10647" class="indexterm"></a> <a id="idx10669" class="indexterm"></a>If you are working with legacy Java code that predates
        Java 5 generics and you do not wish to introduce generics to it, you
        can still add a layer of type safety at runtime by switching to a
        runtime type-checked version of your collection types. Java supplies
        runtime-checked wrappers for all of the basic collection types. These
        wrappers enforce a specific Java element type at runtime by throwing
        <a id="id724113" class="indexterm"></a><code class="literal">ClassCastException</code> if
        the wrong element is inserted. For example:</p>
<pre class="programlisting" data-language="java" id="I_11_tt707">    <code class="n">List</code> <code class="n">list</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayList</code><code class="o">();</code>
    <code class="n">list</code> <code class="o">=</code> <code class="n">Collections</code><code class="o">.</code><code class="na">checkedList</code><code class="o">(</code> <code class="n">list</code><code class="o">,</code> <code class="n">Date</code><code class="o">.</code><code class="na">class</code> <code class="o">);</code>
    <code class="n">list</code><code class="o">.</code><code class="na">add</code><code class="o">(</code> <code class="k">new</code> <code class="n">Date</code><code class="o">()</code> <code class="o">);</code>
    <code class="n">list</code><code class="o">.</code><code class="na">add</code><code class="o">(</code> <code class="s">"foo"</code> <code class="o">);</code> <code class="c1">// Runtime ClassCastException!</code></pre>
<p id="here_the_stati">Here, the static <a id="id724302" class="indexterm"></a><code class="literal">Collections.checkedList()</code> method has wrapped
        our collection, <code class="literal">list</code>, in a wrapper
        that implements all of the methods of <code class="literal">List</code>, but checks that we are only holding
        <code class="literal">Date</code>s. The second argument to the
        method is the literal <code class="literal">Date.class</code>
        reference to the <code class="literal">Class</code> of <code class="literal">Date</code>. This serves to tell the wrapper what
        type we want to enforce. Corresponding â€œcheckedâ€? collection methods
        exist for all of the basic collection interfaces that weâ€™ll see,
        including the base <code class="literal">Collection</code>,
        <code class="literal">List</code>, <code class="literal">Set</code>, and <code class="literal">Map</code>.<a id="id724378" class="indexterm"></a><a id="id724387" class="indexterm"></a><a id="id724397" class="indexterm"></a></p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.1.3">
<div class="titlepage"><div><div><h4 class="title">Converting between collections and arrays</h4></div></div></div>
<p id="arraysconvertin"><a id="id724420" class="indexterm"></a> <a id="id724429" class="indexterm"></a>Converting between collections and arrays is easy. For
        convenience, the elements of a collection can be retrieved as an array
        using the following methods:</p>
<pre class="programlisting" data-language="java" id="I_11_tt708">    <code class="kd">public</code> <code class="n">Object</code><code class="o">[]</code> <code class="nf">toArray</code><code class="o">()</code>
    <code class="kd">public</code> <code class="o">&lt;</code><code class="n">E</code><code class="o">&gt;</code> <code class="n">E</code><code class="o">[]</code> <code class="n">toArray</code><code class="o">(</code> <code class="n">E</code><code class="o">[]</code> <code class="n">a</code> <code class="o">)</code></pre>
<p id="the_first_metho_id2">The first method returns a plain <code class="literal">Object</code> array. With the second form, we can
        be more specific and get back an array of the correct element type. If
        we supply an array of sufficient size, it will be filled in with the
        values. But if the array is too short (e.g., zero length), a new array
        of the <span class="emphasis"><em>same type but the required length</em></span> will be
        created and returned to us. So you can just pass in an empty array of
        the correct type like this:</p>
<pre class="programlisting" data-language="java" id="I_11_tt709">    <code class="n">Collection</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">myCollection</code> <code class="o">=</code> <code class="o">...;</code>    
    <code class="n">String</code> <code class="o">[]</code> <code class="n">myStrings</code> <code class="o">=</code> <code class="n">myCollection</code><code class="o">.</code><code class="na">toArray</code><code class="o">(</code> <code class="k">new</code> <code class="n">String</code><code class="o">[</code><code class="mi">0</code><code class="o">]</code> <code class="o">);</code></pre>
<p id="this_trick_is_">(This trick is a little awkward and it would be nice if Java let
        us specify the type explicitly using a <code class="literal">Class</code> reference, but for some reason, this
        isnâ€™t the case.) Going the other way, you can convert an array of
        objects to a <code class="literal">List</code> collection with
        the static <code class="literal">asList()</code> method of the
        <code class="literal">java.util.Arrays</code> class:<a id="id724700" class="indexterm"></a></p>
<pre class="programlisting" data-language="java" id="I_11_tt710">    <code class="n">String</code> <code class="o">[]</code> <code class="n">myStrings</code> <code class="o">=</code> <code class="o">...;</code>    <code class="n">List</code> <code class="n">list</code> <code class="o">=</code> <code class="n">Arrays</code><code class="o">.</code><code class="na">asList</code><code class="o">(</code> <code class="n">myStrings</code> <code class="o">);</code></pre>
</div>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.2">
<div class="titlepage"><div><div><h3 class="title">Iterator</h3></div></div></div>
<p id="core_utilitiesc_id2"><a id="idx10617" class="indexterm"></a>An <a id="id724821" class="indexterm"></a><span class="emphasis"><em>iterator</em></span> is an object that lets you
      step through a sequence of values. This kind of operation comes up so
      often that it is given a standard interface: <code class="literal">java.util.Iterator</code>. The <a id="id724840" class="indexterm"></a><code class="literal">Iterator</code> interface has
      only two primary methods:</p>
<div class="variablelist" id="public_e_next"><dl class="variablelist">
<dt><span class="term"><code class="literal">public E next()</code></span></dt>
<dd><p id="next_method_"><a id="id724870" class="indexterm"></a>This method returns the next element (an element of
            generic type E) of the associated collection.</p></dd>
<dt><span class="term"><code class="literal">public boolean
          hasNext()</code></span></dt>
<dd><p id="hasnext_metho"><a id="id724891" class="indexterm"></a>This method returns <code class="literal">true</code> if you have not yet stepped through
            all the <code class="literal">Collection</code>â€™s elements.
            In other words, it returns <code class="literal">true</code>
            if you can call <code class="literal">next()</code> to get
            the next element.</p></dd>
</dl></div>
<p id="the_following_e_id5">The following example shows how you could use an <code class="literal">Iterator</code> to print out every element of a
      collection:</p>
<pre class="programlisting" data-language="java" id="I_11_tt711">    <code class="kd">public</code> <code class="kt">void</code> <code class="nf">printElements</code><code class="o">(</code><code class="n">Collection</code> <code class="n">c</code><code class="o">,</code> <code class="n">PrintStream</code> <code class="n">out</code><code class="o">)</code> <code class="o">{</code>
        <code class="n">Iterator</code> <code class="n">iterator</code> <code class="o">=</code> <code class="n">c</code><code class="o">.</code><code class="na">iterator</code><code class="o">();</code>
        <code class="k">while</code> <code class="o">(</code> <code class="n">iterator</code><code class="o">.</code><code class="na">hasNext</code><code class="o">()</code> <code class="o">)</code>
            <code class="n">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="n">iterator</code><code class="o">.</code><code class="na">next</code><code class="o">()</code> <code class="o">);</code>
    <code class="o">}</code></pre>
<p id="in_addition_to__id8">In addition to the traversal methods, <code class="literal">Iterator</code> provides the ability to remove an
      element from a collection:</p>
<div class="variablelist" id="public_void_rem"><dl class="variablelist">
<dt><span class="term"><code class="literal">public void remove()</code></span></dt>
<dd><p id="remove_method_id2"><a id="id725145" class="indexterm"></a>This method removes the most recent object returned
            from <code class="literal">next()</code> from the associated
            <code class="literal">Collection</code>.</p></dd>
</dl></div>
<p id="not_all_iterato">Not all iterators implement <code class="literal">remove()</code>. It doesnâ€™t make sense to be able to
      remove an element from a read-only collection, for example. If element
      removal is not allowed, an <code class="literal">UnsupportedOperationException</code> is thrown from
      this method. If you call <code class="literal">remove()</code>
      before first calling <code class="literal">next()</code>, or if
      you call <code class="literal">remove()</code> twice in a row,
      youâ€™ll get an <code class="literal">IllegalStateException</code>.</p>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.2.1">
<div class="titlepage"><div><div><h4 class="title">For loop over collections</h4></div></div></div>
<p id="collectionsiter_id1"><a id="id725226" class="indexterm"></a> <a id="id725237" class="indexterm"></a> <a id="id725246" class="indexterm"></a>A form of the <code class="literal">for</code>
        loop, described in <a class="xref" href="ch04.html" title="ChapterÂ 4.Â The Java Language">ChapterÂ 4</a>, can operate
        over all types of <a id="id725268" class="indexterm"></a><code class="literal">Collection</code> objects.
        For example, we can now step over all of the elements of a typed
        collection of <code class="literal">Date</code> objects like
        so:</p>
<pre class="programlisting" data-language="java" id="I_11_tt712">    <code class="n">Collection</code><code class="o">&lt;</code><code class="n">Date</code><code class="o">&gt;</code> <code class="n">col</code> <code class="o">=</code> <code class="o">...</code>
    <code class="k">for</code><code class="o">(</code> <code class="n">Date</code> <code class="n">date</code> <code class="o">:</code> <code class="n">col</code> <code class="o">)</code>
       <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="n">date</code> <code class="o">);</code></pre>
<p id="this_feature_of">This feature of the Java built-in <code class="literal">for</code> loop is called the "enhanced" <code class="literal">for</code> loop (as opposed to the pregenerics,
        numeric-only <code class="literal">for</code> loop). The
        enhanced <code class="literal">for</code> loop applies only to
        <code class="literal">Collection</code> type collections, not
        <code class="literal">Map</code>s. <code class="literal">Map</code>s are another type of beast that really
        contain two distinct sets of objects (keys and values), so itâ€™s not
        obvious what your intentions would be in such a loop.</p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.2.2">
<div class="titlepage"><div><div><h4 class="title">java.util.Enumeration</h4></div></div></div>
<p id="collectionsiter_id2"><a id="id725472" class="indexterm"></a> <a id="id725483" class="indexterm"></a> <a id="idx10645" class="indexterm"></a>Prior to the introduction of the Collections API there
        was another iterator interface: <code class="literal">java.util.Enumeration</code>. It used the slightly
        more verbose names <a id="id725512" class="indexterm"></a><code class="literal">nextElement()</code> and
        <a id="id725524" class="indexterm"></a><code class="literal">hasMoreElements()</code>,
        but accomplished the same thing. Many older classes provide <a id="id725536" class="indexterm"></a><code class="literal">Enumeration</code>s where
        they would now use <code class="literal">Iterator</code>. If you
        arenâ€™t worried about performance, you can just convert your <code class="literal">Enumeration</code> into a <code class="literal">List</code> with a static convenience method of the
        <code class="literal">java.util.Collections</code>
        class:<a id="id725574" class="indexterm"></a></p>
<pre class="programlisting" data-language="java" id="I_11_tt713">    <code class="n">Enumeration</code> <code class="n">myEnumeartion</code> <code class="o">=</code> <code class="o">...;</code>    
    <code class="n">List</code> <code class="n">list</code> <code class="o">=</code> <code class="n">Collections</code><code class="o">.</code><code class="na">list</code><code class="o">(</code> <code class="n">myEnumeration</code> <code class="o">);</code></pre>
</div>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.3">
<div class="titlepage"><div><div><h3 class="title">Collection Types</h3></div></div></div>
<p id="core_utilitiesc_id3"><a id="idx10613" class="indexterm"></a>The <code class="literal">Collection</code>
      interface has three child interfaces. <code class="literal">Set</code> represents a collection in which duplicate
      elements are not allowed. <code class="literal">List</code> is a
      collection whose elements have a specific order. The <code class="literal">Queue</code> interface is a buffer for objects with a
      notion of a â€œheadâ€? element thatâ€™s next in line for processing.</p>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.3.1">
<div class="titlepage"><div><div><h4 class="title">Set</h4></div></div></div>
<p id="collectionscoll_id3"><a id="id725730" class="indexterm"></a> <a id="id725741" class="indexterm"></a> <code class="literal">Set</code> has no methods
        besides the ones it inherits from <code class="literal">Collection</code>. It simply enforces its
        no-duplicates rule. If you try to add an element that already exists
        in a <code class="literal">Set</code>, the <code class="literal">add()</code> method simply returns <code class="literal">false</code>. <code class="literal">SortedSet</code> maintains elements in a prescribed
        order; like a sorted list that can contain no duplicates. It adds the
        methods <code class="literal">add()</code> and <code class="literal">remove()</code> to the <code class="literal">Set
        </code>interface. You can retrieve subsets (which are also sorted)
        using the <a id="id725804" class="indexterm"></a><code class="literal">subSet()</code>, <a id="id725815" class="indexterm"></a><code class="literal">headSet()</code>, and
        <a id="id725827" class="indexterm"></a><code class="literal">tailSet()</code> methods.
        These methods accept one or a pair of elements that mark the
        boundaries. The <a id="id725839" class="indexterm"></a><code class="literal">first()</code>, <a id="id725851" class="indexterm"></a><code class="literal">last()</code>, and
        <a id="id725862" class="indexterm"></a><code class="literal">comparator()</code> methods
        provide access to the first element, the last element, and the object
        used to compare elements (more on this later).</p>
<p id="java__adds_nav">Java 7 adds <code class="literal">NavigableSet</code>,
        which extends <code class="literal">SortedSet</code> and adds
        methods for finding the closest match greater or lesser than a target
        value within the sort order of the <code class="literal">Set</code>. This interface can be implemented
        efficiently using techniques such as skip lists, which make finding
        ordered elements fast (Java 7 supplies such an implementation, which
        weâ€™ll note later).</p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.3.2">
<div class="titlepage"><div><div><h4 class="title">List</h4></div></div></div>
<p id="collectionscoll_id4"><a id="idx10598" class="indexterm"></a> <a id="idx10649" class="indexterm"></a>The next child interface of <code class="literal">Collection</code> is <code class="literal">List</code>. The <code class="literal">List</code> is an ordered collection, similar to an
        array but with methods for manipulating the position of elements in
        the list:</p>
<div class="variablelist" id="public_boolean__id2"><dl class="variablelist">
<dt><span class="term"><code class="literal">public boolean add( E</code>
            <em class="replaceable"><code>element</code></em> <code class="literal">)</code></span></dt>
<dd><p id="add_methodlis"><a id="id725994" class="indexterm"></a>This method adds the specified element to the end
              of the list.</p></dd>
<dt><span class="term"><code class="literal">public void add( int</code>
            <em class="replaceable"><code>index</code></em> <code class="literal">,
            E</code> <em class="replaceable"><code>element</code></em> <code class="literal">)</code></span></dt>
<dd><p id="this_method_ins">This method inserts the given object at the supplied
              position in the list. If the position is less than zero or
              greater than the list length, an <code class="literal">IndexOutOfBoundsException</code> will be
              thrown. The element that was previously at the supplied
              position, and all elements after it, are moved up one index
              position.</p></dd>
<dt><span class="term"><code class="literal">public void remove( int</code>
            <em class="replaceable"><code>index</code></em> <code class="literal">)</code></span></dt>
<dd><p id="remove_method_id3"><a id="id726066" class="indexterm"></a>This method removes the element at the specified
              position. All subsequent elements move down one index
              position.</p></dd>
<dt><span class="term"><code class="literal">public E get( int</code>
            <em class="replaceable"><code>index</code></em> <code class="literal">)</code></span></dt>
<dd><p id="get_methodlis"><a id="id726098" class="indexterm"></a>This method returns the element at the given
              position.</p></dd>
<dt><span class="term"><code class="literal">public Object set( int</code>
            <em class="replaceable"><code>index</code></em> <code class="literal">,
            E</code> <em class="replaceable"><code>element</code></em> <code class="literal">)</code></span></dt>
<dd><p id="set_methodthi"><a id="id726138" class="indexterm"></a>This method changes the element at the given
              position to the specified object. There must already be an
              object at the index or else an <code class="literal">IndexOutOfBoundsException</code> is
              thrown.</p></dd>
</dl></div>
<p id="the_type_e_in_t">The type <code class="literal">E</code> in these methods
        refers to the parameterized element type of the <code class="literal">List</code> class. <code class="literal">Collection</code>, <code class="literal">Set</code>, and <code class="literal">List</code> are all interface types. Weâ€™ll look at
        concrete implementations of these shortly.<a id="id726190" class="indexterm"></a><a id="id726200" class="indexterm"></a></p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.3.3">
<div class="titlepage"><div><div><h4 class="title">Queue</h4></div></div></div>
<p id="collectionscoll_id5"><a id="id726223" class="indexterm"></a> A <a id="id726235" class="indexterm"></a><code class="literal">Queue</code> is a collection
        that acts like a buffer for elements. The queue maintains the
        insertion order of items placed into it and has the notion of a â€œheadâ€?
        item. Queues may be first in, first out (FIFO) or last in, first out
        (LIFO) depending on the implementation:</p>
<div class="variablelist" id="public_boolean__id3"><dl class="variablelist">
<dt>
<span class="term"><code class="literal">public boolean offer( E element
            )</code>, </span><span class="term"><code class="literal">public boolean add( E element
            )</code></span>
</dt>
<dd><p id="the_offer_met">The <a id="id726277" class="indexterm"></a><code class="literal">offer()</code> method
              attempts to place the element into the queue, returning true if
              successful. Different <code class="literal">Queue</code>
              types may have different limits or restrictions on element types
              (including capacity). This method differs from the <a id="id726296" class="indexterm"></a><code class="literal">add()</code> method
              inherited from <code class="literal">Collection</code> in
              that it returns a Boolean value instead of throwing an exception
              to indicate that the element cannot be accepted.</p></dd>
<dt>
<span class="term"><code class="literal">public E</code> <code class="literal">poll()</code>, </span><span class="term"><code class="literal">public E remove()</code></span>
</dt>
<dd><p id="the_poll_meth">The <a id="id726343" class="indexterm"></a><code class="literal">poll()</code> method
              removes the element at the head of the queue and returns it.
              This method differs from the <code class="literal">Collection</code> method <a id="id726362" class="indexterm"></a><code class="literal">remove()</code> in
              that if the queue is empty, <code class="literal">null</code> is returned instead of throwing
              an exception.</p></dd>
<dt><span class="term"><code class="literal">public E</code> <code class="literal">peek()</code></span></dt>
<dd><p id="peek_methodthis"><a id="id726401" class="indexterm"></a>This method returns the head element
              <span class="emphasis"><em>without</em></span> removing it from the queue. If the
              queue is empty, <code class="literal">null</code> is
              returned.</p></dd>
</dl></div>
<p id="java__added_de">Java 7 added <a id="id726425" class="indexterm"></a><code class="literal">Deque</code>, which is a
        â€œdouble-endedâ€? queue that supports adding, querying, and removing
        elements from either end of the queue (the head or the tail). <code class="literal">Dequeue</code> has versions of the queue
        methodsâ€”<code class="literal">offer</code>, <code class="literal">poll</code>, and <code class="literal">peek</code>â€”that operate on the first or last
        element: <a id="id726464" class="indexterm"></a><code class="literal">offerFirst()</code>,
        <a id="id726476" class="indexterm"></a><code class="literal">pollFirst()</code>,
        <a id="id726488" class="indexterm"></a><code class="literal">peekFirst()</code>,
        <a id="id726499" class="indexterm"></a><code class="literal">offerLast()</code>,
        <a id="id726511" class="indexterm"></a><code class="literal">pollLast()</code>,
        <a id="id726523" class="indexterm"></a><code class="literal">peekLast()</code>. Note that
        <code class="literal">Deque</code> extends <code class="literal">Queue</code> and so is still a type of <code class="literal">Queue</code>. If you use the plain <code class="literal">Queue</code> methods <code class="literal">offer()</code>, <a id="id726564" class="indexterm"></a><code class="literal">poll()</code>, and
        <a id="id726576" class="indexterm"></a><code class="literal">peek()</code> on a <code class="literal">Deque</code>, they operate as a FIFO queue.
        Specifically, calling <code class="literal">offer()</code> is
        equivalent to <code class="literal">offerLast()</code> and
        calling <code class="literal">poll()</code> or <code class="literal">peek()</code> is the same as calling <code class="literal">pollFirst()</code> or <code class="literal">peekFirst()</code>, respectively.</p>
<p id="finally_java_h">Finally, Java has a legacy <a id="id726637" class="indexterm"></a><code class="literal">Stack</code> class that acts
        as a LIFO queue with â€œpushâ€? and â€œpopâ€? operations, but <code class="literal">Deque</code> is generally better and should serve
        as a general replacement for <code class="literal">Stack</code>.
        Simply use <a id="id726662" class="indexterm"></a><code class="literal">addFirst()</code> for â€œpushâ€?
        and <code class="literal">pollFirst()</code> for â€œpop.â€?</p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.3.4">
<div class="titlepage"><div><div><h4 class="title">BlockingQueue</h4></div></div></div>
<p id="collectionscoll_id6"><a id="id726693" class="indexterm"></a> <a id="id726705" class="indexterm"></a> <code class="literal">BlockingQueue</code> is
        part of the <a id="id726718" class="indexterm"></a><code class="literal">java.util.concurrent</code>
        package. It extends the <code class="literal">Queue</code>
        interface for queues that may have a fixed capacity or other
        time-based limitations and allows the user to block, waiting for
        insertion of an item or for an available item to retrieve. It adds
        timed wait versions of <a id="id726738" class="indexterm"></a><code class="literal">offer()</code> and
        <a id="id726749" class="indexterm"></a><code class="literal">poll()</code> and
        additional, blocking <a id="id726761" class="indexterm"></a><code class="literal">take()</code> and <a id="id726773" class="indexterm"></a><code class="literal">put()</code> methods:</p>
<div class="variablelist" id="public_boolean__id4"><dl class="variablelist">
<dt><span class="term"><code class="literal">public boolean offer( E element,
            long time, TimeUnit units )</code></span></dt>
<dd><p id="this_method_att_id1">This method attempts to place the element into the queue,
              just like the method of the base <code class="literal">Queue</code> interface, but blocks for up to
              the specified period of time as it waits for space to become
              available.</p></dd>
<dt><span class="term"><code class="literal">public E poll( long time, timeUnit
            unit )</code></span></dt>
<dd><p id="this_method_att_id2">This method attempts to remove the element at the head of
              the queue, just like the method of the base <code class="literal">Queue</code> interface, but blocks for up to
              the specified period of time as it waits for an element to
              become available.</p></dd>
<dt><span class="term"><code class="literal">public E take()</code></span></dt>
<dd><p id="this_method_ret">This method retrieves the element at the head of the
              queue, blocking if necessary until one becomes available.</p></dd>
<dt><span class="term"><code class="literal">public void put( E element
            )</code></span></dt>
<dd><p id="this_method_add">This method adds an element to the queue, blocking if
              necessary until space becomes available.</p></dd>
<dt><span class="term"><code class="literal">public boolean add( E element
            )</code></span></dt>
<dd><p id="this_method_att_id3">This method attempts to add an element to the queue
              immediately. If successful, it returns <code class="literal">true</code>. If no space is available, it
              throws an <a id="id726886" class="indexterm"></a><code class="literal">IllegalStateException</code>. This method is
              useful for cases where you are not expecting the queue to ever
              reject an item.<a id="id726899" class="indexterm"></a></p></dd>
</dl></div>
</div>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.4">
<div class="titlepage"><div><div><h3 class="title">The Map Interface</h3></div></div></div>
<p id="collectionsmap_"><a id="idx10606" class="indexterm"></a> <a id="idx10618" class="indexterm"></a> <a id="idx10658" class="indexterm"></a>The Collections Framework also includes the <code class="literal">java.util.Map</code>, which is a collection of
      key/value pairs. Other names for map are â€œdictionaryâ€? or â€œassociative
      array.â€? Maps store and retrieve elements with key values; they are very
      useful for things like caches or minimalist databases. When you store a
      value in a map, you associate a key object with a value. When you need
      to look up the value, the map retrieves it using the key.</p>
<p id="with_generics_">With generics, a <code class="literal">Map</code> type is
      parameterized with two types: one for the keys and one for the values.
      The following snippet uses a <code class="literal">HashMap</code>,
      which is an efficient type of map implementation that weâ€™ll discuss
      later:</p>
<pre class="programlisting" data-language="java" id="I_11_tt714">    <code class="n">Map</code><code class="o">&lt;</code><code class="n">String</code><code class="o">,</code> <code class="n">Date</code><code class="o">&gt;</code> <code class="n">dateMap</code> <code class="o">=</code> <code class="k">new</code> <code class="n">HashMap</code><code class="o">&lt;</code><code class="n">String</code><code class="o">,</code> <code class="n">Date</code><code class="o">&gt;();</code>
    <code class="n">dateMap</code><code class="o">.</code><code class="na">put</code><code class="o">(</code> <code class="s">"today"</code><code class="o">,</code> <code class="k">new</code> <code class="n">Date</code><code class="o">()</code> <code class="o">);</code>
    <code class="n">Date</code> <code class="n">today</code> <code class="o">=</code> <code class="n">dateMap</code><code class="o">.</code><code class="na">get</code><code class="o">(</code> <code class="s">"today"</code> <code class="o">);</code></pre>
<p id="in_legacy_code">In legacy code, maps simply map <code class="literal">Object</code> types to <code class="literal">Object</code> types and require the appropriate cast
      to retrieve values.</p>
<p id="the_basic_opera">The basic operations on <code class="literal">Map</code> are
      straightforward. In the following methods, the type <code class="literal">K</code> refers to the key parameter type and the
      type <code class="literal">V</code> refers to the value parameter
      type:</p>
<div class="variablelist" id="public_v_put_k"><dl class="variablelist">
<dt><span class="term"><code class="literal">public V put( K</code>
          <em class="replaceable"><code>key</code></em> <code class="literal">,
          V</code> <em class="replaceable"><code>value</code></em> <code class="literal">)</code></span></dt>
<dd><p id="put_methodthi"><a id="id727253" class="indexterm"></a>This method adds the specified key/value pair to the
            map. If the map already contains a value for the specified key,
            the old value is replaced and returned as the result.</p></dd>
<dt><span class="term"><code class="literal">public V get( K</code>
          <em class="replaceable"><code>key</code></em> <code class="literal">)</code></span></dt>
<dd><p id="get_methodmap"><a id="id727282" class="indexterm"></a>This method retrieves the value corresponding to
            <code class="literal">key</code> from the map.</p></dd>
<dt><span class="term"><code class="literal">public V remove( K</code>
          <em class="replaceable"><code>key</code></em> <code class="literal">)</code></span></dt>
<dd><p id="remove_method_id4"><a id="id727319" class="indexterm"></a>This method removes the value corresponding to
            <code class="literal">key</code> from the map. The value
            removed is returned.</p></dd>
<dt><span class="term"><code class="literal">public int size()</code></span></dt>
<dd><p id="size_methodma"><a id="id727347" class="indexterm"></a>Use this method to find the number of key/value
            pairs in this map.</p></dd>
</dl></div>
<p id="you_can_retriev_id2">You can retrieve all the keys or values in the map:</p>
<div class="variablelist" id="public_set_keys"><dl class="variablelist">
<dt><span class="term"><code class="literal">public Set keySet()</code></span></dt>
<dd><p id="keyset_method"><a id="id727382" class="indexterm"></a>This method returns a <code class="literal">Set</code> that contains all the keys in this
            map.</p></dd>
<dt><span class="term"><code class="literal">public Collection
          values()</code></span></dt>
<dd><p id="value_methodu"><a id="id727408" class="indexterm"></a>Use this method to retrieve all the values in this
            map. The returned <code class="literal">Collection</code>
            can contain duplicate elements.</p></dd>
</dl></div>
<p id="map_has_one_chi"><code class="literal">Map</code> has one child interface,
      <a id="id727432" class="indexterm"></a><code class="literal">SortedMap</code>. A <code class="literal">SortedMap</code> maintains its key/value pairs sorted
      in a particular order according to the key values. It provides the
      <a id="id727451" class="indexterm"></a><code class="literal">subMap()</code>, <a id="id727462" class="indexterm"></a><code class="literal">headMap()</code>, and
      <a id="id727474" class="indexterm"></a><code class="literal">tailMap()</code> methods for
      retrieving sorted map subsets. Like <a id="id727486" class="indexterm"></a><code class="literal">SortedSet</code>, it also
      provides a <code class="literal">comparator()</code> method, which
      returns an object that determines how the map keys are sorted. Weâ€™ll
      talk more about that later. Java 7 adds a <a id="id727506" class="indexterm"></a><code class="literal">NavigableMap</code> with
      functionality parallel to that of <code class="literal">NavigableSet</code>; namely, it adds methods to
      search the sorted elements for an element greater or lesser than a
      target value.</p>
<p id="finally_we_sho_id2">Finally, we should make it clear that although related, <code class="literal">Map</code> is not literally a type of <code class="literal">Collection</code> (<code class="literal">Map</code> does not extend the <code class="literal">Collection</code> interface). You might wonder why.
      All of the methods of the <code class="literal">Collection</code>
      interface would appear to make sense for <code class="literal">Map</code>, except for <code class="literal">iterator()</code>. A <code class="literal">Map</code>, again, has two sets of objects: keys and
      values, and separate iterators for each. This is why a <code class="literal">Map</code> does not implement <code class="literal">Collection</code>.</p>
<p id="one_more_note_a">One more note about maps: some map implementations (including
      Javaâ€™s standard <code class="literal">HashMap</code>) allow
      <code class="literal">null</code> to be used as a key or value,
      but others may not.</p>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.4.1">
<div class="titlepage"><div><div><h4 class="title">ConcurrentMap</h4></div></div></div>
<p id="concurrentmap_i_id1"><a id="idx10610" class="indexterm"></a>The <code class="literal">ConcurrentMap</code>
        interface is part of the <code class="literal">java.util.concurrent</code> package. It extends the
        base <code class="literal">Map</code> interface and adds atomic
        put, remove, and replace functionality that is useful for concurrent
        programming:</p>
<div class="variablelist" id="public_v_putifa"><dl class="variablelist">
<dt><span class="term"><code class="literal">public V putIfAbsent( K key, V
            value )</code></span></dt>
<dd><p id="putifabsent_m"><a id="id727675" class="indexterm"></a>This method associates the value with the key only
              if the key was not already in use. If the key exists, no action
              is taken. If the key does not exist, it is created. The
              resulting value (<code class="literal">existing</code> or
              <code class="literal">new</code>) is returned.</p></dd>
<dt><span class="term"><code class="literal">public boolean remove( Object key,
            Object value )</code></span></dt>
<dd><p id="remove_method_id5"><a id="id727709" class="indexterm"></a>This method removes the mapping (key and value)
              only if the current value associated with the key equals the
              supplied value. It returns <code class="literal">true</code> if the value was removed,
              <code class="literal">false</code> if not.</p></dd>
<dt><span class="term"><code class="literal">public boolean replace( K key, V
            existingValue, V newValue)</code></span></dt>
<dd><p id="replace_metho_id2"><a id="id727745" class="indexterm"></a>This method replaces the value associated with the
              key only if the existing value equals the <code class="literal">existingValue</code> argument. It returns
              <code class="literal">true</code> if the value was
              replaced.</p></dd>
<dt><span class="term"><code class="literal">public boolean replace( K key, V
            value )</code></span></dt>
<dd><p id="this_method_rep">This method replaces the value associated with the key
              only if a mapping already exists for the key (i.e., it already
              has some value).<a id="id727784" class="indexterm"></a><a id="id727793" class="indexterm"></a><a id="id727803" class="indexterm"></a></p></dd>
</dl></div>
</div>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.5">
<div class="titlepage"><div><div><h3 class="title">Collection Implementations</h3></div></div></div>
<p id="core_utilitiesc_id4"><a id="idx10611" class="indexterm"></a>Up until this point, weâ€™ve talked only about interfaces.
      But you canâ€™t instantiate interfaces; you need concrete implementations.
      Of course, the Collections Framework includes useful implementations of
      all of the collections interfaces. In some cases, there are several
      alternatives from which to choose. To understand the tradeoffs between
      these implementations, it helps to have a basic understanding of a few
      of the most common data structures used in all programming: arrays,
      linked lists, trees, and hash maps. Many books have been written about
      these data structures, and we will not drag you into the mind-numbing
      details here. Weâ€™ll hit the highlights briefly as a prelude to our
      discussion of the Java implementations. We should stress before we go on
      that the differences in the implementations of Java collections are only
      significant when working with very large numbers of elements or with
      extreme time sensitivity. For the most part, they all behave well enough
      to be interchangeable.</p>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.5.1">
<div class="titlepage"><div><div><h4 class="title">Arrays</h4></div></div></div>
<p id="arrays_collecti"><a id="idx10595" class="indexterm"></a> <a id="idx10602" class="indexterm"></a>It should be fairly obvious that plain old Java arrays,
        shown in <a class="xref" href="ch11.html#learnjava3-CHP-11-FIG-2" title="FigureÂ 11-2.Â Array structure">FigureÂ 11-2</a>, would be good at
        holding an ordered collection of elements. As we mentioned earlier,
        however, one limitation of arrays is that they cannot grow. This means
        that to support a true <code class="literal">Collection</code>,
        arrays must be copied into larger arrays as capacity demands increase.
        Another problem with using arrays for lists is that inserting an
        element into the middle of an array or taking one out generally also
        involves copying large parts of the array to and fro, which is an
        expensive operation.</p>
<div class="figure" id="learnjava3-CHP-11-FIG-2">
<div class="figure-contents"><div class="mediaobject" id="I_11_tt715"><img src="http://orm-chimera-prod.s3.amazonaws.com/1234000001805/figs/lj4e_1102.png" alt="Array structure"></div></div>
<div class="figure-title">FigureÂ 11-2.Â Array structure</div>
</div>
<p id="constant_time_l"><a id="id727948" class="indexterm"></a> <a id="id727954" class="indexterm"></a>Because of this, arrays are described as consuming
        <span class="emphasis"><em>constant time</em></span> for retrieval, but <span class="emphasis"><em>linear
        time</em></span> for insertion into or deletion from the body of the
        array. The term <span class="emphasis"><em>constant time</em></span> here means that, in
        general, the time to retrieve an element stays roughly constant even
        as you add more elements to the array (this is due to the fact that
        arrays are fully indexed). Linear time means that the time to insert
        or delete an element takes longer and longer as the array adds
        elements; the time expense grows linearly with the number of elements.
        There are worse things too: exponential time, as you might imagine,
        means that an algorithm is useless for very large numbers of elements.
        Unless otherwise stated, all of the Java collection implementations
        work in linear time or better.</p>
<p id="arrays_are_usef">Arrays are useful when you are mostly reading or exclusively
        appending to the end of the collection.<a id="id727986" class="indexterm"></a><a id="id727996" class="indexterm"></a></p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.5.2">
<div class="titlepage"><div><div><h4 class="title">Linked lists</h4></div></div></div>
<p id="collectionsimpl_id1"><a id="idx10604" class="indexterm"></a> <a id="idx10648" class="indexterm"></a>A linked list, shown in <a class="xref" href="ch11.html#learnjava3-CHP-11-FIG-3" title="FigureÂ 11-3.Â Linked list structure">FigureÂ 11-3</a>, holds its elements in a chain of
        <a id="id728056" class="indexterm"></a><span class="emphasis"><em>node</em></span>s, each referencing the node
        before and after it (if any). In this way, the linked list forms an
        ordered collection that looks something like an array. Unlike the
        magic of an array, however, to retrieve an element from a linked list,
        you must traverse the list from either the head or tail to reach the
        correct spot. As you might have guessed, this is a linear-time
        operation that gets more expensive as the number of elements grows.
        The flip side is that once youâ€™re at the spot, inserting or deleting
        an element is a piece of cake: simply change the references and youâ€™re
        done. This means that insertions and deletionsâ€”at least near the head
        and tail of a linked listâ€”are said to be in constant time.</p>
<div class="figure" id="learnjava3-CHP-11-FIG-3">
<div class="figure-contents"><div class="mediaobject" id="I_11_tt716"><img src="http://orm-chimera-prod.s3.amazonaws.com/1234000001805/figs/lj4e_1103.png" alt="Linked list structure"></div></div>
<div class="figure-title">FigureÂ 11-3.Â Linked list structure</div>
</div>
<p id="linked_lists_ar">Linked lists are useful when you are doing a lot of insertions
        or deletions on a collection. An interesting variation on the basic
        linked list is the â€œskip list,â€? which is a kind of linked list that
        maintains a hierarchy of references spanning increasing ranges of
        elements instead of only pointing to the next element in the chain.
        The idea is that when you need to jump to the middle, you can use one
        of these â€œexpress laneâ€? pointers to jump to the approximate location
        and then move forward or backward with finer granularity as needed by
        descending the pointer hierarchy. Java 7 adds skip list
        implementations of the <a id="id728117" class="indexterm"></a><code class="literal">NavigableMap</code> and
        <a id="id728129" class="indexterm"></a><code class="literal">NavigableSet</code>
        interfaces in the <code class="literal">java.util.concurrent
        </code>package for concurrent programming.<a id="id728147" class="indexterm"></a><a id="id728156" class="indexterm"></a></p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.5.3">
<div class="titlepage"><div><div><h4 class="title">Trees</h4></div></div></div>
<p id="binary_search_t"><a id="id728179" class="indexterm"></a> <a id="id728185" class="indexterm"></a> <a id="id728197" class="indexterm"></a>A tree is like a linked list in that it holds its
        elements in nodes that point to their neighbors. However, a tree, as
        its name suggests, does not have a linear structure, but instead
        arranges its elements in a cascade of branches like a family tree. The
        power of the tree structure is in sorting and searching elements that
        have a specified order. A <span class="emphasis"><em>binary search tree</em></span>, as
        shown in <a class="xref" href="ch11.html#learnjava3-CHP-11-FIG-4" title="FigureÂ 11-4.Â Tree structure">FigureÂ 11-4</a>, arranges its
        elements such that the children divide up a range of values. One child
        holds values greater than the node and one child holds values lower.
        By applying this knowledge recursively on a properly â€œbalancedâ€? tree,
        we can rapidly find any value. The effort to search the tree is
        described as <span class="emphasis"><em>log(n) time</em></span>, which means that it
        grows only with the logarithm of the number of elements, which is much
        better than the linear time it would take to check all of the elements
        by brute force.</p>
<div class="figure" id="learnjava3-CHP-11-FIG-4">
<div class="figure-contents"><div class="mediaobject" id="I_11_tt717"><img src="http://orm-chimera-prod.s3.amazonaws.com/1234000001805/figs/lj4e_1104.png" alt="Tree structure"></div></div>
<div class="figure-title">FigureÂ 11-4.Â Tree structure</div>
</div>
<p id="trees_are_usefu">Trees are useful for maintaining and searching large collections
        of sorted elements. A similar concept that can be used for data that
        rarely requires updates is to use a plain sorted array with a binary
        search algorithm. In a binary search, you make (exponentially)
        decreasing size jumps into the sorted array to approximate locations
        for the element and then choose your next jump based on whether you
        have overshot or undershot the target. The Java <code class="literal">Arrays</code> class has several <code class="literal">binarySearch()</code> methods that operate on
        different types of arrays.</p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.5.4">
<div class="titlepage"><div><div><h4 class="title">Hash maps</h4></div></div></div>
<p id="collectionsimpl_id2"><a id="idx10603" class="indexterm"></a> <a id="idx10644" class="indexterm"></a>Hash maps are strange and magical beasts. A hash map (or
        hash table, as it is also called) uses a mathematical hash algorithm
        applied to its key value to distribute its element values into a
        series of â€œbuckets.â€? The algorithm relies on the hash algorithm to
        distribute the elements as uniformly (randomly) as possible. To
        retrieve an element by its key simply involves searching the correct
        bucket. Because the hash calculation is fast and can have a large
        number of buckets, there are few elements to search and retrieval is
        very fast. As we described in <a class="xref" href="ch07.html" title="ChapterÂ 7.Â Working with Objects and Classes">ChapterÂ 7</a>, all
        Java <code class="literal">Object</code>s have a hash value as
        determined by the <code class="literal">hashCode()</code>
        method. Weâ€™ll say more about hash codes and key values for maps later
        in this chapter.</p>
<p id="hash_map_perfor">Hash map performance is governed by many factors, including the
        sophistication of the hash algorithm implemented by its elements (see
        <a class="xref" href="ch11.html#learnjava3-CHP-11-FIG-5" title="FigureÂ 11-5.Â Hash map structure">FigureÂ 11-5</a>). In general, with a good
        hash function implementation, the Java <code class="literal">HashMap</code> operates in constant time for
        putting and retrieving elements. Hash maps are fast at mapping
        unsorted collections.<a id="id728366" class="indexterm"></a><a id="id728376" class="indexterm"></a></p>
<div class="figure" id="learnjava3-CHP-11-FIG-5">
<div class="figure-contents"><div class="mediaobject" id="I_11_tt718"><img src="http://orm-chimera-prod.s3.amazonaws.com/1234000001805/figs/lj4e_1105.png" alt="Hash map structure"></div></div>
<div class="figure-title">FigureÂ 11-5.Â Hash map structure</div>
</div>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.5.5">
<div class="titlepage"><div><div><h4 class="title">Java Collections implementations</h4></div></div></div>
<p id="collectionsimpl_id3"><a id="idx10605" class="indexterm"></a> <a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-7" title="TableÂ 11-7.Â Collections Framework implementation classes">TableÂ 11-7</a> lists the
        implementations of the Java Collections Framework by interface
        type.</p>
<div class="table" id="learnjava3-CHP-11-TABLE-7">
<div class="table-title">TableÂ 11-7.Â Collections Framework implementation classes</div>
<div class="table-contents"><table style="border: none;">
<colgroup>
<col class="col1">
<col class="col2">
</colgroup>
<thead><tr>
<td style="text-align: left; "><p id="interface">Interface</p></td>
<td style="text-align: left; "><p id="implementation">Implementation</p></td>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="set_interface_s"> <a id="id728510" class="indexterm"></a> <code class="literal">Set</code>
                </p></td>
<td style="text-align: left; ">
<p id="hashset_class_h_id1"> <a id="id728531" class="indexterm"></a> <code class="literal">HashSet</code>
                </p> <p id="linkedhashset_c"> <a id="id728551" class="indexterm"></a> <code class="literal">LinkedHashSet</code> </p> <p id="copyonwritearra_id1">
                <a id="id728571" class="indexterm"></a> <code class="literal">CopyOnWriteArraySet</code> </p> <p id="enumset">
                <code class="literal">EnumSet</code> </p> <p id="copyonwritearra_id2">
                <code class="literal">CopyOnWriteArraySet</code>
                </p>
</td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="sortedset_inter"> <a id="id728622" class="indexterm"></a> <code class="literal">SortedSet</code>
                </p></td>
<td style="text-align: left; ">
<p id="treeset_class_t_id1"> <a id="id728644" class="indexterm"></a> <code class="literal">TreeSet</code>
                </p> <p id="concurrentskipl_id1"> <a id="id728663" class="indexterm"></a> <code class="literal">ConcurrentSkipListSet</code>
                </p>
</td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="list_interface_"> <a id="id728688" class="indexterm"></a> <code class="literal">List</code>
                </p></td>
<td style="text-align: left; ">
<p id="arraylist_class_id1"> <a id="id728710" class="indexterm"></a> <code class="literal">ArrayList</code>
                </p> <p id="linkedlist_clas_id1"> <a id="id728730" class="indexterm"></a> <code class="literal">LinkedList</code>
                </p> <p id="vector_class_ve"> <a id="id728749" class="indexterm"></a> <code class="literal">Vector</code>
                <a href="#ftn.id728762" class="footnote"><sup class="footnote" id="id728762">[a]</sup></a> </p> <p id="stack_class_sta"> <a id="id728796" class="indexterm"></a> <code class="literal">Stack</code>
                </p> <p id="copyonwritearra_id3"> <a id="id728816" class="indexterm"></a> <code class="literal">CopyOnWriteArrayList</code> </p>
</td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="map_interface_m"> <a id="id728841" class="indexterm"></a> <code class="literal">Map</code>
                </p></td>
<td style="text-align: left; ">
<p id="hashmap"> <code class="literal">HashMap</code> </p> <p id="enummap"> <code class="literal">EnumMap</code> </p> <p id="linkedhashmap_c"> <a id="id728888" class="indexterm"></a> <code class="literal">LinkedHashMap</code> </p> <p id="identityhashmap">
                <a id="id728907" class="indexterm"></a> <code class="literal">IdentityHashMap</code> </p> <p id="hashtable_class">
                <a id="id728927" class="indexterm"></a> <code class="literal">Hashtable</code>
                <sup>a</sup></p>
</td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="concurrentmap_i_id2"> <a id="id728955" class="indexterm"></a> <code class="literal">ConcurrentMap</code> </p></td>
<td style="text-align: left; ">
<p id="concurrenthashm"> <a id="id728977" class="indexterm"></a> <code class="literal">ConcurrentHashMap</code> </p> <p id="concurrentskipl_id2">
                <a id="id728997" class="indexterm"></a> <code class="literal">ConcurrentSkipListMap</code>
                </p>
</td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="sortedmap_inter"> <a id="id729022" class="indexterm"></a> <code class="literal">SortedMap</code>
                </p></td>
<td style="text-align: left; "><p id="treemap_class_t"> <a id="id729044" class="indexterm"></a> <code class="literal">TreeMap</code>
                </p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="queue__dequeue"> <code class="literal">Queue / Dequeue</code> </p></td>
<td style="text-align: left; ">
<p id="linkedlist_clas_id2"> <a id="id729084" class="indexterm"></a> <code class="literal">LinkedList</code>
                </p> <p id="arraydeque_clas"> <a id="id729103" class="indexterm"></a> <code class="literal">ArrayDeque</code>
                </p> <p id="priorityqueue_c"> <a id="id729123" class="indexterm"></a> <code class="literal">PriorityQueue</code> </p> <p id="delayqueue_clas">
                <a id="id729142" class="indexterm"></a> <code class="literal">DelayQueue</code>
                </p> <p id="synchronousqueu"> <a id="id729162" class="indexterm"></a> <code class="literal">SynchronousQueue</code> </p> <p id="concurrentlinke_id1">
                <a id="id729181" class="indexterm"></a> <code class="literal">ConcurrentLinkedQueue</code> </p> <p id="concurrentlinke_id2">
                <a id="id729201" class="indexterm"></a> <code class="literal">ConcurrentLinkedDequeue</code>
                </p>
</td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="blockingqueue_i"> <a id="id729226" class="indexterm"></a> <code class="literal">BlockingQueue</code> </p></td>
<td style="text-align: left; ">
<p id="arrayblockingqu"> <a id="id729248" class="indexterm"></a> <code class="literal">ArrayBlockingQueue</code> </p> <p id="linkedblockingq">
                <a id="id729267" class="indexterm"></a> <code class="literal">LinkedBlockingQueue</code> </p> <p id="priorityblockin">
                <a id="id729287" class="indexterm"></a> <code class="literal">PriorityBlockingQueue</code>
                </p>
</td>
</tr>
</tbody>
<tbody class="footnotes"><tr><td colspan="2"><div id="ftn.id728762" class="footnote"><p><a href="#id728762" class="para"><sup class="para">[a] </sup></a><code class="literal">Vector</code> and
                    <code class="literal">Hashtable</code> are legacy
                    classes and should generally be avoided in favor of
                    <code class="literal">ArrayList</code> and <code class="literal">HashMap</code>, respectively.</p></div></td></tr></tbody>
</table></div>
</div>
<p id="arraylist_class_id2"><a id="id729304" class="indexterm"></a> <code class="literal">ArrayList</code> and
        <code class="literal">LinkedList</code> provide the array and
        linked list implementations of the <code class="literal">List</code> interface that was described earlier.
        <code class="literal">ArrayList</code> is satisfactory for most
        purposes, but you should use <code class="literal">LinkedList</code> when you plan to do a lot of
        insertions or deletions at various points in the list.</p>
<p id="hashset_class_h_id2"><a id="id729348" class="indexterm"></a> <code class="literal">HashSet</code> and
        <a id="id729360" class="indexterm"></a><code class="literal">HashMap</code> provide a
        good hash map implementation of the <code class="literal">Set</code> and <code class="literal">Map</code> interfaces. The <a id="id729384" class="indexterm"></a><code class="literal">LinkedHashSet</code> and
        <code class="literal">LinkedHashMap</code> implementations
        combine the hash algorithm with a linked list that maintains the
        <span class="emphasis"><em>insertion order</em></span> of the elements. Note that these
        linked collections are ordered, but <span class="emphasis"><em>not sorted</em></span>
        collections.</p>
<p id="treeset_class_t_id2"><a id="id729415" class="indexterm"></a> <code class="literal">TreeSet</code> and <code class="literal">TreeMap</code> maintain sorted collections using a
        tree data structure. In the case of <code class="literal">TreeMap</code>, it is the <span class="emphasis"><em>key</em></span>
        values that are sorted. The sorting is accomplished by a comparator
        object. Weâ€™ll discuss sorting later in this chapter.</p>
<p id="queue_is_implem"><code class="literal">Queue</code> is implemented both by
        <code class="literal">LinkedList</code> (which implements
        <code class="literal">List</code>, <code class="literal">Queue</code>, andâ€”as of Java 7, <code class="literal">Deque</code>) and <code class="literal">PriorityQueue</code>. A <code class="literal">PriorityQueue</code>â€™s prioritization comes from a
        sorting order determined by a comparator supplied with its
        constructor. Elements that sort â€œleastâ€? or â€œlowestâ€? have the highest
        priority. The various implementations of <code class="literal">BlockingQueue</code> mirror these for
        concurrency-aware queues.</p>
<p id="finally_identi">Finally, <a id="id729507" class="indexterm"></a><code class="literal">IdentityHashMap</code> is an
        alternate type of <code class="literal">HashMap</code> that uses
        object <span class="emphasis"><em>identity</em></span> instead of object
        <span class="emphasis"><em>equality</em></span> to determine which keys match which
        objects. Normally, any two objects that test equal with <code class="literal">equals()</code> operate as the same key in a
        <code class="literal">Map</code>. With <code class="literal">IdentityHashMap</code>, only the original object
        instance retrieves the element. Weâ€™ll talk about hash codes and keys
        more in the next section.</p>
<p id="we_should_also__id4">We should also mention three specialized collections that weâ€™ll
        talk about later: <code class="literal">EnumSet</code> and
        <code class="literal">EnumMap</code> are specifically designed
        to work with Java enumerations. <code class="literal">WeakHashMap</code> uses weak references to
        cooperate with Java garbage collection.<a id="id729580" class="indexterm"></a><a id="id729590" class="indexterm"></a></p>
</div>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.6">
<div class="titlepage"><div><div><h3 class="title">Hash Codes and Key Values</h3></div></div></div>
<p id="collectionshash"><a id="idx10601" class="indexterm"></a> <a id="idx10616" class="indexterm"></a> <a id="idx10643" class="indexterm"></a> <a id="idx10646" class="indexterm"></a>The term <span class="emphasis"><em>hash</em></span> in <a id="id729676" class="indexterm"></a><code class="literal">Hashtable</code> and
      <a id="id729688" class="indexterm"></a><code class="literal">HashMap</code> refers to the
      key hash value that these collections use to make their associations.
      Specifically, an element in a <code class="literal">Hashtable</code> or <code class="literal">HashMap</code> is not associated with a key strictly
      by the key objectâ€™s identity but rather by a function of the keyâ€™s
      contents. This allows keys that are equivalent to access the same
      object. By â€œequivalent,â€? we mean those objects that compare <code class="literal">true</code> with <code class="literal">equals()</code>. If you store an object in a <code class="literal">Hashtable</code> using one object as a key, you can
      use any other object that <code class="literal">equals()</code>
      tells you is equivalent to retrieve the stored object.</p>
<p id="its_easy_to_se">Itâ€™s easy to see why equivalence is important if you remember our
      discussion of strings. You may create two <code class="literal">String</code> objects that have the same characters
      in them but that are different objects in Java. In this case, the
      <code class="literal">==</code> operator tells you that the
      <code class="literal">String</code> objects are different, but the
      <code class="literal">equals()</code> method of the <code class="literal">String</code> class tells you that they are
      equivalent. Because they are equivalent, if we store an object in a
      <code class="literal">HashMap</code> using one of the <code class="literal">String</code> objects as a key, we can retrieve it
      using the other.</p>
<p id="the_hash_code_o">The hash code of an object makes this association based on
      content. As we mentioned in <a class="xref" href="ch07.html" title="ChapterÂ 7.Â Working with Objects and Classes">ChapterÂ 7</a>, the
      hash code is like a fingerprint of the objectâ€™s data content. <code class="literal">HashMap</code> uses it to store the objects so that
      they can be retrieved efficiently. The hash code is nothing more than a
      number (an integer) that is a function of the data. The number is always
      the same for identical data, but the hashing function is intentionally
      designed to generate as different (random looking) a number as possible
      for different combinations of data. In other words, a very small change
      in the data should produce a big difference in the number. It should be
      unlikely that two nonidentical datasets, even very similar ones, would
      produce the same hash code.</p>
<p id="as_we_described_id1">As we described earlier, internally, <code class="literal">HashMap</code> really just keeps a number of lists of
      objects, but it puts objects into the lists based on their hash code.
      When it wants to find the object again, it can look at the hash code and
      know immediately how to get to the appropriate list. The <code class="literal">HashMap</code> still might end up with a number of
      objects to examine, but the list should be short. For each object in the
      short list it finds, it does the following comparison to see if the key
      matches:</p>
<pre class="programlisting" data-language="java" id="I_11_tt719">    <code class="k">if</code> <code class="o">((</code><code class="n">keyHashcode</code> <code class="o">==</code> <code class="n">storedKeyHashcode</code><code class="o">)</code> <code class="o">&amp;&amp;</code> <code class="n">key</code><code class="o">.</code><code class="na">equals</code><code class="o">(</code><code class="n">storedKey</code><code class="o">))</code>
        <code class="k">return</code> <code class="n">object</code><code class="o">;</code></pre>
<p id="there_is_no_pre">There is no prescribed way to generate hash codes. The only
      requirement is that they be somewhat randomly distributed and
      reproducible (based on the data). This means that two objects that are
      not the same could end up with the same hash code by accident. This is
      unlikely (there are 2<sup>32</sup> possible integer
      values); moreover, it shouldnâ€™t cause a problem because as you can see
      in the preceding snippet, the <code class="literal">HashMap</code>
      ultimately checks the actual keys using <code class="literal">equals()</code>, as well as the hash codes, to find
      the match. Therefore, even if two key objects have the same hash code,
      they can still coexist in the <code class="literal">HashMap</code>
      as long as they donâ€™t test equal to one another as well. (To put it
      another way, if two keysâ€™ hashcodes are the same and the equals method
      says they are the same, then they will be considered the same key and
      retrieve the same value object.)</p>
<p id="hash_codes_are_">Hash codes are computed by an objectâ€™s <code class="literal">hashCode()</code> method, which is inherited from the
      <code class="literal">Object</code> class if it isnâ€™t overridden.
      The default <code class="literal">hashCode()</code> method simply
      assigns each object instance a unique number to be used as a hash code.
      If a class does not override this method, each instance of the class
      will have a unique hash code. This goes along well with the default
      implementation of <code class="literal">equals()</code> in
      <code class="literal">Object</code>, which only compares objects
      for identity using <code class="literal">==</code>; the effect
      being that these arbitrary objects serve as unique keys in maps.</p>
<p id="you_must_overri">You must override <code class="literal">equals()</code> in
      any classes for which equivalence of different objects is meaningful.
      Likewise, if you want equivalent objects to serve as equivalent keys,
      you must override the <code class="literal">hashCode()</code>
      method as well to return identical hash code values. To do this, you
      need to create some suitably randomizing, arbitrary function of the
      contents of your object. The only criterion for the function is that it
      should be almost certain to return different values for objects with
      different data, but the same value for objects with identical
      data.<a id="id730034" class="indexterm"></a><a id="id730044" class="indexterm"></a><a id="id730054" class="indexterm"></a><a id="id730064" class="indexterm"></a></p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.7">
<div class="titlepage"><div><div><h3 class="title">Synchronized and Unsynchronized Collections</h3></div></div></div>
<p id="the_javautilc_id4">The <code class="literal">java.util.Collections</code> class
      contains important static utility methods for working with <code class="literal">Set</code>s and <code class="literal">Map</code>s. All the methods in <code class="literal">Collections</code> operate on interfaces, so they
      work regardless of the actual implementation classes youâ€™re using. The
      first methods weâ€™ll look at involve creating synchronized versions of
      our collections.</p>
<p id="most_of_the_def">Most of the default collection implementations are not
      synchronized; that is, they are not safe for concurrent access by
      multiple threads. The reason for this is performance. In many
      applications, there is no need for synchronization, so the Collections
      API does not provide it by default. Instead, you can create a
      synchronized version of any collection using the following methods of
      the <code class="literal">Collections</code> class:</p>
<pre class="programlisting" data-language="java" id="I_11_tt720">    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Collection</code> <code class="nf">synchronizedCollection</code><code class="o">(</code><code class="n">Collection</code> <code class="n">c</code><code class="o">)</code>
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Set</code> <code class="nf">synchronizedSet</code><code class="o">(</code><code class="n">Set</code> <code class="n">s</code><code class="o">)</code>
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">List</code> <code class="nf">synchronizedList</code><code class="o">(</code><code class="n">List</code> <code class="n">list</code><code class="o">)</code>
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Map</code> <code class="nf">synchronizedMap</code><code class="o">(</code><code class="n">Map</code> <code class="n">m</code><code class="o">)</code>
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">SortedSet</code> <code class="nf">synchronizedSortedSet</code><code class="o">(</code><code class="n">SortedSet</code> <code class="n">s</code><code class="o">)</code>
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">SortedMap</code> <code class="nf">synchronizedSortedMap</code><code class="o">(</code><code class="n">SortedMap</code> <code class="n">m</code><code class="o">)</code></pre>
<p id="these_methods_r">These methods return synchronized, threadsafe versions of the
      supplied collection, by wrapping them (in a new object that implements
      the same interface and delegates the calls to the underlying
      collection). For example, the following shows how to create a threadsafe
      <code class="literal">List</code>:</p>
<pre class="programlisting" data-language="java" id="I_11_tt721">    <code class="n">List</code> <code class="n">list</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayList</code><code class="o">();</code>
    <code class="n">List</code> <code class="n">syncList</code> <code class="o">=</code> <code class="n">Collections</code><code class="o">.</code><code class="na">synchronizedList</code><code class="o">(</code><code class="n">list</code><code class="o">);</code></pre>
<p id="multiple_thread_id2">Multiple threads can call methods on this list safely and they
      will block as necessary to wait for the other threads to
      complete.</p>
<p id="in_contrast_to__id1">In contrast to the norm, the older <code class="literal">Hashtable</code> and <code class="literal">Vector</code> collections are synchronized by default
      (and, therefore, may be a bit slower when thatâ€™s not needed). The â€œcopy
      on writeâ€? collection implementations that weâ€™ll talk about later also do
      not require synchronization for their special applications. Finally, the
      <code class="literal">ConcurrentHashMap</code> and <code class="literal">ConcurrentLinkedQueue</code> implementations that
      weâ€™ll cover later are threadsafe and designed specifically to support a
      high degree of concurrent access <span class="emphasis"><em>without</em></span> incurring
      a significant penalty for their internal synchronization.</p>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.7.1">
<div class="titlepage"><div><div><h4 class="title">Synchronizing iterators</h4></div></div></div>
<p id="collectionssync_id1"><a id="id730536" class="indexterm"></a> <a id="id730547" class="indexterm"></a> <a id="idx10676" class="indexterm"></a>This is important, so remember this! Although
        synchronized collections are threadsafe, the <a id="id730573" class="indexterm"></a><code class="literal">Iterator</code>s returned
        from them are not. If you obtain an <code class="literal">Iterator</code> from a collection, you should do
        your own synchronization to ensure that the collection does not change
        as youâ€™re iterating through its elements. A convention does this by
        synchronizing on the collection itself with a <code class="literal">synchronized</code> block:</p>
<pre class="programlisting" data-language="java" id="I_11_tt722">    <code class="kd">synchronized</code><code class="o">(</code><code class="n">syncList</code><code class="o">)</code> <code class="o">{</code>
        <code class="n">Iterator</code> <code class="n">iterator</code> <code class="o">=</code> <code class="n">syncList</code><code class="o">.</code><code class="na">iterator</code><code class="o">();</code>
        <code class="c1">// do stuff with the iterator here</code>
    <code class="o">}</code></pre>
<p id="if_you_do_not_s">If you do not synchronize on the collection while iterating and
        the collection changes, Java attempts to throw a <a id="id730687" class="indexterm"></a><code class="literal">ConcurrentModificationException</code>. However,
        this is not guaranteed.<a id="id730699" class="indexterm"></a></p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.7.2">
<div class="titlepage"><div><div><h4 class="title">ConcurrentHashMap and ConcurrentLinkedQueue</h4></div></div></div>
<p id="collectionssync_id2"><a id="idx10607" class="indexterm"></a><a id="idx10608" class="indexterm"></a> <a id="idx10609" class="indexterm"></a> <a id="idx10671" class="indexterm"></a> <a id="idx10675" class="indexterm"></a>The <code class="literal">java.util.concurrent.ConcurrentHashMap</code> class
        is part of the concurrency utilities package and provides a <code class="literal">Map</code> that performs well under multithreaded
        access. A <code class="literal">ConcurrentHashMap</code> is safe
        for access from multiple threads, but it does not necessarily block
        threads during operations. Instead, some degree of overlapping
        operations, such as concurrent reads, are permitted safely. The
        <code class="literal">ConcurrentHashMap</code> can even allow a
        limited number of concurrent writes to happen while reads are being
        performed. These operations and iterators over the map do not throw a
        <code class="literal">ConcurrentModificationException</code>,
        but no guarantees are made as to exactly when one thread will see
        another threadâ€™s work. All views of the map are based upon the most
        recently committed writes.</p>
<p id="similarly_the__id1">Similarly, the <code class="literal">ConcurrentLinkedQueue</code> implementation
        provides the same sort of benefits for a linked queue, allowing some
        degree of overlapping writes and reads by concurrent users.<a id="id730849" class="indexterm"></a><a id="id730859" class="indexterm"></a><a id="id730869" class="indexterm"></a><a id="id730878" class="indexterm"></a><a id="id730888" class="indexterm"></a></p>
</div>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.8">
<div class="titlepage"><div><div><h3 class="title">Read-Only and Read-Mostly Collections</h3></div></div></div>
<p id="collectionsread"><a id="id730911" class="indexterm"></a> <a id="id730920" class="indexterm"></a> <a id="id730927" class="indexterm"></a> <a id="id730939" class="indexterm"></a>You can use the <code class="literal">Collections</code> class to create read-only versions
      of any collection:</p>
<pre class="programlisting" data-language="java" id="I_11_tt723">    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Collection</code> <code class="nf">unmodifiableCollection</code><code class="o">(</code><code class="n">Collection</code> <code class="n">c</code><code class="o">)</code>
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Set</code> <code class="nf">unmodifiableSet</code><code class="o">(</code><code class="n">Set</code> <code class="n">s</code><code class="o">)</code>
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">List</code> <code class="nf">unmodifiableList</code><code class="o">(</code><code class="n">List</code> <code class="n">list</code><code class="o">)</code>
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">Map</code> <code class="nf">unmodifiableMap</code><code class="o">(</code><code class="n">Map</code> <code class="n">m</code><code class="o">)</code>
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">SortedSet</code> <code class="nf">unmodifiableSortedSet</code><code class="o">(</code><code class="n">SortedSet</code> <code class="n">s</code><code class="o">)</code>
    <code class="kd">public</code> <code class="kd">static</code> <code class="n">SortedMap</code> <code class="nf">unmodifiableSortedMap</code><code class="o">(</code><code class="n">SortedMap</code> <code class="n">m</code><code class="o">)</code></pre>
<p id="making_unmodifi">Making unmodifiable versions of collections is a useful way to
      ensure that a collection handed off to another part of your code is not
      modified intentionally or inadvertently. Attempting to modify a
      read-only collection results in an <a id="id731208" class="indexterm"></a><code class="literal">UnsupportedOperationException</code>.</p>
<div class="sect3" id="learnjava3-CHP-11-SECT-4.8.1">
<div class="titlepage"><div><div><h4 class="title">Copy-on-write (â€œread-mostlyâ€?) collections</h4></div></div></div>
<p id="copyonwrite_"><a id="id731233" class="indexterm"></a> <a id="id731240" class="indexterm"></a>The <code class="literal">java.util.concurrent</code> package contains the
        <a id="id731253" class="indexterm"></a><a id="id731259" class="indexterm"></a><code class="literal">CopyOnWriteArrayList</code>
        and <code class="literal">CopyOnWriteArraySet List</code> and
        <code class="literal">Set</code> implementations. These classes
        are threadsafe and do not require explicit synchronization, but are
        heavily optimized for read operations. Any write operation causes the
        entire data structure to be copied internally in a blocking operation.
        The advantage is that if you are almost always reading, these
        implementations are extremely fast and no synchronization is
        required.</p>
</div>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.9">
<div class="titlepage"><div><div><h3 class="title">WeakHashMap</h3></div></div></div>
<p id="collectionsweak"><a id="id731298" class="indexterm"></a> <a id="id731307" class="indexterm"></a> <a id="id731319" class="indexterm"></a>In <a class="xref" href="ch05.html" title="ChapterÂ 5.Â Objects in Java">ChapterÂ 5</a>, we introduced the
      idea of weak referencesâ€”object references that donâ€™t prevent their
      objects from being removed by the garbage collector. <code class="literal">WeakHashMap</code> is an implementation of <code class="literal">Map</code> that makes use of weak references in its
      keys and values. This means that you donâ€™t have to remove key/value
      pairs from a <code class="literal">Map</code> when youâ€™re finished
      with them. Normally, if you removed all references to a key object from
      the rest of your application, the <code class="literal">Map</code>
      would still contain a reference and keep the object â€œalive,â€? preventing
      garbage collection. <code class="literal">WeakHashMap</code>
      changes this; once you remove all references to a key object from the
      rest of the application, the <code class="literal">WeakHashMap</code> lets go of it, too and both the
      key and its corresponding value (if it is similarly unreferenced) are
      eligible for garbage collection.</p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.10">
<div class="titlepage"><div><div><h3 class="title">EnumSet and EnumMap</h3></div></div></div>
<p id="collectionsenum"><a id="idx10599" class="indexterm"></a> <a id="idx10614" class="indexterm"></a> <a id="idx10642" class="indexterm"></a> <code class="literal">EnumSet</code> and <code class="literal">EnumMap</code> are collections designed to work
      specifically with the limited domain of objects defined by a Java
      enumerated type. (Enums are discussed in <span class="keep-together"><a class="xref" href="ch05.html" title="ChapterÂ 5.Â Objects in Java">ChapterÂ 5</a>.)</span> Java
      enums are Java objects and there is no reason you canâ€™t use them as keys
      or values in collections otherwise. However, the <code class="literal">EnumSet</code> and <code class="literal">EnumMap</code> classes are highly optimized, taking
      advantage of the knowledge that the set or keys in the map,
      respectively, may be one of only a few individual objects. With this
      knowledge, storage can be compact and fast using bit fields internally.
      The idea is to make using collection operations on enumerations
      efficient enough to replace the general usage pattern of bit-flags and
      make binary logic operations unnecessary. Instead of using:</p>
<pre class="programlisting" data-language="java" id="I_11_tt724">    <code class="kt">int</code> <code class="n">flags</code> <code class="o">=</code> <code class="n">getFlags</code><code class="o">();</code>
    <code class="k">if</code> <code class="o">(</code> <code class="n">flags</code> <code class="o">&amp;</code> <code class="o">(</code> <code class="n">Constants</code><code class="o">.</code><code class="na">ERROR</code> <code class="o">|</code> <code class="n">Constants</code><code class="o">.</code><code class="na">WARNING</code> <code class="o">)</code> <code class="o">!=</code> <code class="mi">0</code> <code class="o">)</code></pre>
<p id="we_could_use_se">we could use set operations:</p>
<pre class="programlisting" data-language="java" id="I_11_tt725">    <code class="n">EnumSet</code> <code class="n">flags</code> <code class="o">=</code> <code class="n">getFlags</code><code class="o">();</code>
    <code class="k">if</code> <code class="o">(</code> <code class="n">flags</code><code class="o">.</code><code class="na">contains</code><code class="o">(</code> <code class="n">Constants</code><code class="o">.</code><code class="na">Error</code><code class="o">)</code> <code class="o">||</code> 
        <code class="n">flags</code><code class="o">.</code><code class="na">contains</code><code class="o">(</code> <code class="n">Constants</code><code class="o">.</code><code class="na">Warning</code> <code class="o">)</code> <code class="o">)</code></pre>
<p id="this_code_may_n">This code may not be as terse, but it is easier to understand and
      should be just as fast.<a id="id731737" class="indexterm"></a><a id="id731746" class="indexterm"></a><a id="id731756" class="indexterm"></a></p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.11">
<div class="titlepage"><div><div><h3 class="title">Sorting Collections</h3></div></div></div>
<p id="collectionssort"><a id="id731778" class="indexterm"></a> <a id="id731787" class="indexterm"></a> <a id="id731799" class="indexterm"></a>The Collections utilities include methods for performing
      common operations like sorting. Sorting comes in two varieties:</p>
<div class="variablelist" id="public_static_v_id1"><dl class="variablelist">
<dt><span class="term"><code class="literal">public static void
          sort(List</code> <em class="replaceable"><code>list</code></em> <code class="literal">)</code></span></dt>
<dd><p id="sort_methodth"><a id="id731836" class="indexterm"></a>This method sorts the given list. You can use this
            method only on lists whose <span class="keep-together">elements</span> implement the <code class="literal">java.lang.Comparable</code> interface. Luckily,
            many classes already implement this interface, including <code class="literal">String</code>, <code class="literal">Date</code>, <code class="literal">BigInteger</code>, and the wrapper classes for
            the primitive types (<code class="literal">Integer</code>,
            <code class="literal">Double</code>, etc.).</p></dd>
<dt><span class="term"><code class="literal">public static void
          sort(List</code> <em class="replaceable"><code>list</code></em>, <code class="literal">Comparator</code><em class="replaceable"><code>c</code></em><code class="literal">)</code></span></dt>
<dd><p id="use_this_method_id2">Use this method to sort a list whose elements donâ€™t
            implement the <code class="literal">Comparable</code>
            interface. The supplied <code class="literal">java.util.Comparator</code> does the work of
            comparing elements. You might, for example, write an <code class="literal">ImaginaryNumber</code> class and want to sort a
            list of them. You would then create a <code class="literal">Comparator</code> implementation that knew how
            to compare two imaginary numbers.</p></dd>
</dl></div>
<p id="the_sorted_coll">The sorted collections we discussed earlier, <code class="literal">SortedSet</code> and <code class="literal">SortedMap</code>, maintain their collections in a
      specified order using the <code class="literal">Comparable</code>
      interface of their elements. If the elements do not implement <code class="literal">Comparable</code>, you must supply a <code class="literal">Comparator</code> object yourself in the constructor
      of the implementation. For example:</p>
<pre class="programlisting" data-language="java" id="I_11_tt726">    <code class="n">Comparator</code> <code class="n">myComparator</code> <code class="o">=</code> <code class="o">...</code>
    <code class="n">SortedSet</code> <code class="n">mySet</code> <code class="o">=</code> <code class="k">new</code> <code class="n">TreeSet</code><code class="o">(</code> <code class="n">myComparator</code> <code class="o">);</code></pre>
<p id="collections_giv">Collections give you some other interesting capabilities, too. If
      youâ€™re interested in learning more, check out the <code class="literal">min()</code>, <code class="literal">max()</code>, <code class="literal">binarySearch()</code>, and <code class="literal">reverse()</code> methods.</p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-4.12">
<div class="titlepage"><div><div><h3 class="title">A Thrilling Example</h3></div></div></div>
<p id="collectionsexam"><a id="idx10600" class="indexterm"></a> <a id="idx10615" class="indexterm"></a>Collections is a bread-and-butter topic, which means itâ€™s
      hard to create exciting examples. The example in this section reads a
      text file, parses all its words, counts the number of occurrences, sorts
      them, and writes the results to another file. It gives you a good feel
      for how to use collections in your own programs. This example also shows
      features including generics, autoboxing, and the <code class="literal">Scanner</code> API.</p>
<pre class="programlisting" data-language="java" id="I_11_tt727">    <code class="kn">import</code> <code class="nn">java.io.*</code><code class="o">;</code>
    <code class="kn">import</code> <code class="nn">java.util.*</code><code class="o">;</code>
    <code class="err">Â </code>
    <code class="kd">public</code> <code class="kd">class</code> <code class="nc">WordSort</code>
    <code class="o">{</code>
      <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code><code class="o">[]</code> <code class="n">args</code><code class="o">)</code> <code class="kd">throws</code> <code class="n">IOException</code>
      <code class="o">{</code>
        <code class="k">if</code> <code class="o">(</code> <code class="n">args</code><code class="o">.</code><code class="na">length</code> <code class="o">&lt;</code> <code class="mi">2</code> <code class="o">)</code> <code class="o">{</code>
          <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Usage: WordSort inputfile outputfile"</code><code class="o">);</code>
          <code class="k">return</code><code class="o">;</code>
        <code class="o">}</code>
        <code class="n">String</code> <code class="n">inputfile</code> <code class="o">=</code> <code class="n">args</code><code class="o">[</code><code class="mi">0</code><code class="o">];</code>
        <code class="n">String</code> <code class="n">outputfile</code> <code class="o">=</code> <code class="n">args</code><code class="o">[</code><code class="mi">1</code><code class="o">];</code>
    <code class="err">Â </code>
        <code class="cm">/*  Create the word map. Each key is a word and each value is an</code>
<code class="cm">            Integer that represents the number of times the word occurs</code>
<code class="cm">            in the input file.</code>
<code class="cm">        */</code>
        <code class="n">Map</code><code class="o">&lt;</code><code class="n">String</code><code class="o">,</code><code class="n">Integer</code><code class="o">&gt;</code> <code class="n">map</code> <code class="o">=</code> <code class="k">new</code> <code class="n">TreeMap</code><code class="o">&lt;&gt;();</code>
    <code class="err">Â </code>
        <code class="n">Scanner</code> <code class="n">scanner</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Scanner</code><code class="o">(</code> <code class="k">new</code> <code class="n">File</code><code class="o">(</code><code class="n">inputfile</code><code class="o">)</code> <code class="o">);</code>
        <code class="k">while</code> <code class="o">(</code> <code class="n">scanner</code><code class="o">.</code><code class="na">hasNext</code><code class="o">()</code> <code class="o">)</code> <code class="o">{</code>
            <code class="n">String</code> <code class="n">word</code> <code class="o">=</code> <code class="n">scanner</code><code class="o">.</code><code class="na">next</code><code class="o">();</code>
            <code class="n">Integer</code> <code class="n">count</code> <code class="o">=</code> <code class="n">map</code><code class="o">.</code><code class="na">get</code><code class="o">(</code> <code class="n">word</code> <code class="o">);</code>
            <code class="n">count</code> <code class="o">=</code> <code class="o">(</code> <code class="n">count</code> <code class="o">==</code> <code class="kc">null</code> <code class="o">?</code> <code class="mi">1</code> <code class="o">:</code> <code class="n">count</code> <code class="o">+</code><code class="mi">1</code> <code class="o">);</code>
            <code class="n">map</code><code class="o">.</code><code class="na">put</code><code class="o">(</code> <code class="n">word</code><code class="o">,</code> <code class="n">count</code> <code class="o">);</code>
        <code class="o">}</code>
        <code class="n">scanner</code><code class="o">.</code><code class="na">close</code><code class="o">();</code>
    <code class="err">Â </code>
        <code class="c1">// get the map's keys</code>
        <code class="n">List</code><code class="o">&lt;</code><code class="n">String</code><code class="o">&gt;</code> <code class="n">keys</code> <code class="o">=</code> <code class="k">new</code> <code class="n">ArrayList</code><code class="o">&lt;&gt;(</code> <code class="n">map</code><code class="o">.</code><code class="na">keySet</code><code class="o">()</code> <code class="o">);</code>
    <code class="err">Â </code>
        <code class="c1">// write the results to the output file</code>
        <code class="n">PrintWriter</code> <code class="n">out</code> <code class="o">=</code> <code class="k">new</code> <code class="n">PrintWriter</code><code class="o">(</code> <code class="k">new</code> <code class="n">FileWriter</code><code class="o">(</code><code class="n">outputfile</code><code class="o">)</code> <code class="o">);</code>
        <code class="k">for</code> <code class="o">(</code> <code class="n">String</code> <code class="n">key</code> <code class="o">:</code> <code class="n">keys</code> <code class="o">)</code>
          <code class="n">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="n">key</code> <code class="o">+</code> <code class="s">" : "</code> <code class="o">+</code> <code class="n">map</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="n">key</code><code class="o">)</code> <code class="o">);</code>
        <code class="n">out</code><code class="o">.</code><code class="na">close</code><code class="o">();</code>
      <code class="o">}</code>
    <code class="o">}</code></pre>
<p id="suppose_for_ex">Suppose, for example, that you have an input file named
      <span class="emphasis"><em>Ian Moore.txt</em></span>:</p>
<pre class="programlisting" data-language="java" id="I_11_tt728">    <code class="n">Well</code> <code class="n">it</code> <code class="n">was</code> <code class="n">my</code> <code class="n">love</code> <code class="n">that</code> <code class="n">kept</code> <code class="n">you</code> <code class="n">going</code>
    <code class="n">Kept</code> <code class="n">you</code> <code class="n">strong</code> <code class="n">enough</code> <code class="n">to</code> <code class="n">fall</code>
    <code class="n">And</code> <code class="n">it</code> <code class="n">was</code> <code class="n">my</code> <code class="n">heart</code> <code class="n">you</code> <code class="n">were</code> <code class="n">breaking</code>
    <code class="n">When</code> <code class="n">he</code> <code class="n">hurt</code> <code class="n">your</code> <code class="n">pride</code>

    <code class="n">So</code> <code class="n">how</code> <code class="n">does</code> <code class="n">it</code> <code class="n">feel</code>
    <code class="n">How</code> <code class="n">does</code> <code class="n">it</code> <code class="n">feel</code>
    <code class="n">How</code> <code class="n">does</code> <code class="n">it</code> <code class="n">feel</code>
    <code class="n">How</code> <code class="n">does</code> <code class="n">it</code> <code class="n">feel</code></pre>
<p id="you_could_run_t">You could run the example on this file using the following
      command:</p>
<pre class="programlisting" data-language="java" id="I_11_tt729">    <code class="o">%</code> <strong class="userinput"><code><code class="n">java</code> <code class="n">WordSort</code> <code class="s">"Ian Moore.txt"</code> <code class="n">count</code><code class="o">.</code><code class="na">txt</code></code></strong></pre>
<p id="the_output_file">The output file, <span class="emphasis"><em>count.txt</em></span>, looks like
      this:</p>
<pre class="programlisting" data-language="java" id="I_11_tt730">    <code class="n">And</code> <code class="o">:</code> <code class="mi">1</code>
    <code class="n">How</code> <code class="o">:</code> <code class="mi">3</code>
    <code class="n">Kept</code> <code class="o">:</code> <code class="mi">1</code>
    <code class="n">So</code> <code class="o">:</code> <code class="mi">1</code>
    <code class="n">Well</code> <code class="o">:</code> <code class="mi">1</code>
    <code class="n">When</code> <code class="o">:</code> <code class="mi">1</code>
    <code class="n">breaking</code> <code class="o">:</code> <code class="mi">1</code>
    <code class="n">does</code> <code class="o">:</code> <code class="mi">4</code>
    <code class="n">enough</code> <code class="o">:</code> <code class="mi">1</code>
    <code class="o">...</code></pre>
<p id="the_results_are_id1">The results are case-sensitive: â€œHowâ€? and â€œhowâ€? are recorded
      separately. You could modify this behavior by converting words to all
      lowercase after retrieving them from the <code class="literal">Scanner</code>.<a id="id733610" class="indexterm"></a><a id="id733619" class="indexterm"></a></p>
</div>
</div>
<div class="sect1" data-original-filename="ch11.xml" id="learnjava3-CHP-11-SECT-5">
<div class="titlepage"><div><div><h2 class="title">Properties</h2></div></div></div>
<p id="the_properties__id1">The <a id="id733645" class="indexterm"></a><code class="literal">java.util.Properties</code>
    class is a specialized hash table for strings. Properties are generally
    used to hold textual configuration data. Examples of this are the Java
    System properties, which are passed to a Java application on the command
    line. Weâ€™ll cover those later in this section. More generally, you can use
    a <code class="literal">Properties</code> table to hold arbitrary
    configuration information for an application in an easily accessible
    format. The neat thing about a <code class="literal">Properties</code> object is that it can load and store
    its information in a plain text or XML text format using streams (see
    <a class="xref" href="ch12.html" title="ChapterÂ 12.Â Input/Output Facilities">ChapterÂ 12</a> for information on streams).</p>
<p id="any_string_valu">Any string values can be stored as key/value pairs in a <code class="literal">Properties</code> table. However, the convention is to
    use a dot-separated naming hierarchy to group property names into logical
    structures. (Unfortunately, this is just a convention, and you canâ€™t
    really work with groups of properties in a hierarchical way as this might
    imply.) For example, you can create an empty <code class="literal">Properties</code> object and add <code class="literal">String</code> key/value pairs just as you could with a
    <code class="literal">Map</code>:</p>
<pre class="programlisting" data-language="java" id="I_11_tt731">    <code class="n">Properties</code> <code class="n">props</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Properties</code><code class="o">();</code>
    <code class="n">props</code><code class="o">.</code><code class="na">setProperty</code><code class="o">(</code><code class="s">"myApp.xsize"</code><code class="o">,</code> <code class="s">"52"</code><code class="o">);</code>
    <code class="n">props</code><code class="o">.</code><code class="na">setProperty</code><code class="o">(</code><code class="s">"myApp.ysize"</code><code class="o">,</code> <code class="s">"79"</code><code class="o">);</code></pre>
<p id="thereafter_you">Thereafter, you can retrieve values with the <a id="id733837" class="indexterm"></a><code class="literal">getProperty()</code>
    method:</p>
<pre class="programlisting" data-language="java" id="I_11_tt732">    <code class="n">String</code> <code class="n">xsize</code> <code class="o">=</code> <code class="n">props</code><code class="o">.</code><code class="na">getProperty</code><code class="o">(</code> <code class="s">"myApp.xsize"</code> <code class="o">);</code></pre>
<p id="if_the_named_pr">If the named property doesnâ€™t exist, <code class="literal">getProperty()</code> returns <code class="literal">null</code>. You can get an <code class="literal">Enumeration</code> of the property names with the
    <a id="id733928" class="indexterm"></a><code class="literal">propertyNames()</code>
    method:</p>
<pre class="programlisting" data-language="java" id="I_11_tt733">    <code class="k">for</code> <code class="o">(</code> <code class="n">Enumeration</code> <code class="n">e</code> <code class="o">=</code> <code class="n">props</code><code class="o">.</code><code class="na">propertyNames</code><code class="o">();</code> <code class="n">e</code><code class="o">.</code><code class="na">hasMoreElements</code><code class="o">();</code> <code class="o">)</code> <code class="o">{</code>
        <code class="n">String</code> <code class="n">name</code> <code class="o">=</code> <code class="n">e</code><code class="o">.</code><code class="na">nextElement</code><code class="o">();</code>
        <code class="o">...</code>
    <code class="o">}</code></pre>
<p id="when_you_create_id1">When you create a <code class="literal">Properties</code>
    object, you can specify a second object for default property
    values:</p>
<pre class="programlisting" data-language="java" id="I_11_tt734">    <code class="n">Properties</code> <code class="n">defaults</code> <code class="o">=</code> <code class="o">...</code>
    <code class="n">Properties</code> <code class="n">props</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Properties</code><code class="o">(</code> <code class="n">defaults</code> <code class="o">);</code></pre>
<p id="now_when_you_c">Now, when you call <code class="literal">getProperty()</code>,
    the method searches the default table if it doesnâ€™t find the named
    property in the current table. An alternative version of <code class="literal">getProperty()</code> also accepts a default value; this
    value is returned instead of <code class="literal">null</code> if
    the property is not found in the current or default lists:</p>
<pre class="programlisting" data-language="java" id="I_11_tt735">    <code class="n">String</code> <code class="n">xsize</code> <code class="o">=</code> <code class="n">props</code><code class="o">.</code><code class="na">getProperty</code><code class="o">(</code> <code class="s">"myApp.xsize"</code><code class="o">,</code> <code class="s">"50"</code> <code class="o">);</code></pre>
<div class="sect2" id="learnjava3-CHP-11-SECT-5.1">
<div class="titlepage"><div><div><h3 class="title">Loading and Storing</h3></div></div></div>
<p id="core_utilitiesp_id1"><a id="idx10634" class="indexterm"></a> <a id="idx10650" class="indexterm"></a> <a id="idx10667" class="indexterm"></a> <a id="idx10670" class="indexterm"></a>You can save a <code class="literal">Properties</code> table to an <code class="literal">OutputStream</code> using the <a id="id734328" class="indexterm"></a><code class="literal">save()</code> method. The
      property information is output in a flat ASCII format. Weâ€™ll talk about
      I/O in the next chapter, but bear with us for now. Continuing with the
      previous example, output the property information using the <code class="literal">System.out</code> stream as follows:</p>
<pre class="programlisting" data-language="java" id="I_11_tt736">    <code class="n">props</code><code class="o">.</code><code class="na">save</code><code class="o">(</code> <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">,</code> <code class="s">"Application Parameters"</code> <code class="o">);</code></pre>
<p id="systemout_is_a"><code class="literal">System.out</code> is a standard output
      stream that prints to the console or command line of an application. We
      could also save the information to a file using a <code class="literal">FileOutputStream</code> as the first argument to
      <code class="literal">save()</code>. The second argument to
      <code class="literal">save()</code> is a <code class="literal">String</code> that is used as a header for the data.
      The previous code outputs something like the following to <code class="literal">System.out</code>:</p>
<pre class="programlisting" data-language="java" id="I_11_tt737">    <code class="err">#</code><code class="n">Application</code> <code class="n">Parameters</code>
    <code class="err">#</code><code class="n">Mon</code> <code class="n">Feb</code> <code class="mi">12</code> <code class="mi">09</code><code class="o">:</code><code class="mi">24</code><code class="o">:</code><code class="mi">23</code> <code class="n">CST</code> <code class="mi">2001</code>
    <code class="n">myApp</code><code class="o">.</code><code class="na">ysize</code><code class="o">=</code><code class="mi">79</code>
    <code class="n">myApp</code><code class="o">.</code><code class="na">xsize</code><code class="o">=</code><code class="mi">52</code></pre>
<p id="the_load_meth">The <a id="id734577" class="indexterm"></a><code class="literal">load()</code> method reads the
      previously saved contents of a <code class="literal">Properties</code> object from an <code class="literal">InputStream</code>:</p>
<pre class="programlisting" data-language="java" id="I_11_tt738">    <code class="n">FileInputStream</code> <code class="n">fin</code><code class="o">;</code>
    <code class="o">...</code>
    <code class="n">Properties</code> <code class="n">props</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Properties</code><code class="o">()</code>
    <code class="n">props</code><code class="o">.</code><code class="na">load</code><code class="o">(</code> <code class="n">fin</code> <code class="o">);</code></pre>
<p id="the_list_meth">The <a id="id734696" class="indexterm"></a><code class="literal">list()</code> method is useful
      for debugging. It prints the contents to an <code class="literal">OutputStream</code> in a format that is more
      human-readable but not retrievable by <code class="literal">load()</code>. It truncates long lines with an
      ellipsis (<code class="literal">...</code>).</p>
<p id="the_properties__id2">The <code class="literal">Properties</code> class also
      contains <a id="id734741" class="indexterm"></a><code class="literal">storeToXML()</code> and
      <a id="id734753" class="indexterm"></a><code class="literal">loadFromXML()</code> methods.
      These operate just like the <code class="literal">save()</code>
      and <code class="literal">load()</code> methods but write an XML
      file like the following:</p>
<pre class="programlisting" data-language="java" id="xml_version_id1">    <code class="o">&lt;?</code><code class="n">xml</code> <code class="n">version</code><code class="o">=</code><code class="s">"1.0"</code> <code class="n">encoding</code><code class="o">=</code><code class="s">"UTF-8"</code><code class="o">?&gt;</code>
    <code class="o">&lt;!</code><code class="n">DOCTYPE</code> <code class="n">properties</code> <code class="n">SYSTEM</code> <code class="s">"http://java.sun.com/dtd/properties.dtd"</code>
    <code class="o">&gt;</code>
    <code class="o">&lt;</code><code class="n">properties</code><code class="o">&gt;</code>
    <code class="o">&lt;</code><code class="n">comment</code><code class="o">&gt;</code><code class="n">My</code> <code class="n">Properties</code><code class="o">&lt;/</code><code class="n">comment</code><code class="o">&gt;</code>
    <code class="o">&lt;</code><code class="n">entry</code> <code class="n">key</code><code class="o">=</code><code class="s">"myApp.ysize"</code><code class="o">&gt;</code><code class="mi">79</code><code class="o">&lt;/</code><code class="n">entry</code><code class="o">&gt;</code>
    <code class="o">&lt;</code><code class="n">entry</code> <code class="n">key</code><code class="o">=</code><code class="s">"myApp.xsize"</code><code class="o">&gt;</code><code class="mi">52</code><code class="o">&lt;/</code><code class="n">entry</code><code class="o">&gt;</code>
    <code class="o">&lt;/</code><code class="n">properties</code><code class="o">&gt;</code></pre>
<p id="well_cover_xml">Weâ€™ll cover XML in detail in <a class="xref" href="ch24.html" title="ChapterÂ 24.Â XML">ChapterÂ 24</a>.<a id="id735030" class="indexterm"></a><a id="id735040" class="indexterm"></a><a id="id735050" class="indexterm"></a><a id="id735059" class="indexterm"></a></p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-5.2">
<div class="titlepage"><div><div><h3 class="title">System Properties</h3></div></div></div>
<p id="core_utilitiesp_id2"><a id="idx10635" class="indexterm"></a> <a id="idx10668" class="indexterm"></a> <a id="idx10672" class="indexterm"></a>The <code class="literal">java.lang.System</code>
      class provides access to basic system environment information through
      the static <a id="id735135" class="indexterm"></a><code class="literal">System.getProperties()</code>
      method. This method returns a <code class="literal">Properties</code> table that contains system
      properties. System properties take the place of environment variables in
      some programming environments. <a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-8" title="TableÂ 11-8.Â System properties">TableÂ 11-8</a> summarizes system properties that
      are guaranteed to be defined in any Java environment.</p>
<div class="table" id="learnjava3-CHP-11-TABLE-8">
<div class="table-title">TableÂ 11-8.Â System properties</div>
<div class="table-contents"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<colgroup>
<col class="col1">
<col class="col2">
</colgroup>
<thead><tr>
<td style="text-align: left; vertical-align: top; "><p id="system_property">System
              property</p></td>
<td style="text-align: left; "><p id="meaning_id1">Meaning</p></td>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="vendor_property"> <a id="id735226" class="indexterm"></a> <code class="literal">java.vendor</code>
              </p></td>
<td style="text-align: left; "><p id="vendorspecific">Vendor-specific string</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="url_property_ja"> <a id="id735261" class="indexterm"></a> <code class="literal">java.vendor.url</code> </p></td>
<td style="text-align: left; "><p id="url_of_vendor">URL of vendor</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="version_propert"> <a id="id735296" class="indexterm"></a> <code class="literal">java.version</code>
              </p></td>
<td style="text-align: left; "><p id="java_version">Java version</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="home_property_j"> <a id="id735330" class="indexterm"></a> <code class="literal">java.home</code>
              </p></td>
<td style="text-align: left; "><p id="java_installati">Java installation
              directory</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="javaclassvers"> <code class="literal">java.class.version</code> </p></td>
<td style="text-align: left; "><p id="java_class_vers">Java class version</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="path_property_j"> <a id="id735393" class="indexterm"></a> <code class="literal">java.class.path</code> </p></td>
<td style="text-align: left; "><p id="the_classpath">The classpath</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="name_property_o"> <a id="id735428" class="indexterm"></a> <code class="literal">os.name</code>
              </p></td>
<td style="text-align: left; "><p id="operating_syste_id1">Operating system name</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="arch_property_o"> <a id="id735463" class="indexterm"></a> <code class="literal">os.arch</code>
              </p></td>
<td style="text-align: left; "><p id="operating_syste_id2">Operating system
              architecture</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="osversion"> <code class="literal">os.version</code> </p></td>
<td style="text-align: left; "><p id="operating_syste_id3">Operating system
              version</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="separator_prope"> <a id="id735526" class="indexterm"></a> <code class="literal">file.separator</code>
              </p></td>
<td style="text-align: left; "><p id="file_separator_">File separator (such as <code class="literal">/</code> or <code class="literal">\</code>)</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="pathseparator"> <code class="literal">path.separator</code> </p></td>
<td style="text-align: left; "><p id="path_separator_">Path separator (such as <code class="literal">:</code> or <code class="literal">;</code>)</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="lineseparator"> <code class="literal">line.separator</code> </p></td>
<td style="text-align: left; "><p id="line_separator_">Line separator (such as <code class="literal">\n</code> or <code class="literal">\r\n</code>)</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="username"> <code class="literal">user.name</code> </p></td>
<td style="text-align: left; "><p id="user_account_na">User account name</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="home_property_u"> <a id="id735678" class="indexterm"></a> <code class="literal">user.home</code>
              </p></td>
<td style="text-align: left; "><p id="users_home_dir">Userâ€™s home directory</p></td>
</tr>
</tbody>
</table></div>
</div>
<p id="java_applets_an">Java applets and other Java applications that run with
      restrictions may be prevented from reading the following properties:
      <code class="literal">java.home</code>, <code class="literal">java.class.path</code>, <code class="literal">user.name</code>, <code class="literal">user.home</code>, and <code class="literal">user.dir</code>. As youâ€™ll see later, these
      restrictions are implemented by a <code class="literal">SecurityManager</code> object.</p>
<p id="your_applicatio">Your application can set system properties with the static method
      <code class="literal">System.setProperty()</code> . You can also
      set your own system properties when you run the Java interpreter, using
      the <code class="literal">-D</code> option:</p>
<pre class="programlisting" data-language="java" id="I_11_tt740">    <code class="o">%</code> <strong class="userinput"><code><code class="n">java</code> <code class="o">-</code><code class="n">Dfoo</code><code class="o">=</code><code class="n">bar</code> <code class="o">-</code><code class="n">Dcat</code><code class="o">=</code><code class="n">Boojum</code> <code class="n">MyApp</code></code></strong></pre>
<p id="because_it_is_c">Because it is common to use system properties to provide
      parameters such as numbers and colors, Java provides some convenience
      routines for retrieving property values and parsing them into their
      appropriate types. The classes <code class="literal">Boolean</code>, <code class="literal">Integer</code>, <code class="literal">Long</code>, and <code class="literal">Color</code> each come with a â€œgetâ€? method that looks
      up and parses a system property. For example, <code class="literal">Integer.getInteger("foo")</code> looks for a system
      property called <code class="literal">foo</code> and then returns
      it as an <code class="literal">Integer</code>.<a id="id735879" class="indexterm"></a><a id="id735889" class="indexterm"></a><a id="id735899" class="indexterm"></a></p>
</div>
</div>
<div class="sect1" data-original-filename="ch11.xml" id="learnjava3-CHP-11-SECT-6">
<div class="titlepage"><div><div><h2 class="title">The Preferences API</h2></div></div></div>
<p id="the_java_prefer">The Java Preferences API accommodates the need to store both system
    and per-user configuration data persistently across executions of the Java
    VM. The Preferences API is like a portable version of the Windows
    registry, a mini-database in which you can keep small amounts of
    information, accessible to all applications. Entries are stored as
    name/value pairs, where the values may be of several standard types
    including strings, numbers, Booleans, and even short byte arrays. We
    should stress that the Preferences API is not intended to be used as a
    true database and you canâ€™t store large amounts of data in it.</p>
<p id="preferences_are">Preferences are stored logically in a tree. A preferences object is
    a node in the tree located by a unique path. You can think of preferences
    as files in a directory structure; within the file are stored one or more
    name/value pairs. To store or retrieve items, you ask for a preferences
    object for the correct path. Here is an example; weâ€™ll explain the node
    lookup shortly:</p>
<pre class="programlisting" data-language="java" id="I_11_tt741">    <code class="n">Preferences</code> <code class="n">prefs</code> <code class="o">=</code> <code class="n">Preferences</code><code class="o">.</code><code class="na">userRoot</code><code class="o">().</code><code class="na">node</code><code class="o">(</code><code class="s">"oreilly/learningjava"</code><code class="o">);</code>

    <code class="n">prefs</code><code class="o">.</code><code class="na">put</code><code class="o">(</code><code class="s">"author"</code><code class="o">,</code> <code class="s">"Niemeyer"</code><code class="o">);</code>
    <code class="n">prefs</code><code class="o">.</code><code class="na">putInt</code><code class="o">(</code><code class="s">"edition"</code><code class="o">,</code> <code class="mi">4</code><code class="o">);</code>

    <code class="n">String</code> <code class="n">author</code> <code class="o">=</code> <code class="n">prefs</code><code class="o">.</code><code class="na">get</code><code class="o">(</code><code class="s">"author"</code><code class="o">,</code> <code class="s">"unknown"</code><code class="o">);</code>
    <code class="kt">int</code> <code class="n">edition</code> <code class="o">=</code> <code class="n">prefs</code><code class="o">.</code><code class="na">getInt</code><code class="o">(</code><code class="s">"edition"</code><code class="o">,</code> <code class="o">-</code><code class="mi">1</code><code class="o">);</code></pre>
<p id="in_addition_to__id9">In addition to the <code class="literal">String</code> and
    <code class="literal">int</code> type accessors, there are the
    following get methods for other types: <code class="literal">getLong()</code>, <code class="literal">getFloat()</code>, <code class="literal">getDouble()</code>, <code class="literal">getByteArray()</code>, and <code class="literal">getBoolean()</code>. Each of these get methods takes a
    key name and default value to be used if no value is defined. And, of
    course, for each get method, there is a corresponding â€œputâ€? method that
    takes the name and a value of the corresponding type. Providing defaults
    in the get methods is mandatory. The intent is for applications to
    function even if there is no preference information or if the storage for
    it is not available, as weâ€™ll discuss later.</p>
<p id="system_preferen"><a id="id736250" class="indexterm"></a> <a id="id736257" class="indexterm"></a>Preferences are stored in two separate trees: system
    preferences and user preferences. <span class="emphasis"><em>System preferences</em></span>
    are shared by all users of the Java installation. But <span class="emphasis"><em>user
    preferences</em></span> are maintained separately for each user; each user
    sees his or her own preference information. In our example, we used the
    static method <a id="id736273" class="indexterm"></a><code class="literal">userRoot()</code> to fetch the
    root node (preference object) for the user preferences tree. We then asked
    that node to find the child node at the path
    <span class="emphasis"><em>oreilly/learningjava</em></span>, using the <a id="id736290" class="indexterm"></a><code class="literal">node()</code> method. The
    corresponding <a id="id736302" class="indexterm"></a><code class="literal">systemRoot()</code> method
    provides the system root node.</p>
<p id="the_node_meth">The <code class="literal">node()</code> method accepts either
    a relative or an absolute path. A relative path asks the node to find the
    path relative to itself as a base. We also could have gotten our node this
    way:</p>
<pre class="programlisting" data-language="java" id="I_11_tt742">    <code class="n">Preferences</code> <code class="n">prefs</code> <code class="o">=</code>
       <code class="n">Preferences</code><code class="o">.</code><code class="na">userRoot</code><code class="o">().</code><code class="na">node</code><code class="o">(</code><code class="s">"oreilly"</code><code class="o">).</code><code class="na">node</code><code class="o">(</code><code class="s">"learningjava"</code><code class="o">);</code></pre>
<p id="but_node_also">But <code class="literal">node()</code> also accepts an
    absolute path, in which case the base node serves only to designate the
    tree that the path is in. We could use the absolute path
    <span class="emphasis"><em>/oreilly/learningjava</em></span> as the argument to any <code class="literal">node()</code> method and reach our preferences
    object.</p>
<div class="sect2" id="learnjava3-CHP-11-SECT-6.1">
<div class="titlepage"><div><div><h3 class="title">Preferences for Classes</h3></div></div></div>
<p id="dot__forw"><a id="id736442" class="indexterm"></a> <a id="id736448" class="indexterm"></a> <a id="id736455" class="indexterm"></a> <a id="id736464" class="indexterm"></a> <a id="id736476" class="indexterm"></a> <a id="id736482" class="indexterm"></a> <a id="id736489" class="indexterm"></a>Java is an object-oriented language, and so itâ€™s natural
      to wish to associate preference data with classes. In <a class="xref" href="ch12.html" title="ChapterÂ 12.Â Input/Output Facilities">ChapterÂ 12</a>, weâ€™ll see that Java provides special
      facilities for loading resource files associated with class files. The
      Preferences API follows this pattern by associating a node with each
      Java package. Its convention is simple: the node path is just the
      package name with the dots (.) converted to slashes (/). All classes in
      the package share the same node.</p>
<p id="you_can_get_the">You can get the preference object node for a class using the
      static <a id="id736518" class="indexterm"></a><code class="literal">Preferences.userNodeForPackage()</code> or <a id="id736530" class="indexterm"></a><code class="literal">Preferences.systemNodeForPackage()</code> methods,
      which take a <code class="literal">Class</code> as an argument and
      return the corresponding package node for the user and system trees,
      respectively. For example:</p>
<pre class="programlisting" data-language="java" id="I_11_tt743">    <code class="n">Preferences</code> <code class="n">datePrefs</code> <code class="o">=</code> <code class="n">Preferences</code><code class="o">.</code><code class="na">systemNodeForPackage</code><code class="o">(</code> <code class="n">Date</code><code class="o">.</code><code class="na">class</code> <code class="o">);</code>
    <code class="n">Preferences</code> <code class="n">myPrefs</code> <code class="o">=</code> <code class="n">Preferences</code><code class="o">.</code><code class="na">userNodeForPackage</code><code class="o">(</code> <code class="n">MyClass</code><code class="o">.</code><code class="na">class</code> <code class="o">);</code>
    <code class="n">Preferences</code> <code class="n">morePrefs</code> <code class="o">=</code>
        <code class="n">Preferences</code><code class="o">.</code><code class="na">userNodeForPackage</code><code class="o">(</code> <code class="n">myObject</code><code class="o">.</code><code class="na">getClass</code><code class="o">()</code> <code class="o">);</code></pre>
<p id="here_weve_use_id2">Here, weâ€™ve used the <code class="literal">.class</code>
      construct to refer to the <code class="literal">Class</code>
      object for the <code class="literal">Date</code> class in the
      system tree and to our own <code class="literal">MyClass</code>
      class in the user tree. The <code class="literal">Date</code>
      class is in the <code class="literal">java.util</code> package, so
      weâ€™ll get the node <span class="emphasis"><em>/java/util</em></span> in that case. You can
      get the <code class="literal">Class</code> for any object instance
      using the <code class="literal">getClass()</code> method.</p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-6.2">
<div class="titlepage"><div><div><h3 class="title">Preferences Storage</h3></div></div></div>
<p id="backing_store_c"><a id="id736795" class="indexterm"></a> <a id="id736802" class="indexterm"></a> <a id="id736814" class="indexterm"></a>There is no need to â€œcreateâ€? nodes. When you ask for a
      node, you get a preferences object for that path in the tree. If you
      write something to it, that data is eventually placed in persistent
      storage, called the backing store. The <span class="emphasis"><em>backing
      store</em></span> is the implementation-dependent storage mechanism used
      to hold the preference data. All the put methods return immediately, and
      no guarantees are made as to when the data is actually stored. You can
      force data to the backing store explicitly using the <a id="id736833" class="indexterm"></a><code class="literal">flush()</code> method of the
      <a id="id736845" class="indexterm"></a><code class="literal">Preferences</code> class.
      Conversely, you can use the <a id="id736857" class="indexterm"></a><code class="literal">sync()</code> method to
      guarantee that a preferences object is up-to-date with respect to
      changes placed into the backing store by other applications or threads.
      Both <code class="literal">flush()</code> and <code class="literal">sync()</code> throw a <code class="literal">BackingStoreException</code> if data cannot be read
      or written for some reason.</p>
<p id="you_dont_have_">You donâ€™t have to create nodes, but you can test for the existence
      of a data node with the <a id="id736896" class="indexterm"></a><code class="literal">nodeExists()</code> method,
      and you can remove a node and all its children with the <a id="id736908" class="indexterm"></a><code class="literal">remove</code><code class="literal">Node()</code> method. To remove a data item from
      a node, use the <code class="literal">remove()</code> method,
      specifying the key; or you can remove all the data from a node with the
      <a id="id736936" class="indexterm"></a><code class="literal">clear()</code> method (which
      is not the same as removing the node).</p>
<p id="although_the_de">Although the details of the backing store are
      implementation-dependent, the Preferences API provides a simple
      import/export facility that can read and write parts of a preference
      tree to an XML file. (The format for the file is available at
      <span class="emphasis"><em>http://java.sun.com/dtd/</em></span>.) A
      preference object can be written to an output stream with the <a id="id736967" class="indexterm"></a><code class="literal">exportNode()</code> method.
      The <a id="id736978" class="indexterm"></a><code class="literal">exportSubtree()</code> method
      writes the node and all its children. Going the other way, the static
      <a id="id736990" class="indexterm"></a><code class="literal">Preferences.importPreferences()</code> method can
      read the XML file and populate the appropriate tree with its data. The
      XML file records whether it is user or system preferences, but user data
      is always placed into the current userâ€™s tree, regardless of who
      generated it.</p>
<p id="its_interestin">Itâ€™s interesting to note that because the import mechanism writes
      directly to the tree, you canâ€™t use this as a general data-to-XML
      storage mechanism (other APIs play that role). Also, although we said
      that the implementation details are not specified, itâ€™s interesting how
      things really work in the current implementation. On some systems, Java
      creates a directory hierarchy for each tree at
      <span class="emphasis"><em>$JAVA_HOME/jre/.systemPrefs</em></span> and
      <span class="emphasis"><em>$HOME/.java/.userPrefs</em></span>, respectively. In each
      directory, there is an XML file called <span class="emphasis"><em>prefs.xml</em></span>
      corresponding to that node.<a id="id737030" class="indexterm"></a></p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-6.3">
<div class="titlepage"><div><div><h3 class="title">Change Notification</h3></div></div></div>
<p id="core_utilitiesp_id3"><a id="idx10633" class="indexterm"></a> <a id="idx10665" class="indexterm"></a>Often your application should be notified if changes are
      made to the preferences while itâ€™s running. You can get updates on
      preference changes using the <a id="id737085" class="indexterm"></a><code class="literal">PreferenceChangeListener</code> and <a id="id737097" class="indexterm"></a><a id="id737103" class="indexterm"></a><code class="literal">NodeChangeListener</code>
      interfaces. These interfaces are examples of <span class="emphasis"><em>event
      listener</em></span> interfaces, and weâ€™ll see many examples of these in
      Chapters <a class="xref" href="ch16.html" title="ChapterÂ 16.Â Swing">16</a> through <a class="xref" href="ch18.html" title="ChapterÂ 18.Â More Swing Components">18</a>. Weâ€™ll
      also talk about the general pattern later in this chapter in the section
      <a class="xref" href="ch11.html#learnjava3-CHP-11-SECT-8" title="Observers and Observables">â€œObservers and Observablesâ€?</a>. For now, weâ€™ll just say
      that by registering an object that implements <code class="literal">PreferenceChangeListener</code> with a node, you can
      receive updates on added, removed, and changed preference data for that
      node. The <code class="literal">NodeChangeListener</code> allows
      you to be told when child nodes are added to or removed from a specific
      node. Here is a snippet that prints all the data changes affecting our
      <span class="emphasis"><em>/oreilly/learningjava</em></span> node:</p>
<pre class="programlisting" data-language="java" id="I_11_tt744">    <code class="n">Preferences</code> <code class="n">prefs</code> <code class="o">=</code>
        <code class="n">Preferences</code><code class="o">.</code><code class="na">userRoot</code><code class="o">().</code><code class="na">node</code><code class="o">(</code><code class="s">"/oreilly/learningjava"</code><code class="o">);</code>

    <code class="n">prefs</code><code class="o">.</code><code class="na">addPreferenceChangeListener</code><code class="o">(</code> <code class="k">new</code> <code class="n">PreferenceChangeListener</code><code class="o">()</code> <code class="o">{</code>
        <code class="kd">public</code> <code class="kt">void</code> <code class="nf">preferenceChange</code><code class="o">(</code><code class="n">PreferenceChangeEvent</code> <code class="n">e</code><code class="o">)</code> <code class="o">{</code>
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code><code class="s">"Value: "</code> <code class="o">+</code> <code class="n">e</code><code class="o">.</code><code class="na">getKey</code><code class="o">()</code>
                <code class="o">+</code> <code class="s">" changed to "</code><code class="o">+</code> <code class="n">e</code><code class="o">.</code><code class="na">getNewValue</code><code class="o">()</code> <code class="o">);</code>
        <code class="o">}</code>
    <code class="o">}</code> <code class="o">);</code></pre>
<p id="in_brief_this_">In brief, this example listens for changes to preferences and
      prints them. If this example isnâ€™t immediately clear, it should be after
      youâ€™ve read about events in <a class="xref" href="ch16.html" title="ChapterÂ 16.Â Swing">ChapterÂ 16</a> and
      beyond.<a id="id737423" class="indexterm"></a><a id="id737433" class="indexterm"></a></p>
</div>
</div>
<div class="sect1" data-original-filename="ch11.xml" id="learnjava3-CHP-11-SECT-7">
<div class="titlepage"><div><div><h2 class="title">The Logging API</h2></div></div></div>
<p id="the_javautill">The <a id="id737459" class="indexterm"></a><code class="literal">java.util.logging</code> package
    provides a highly flexible and easy-to-use logging framework for system
    information, error messages, and fine-grained tracing (debugging) output.
    With the logging package, you can apply filters to select log messages,
    direct their output to one or more destinations (including files and
    network services), and format the messages appropriately for their
    consumers.</p>
<p id="most_importantl">Most importantly, much of this basic logging configuration can be
    set up externally at runtime through the use of a logging setup properties
    file or an external program. For example, by setting the right properties
    at runtime, you can specify that log messages are to be sent both to a
    designated file in XML format and also logged to the system console in a
    digested, human-readable form. Furthermore, for each of those
    destinations, you can specify the level or priority of messages to be
    logged, discarding those below a certain threshold of significance. By
    following the correct source conventions in your code, you can even make
    it possible to adjust the logging levels for specific parts of your
    application, allowing you to target individual packages and classes for
    detailed logging without being overwhelmed by too much output. The Logging
    API can even be controlled remotely via Java Management Extensions MBean
    APIs.</p>
<div class="sect2" id="learnjava3-CHP-11-SECT-7.1">
<div class="titlepage"><div><div><h3 class="title">Overview</h3></div></div></div>
<p id="core_utilitiesl_id1"><a id="idx10627" class="indexterm"></a> <a id="idx10656" class="indexterm"></a>Any good logging API must have at least two guiding
      principles. First, performance should not inhibit the developer from
      using log messages freely. As with Java language assertions (discussed
      in <a class="xref" href="ch04.html" title="ChapterÂ 4.Â The Java Language">ChapterÂ 4</a>), when log messages are turned
      off, they should not consume any significant amount of processing time.
      This means that thereâ€™s no <span class="keep-together">performance</span> penalty for including logging
      statements as long as theyâ€™re turned off. Second, although some users
      may want advanced features and configuration, a logging API must have
      some simple mode of usage that is convenient enough for time-starved
      developers to use in lieu of the old standby <code class="literal">System.out.println()</code>. Javaâ€™s Logging API
      provides a simple model and many convenience methods that make it very
      tempting.</p>
<div class="sect3" id="learnjava3-CHP-11-SECT-7.1.1">
<div class="titlepage"><div><div><h4 class="title">Loggers</h4></div></div></div>
<p id="core_utilitiesl_id2"><a id="id737580" class="indexterm"></a> <a id="id737591" class="indexterm"></a>The heart of the logging framework is the
        <span class="emphasis"><em>logger</em></span>, an instance of <a id="id737604" class="indexterm"></a><code class="literal">java.util.logging.Logger</code>. In most cases,
        this is the only class your code will ever have to deal with. A logger
        is constructed from the static <a id="id737617" class="indexterm"></a><code class="literal">Logger.getLogger()</code>
        method, with a logger name as its argument. Logger names place loggers
        into a hierarchy with a global, root logger at the top and a tree and
        children below. This hierarchy allows the configuration to be
        inherited by parts of the tree so that logging can be automatically
        configured for different parts of your application. The convention is
        to use a separate logger instance in each major class or package and
        to use the dot-separated package and/or class name as the logger name.
        For example:</p>
<pre class="programlisting" data-language="java" id="I_11_tt745">    <code class="kn">package</code> <code class="n">com</code><code class="o">.</code><code class="na">oreilly</code><code class="o">.</code><code class="na">learnjava</code><code class="o">;</code>
    <code class="kd">public</code> <code class="kd">class</code> <code class="nc">Book</code> <code class="o">{</code>
        <code class="kd">static</code> <code class="n">Logger</code> <code class="n">log</code> <code class="o">=</code> <code class="n">Logger</code><code class="o">.</code><code class="na">getLogger</code><code class="o">(</code><code class="s">"com.oreilly.learnjava.Book"</code><code class="o">);</code></pre>
<p id="the_logger_prov">The logger provides a wide range of methods to log messages;
        some take very detailed information, and some convenience methods take
        only a string for ease of use. For example:</p>
<pre class="programlisting" data-language="java" id="I_11_tt746">    <code class="n">log</code><code class="o">.</code><code class="na">warning</code><code class="o">(</code><code class="s">"Disk 90% full."</code><code class="o">);</code>
    <code class="n">log</code><code class="o">.</code><code class="na">info</code><code class="o">(</code><code class="s">"New user joined chat room."</code><code class="o">);</code></pre>
<p id="we_cover_method">We cover methods of the logger class in detail a bit later. The
        names <code class="literal">warning</code> and <code class="literal">info</code> are two examples of logging levels;
        there are seven levels ranging from SEVERE at the top to FINEST at the
        bottom. Distinguishing log messages in this way allows us to select
        the level of information that we want to see at runtime. Rather than
        simply logging everything and sorting through it later (with negative
        performance impact) we can tweak which messages are generated. Weâ€™ll
        talk more about logging levels in the next section.</p>
<p id="we_should_also__id5">We should also mention that for convenience in very simple
        applications or experiments, a logger for the name â€œglobalâ€? is
        provided in the static field <a id="id737850" class="indexterm"></a><code class="literal">Logger.global</code>. You
        can use it as an alternative to the old standby <code class="literal">System.out.println()</code> for those cases where
        that is still a temptation:</p>
<pre class="programlisting" data-language="java" id="I_11_tt747">    <code class="n">Logger</code><code class="o">.</code><code class="na">global</code><code class="o">.</code><code class="na">info</code><code class="o">(</code><code class="s">"Doing foo..."</code><code class="o">)</code></pre>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-7.1.2">
<div class="titlepage"><div><div><h4 class="title">Handlers</h4></div></div></div>
<p id="core_utilitiesl_id3"><a id="id737927" class="indexterm"></a> <a id="idx10652" class="indexterm"></a>Loggers represent the client interface to the logging
        system, but the actual work of publishing messages to destinations
        (such as files or the console) is done by <span class="emphasis"><em>handler</em></span>
        objects. Each logger may have one or more <code class="literal">Handler</code> objects associated with it, which
        includes several predefined handlers supplied with the Logging API:
        <a id="id737966" class="indexterm"></a><code class="literal">ConsoleHandler</code>,
        <a id="id737978" class="indexterm"></a><code class="literal">FileHandler</code>,
        <a id="id737989" class="indexterm"></a><code class="literal">StreamHandler</code>, and
        <a id="id738001" class="indexterm"></a><code class="literal">SocketHandler</code>. Each
        handler knows how to deliver messages to its respective destination.
        <code class="literal">ConsoleHandler</code> is used by the
        default configuration to print messages on the command line or system
        console. <code class="literal">FileHandler</code> can direct
        output to files using a supplied naming convention and automatically
        rotate the files as they become full. The others send messages to
        streams and sockets, respectively. There is one additional handler,
        <a id="id738028" class="indexterm"></a><code class="literal">MemoryHandler</code>, that
        can hold a number of log messages in memory. <code class="literal">MemoryHandler</code> has a circular buffer, which
        maintains a certain number of messages until it is triggered to
        publish them to another designated handler.</p>
<p id="as_we_said_log">As we said, loggers can be set to use one or more handlers.
        Loggers also send messages up the tree to each of their parent
        loggerâ€™s handlers. In the simplest configuration, this means that all
        messages end up distributed by the root loggerâ€™s handlers. Weâ€™ll soon
        see how to set up output using the standard handlers for the console,
        files, etc.<a id="id738061" class="indexterm"></a></p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-7.1.3">
<div class="titlepage"><div><div><h4 class="title">Filters</h4></div></div></div>
<p id="core_utilitiesl_id4"><a id="id738083" class="indexterm"></a> <a id="id738095" class="indexterm"></a>Before a logger hands off a message to its handlers or
        its parentâ€™s handlers, it first checks whether the logging level is
        sufficient to proceed. If the message doesnâ€™t meet the required level,
        it is discarded at the source. In addition to level, you can implement
        arbitrary filtering of messages by creating <a id="id738110" class="indexterm"></a><code class="literal">Filter</code> classes that
        examine the log message before it is processed. A <code class="literal">Filter</code> class can be applied to a logger
        externally at runtime in the same way that the logging level,
        handlers, and formatters, which are discussed next, can be. A <code class="literal">Filter</code> may also be attached to an individual
        <code class="literal">Handler</code> to filter records at the
        output stage (as opposed to the source).</p>
</div>
<div class="sect3" id="learnjava3-CHP-11-SECT-7.1.4">
<div class="titlepage"><div><div><h4 class="title">Formatters</h4></div></div></div>
<p id="core_utilitiesl_id5"><a id="id738155" class="indexterm"></a> <a id="id738166" class="indexterm"></a>Internally, messages are carried in a neutral format,
        including all the source information provided. It is not until they
        are processed by a handler that they are formatted for output by an
        instance of a <code class="literal">Formatter</code> object. The
        logging package comes with two basic formatters: <a id="id738184" class="indexterm"></a><code class="literal">SimpleFormatter</code> and
        <a id="id738196" class="indexterm"></a><code class="literal">XMLFormatter</code>. The
        <code class="literal">SimpleFormatter</code> is the default used
        for console output. It produces short, human-readable summaries of log
        messages. <code class="literal">XMLFormatter</code> encodes all
        the log message details into an XML record format. The DTD for the
        format can be found at <a class="ulink" href="http://java.sun.com/dtd/" target="_top">http://java.sun.com/dtd/</a>.<a id="id738231" class="indexterm"></a><a id="id738241" class="indexterm"></a></p>
</div>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-7.2">
<div class="titlepage"><div><div><h3 class="title">Logging Levels</h3></div></div></div>
<p id="core_utilitiesl_id6"><a id="idx10624" class="indexterm"></a> <a id="idx10653" class="indexterm"></a> <a class="xref" href="ch11.html#learnjava3-CHP-11-TABLE-9" title="TableÂ 11-9.Â Logging API logging levels">TableÂ 11-9</a> lists the
      logging levels from most to least significant.</p>
<div class="table" id="learnjava3-CHP-11-TABLE-9">
<div class="table-title">TableÂ 11-9.Â Logging API logging levels</div>
<div class="table-contents"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<colgroup>
<col class="col1">
<col class="col2">
</colgroup>
<thead><tr>
<td style="text-align: left; vertical-align: top; "><p id="level">Level</p></td>
<td style="text-align: left; "><p id="meaning_id2">Meaning</p></td>
</tr></thead>
<tbody>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="severe_logging_"> <a id="id738368" class="indexterm"></a> <code class="literal">SEVERE</code>
              </p></td>
<td style="text-align: left; "><p id="application_fai">Application failure</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="warning_logging"> <a id="id738403" class="indexterm"></a> <code class="literal">WARNING</code>
              </p></td>
<td style="text-align: left; "><p id="notification_of">Notification of potential
              problem</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="info_logging_le"> <a id="id738438" class="indexterm"></a> <code class="literal">INFO</code>
              </p></td>
<td style="text-align: left; "><p id="messages_of_gen">Messages of general interest to end
              users</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; "><p id="config_logging_"> <a id="id738473" class="indexterm"></a> <code class="literal">CONFIG</code>
              </p></td>
<td style="text-align: left; "><p id="detailed_system">Detailed system configuration
              information for administrators</p></td>
</tr>
<tr>
<td style="text-align: left; vertical-align: top; ">
<p id="fine_logging_le"> <a id="id738507" class="indexterm"></a> <code class="literal">FINE</code>,</p>
<p id="finer_logging_l"> <a id="id738526" class="indexterm"></a> <code class="literal">FINER</code>,</p>
<p id="finest_logging_"> <a id="id738544" class="indexterm"></a> <code class="literal">FINEST</code>
              </p>
</td>
<td style="text-align: left; "><p id="successively_mo">Successively more detailed application
              tracing information for developers</p></td>
</tr>
</tbody>
</table></div>
</div>
<p id="these_levels_fa">These levels fall into three camps: end user, administrator, and
      developer. Applications often default to logging only messages of the
      <code class="literal">INFO</code> level and above (<code class="literal">INFO</code>, <code class="literal">WARNING</code>, and <code class="literal">SEVERE</code>). These levels are generally seen by
      end users and messages logged to them should be suitable for general
      consumption. In other words, they should be written clearly so they make
      sense to an average user of the application. Often these kinds of
      messages are presented to the end user on a system console or in a
      pop-up message dialog.</p>
<p id="the_config_leve">The <code class="literal">CONFIG</code> level should be used
      for relatively static but detailed system information that could assist
      an administrator or installer. This might include information about the
      installed software modules, host system characteristics, and
      configuration parameters. These details are important, but probably not
      as meaningful to an end user.</p>
<p id="the_fine_finer">The <code class="literal">FINE</code>, <code class="literal">FINER</code>, and <code class="literal">FINEST</code> levels are for developers or others
      with knowledge of the internals of the application. These should be used
      for tracing the application at successive levels of detail. You can
      define your own meanings for these. Weâ€™ll suggest a rough outline in our
      example, coming up next.<a id="id738644" class="indexterm"></a><a id="id738654" class="indexterm"></a></p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-7.3">
<div class="titlepage"><div><div><h3 class="title">A Simple Example</h3></div></div></div>
<p id="core_utilitiesl_id7"><a id="idx10623" class="indexterm"></a> <a id="idx10651" class="indexterm"></a>In the following (admittedly very contrived) example, we
      use all the logging levels so that we can experiment with logging
      configuration. Although the sequence of messages is nonsensical, the
      text is representative of messages of that type.</p>
<pre class="programlisting" data-language="java" id="I_11_tt748">    <code class="kn">import</code> <code class="nn">java.util.logging.*</code><code class="o">;</code>

    <code class="kd">public</code> <code class="kd">class</code> <code class="nc">LogTest</code> <code class="o">{</code>
        <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code><code class="n">String</code> <code class="n">argv</code><code class="o">[])</code>
        <code class="o">{</code>
            <code class="n">Logger</code> <code class="n">logger</code> <code class="o">=</code> <code class="n">Logger</code><code class="o">.</code><code class="na">getLogger</code><code class="o">(</code><code class="s">"com.oreilly.LogTest"</code><code class="o">);</code>

            <code class="n">logger</code><code class="o">.</code><code class="na">severe</code><code class="o">(</code><code class="s">"Power lost - running on backup!"</code><code class="o">);</code>
            <code class="n">logger</code><code class="o">.</code><code class="na">warning</code><code class="o">(</code><code class="s">"Database connection lost, retrying..."</code><code class="o">);</code>
            <code class="n">logger</code><code class="o">.</code><code class="na">info</code><code class="o">(</code><code class="s">"Startup complete."</code><code class="o">);</code>
            <code class="n">logger</code><code class="o">.</code><code class="na">config</code><code class="o">(</code><code class="s">"Server configuration: standalone, JVM version 1.5"</code><code class="o">);</code>
            <code class="n">logger</code><code class="o">.</code><code class="na">fine</code><code class="o">(</code><code class="s">"Loading graphing package."</code><code class="o">);</code>
            <code class="n">logger</code><code class="o">.</code><code class="na">finer</code><code class="o">(</code><code class="s">"Doing pie chart"</code><code class="o">);</code>
            <code class="n">logger</code><code class="o">.</code><code class="na">finest</code><code class="o">(</code><code class="s">"Starting bubble sort: value ="</code><code class="o">+</code><code class="mi">42</code><code class="o">);</code>
        <code class="o">}</code>
    <code class="o">}</code></pre>
<p id="theres_not_muc_id1">Thereâ€™s not much to this example. We ask for a <code class="literal">logger</code> instance for our class using the static
      <code class="literal">Logger.getLogger()</code> method, specifying
      a class name. The convention is to use the fully qualified class name,
      so weâ€™ll pretend that our class is in a <code class="literal">com.oreilly</code> package.</p>
<p id="now_run_logtes">Now, run <code class="literal">LogTest</code>. You should
      see output like the following on the system console:</p>
<pre class="programlisting" data-language="java" id="I_11_tt749">    <code class="n">Jan</code> <code class="mi">6</code><code class="o">,</code> <code class="mi">2002</code> <code class="mi">3</code><code class="o">:</code><code class="mi">24</code><code class="o">:</code><code class="mi">36</code> <code class="n">PM</code> <code class="n">LogTest</code> <code class="n">main</code>
    <code class="nl">SEVERE:</code> <code class="n">Power</code> <code class="n">lost</code> <code class="o">-</code> <code class="n">running</code> <code class="n">on</code> <code class="n">backup</code><code class="o">!</code>
    <code class="n">Jan</code> <code class="mi">6</code><code class="o">,</code> <code class="mi">2002</code> <code class="mi">3</code><code class="o">:</code><code class="mi">24</code><code class="o">:</code><code class="mi">37</code> <code class="n">PM</code> <code class="n">LogTest</code> <code class="n">main</code>
    <code class="nl">WARNING:</code> <code class="n">Database</code> <code class="n">connection</code> <code class="n">lost</code><code class="o">,</code> <code class="n">retrying</code><code class="o">...</code>
    <code class="n">Jan</code> <code class="mi">6</code><code class="o">,</code> <code class="mi">2002</code> <code class="mi">3</code><code class="o">:</code><code class="mi">24</code><code class="o">:</code><code class="mi">37</code> <code class="n">PM</code> <code class="n">LogTest</code> <code class="n">main</code>
    <code class="nl">INFO:</code> <code class="n">Startup</code> <code class="n">complete</code><code class="o">.</code></pre>
<p id="we_see_the_info">We see the <code class="literal">INFO</code>, <code class="literal">WARNING</code>, and <code class="literal">SEVERE</code> messages, each identified with a date
      and timestamp and the name of the class and method (<code class="literal">LogTest main</code>) from which they came. Notice
      that the lower-level messages did not appear. This is because the
      default logging level is normally set to <code class="literal">INFO</code>, meaning that only messages of severity
      <code class="literal">INFO</code> and above are logged. Also note
      that the output went to the system console and not to a logfile
      somewhere; thatâ€™s also the default. Now weâ€™ll describe where these
      defaults are set and how to override them at runtime.<a id="id739422" class="indexterm"></a><a id="id739432" class="indexterm"></a></p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-7.4">
<div class="titlepage"><div><div><h3 class="title">Logging Setup Properties</h3></div></div></div>
<p id="core_utilitiesl_id8"><a id="idx10625" class="indexterm"></a> <a id="idx10654" class="indexterm"></a>As we said in the introduction, probably the most
      important feature of the Logging API is the ability to configure so much
      of it at runtime through the use of external properties or applications.
      The default logging configuration is stored in the file
      <span class="emphasis"><em>jre/lib/logging.properties</em></span> in the directory where
      Java is installed. Itâ€™s a standard Java properties file (of the kind we
      described earlier in this chapter).</p>
<p id="the_format_of_t">The format of this file is simple. You can make changes to it, but
      you donâ€™t have to. Instead, you can specify your own logging setup
      properties file on a case-by-case basis using a system property at
      runtime, as follows:</p>
<pre class="programlisting" data-language="java" id="I_11_tt750">    <code class="o">%</code> <strong class="userinput"><code><code class="n">java</code> <code class="o">-</code><code class="n">Djava</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">config</code><code class="o">.</code><code class="na">file</code><code class="o">=</code><code class="n">myfile</code><code class="o">.</code><code class="na">properties</code></code></strong></pre>
<p id="in_this_command">In this command line, <span class="emphasis"><em>myfile</em></span> is your
      properties file that contains the directive, which weâ€™ll describe next.
      If you want to make this file designation more permanent, you can do so
      by setting the filename in the corresponding entry using the Java
      Preferences API described earlier in this chapter. You can go even
      further and instead of specifying a setup file, supply a class that is
      responsible for setting up all logging configuration, but we wonâ€™t get
      into that here.</p>
<p id="a_very_simple_l">A very simple logging properties file might look like this:</p>
<pre class="programlisting" data-language="java" id="I_11_tt751">    <code class="err">#</code> <code class="n">Set</code> <code class="n">the</code> <code class="k">default</code> <code class="n">logging</code> <code class="n">level</code>
    <code class="o">.</code><code class="na">level</code> <code class="o">=</code> <code class="n">FINEST</code>
    <code class="err">#</code> <code class="n">Direct</code> <code class="n">output</code> <code class="n">to</code> <code class="n">the</code> <code class="n">console</code>
    <code class="n">handlers</code> <code class="o">=</code> <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">ConsoleHandler</code></pre>
<p id="here_we_have_s_id2">Here, we have set the default logging level for the entire
      application using the <code class="literal">.level</code> (thatâ€™s
      dot-level) property. We have also used the <a id="id739764" class="indexterm"></a><code class="literal">handlers</code> property to
      specify that an instance of the <code class="literal">ConsoleHandler</code> should be used (just like the
      default setup) to show messages on the console. If you run our
      application again, specifying this properties file as the logging setup,
      you will now see all our log messages.</p>
<p id="but_were_just_">But weâ€™re just getting warmed up. Next, letâ€™s look at a more
      complex configuration:</p>
<pre class="programlisting" data-language="java" id="I_11_tt752">    <code class="err">#</code> <code class="n">Set</code> <code class="n">the</code> <code class="k">default</code> <code class="n">logging</code> <code class="n">level</code>
    <code class="o">.</code><code class="na">level</code> <code class="o">=</code> <code class="n">INFO</code>

    <code class="err">#</code> <code class="n">Ouput</code> <code class="n">to</code> <code class="n">file</code> <code class="n">and</code> <code class="n">console</code>
    <code class="n">handlers</code> <code class="o">=</code> <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">FileHandler</code><code class="o">,</code> <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">ConsoleHandler</code>

    <code class="err">#</code> <code class="n">Configure</code> <code class="n">the</code> <code class="n">file</code> <code class="n">output</code>
    <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">FileHandler</code><code class="o">.</code><code class="na">level</code> <code class="o">=</code> <code class="n">FINEST</code>
    <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">FileHandler</code><code class="o">.</code><code class="na">pattern</code> <code class="o">=</code> <code class="o">%</code><code class="n">h</code><code class="o">/</code><code class="n">Test</code><code class="o">.</code><code class="na">log</code>
    <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">FileHandler</code><code class="o">.</code><code class="na">limit</code> <code class="o">=</code> <code class="mi">25000</code>
    <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">FileHandler</code><code class="o">.</code><code class="na">count</code> <code class="o">=</code> <code class="mi">4</code>
    <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">FileHandler</code><code class="o">.</code><code class="na">formatter</code> <code class="o">=</code> <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">XMLFormatter</code>

    <code class="err">#</code> <code class="n">Configure</code> <code class="n">the</code> <code class="n">console</code> <code class="n">output</code>
    <code class="n">java</code><code class="o">.</code><code class="na">util</code><code class="o">.</code><code class="na">logging</code><code class="o">.</code><code class="na">ConsoleHandler</code><code class="o">.</code><code class="na">level</code> <code class="o">=</code> <code class="n">WARNING</code>

    <code class="err">#</code> <code class="n">Levels</code> <code class="k">for</code> <code class="n">specific</code> <code class="n">classes</code>
    <code class="n">com</code><code class="o">.</code><code class="na">oreilly</code><code class="o">.</code><code class="na">LogTest</code><code class="o">.</code><code class="na">level</code> <code class="o">=</code> <code class="n">FINEST</code></pre>
<p id="in_this_example_id24">In this example, we have configured two log handlers: a <a id="id740437" class="indexterm"></a><code class="literal">ConsoleHandler</code> with the
      logging level set to <a id="id740449" class="indexterm"></a><code class="literal">WARNING</code> and also an
      instance of <a id="id740461" class="indexterm"></a><code class="literal">FileHandler</code> that sends
      the output to an <a id="id740473" class="indexterm"></a>XML file. The file handler is configured to log messages
      at the <a id="id740483" class="indexterm"></a><code class="literal">FINEST</code> level (all
      messages) and to rotate logfiles every 25,000 lines, keeping a maximum
      of four files.</p>
<p id="the_filename_is">The filename is controlled by the <code class="literal">pattern</code> property. Forward slashes in the
      filename are automatically localized to backslash (\) if necessary. The
      special symbol <a id="id740508" class="indexterm"></a><code class="literal">%h</code> refers to the user
      home. You can use <a id="id740520" class="indexterm"></a><code class="literal">%t</code> to refer to the
      system temporary directory. If filenames conflict, a number is appended
      automatically after a dot (starting at zero). Alternatively, you can use
      <a id="id740534" class="indexterm"></a><code class="literal">%u</code> to indicate where a
      unique number should be inserted into the name. Similarly, when files
      rotate, a number is appended after a dot at the end. You can take
      control of where the rotation number is placed with the <a id="id740547" class="indexterm"></a><code class="literal">%g</code> identifier.</p>
<p id="in_our_example_id1">In our example, we specified the <code class="literal">XMLFormatter</code> class. We could also have used
      the <code class="literal">SimpleFormatter</code> class to send the
      same kind of simple output to the console. The <code class="literal">ConsoleHandler</code> also allows us to specify any
      formatter we wish, using the <code class="literal">formatter</code> property.</p>
<p id="finally_we_pro">Finally, we promised earlier that you could control logging levels
      for parts of your applications. To do this, set properties on your
      application loggers using their hierarchical names:</p>
<pre class="programlisting" data-language="java" id="I_11_tt753">    <code class="err">#</code> <code class="n">Levels</code> <code class="k">for</code> <code class="n">specific</code> <code class="n">logger</code> <code class="o">(</code><code class="n">class</code><code class="o">)</code> <code class="n">names</code>
    <code class="n">com</code><code class="o">.</code><code class="na">oreilly</code><code class="o">.</code><code class="na">LogTest</code><code class="o">.</code><code class="na">level</code> <code class="o">=</code> <code class="n">FINEST</code></pre>
<p id="here_weve_set">Here, weâ€™ve set the logging level for just our test logger, by
      name. The log properties follow the hierarchy, so we could set the
      logging level for all classes in the <code class="literal">oreilly</code> package with:</p>
<pre class="programlisting" data-language="java" id="I_11_tt754">    <code class="n">com</code><code class="o">.</code><code class="na">oreilly</code><code class="o">.</code><code class="na">level</code> <code class="o">=</code> <code class="n">FINEST</code></pre>
<p id="logging_levels_">Logging levels are set in the order in which they are read in the
      properties file, so set the general ones first. Also note that the
      levels set on the handlers allow the file handler to filter only the
      messages being supplied by the loggers. So setting the file handler to
      <a id="id740762" class="indexterm"></a><code class="literal">FINEST</code> wonâ€™t revive
      messages squelched by a logger set to <a id="id740774" class="indexterm"></a><code class="literal">SEVERE</code> (only the
      <code class="literal">SEVERE</code> messages will make it to the
      handler from that logger).<a id="id740792" class="indexterm"></a><a id="id740802" class="indexterm"></a></p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-7.5">
<div class="titlepage"><div><div><h3 class="title">The Logger</h3></div></div></div>
<p id="core_utilitiesl_id9"><a id="idx10626" class="indexterm"></a> <a id="idx10655" class="indexterm"></a>In our example, we used the seven convenience methods
      named for the various logging levels. There are also three groups of
      general methods that can be used to provide more detailed information.
      The most general are:</p>
<pre class="programlisting" data-language="java" id="I_11_tt755">    <code class="n">log</code><code class="o">(</code><code class="n">Level</code> <code class="n">level</code><code class="o">,</code> <code class="n">String</code> <code class="n">msg</code><code class="o">)</code>
    <code class="n">log</code><code class="o">(</code><code class="n">Level</code> <code class="n">level</code><code class="o">,</code> <code class="n">String</code> <code class="n">msg</code><code class="o">,</code> <code class="n">Object</code> <code class="n">param1</code><code class="o">)</code>
    <code class="n">log</code><code class="o">(</code><code class="n">Level</code> <code class="n">level</code><code class="o">,</code> <code class="n">String</code> <code class="n">msg</code><code class="o">,</code> <code class="n">Object</code> <code class="n">params</code><code class="o">[])</code>
    <code class="n">log</code><code class="o">(</code><code class="n">Level</code> <code class="n">level</code><code class="o">,</code> <code class="n">String</code> <code class="n">msg</code><code class="o">,</code> <code class="n">Throwable</code> <code class="n">thrown</code><code class="o">)</code></pre>
<p id="these_methods_a">These methods accept as their first argument a static logging
      level identifier from the <a id="id741075" class="indexterm"></a><code class="literal">Level</code> class, followed
      by a parameter, array, or exception type. The level identifier is one of
      <code class="literal">Level.SEVERE</code>, <code class="literal">Level.WARNING</code>, <code class="literal">Level.INFO</code>, and so on.</p>
<p id="in_addition_to__id10">In addition to these four methods, there are four corresponding
      methods named <a id="id741112" class="indexterm"></a><code class="literal">logp()</code> that also take a
      source class and method name as the second and third arguments. In our
      example, we saw Java automatically determine that information, so why
      would we want to supply it? The answer is that Java may not always be
      able to determine the exact method name because of runtime dynamic
      optimization. The <code class="literal">p</code> in <code class="literal">logp</code> stands for â€œpreciseâ€? and allows you to
      control this yourself.</p>
<p id="there_is_yet_an">There is yet another set of methods named <a id="id741146" class="indexterm"></a><code class="literal">logrb()</code>â€”which probably
      should have been named <code class="literal">logprb()</code>â€”that
      take both the class and method names and a resource bundle name. The
      resource bundle localizes the messages (see the section <a class="xref" href="ch10.html#learnjava3-CHP-10-SECT-3.2" title="Resource Bundles">â€œResource Bundlesâ€?</a> in <a class="xref" href="ch10.html" title="ChapterÂ 10.Â Working with Text">ChapterÂ 10</a>). More generally, a logger may have a
      resource bundle associated with it when it is created, using another
      form of the <code class="literal">getLogger</code> method:</p>
<pre class="programlisting" data-language="java" id="I_11_tt756">    <code class="n">Logger</code><code class="o">.</code><code class="na">getLogger</code><code class="o">(</code><code class="s">"com.oreilly.LogTest"</code><code class="o">,</code> <code class="s">"logMessages"</code><code class="o">);</code></pre>
<p id="in_either_case_id3">In either case, the resource bundle name is passed along with the
      log message and can be used by the formatter. If a resource bundle is
      specified, the standard formatters treat the message text as a key and
      try to look up a localized message. Localized messages may include
      parameters using the standard message format notation and the form of
      <code class="literal">log()</code>, which accepts an argument
      array.</p>
<p id="finally_there__id1">Finally, there are convenience methods called <a id="id741252" class="indexterm"></a><code class="literal">entering()</code>, <a id="id741263" class="indexterm"></a><code class="literal">exiting()</code>, and
      <a id="id741275" class="indexterm"></a><code class="literal">throwing()</code> that
      developers can use to log detailed trace information.<a id="id741287" class="indexterm"></a><a id="id741297" class="indexterm"></a></p>
</div>
<div class="sect2" id="learnjava3-CHP-11-SECT-7.6">
<div class="titlepage"><div><div><h3 class="title">Performance</h3></div></div></div>
<p id="core_utilitiesl_id10"><a id="id741319" class="indexterm"></a> <a id="idx10657" class="indexterm"></a>In the introduction, we said that performance is a
      priority of the Logging API. To that end weâ€™ve described that log
      messages are filtered at the source, using logging levels to cut off
      processing of messages early. This saves much of the expense of handling
      them. However, it cannot prevent certain kinds of setup work that you
      might do before the logging call. Specifically, because weâ€™re passing
      things into the log methods, itâ€™s common to construct detailed messages
      or render objects to strings as arguments. Often this kind of operation
      is costly. To avoid unnecessary string construction, you should wrap
      expensive log operations in a conditional test using the <code class="literal">Logger isLoggable()</code> method to test whether you
      should carry out the operation:<a id="id741359" class="indexterm"></a></p>
<pre class="programlisting" data-language="java" id="I_11_tt757">    <code class="k">if</code> <code class="o">(</code> <code class="n">log</code><code class="o">.</code><code class="na">isLoggable</code><code class="o">(</code> <code class="n">Level</code><code class="o">.</code><code class="na">CONFIG</code> <code class="o">)</code> <code class="o">)</code> <code class="o">{</code>
        <code class="n">log</code><code class="o">.</code><code class="na">config</code><code class="o">(</code><code class="s">"Configuration: "</code><code class="o">+</code> <code class="n">loadExpensiveConfigInfo</code><code class="o">()</code> <code class="o">);</code>
    <code class="o">}</code></pre>
</div>
</div>
<div class="sect1" data-original-filename="ch11.xml" id="learnjava3-CHP-11-SECT-8">
<div class="titlepage"><div><div><h2 class="title">Observers and Observables</h2></div></div></div>
<p id="core_utilitieso"><a id="idx10632" class="indexterm"></a> <a id="idx10663" class="indexterm"></a>The <a id="id741526" class="indexterm"></a><code class="literal">java.util.Observer</code>
    interface and <a id="id741538" class="indexterm"></a><code class="literal">java.util.Observable</code>
    class are relatively small utilities, but they provide a glimpse of a
    fundamental design pattern in Java. Observers and observables are part of
    the MVC (Model-View-Controller) framework. It is an abstraction that lets
    a number of client objects (the <span class="emphasis"><em>observers</em></span>) be
    notified whenever a certain object or resource (the
    <span class="emphasis"><em>observable</em></span>) changes in some way. We will see this
    pattern used extensively in Javaâ€™s event mechanism, which is covered in
    Chapters <a class="xref" href="ch16.html" title="ChapterÂ 16.Â Swing">16</a> through <a class="xref" href="ch19.html" title="ChapterÂ 19.Â Layout Managers">19</a>. Although
    these classes are not often used directly, itâ€™s worth looking at them in
    order to understand the pattern.</p>
<p id="the_observable_">The <code class="literal">Observable</code> object has a
    method that an <code class="literal">Observer</code> calls to
    register its interest. When a change happens, the <code class="literal">Observable</code> sends a notification by calling a
    method in each of the <code class="literal">Observer</code>s. The
    observers implement the <code class="literal">Observer</code>
    interface, which specifies that notification causes an <code class="literal">Observer</code> objectâ€™s <code class="literal">update()</code> method to be called.</p>
<p id="in_the_followin_id4">In the following example, we create a <code class="literal">MessageBoard</code> object that holds a <code class="literal">String</code> message. <code class="literal">MessageBoard</code> extends <code class="literal">Observable</code>, from which it inherits the mechanism
    for registering observers (<code class="literal">addObserver()</code>) and notifying observers (<code class="literal">notifyObservers()</code>). To observe the <code class="literal">MessageBoard</code>, we have <code class="literal">Student</code> objects that implement the <code class="literal">Observer</code> interface so that they can be notified
    when the message changes:</p>
<pre class="programlisting" data-language="java" id="I_11_tt758">    <code class="c1">//file: MessageBoard.java</code>
    <code class="kn">import</code> <code class="nn">java.util.*</code><code class="o">;</code>
     <code class="err">Â </code>
    <code class="kd">public</code> <code class="kd">class</code> <code class="nc">MessageBoard</code> <code class="kd">extends</code> <code class="n">Observable</code> <code class="o">{</code>
        <code class="kd">private</code> <code class="n">String</code> <code class="n">message</code><code class="o">;</code>
     <code class="err">Â </code>
        <code class="kd">public</code> <code class="n">String</code> <code class="nf">getMessage</code><code class="o">()</code> <code class="o">{</code>
            <code class="k">return</code> <code class="n">message</code><code class="o">;</code>
        <code class="o">}</code>
        <code class="kd">public</code> <code class="kt">void</code> <code class="nf">changeMessage</code><code class="o">(</code> <code class="n">String</code> <code class="n">message</code> <code class="o">)</code> <code class="o">{</code>
            <code class="k">this</code><code class="o">.</code><code class="na">message</code> <code class="o">=</code> <code class="n">message</code><code class="o">;</code>
            <code class="n">setChanged</code><code class="o">();</code>
            <code class="n">notifyObservers</code><code class="o">(</code> <code class="n">message</code> <code class="o">);</code>
        <code class="o">}</code>
        <code class="kd">public</code> <code class="kd">static</code> <code class="kt">void</code> <code class="nf">main</code><code class="o">(</code> <code class="n">String</code> <code class="o">[]</code> <code class="n">args</code> <code class="o">)</code> <code class="o">{</code>
            <code class="n">MessageBoard</code> <code class="n">board</code> <code class="o">=</code> <code class="k">new</code> <code class="n">MessageBoard</code><code class="o">();</code>
            <code class="n">Student</code> <code class="n">bob</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Student</code><code class="o">();</code>
            <code class="n">Student</code> <code class="n">joe</code> <code class="o">=</code> <code class="k">new</code> <code class="n">Student</code><code class="o">();</code>
            <code class="n">board</code><code class="o">.</code><code class="na">addObserver</code><code class="o">(</code> <code class="n">bob</code> <code class="o">);</code>
            <code class="n">board</code><code class="o">.</code><code class="na">addObserver</code><code class="o">(</code> <code class="n">joe</code> <code class="o">);</code>
            <code class="n">board</code><code class="o">.</code><code class="na">changeMessage</code><code class="o">(</code><code class="s">"More Homework!"</code><code class="o">);</code>
        <code class="o">}</code>
    <code class="o">}</code> <code class="c1">// end of class MessageBoard</code>
     <code class="err">Â </code>
    <code class="kd">class</code> <code class="nc">Student</code> <code class="kd">implements</code> <code class="n">Observer</code> <code class="o">{</code>
        <code class="kd">public</code> <code class="kt">void</code> <code class="nf">update</code><code class="o">(</code><code class="n">Observable</code> <code class="n">o</code><code class="o">,</code> <code class="n">Object</code> <code class="n">arg</code><code class="o">)</code> <code class="o">{</code>
            <code class="n">System</code><code class="o">.</code><code class="na">out</code><code class="o">.</code><code class="na">println</code><code class="o">(</code> <code class="s">"Message board changed: "</code> <code class="o">+</code> <code class="n">arg</code> <code class="o">);</code>
        <code class="o">}</code>
    <code class="o">}</code></pre>
<p id="our_messageboar">Our <code class="literal">MessageBoard</code> object extends
    <code class="literal">Observable</code>, which provides a method
    called <a id="id742345" class="indexterm"></a><code class="literal">addObserver()</code>. Each
    <code class="literal">Student</code> object registers itself using
    this method and receives updates via its <code class="literal">update()</code> method. When a new message string is
    set using the <code class="literal">MessageBoard</code>â€™s <code class="literal">changeMessage()</code> method, the <code class="literal">Observable</code> calls the <a id="id742388" class="indexterm"></a><code class="literal">setChanged()</code> and <code class="literal">notifyObservers()</code> methods to notify the
    observers. <code class="literal">notifyObservers()</code> can take
    as an argument an <code class="literal">Object</code> to pass along
    as an indication of the change. This objectâ€”in this case, the <code class="literal">String</code> containing the new messageâ€”is passed to
    the observerâ€™s <code class="literal">update()</code> method as its
    second argument. The first argument to <code class="literal">update()</code> is the <code class="literal">Observable</code> object itself.</p>
<p id="the_main_meth_id5">The <code class="literal">main()</code> method of <code class="literal">MessageBoard</code> creates a <code class="literal">MessageBoard</code> and registers two <code class="literal">Student</code> objects with it. Then it changes the
    message. When you run the code, you should see each <code class="literal">Student</code> object print the message as it is
    notified.</p>
<p id="you_can_imagine">You can imagine how you could implement the observer/observable
    relationship yourself using a <code class="literal">List</code> to
    hold the list of observers. In <a class="xref" href="ch16.html" title="ChapterÂ 16.Â Swing">ChapterÂ 16</a> and
    beyond, weâ€™ll see that the Java AWT and Swing event model extends this
    design pattern to use strongly typed observables and observers, which are
    called events and event listeners. But for now, we turn our discussion of
    core utilities to another fundamental topic: I/O.<a id="id742505" class="indexterm"></a><a id="id742515" class="indexterm"></a></p>
</div>
<div class="footnotes">
<br><hr style="width: 100; align: left;">
<div id="ftn.learnjava3-CHP-11-FN-1" class="footnote"><p><a href="#learnjava3-CHP-11-FN-1" class="para"><sup class="para">[31] </sup></a><a id="id716072" class="indexterm"></a><a id="id716078" class="indexterm"></a>The generator uses a linear congruential formula. See
          <span class="emphasis"><em>The Art of Computer Programming</em></span>,
          <span class="emphasis"><em>Volume 2: Semi-numerical Algorithms</em></span> by Donald
          Knuth (Addison-Wesley).</p></div>
<div id="ftn.learnjava3-CHP-11-FN-2" class="footnote"><p><a href="#learnjava3-CHP-11-FN-2" class="para"><sup class="para">[32] </sup></a>Prior to Java 1.1, the <code class="literal">Date</code>
        class handled some of the functions of a calendar as well. Most of
        these methods have now been deprecated. Today, the only purpose of the
        <code class="literal">Date</code> class is to represent a point
        in time.</p></div>
<div id="ftn.learnjava3-CHP-11-FN-3" class="footnote"><p><a href="#learnjava3-CHP-11-FN-3" class="para"><sup class="para">[33] </sup></a>Javaâ€™s <a id="id716739" class="indexterm"></a><code class="literal">GregorianCalendar</code>
        class is actually both a Julian and Gregorian calendar with a
        programmable cut-over date. For a wealth of information about time and
        world time-keeping conventions, see the <a class="ulink" href="http://tycho.usno.navy.mil" target="_top">U.S. Navy Directorate of
        Time</a>.</p></div>
</div></section><footer><div class="navfooter">
<hr>
<table style="width: 100%; ">
<tr>
<td style="width: 40%; text-align: left; ">
<a accesskey="p" href="ch10.html">Prev</a>Â </td>
<td style="width: 20%; text-align: center; ">Â </td>
<td style="width: 40%; text-align: right; ">Â <a accesskey="n" href="ch12.html">Next</a>
</td>
</tr>
<tr>
<td style="width: 40%; text-align: left; vertical-align: top; ">ChapterÂ 10.Â Working with TextÂ </td>
<td style="width: 20%; text-align: center; "><a accesskey="h" href="index.html">Home</a></td>
<td style="width: 40%; text-align: right; vertical-align: top; ">Â ChapterÂ 12.Â Input/Output Facilities</td>
</tr>
</table>
</div></footer>


	<div class="extra-footer">
		<p>Â© 2013, Oâ€™Reilly Media, Inc.</p>
		<ul>
			<li><a href="http://oreilly.com/terms/">Terms of Service</a></li>
			<li><a href="http://oreilly.com/oreilly/privacy.csp">Privacy Policy</a></li>
			<li>Interested in <a href="mailto:scordesse@oreilly.com">sponsoring content?</a></li>
		</ul>
	</div>
<script type="text/javascript">if (!NREUMQ.f) { NREUMQ.f=function() {
NREUMQ.push(["load",new Date().getTime()]);
var e=document.createElement("script");
e.type="text/javascript";
e.src=(("http:"===document.location.protocol)?"http:":"https:") + "//" +
  "js-agent.newrelic.com/nr-100.js";
document.body.appendChild(e);
if(NREUMQ.a)NREUMQ.a();
};
NREUMQ.a=window.onload;window.onload=NREUMQ.f;
};
NREUMQ.push(["nrfj","beacon-3.newrelic.com","3e361aebcf","2194180","IApbRUBZXg1WEEoHDAwORh5aQl8N",20,132,new Date().getTime(),"","","","",""]);</script></body>
</html>
