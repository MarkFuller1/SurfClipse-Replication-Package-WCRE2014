<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="robots" content="index, follow, noarchive" />
    <meta name="description" content="I have inherited and am trying to finish up an implementation of a Pub/Sub service using WCF. The Pub/Sub Serivce is hosted in a Windows service and is meant to run forever. I have another service..." />
    <meta name="google-site-verification" content="_5cXhFki_NrEovleFuuN-9eaHvpDQv1Y3I5e1bIesa0" />
    <meta name="msvalidate.01" content="19C984E796A6C2E12B5745B0A771521A" />
    <link rel="publisher" href="https://plus.google.com/110263686057287067086" />
    <meta name="yandex-verification" content="54b30aacc4e975b3" />
    <meta name="keywords" content="WCF DuplexClientChannel, Web Services and WCF" />
    <link rel="canonical" href="http://www.experts-exchange.com/Programming/Languages/.NET/Web_Services/Q_26718112.html" />
    <link rel="alternate" href="http://mobile.experts-exchange.com/Programming/Languages/.NET/Web_Services/Q_26718112.html" media="only screen and (max-width: 640px)" />
    <meta property="og:title" content="Am I abusing WCF?: WCF DuplexClientChannel" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="http://www.experts-exchange.com/Programming/Languages/.NET/Web_Services/Q_26718112.html" />
    <meta property="og:image" content="http://experts.cachefly.net/images/experts-exchange/experts-exchange-logo-opengraph.png" />
    <title>Am I abusing WCF?: WCF DuplexClientChannel</title>
    <link rel="shortcut icon" href="http://experts.cachefly.net/images/experts-exchange/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic|Droid+Sans:400,700" /> <!--[if lte IE 8]> <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Droid+Serif:700|Droid+Sans:700" /> <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Droid+Serif:400italic" /> <![endif]-->
    <link rel="stylesheet" href="http://experts.cachefly.net/css/2/2492bbabd34e2ec860a2767a72fe00257ad32bf5532a02e380bb7261332a2d6b.css" media="all" />
    <link rel="stylesheet" href="http://experts.cachefly.net/css/2/c569f208fe870a2ef0d6fef555c9e6de49c2d2b18e248b16c2a4207db125b989.css" media="all" />
    <script type="text/javascript" src="http://experts.cachefly.net/js/2/f09e9cd63ac1c0e53a5d9e59455fc407cdaaad8948bdb858d154062a6d7f2b6d.js"></script>
    <script type="text/javascript" src="http://experts.cachefly.net/js/2/c12a5a82ee62b43bec06baa440d61ccdf5a75b1b1f9b8416fd11267ccfd96f19.js"></script>
    <script type="text/javascript">
        <!--
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-25977090-13']);
        _gaq.push(['_setCustomVar', 1, 'User Segmentation', 'Free Trial Guest', 2]);
        _gaq.push(['_setCustomVar', 2, 'VQP ID', '201309-EE-VQP-052', 2]);
        _gaq.push(['_setDomainName', 'experts-exchange.com']);
        _gaq.push(['_setAllowLinker', true]);
        _gaq.push(['_trackEvent', 'General', 'Page View', 'LO - 201309-EE-VQP-052', undefined]);
        _gaq.push(['_trackPageview']);
        //-->
    </script>
    <script type="text/javascript">
      var EETOP={};EETOP.startTime=new Date();EETOP.url='';EETOP.memberBehaviorId=0;EETOP.setUrl=function(url)
      {EETOP.url=url;}
      EETOP.setMemberBehaviorId=function(memberBehaviorId)
      {EETOP.memberBehaviorId=memberBehaviorId;}
      timeOnPage=function()
      {var endTime=new Date();var timeSpent=(endTime-EETOP.startTime);if(EETOP.memberBehaviorId>0)
      {var json={'timeOnPage':timeSpent,'memberBehaviorId':EETOP.memberBehaviorId};onUnloadSubrequest(EETOP.url,json);}}
      if(window.addEventListener)
      {window.addEventListener('beforeunload',timeOnPage,false);}
      else if(window.attachEvent)
      {window.attachEvent('beforeunload',timeOnPage);}
      function setTimeOnPageUrl(url)
      {EETOP.setUrl(url);}
      function setTimeOnPageMemberBehaviorId(id)
      {EETOP.setMemberBehaviorId(id);}
      setTimeOnPageUrl('/jsp/timeOnPage.jsp');
      setTimeOnPageMemberBehaviorId(1);
    </script>
  </head>
  <body class="characterTreatment bugFinder" itemscope="itemscope" itemtype="http://schema.org/WebPage">
    <div id="uberContainer">
      <div id="wrapper1">
        <div id="wrapper2">
          <div id="header">
            <div id="headerInnerWrap">
              <div class="component navigationTabs altNavigation" id="navigationTabs">
                <div class="body">
                  <div class="section">
                    <ul class="">
                      <li class="uiTab-00 ft ft-startlink first last"><a class="tab uiTabTarget-00" href="/register.jsp?redirect=/Programming/Languages/.NET/Web_Services/Q_26718112.html" target="_self" title="Start Free Trial"><span>Start Free Trial</span></a></li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="component toggleButton navigationTabs altNavigation" id="toggleButton">
                <div class="body">
                  <a class="button toggleButton login-toggle" href="#" title="Login"><span>Login</span></a>
                </div>
              </div>
              <div class="component navigationTabs altNavigation" id="navigationTabs-id2">
                <div class="body">
                  <div class="section">
                    <ul class="">
                      <li class="uiTab-00 first"><a class="tab uiTabTarget-00" href="http://support.experts-exchange.com" target="_blank" title="Get Help Using the Site"><span>Help</span></a></li>
                      <li class="uiTab-01 last"><a class="tab uiTabTarget-01" href="/aboutUs.jsp" target="_self" title="About Experts Exchange"><span>About Us</span></a></li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="hidden reactivate" id="loginToggle">
                <div class="component login" id="login">
                  <div class="body">
                    <div class="section">
                      <form action="https://secure.experts-exchange.com/login.jsp?redirect=/Programming/Languages/.NET/Web_Services/Q_26718112.html" method="post" id="login-loginForm" onsubmit="return submitOnce('#login-loginForm');">
                        <div>
                          <div class="input text">
                            <div>
                              <input class="ghostUsername inputUsername" id="login-loginForm-loginName" maxlength="90" name="loginName" type="text" value="Username or email address" />
                            </div>
                          </div>
                        </div>
                        <div>
                          <div class="input password">
                            <div>
                              <input class="ghostPassword inputPassword" id="login-loginForm-loginPassword" maxlength="30" name="loginPassword" type="text" value="Password" />
                            </div>
                          </div>
                        </div>
                        <div class="input checkbox show-password">
                          <div class="selectionWrapper">
                            <ul>
                              <li class="first last">
                                <input class="showPassword ghostPassword" id="login-loginForm-showPassword-checkbox-null" name="showPassword" type="checkbox" />
                                <label for="login-loginForm-showPassword-checkbox-null">Show Password</label>
                              </li>
                            </ul>
                          </div>
                        </div>
                        <script type="text/javascript">
                          jqOne('#login .ghostPassword.showPassword','click',function(e){if(jqGetValue('#login .inputPassword') == 'Password'){replaceInput('#login .inputPassword','text',jqGetProperty('#login .inputPassword','id'),jqGetProperty('#login .inputPassword','name'),'',jqGetProperty('#login .inputPassword','className'));jqTrigger('#login .inputPassword','focus');jqOff('#login .ghostPassword.showPassword','focus');}});jqOn('#login .showPassword','change',function(e){if(is('#login .showPassword',':checked')){replaceInput('#login .inputPassword','text',jqGetProperty('#login .inputPassword','id'),jqGetProperty('#login .inputPassword','name'),jqGetProperty('#login .inputPassword','value'),'inputPassword','30')}else{replaceInput('#login .inputPassword','password',jqGetProperty('#login .inputPassword','id'),jqGetProperty('#login .inputPassword','name'),jqGetProperty('#login .inputPassword','value'),'inputPassword','30')}});
                        </script>
                        <script type="text/javascript">
                          jqOne('#login .ghostUsername','focus',function(e){jqClearTextField(this);return false;});
                          jqOne('#login .ghostPassword.inputPassword','focus',function(e){replaceInput('#login .ghostPassword.inputPassword','password',jqGetProperty('#login .ghostPassword.inputPassword','id'),jqGetProperty('#login .ghostPassword.inputPassword','name'),'',jqGetProperty('#login .ghostPassword.inputPassword','className'));jqTrigger('#login .ghostPassword.inputPassword','focus');jqFocus('#login .ghostPassword.inputPassword');});
                        </script>
                        <div class="input checkbox remember-me">
                          <div class="selectionWrapper">
                            <ul>
                              <li class="first last">
                                <input id="login-loginForm-rememberMe-checkbox-null" name="rememberMe" type="checkbox" />
                                <label for="login-loginForm-rememberMe-checkbox-null">Keep Me Logged In</label>
                              </li>
                            </ul>
                          </div>
                        </div>
                        <p class="buttons">
                          <button class="button confirm" name="loginSubmit" title="Login" type="submit"><span>Login</span></button>
                          <script type="text/javascript">
                            var anchorValue = window.location.hash.substr(1);
                            var anchor = $("<input>", { type: "hidden", name: "anchor", value: anchorValue });
                            
                            if (anchorValue) {
                               $('#login-loginForm').append($(anchor));
                            }
                            
                          </script>
                          <a class="button forgotPasswordLink" href="/forgotPassword.jsp" title="Forgot your password?"><span>Forgot your password?</span></a><a class="button signUp" href="/register.jsp?redirect=/Programming/Languages/.NET/Web_Services/Q_26718112.html" title="Sign Up"><span>Sign Up</span></a></p>
                      </form>
                    </div>
                  </div>
                </div>
                <script id="contentJavascript" type="text/javascript">
                  loginToggle();
                </script>
              </div>
              <span class="component textComponent" id="textComponent"><script type="text/javascript">
              $(document).ready(function() {
              	if ($(".ft-startlink a span").text() == "Join Today") 
              		$("#loginToggle").css("right", "-40px");
              });
              </script></span>
              <div id="flex1">
                <div class="component navigationTabs stlco mainNavigation" id="navigationTabs-id3">
                  <div class="body">
                    <div class="section">
                      <ul class="">
                        <li class="uiTab-00 first"><a class="tab uiTabTarget-00" href="/register.jsp?redirect=/askQuestion.jsp?taid=3923" target="_self" title="Ask The Experts A Question"><span>Ask</span></a></li>
                        <li class="uiTab-01"><a class="tab uiTabTarget-01" href="/expertSignUp.jsp?redirect=/questionList.jsp?ts=open-questions" target="_self" title="Are You An Expert? Answer Questions for Free Access!"><span>Answer</span></a></li>
                        <li class="uiTab-02 topics"><a class="tab uiTabTarget-02" href="/allTopics.jsp" target="_self" title="Browse All Topics"><span>Topics</span></a>
                          <ul class="">
                            <li class="uiTab-02-00 first"><a class="tab uiTabTarget-02-00" href="/Microsoft/" target="_self" title="Microsoft"><span>Microsoft</span></a></li>
                            <li class="uiTab-02-01"><a class="tab uiTabTarget-02-01" href="/Apple/" target="_self" title="Apple"><span>Apple</span></a></li>
                            <li class="uiTab-02-02"><a class="tab uiTabTarget-02-02" href="/Digital_Living/" target="_self" title="Digital Living"><span>Digital Living</span></a></li>
                            <li class="uiTab-02-03"><a class="tab uiTabTarget-02-03" href="/Hardware/" target="_self" title="Hardware"><span>Hardware</span></a></li>
                            <li class="uiTab-02-04"><a class="tab uiTabTarget-02-04" href="/Software/" target="_self" title="Software"><span>Software</span></a></li>
                            <li class="uiTab-02-05"><a class="tab uiTabTarget-02-05" href="/OS/" target="_self" title="Operating Systems"><span>Operating Systems</span></a></li>
                            <li class="uiTab-02-06"><a class="tab uiTabTarget-02-06" href="/Storage/" target="_self" title="Storage"><span>Storage</span></a></li>
                            <li class="uiTab-02-07"><a class="tab uiTabTarget-02-07" href="/Database/" target="_self" title="Database"><span>Database</span></a></li>
                            <li class="uiTab-02-08"><a class="tab uiTabTarget-02-08" href="/Security/" target="_self" title="Security"><span>Security</span></a></li>
                            <li class="uiTab-02-09 selected"><a class="tab uiTabTarget-02-09" href="/Programming/" target="_self" title="Programming"><span>Programming</span></a></li>
                            <li class="uiTab-02-10"><a class="tab uiTabTarget-02-10" href="/Web_Development/" target="_self" title="Web Development"><span>Web Development</span></a></li>
                            <li class="uiTab-02-11"><a class="tab uiTabTarget-02-11" href="/Networking/" target="_self" title="Networking"><span>Networking</span></a></li>
                            <li class="uiTab-02-12"><a class="tab uiTabTarget-02-12" href="/Virus_and_Spyware/" target="_self" title="Virus &amp; Spyware"><span>Virus &amp; Spyware</span></a></li>
                            <li class="uiTab-02-13"><a class="tab uiTabTarget-02-13" href="/Copy_Review/" target="_self" title="Copy Review"><span>Copy Review</span></a></li>
                            <li class="uiTab-02-14 last"><a class="tab uiTabTarget-02-14" href="/allTopics.jsp" target="_self" title="Browse All"><span>Browse All</span></a></li>
                          </ul>
                        </li>
                        <li class="uiTab-03"><a class="tab uiTabTarget-03" href="/articles/" target="_self" title="View All Articles"><span>Articles</span></a></li>
                        <li class="uiTab-04"><a class="tab uiTabTarget-04" href="/videos/" target="_self" title="Learn a new technology or refresh your skills with Cloud Class Video Tutorials"><span>Cloud Class</span></a>
                          <ul class="">
                            <li class="uiTab-04-00 first"><a class="tab uiTabTarget-04-00" href="/cloud-class-live/" target="_self" title="Live Instruction"><span>Live Instruction</span></a></li>
                            <li class="uiTab-04-01 last"><a class="tab uiTabTarget-04-01" href="/tutorials/" target="_self" title="Video Tutorials"><span>Video Tutorials</span></a></li>
                          </ul>
                        </li>
                        <li class="uiTab-05"><a class="tab uiTabTarget-05" href="/BugFinder/" target="_self" title="Bug Finder"><span>Bug Finder</span></a>
                          <ul class="">
                            <li class="uiTab-05-00 first"><a class="tab uiTabTarget-05-00" href="/BugFinder/projects.jsp" target="_self" title="View Open Projects"><span>Start Testing</span></a></li>
                            <li class="uiTab-05-01"><a class="tab uiTabTarget-05-01" href="/BugFinder/addProject.jsp" target="_self" title="Submit a Project"><span>Submit a Project</span></a></li>
                            <li class="uiTab-05-02"><a class="tab uiTabTarget-05-02" href="/BugFinder/?ts=how" target="_self" title="How it Works"><span>How it Works</span></a></li>
                            <li class="uiTab-05-03 last"><a class="tab uiTabTarget-05-03" href="/BugFinder/?ts=experts" target="_self" title="Points for Experts"><span>Points for Experts</span></a></li>
                          </ul>
                        </li>
                        <li class="uiTab-06 more-results last"><a class="tab uiTabTarget-06" href=" " target="_self" title="More"><span>&#43;</span></a>
                          <ul class="">
                            <li class="uiTab-06-00 first"><a class="tab uiTabTarget-06-00" href="http://drackula.experts-exchange.com/" target="_self" title="Datacenter Management Tools"><span>Drackula DCIM</span></a></li>
                            <li class="uiTab-06-01"><a class="tab uiTabTarget-06-01" href="/Copy_Review/" target="_self" title="Writing Help"><span>Writing Help</span></a></li>
                            <li class="uiTab-06-02"><a class="tab uiTabTarget-06-02" href="http://careers.experts-exchange.com/" target="_self" title="Job Board"><span>Job Board</span></a></li>
                            <li class="uiTab-06-03"><a class="tab uiTabTarget-06-03" href="/discoverBusinessAccounts.jsp" target="_self" title="Business Accounts"><span>Business Accounts</span></a></li>
                            <li class="uiTab-06-04 last"><a class="tab uiTabTarget-06-04" href="http://blog.experts-exchange.com/" target="_self" title="EE Blog"><span>EE Blog</span></a></li>
                          </ul>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="component logoComponent stlco" id="logoComponent">
                  <div class="body">
                    <div class="section">
                      <h2><a href="/" title="Experts Exchange Home">
                        <img alt="Experts Exchange Logo" src="http://experts.cachefly.net/images/experts-exchange/experts-exchange-logo.png" title="Experts Exchange" />
                        </a></h2>
                    </div>
                  </div>
                </div>
              </div>
              <div class="component searchFormSimple" id="searchFormSimple">
                <div class="body">
                  <div class="section">
                    <form action="/searchResults.jsp" method="get" id="searchFormSimple-form" onsubmit="return submitOnce('#searchFormSimple-form');">
                      <div class="input text">
                        <div>
                          <input class="search" id="searchFormSimple-form-searchTerms" name="searchTerms" type="text" value="Search Experts Exchange" />
                        </div>
                      </div>
                      <p class="buttons">
                        <button class="button submit" name="searchSubmit" type="submit"></button>
                      </p>
                      <script type="text/javascript">
                        jqOne('#searchFormSimple .search','focus',function(e){jqClearTextField(this);return false;});
                      </script>
                    </form>
                  </div>
                </div>
              </div>
              <div class="component textComponent header-advanced-search" id="textComponent-id2">
                <div class="body">
                  <div class="section">
                  </div>
                </div>
              </div>
              <div class="component breadcrumb stlco" id="breadcrumb">
                <div class="body" itemprop="breadcrumb">
                    <a href="/" title="Experts Exchange"><span>Experts Exchange</span></a> &#62; <a href="/Programming/" title="Programming"><span>Programming</span></a> &#62; <a href="/Programming/Languages/" title="Prog Languages"><span>Prog Languages</span></a> &#62; <a href="/Programming/Languages/.NET/" title=".NET Programming"><span>.NET Programming</span></a> &#62; <a href="/Programming/Languages/.NET/Web_Services/" title="Web Services and WCF"><span>Web Services and WCF</span></a> &#62;   Am I abusing WCF?
                </div>
              </div>
              <script id="contentJavascript-id2" type="text/javascript">
                baUpgradeCtaMove();
              </script>
            </div>
          </div>
          <div id="flex2"></div>
          <div id="bodyWrapper">
            <div id="columnsWrapper">
              <div id="col1Wrap">
                <div id="col1">
                  <div class="viewQuestionWrapper ft-v1">
                    <div class="component viewQuestionHeader ctContentHead" id="viewQuestionHeader">
                      <div class="head">
                        <h2 class="title">Question</h2>
                        <div class="ui-chrome"></div>
                      </div>
                      <div class="body layout1">
                        <div class="section"></div>
                      </div>
                    </div>
                    <div class="component questionView stlco ctContentView lo" id="questionView">
                      <div class="body">
                        <div class="section first last">
                          <h1 class="commentable-title">Am I abusing WCF?</h1>
                          <div class="meta leading-meta">
                            <span class="author">Asked by: <a href="/M_4450696.html">mfenske17363</a></span>
                          </div>
                          <div class="content btf-content">
                            <div class="first">
                              I have inherited and am trying to finish up an implementation of a Pub/Sub service using WCF. &nbsp;The Pub/Sub Serivce is hosted in a Windows service and is meant to run forever. &nbsp;I have another service (non WCF) that receives data via TCP and stores that data in a database. &nbsp;As each record is received, an ACK is sent back to the TCP client.<br /><br />During all this activity, I am generating internal events (essentially a small status structure) during receive/send activity along with a string representing the data. &nbsp;The event is published for any subscriber that cares - in my case only a UI form that has its visuals updated.<br /><br />The transmissions recevied are essentially bursts of say 200 records at a time each requiring a response and each generating a pub/sub event.<br /><br />Mostly things work OK but sometimes periodically the sender will call the PostEvent method of the PubSubClient that is supposed to forward the call via the WCF Channel to the actual WCF service. &nbsp;I can see a bunch of calls &quot;stack up&quot; at the PubSubClient level and UI updates stop occurring then after several seconds the WCF service picks up processing them by adding them it an internal event queue which is worked off in another thread (CallClients).<br /><br />If things were getting stalled inside the service I might look how I am managing the inbound event queue but it definitely appears as though the events are not making it onto the Channel at all.<br /><br />Am I asking too much from WCF?<br /><br />I have tried several different incantations of settings for the service but nothing seems to help.<br /><br />I am gonna to include a significant amount of code to this post in hopes someone can spot something wrong.<br /><br />Thanks!<br /><br /><br />&nbsp;
                            </div>
                            <div class="attachment embedded last">
                              <div class="snippet">
                                <div>
                                  <pre class="code ">
<code id="questionViewCode10-26718112-6331404">================================================
Pub Sub Service Interface
================================================

using System;
using System.ServiceModel;
using System.Runtime.Serialization;
using EventObjects;

namespace Shared.Interfaces
{
    [DataContract]
    public enum EN_EVENT_TYPE
    {
        [EnumMember]
        ET_ALL = -1,
        [EnumMember]
        ET_INST_STATUS = 177,
        [EnumMember]
        ET_RAW_RESULTS_READY,
        [EnumMember]
        ET_REQUEST_SERVICE_STATUS,
        [EnumMember]
        ET_REQUEST_STATUS,
    }

    [ServiceContract(SessionMode = SessionMode.Required, CallbackContract = typeof(IEventPubSubServiceCallback))]
    [ServiceKnownType(typeof(clsBaseEvent))]
    [ServiceKnownType(typeof(clsInstState))]
    public interface IEventPubSubService
    {
        //
        // In order to prevent dead lock situation, make the interfaces
        // one way.  Otherwise we could post an event that is consumed by
        // another client that in its handler tries to send out its own
        // event and locks up the first client.
        //
        [OperationContract (IsOneWay=true, IsInitiating=true)]
        void Subscribe(EN_EVENT_TYPE evtType);

        [OperationContract(IsOneWay = true, IsInitiating = false, IsTerminating = true)]
        void Unsubscribe();

        [OperationContract (IsOneWay=true)]
        void PostEvent(object evt, EN_EVENT_TYPE evtType);

        [OperationContract(IsOneWay = true)]
        void KeepAlive();
    }

    public interface IEventPubSubServiceCallback
    {
        [OperationContract]
        [ServiceKnownType(typeof(clsBaseEvent))]
        [ServiceKnownType(typeof(clsInstState))]
        void EventCallback(object evt, EN_EVENT_TYPE evtType);
    }
}


================================================
Pub Sub Service - Hosted in Windows Service
================================================

using System;
using System.ServiceModel;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using Shared.Interfaces;
using LoggerClient;
using EventObjects;

namespace EventPubSubService
{
    class clsThreadParams
    {
        public AutoResetEvent[] _eventTriggers;
    }

    /******************************************************************************
	*
	* Class:        EventPubSubService
	*
	* Description:  Receive and distribute system wide events.
	*
	******************************************************************************/
    [ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Multiple,
        InstanceContextMode = InstanceContextMode.Single)] 

    public class EventPubSubService : IEventPubSubService, IDisposable
    {
        const int MAX_EVENTS = 2;
        const int SHUTDOWN_EVENT = 0;
        const int CALLBACK_EVENT = 1;

        // static?
        static clsLoggerClient _Logger = null;

        //
        // Track whether Dispose has been called.
        //
        private bool _disposed = false;

        // make event types a List instead of array?
        private static Dictionary&lt;IEventPubSubServiceCallback, EN_EVENT_TYPE[]&gt; _callbackList = new Dictionary&lt;IEventPubSubServiceCallback, EN_EVENT_TYPE[]&gt;();

        //
        // queue to hold incoming events
        //
        private static Queue&lt;clsEventQueueObject&gt; _eventQueue = new Queue&lt;clsEventQueueObject&gt;(100);

        private AutoResetEvent _callTrigger = null;
        private AutoResetEvent _shutdown = null;
        private clsThreadParams _threadParams = null;

        private int _eventId = 0;

        //
        // thread to work off events
        //
        private Thread _callThread = null;

        /// &lt;summary&gt;
        /// Constructor
        /// &lt;/summary&gt;

        public EventPubSubService()
        {
            try
            {
                _Logger = new clsLoggerClient();

                //
                // create a thread parameter package for the callback thread
                //
                _threadParams = new clsThreadParams();
                _threadParams._eventTriggers = new AutoResetEvent[MAX_EVENTS];

                _shutdown = new AutoResetEvent(false);
                _threadParams._eventTriggers[SHUTDOWN_EVENT] = _shutdown;
                _callTrigger = new AutoResetEvent(false);
                _threadParams._eventTriggers[CALLBACK_EVENT] = _callTrigger;

                //
                // start thread to callback clients
                //
                _callThread = new Thread(CallClients);
                _callThread.Start(_threadParams);

                _eventId = 0;

                _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::Constructor - Service constructed&quot;));

            }
            catch (Exception ex)
            {
                _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::Constructor - Failed:{0}&quot;,
                    ex.Message));
            }
        }

        public void Dispose()
        {
            Dispose(true);
            // This object will be cleaned up by the Dispose method.
            // Therefore, you should call GC.SupressFinalize to
            // take this object off the finalization queue
            // and prevent finalization code for this object
            // from executing a second time.
            GC.SuppressFinalize(this);
        }

        /// &lt;summary&gt;
        /// Dipose
        /// Executes in two distinct scenarios.
        /// If disposing equals true, the method has been called directly
        /// or indirectly by a user's code. Managed and unmanaged resources
        /// can be disposed.
        /// If disposing equals false, the method has been called by the
        /// runtime from inside the finalizer and you should not reference
        /// other objects. Only unmanaged resources can be disposed.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;disposing&quot;&gt;&lt;/param&gt;
        private void Dispose(bool disposing)
        {
            // Check to see if Dispose has already been called.
            if (!this._disposed)
            {
                // If disposing equals true, dispose all managed
                // and unmanaged resources.
                if (disposing)
                {
                    //
                    // shutdown the callback thread
                    //
                    _shutdown.Set();
                }

                // Call the appropriate methods to clean up
                // unmanaged resources here.
                // If disposing is false,
                // only the following code is executed.

                // Note disposing has been done.
                _disposed = true;
            }
        }

        /// &lt;summary&gt;
        /// Subscribe
        /// Client calls this to register to receive callbacks
        /// as new events are posted.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;evtType&quot;&gt;Event type from the EN_EVENT_TYPE enumeration&lt;/param&gt;

        public void Subscribe(EN_EVENT_TYPE evtType)
        {
            //
            // get callback channel for calling client
            //
            IEventPubSubServiceCallback callback = OperationContext.Current.GetCallbackChannel&lt;IEventPubSubServiceCallback&gt;();

            lock (_callbackList)
            {
                //
                // if they aren't already in the callback list, add em.
                //
                if (!_callbackList.ContainsKey(callback))
                {
                    _callbackList.Add(callback, new EN_EVENT_TYPE[] { evtType });
                    _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::Subscribe - Client connected:{0}&quot;, callback));
                }
                else
                {
                    EN_EVENT_TYPE[] subscribedEvents = _callbackList[callback];

                    Array.Resize&lt;EN_EVENT_TYPE&gt;(ref subscribedEvents, subscribedEvents.Length + 1);
                    subscribedEvents[subscribedEvents.Length - 1] = evtType;

                    _callbackList[callback] = subscribedEvents;
                    _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::Subscribe - callback appended&quot;));
                }
            }
        }

        /// &lt;summary&gt;
        /// Unsubscribe
        /// Called by clients that are no longer interested in events
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// History
        ///	Date        Author          Description of Change
        ///	09/29/2010  Michael Fenske  Created
        /// &lt;/remarks&gt;
        public void Unsubscribe()
        {
            //
            // get callback channel for calling client
            //
            IEventPubSubServiceCallback callback = OperationContext.Current.GetCallbackChannel&lt;IEventPubSubServiceCallback&gt;();

            //
            // if we find em in the callback list, remove em
            //
            lock (_callbackList)
            {
                if (_callbackList.ContainsKey(callback))
                {
                    _callbackList.Remove(callback);
                    _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::Unsubscribe - Client disconnected&quot;));
                }
                else
                {
                    _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::Unsubscribe - Cannot find callback&quot;));
                    throw new InvalidOperationException(&quot;Cannot find callback&quot;);
                }
            }
        }

        /// &lt;summary&gt;
        /// PostEvent
        /// Called when a new event is generated for the  
        /// system.  All subscribed clients for the event type
        /// are then informed of the new event.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;evt&quot;&gt;event payload&lt;/param&gt;
        /// &lt;param name=&quot;evtType&quot;&gt;Event type from the EN_EVENT_TYPE enumeration&lt;/param&gt;
        public void PostEvent(object evt, EN_EVENT_TYPE evtType)
        {
            Interlocked.Increment(ref _eventId);
            ((clsBaseEvent)evt).EventId = _eventId;

            lock (_eventQueue)
            {
                clsEventQueueObject evtObj = new clsEventQueueObject(evt, evtType);
                _eventQueue.Enqueue(evtObj);

                _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::PostEvent - New event received:{0}:{1}&quot;,
                    evtType, ((clsBaseEvent)evt).EventId));
            }

            //
            // post to the callback clients
            //
            _callTrigger.Set();
        }

        /// &lt;summary&gt;
        /// CallClients
        /// Peruse the callback list and attempt to send the
        /// event and event payload to each registered client.
        /// Wound up doing old style looping (as opposed to something more
        /// LINQish so that we could catch an unexpectedly disconnected 
        /// client and clean it out of the callback list.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;evt&quot;&gt;event payload&lt;/param&gt;
        /// &lt;param name=&quot;evtType&quot;&gt;Event type from the EN_EVENT_TYPE enumeration&lt;/param&gt;

        private static void CallClients(object tParams) 
        {
            clsThreadParams threadParams = (clsThreadParams)tParams;
            clsEventQueueObject eventObj = null;

            while (true)
            {
                int index = WaitHandle.WaitAny(threadParams._eventTriggers);                        // includes shutdownEvent, callback trigger
                _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::CallClients - Semaphore triggered:{0}&quot;,
                    index));

                if (index == SHUTDOWN_EVENT) // shutdown event
                {
                    //
                    // end the thread
                    //
                    break;
                }

                _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::CallClients - _eventQueue Count:{0}&quot;,
                    _eventQueue.Count));

                while (_eventQueue.Count != 0)
                {
                    lock (_eventQueue)
                    {
                        eventObj = _eventQueue.Dequeue();

                        _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::CallClients - Calling subscribers of event:{0}:{1}&quot;,
                            eventObj.EventType, ((clsBaseEvent)eventObj.EventPayload).EventId));
                    }

                    //
                    // callback client
                    //
                    //
                    //  Delegate to call to notify each subscriber
                    //
                    Action&lt;IEventPubSubServiceCallback&gt; notifySubscriber = callback =&gt;
                    {
                        try
                        {
                            _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::CallClients - Invoking callback&quot;));

                            callback.EventCallback(eventObj.EventPayload, eventObj.EventType);
                        }
                        catch (Exception ex)
                        {
                            //
                            // remove client from callback list
                            // _callbackList is already locked
                            //
                            if (_callbackList.ContainsKey(callback))
                            {
                                _callbackList.Remove(callback);
                                _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::Unsubscribe - Client disconnected&quot;));
                            }

                            _epiLogger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::CallClients Exception- {0}:{1}&quot;,
                                ex.Message, callback));
                        }
                    };

                    //
                    // List of subscribers for this particular event is retrieved from the dictionary
                    // This is a sublist based on EN_EVENT_TYPE
                    //
                    List&lt;IEventPubSubServiceCallback&gt; recipients = new List&lt;IEventPubSubServiceCallback&gt;();

                    lock (_callbackList)
                    {
                        //
                        // peruse the list and invoke the callback
                        // method for each client
                        //
                        _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::CallClients - Building callback list&quot;));

                        foreach (KeyValuePair&lt;IEventPubSubServiceCallback, EN_EVENT_TYPE[]&gt; kvp in _callbackList)
                        {
                            if (kvp.Value.Contains(eventObj.EventType) || kvp.Value.Contains(EN_EVENT_TYPE.ET_ALL))
                            {
                                recipients.Add((IEventPubSubServiceCallback)kvp.Key);
                            }
                        };

                        //
                        //  if there are any subscribers, publish this event to them
                        //
                        if (recipients.Count &gt; 0)
                        {
                            _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubService::CallClients - Calling {0} recipients&quot;,
                                recipients.Count));

                            recipients.ForEach(notifySubscriber);
                        }
                    }
                }
            }
        }

        /// &lt;summary&gt;
        /// KeepAlive
        /// Called by client to keep connection alive
        /// &lt;/summary&gt;

        public void KeepAlive()
        {
            //
            // Do Nothing
            //
        }
    }
}

================================================
Event Objects
================================================
using System;
using System.Diagnostics;
using System.Runtime.Serialization;
using System.Threading;

namespace EventObjects
{
    [DataContract]
    public class clsBaseEvent
    {
        [DataMember]
        public int EventId { get; set; }

        [DataMember]
        public int ProcId { get; set; }

        /// &lt;summary&gt;
        /// Constructor
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;eventId&quot;&gt;&lt;/param&gt;
        public clsBaseEvent()
        {
            ProcId = Process.GetCurrentProcess().Id;
        }
    }


    [DataContract]
    public enum EN_SERVICE_STATE
    {
        [EnumMember]
        SS_OFFLINE = 0,
        [EnumMember]
        SS_ONLINE
    }

    [DataContract]
    public enum EN_INST_STATE
    {
        [EnumMember]
        IS_OFFLINE = 0,
        [EnumMember]
        IS_ONLINE,
        [EnumMember]
        IS_ERROR,
    }


    [DataContract]
    public class clsInstState : clsBaseEvent
    {
        [DataMember]
        public EN_SERVICE_STATE ServiceState { get; set; }
        [DataMember]
        public int InstNumber { get; set; }
        [DataMember]
        public EN_INST_STATE InstState { get; set; }
        [DataMember]
        public bool XmitState { get; set; }
        [DataMember]
        public bool RecvState { get; set; }
        [DataMember]
        public string StatusText { get; set; }
    }
}

================================================
Pub Sub Service Client Wrapper
================================================

using System;
using System.ServiceModel;
using BD.EpiCenter.Shared.Interfaces;
using System.Timers;
using BD.EpiCenter.EpiCenterLoggerClient;

namespace BD.EpiCenter.EventPubSubClient
{
    /******************************************************************************
	*
	* Class:        clsEventPubSubClient
	*
	* Description:  Client wrapper for the Event Pub Sub service that establishes 
     * a connection to the service via DuplexClientBase and the app domain's
     * app.config file.  On construction, the owner must supply a context (either itself
     * or another object it owns) that implements the IEventPubSubServiceCallback
     * interface.  
     * If the owner will only post events, the clsEventPubSubCallback class
     * in EventPubSubPublisher can be used which will have an empty callback method.
     * If the owner will both post and receive events, the owner will implement the 
     * callback interface directly by inheriting IEventPubSubServiceCallback and 
     * implementing the EventCallback method.

	******************************************************************************/
    public class clsEventPubSubClient : DuplexClientBase&lt;IEventPubSubService&gt;, IEventPubSubService
    {
        const int TIMER_INTERVAL = 1000 * 60 * 7;   // 7 minutes

        private Timer _keepAliveTimer = null;
        private clsLoggerClient _Logger = null;

        /// &lt;summary&gt;
        /// Constructor
        /// This constructor uses the default endpoint from the app.config file.
        /// The client must implement IPubSubCallback to receive published events.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;callbackInstance&quot;&gt;An object that implements IPubSubCallback to recieve published events.&lt;/param&gt;

        public clsEventPubSubClient(InstanceContext callbackInstance)
            : base(callbackInstance)
        {
            Initialize();
        }

        /// &lt;summary&gt;
        /// Constructor
        /// This constructor accepts a specified endpoint.  
        /// The client must implement IPubSubCallback to receive published events.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;callbackInstance&quot;&gt;An object that implements IPubSubCallback to recieve published events.&lt;/param&gt;
        /// &lt;param name=&quot;endpointConfigurationName&quot;&gt;The name of the endpoint configuration to load.&lt;/param&gt;

        public clsEventPubSubClient(InstanceContext callbackInstance, string endpointConfigurationName)
            : base(callbackInstance, endpointConfigurationName)
        {
            Initialize();
        }

        /// &lt;summary&gt;
        /// InitializeTimer
        /// Registers a delegate to call KeepAlive whenever the timer elapses.
        /// &lt;/summary&gt;

        private void Initialize()
        {
            _Logger = new clsEpicenterLoggerClient();

            _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubClient::Initialize - Initializing timer with interval of {0} seconds...&quot;,
                TIMER_INTERVAL / 1000));

            //
            // initialize keep alive timer
            //
            _keepAliveTimer = new Timer();
            _keepAliveTimer.Interval = TIMER_INTERVAL;   // 7 minutes
            _keepAliveTimer.Elapsed += KeepAliveTick;
            _keepAliveTimer.Start();
        }

        /// &lt;summary&gt;
        /// KeepAliveTick
        /// Timer tick handler
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;source&quot;&gt;source of tick event&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;arguments of event&lt;/param&gt;

        private void KeepAliveTick(object source, ElapsedEventArgs e)
        {
            KeepAlive();
        }

        /// &lt;summary&gt;
        /// Subscribe
        /// Pass through to server Subscribe method
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;evtType&quot;&gt;event identifer&lt;/param&gt;

        public void Subscribe(EN_EVENT_TYPE evtType)
        {
            Channel.Subscribe(evtType);
        }

        /// &lt;summary&gt;
        /// Unsubscribe
        /// Pass through to server Unsubscribe method
        /// &lt;/summary&gt;

        public void Unsubscribe()
        {
            Channel.Unsubscribe();
        }

        /// &lt;summary&gt;
        /// PostEvent
        /// Pass through to server PostEvent method
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;evt&quot;&gt;event payload&lt;/param&gt;
        /// &lt;param name=&quot;evtType&quot;&gt;event identifier&lt;/param&gt;

        public void PostEvent(object evt, EN_EVENT_TYPE evtType)
        {
            _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubClient::PostEvent&quot;));

            try
            {
                Channel.PostEvent(evt, evtType);

                _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubClient::PostEvent - Channel Complete&quot;));
            }
            catch (Exception ex)
            {
                _Logger.LoggerProxy.LogTrace(string.Format(&quot;EventPubSubClient::PostEvent - Exception:{0}&quot;, 
                    ex.Message));
            }
        }

        /// &lt;summary&gt;
        /// KeepAlive
        /// Pass through to server KeepAlive method
        /// &lt;/summary&gt;

        public void KeepAlive()
        {
            Channel.KeepAlive();
        }
    }
}

================================================
App Config
================================================

&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;configuration&gt;
  &lt;system.serviceModel&gt;
    &lt;client&gt;
      &lt;endpoint
         address=&quot;net.tcp://localhost:8077/EventPubSubService&quot;
         binding=&quot;netTcpBinding&quot;
         contract=&quot;Shared.Interfaces.IEventPubSubService&quot; name=&quot;NetTcpBinding_IEventPubSubService&quot;&gt;
      &lt;/endpoint&gt;
    &lt;/client&gt;
  &lt;/system.serviceModel&gt;  
&lt;/configuration&gt;


================================================
Event generator
================================================

namespace TcpServices
{
    
    [ServiceContract(CallbackContract = typeof(IEventPubSubServiceCallback))]
    [CallbackBehavior(ConcurrencyMode = ConcurrencyMode.Single)]
    public class clsTcpService : IEventPubSubServiceCallback, IDisposable
    {

        clsLoggerClient _Logger = null;
        clsEventPubSubClient _eventBrokerClient = null;

        private ManualResetEvent[] _eventHandles = null;
        private ManualResetEvent _acceptDone = new ManualResetEvent(false);
        protected ManualResetEvent _sendDone = new ManualResetEvent(false);


        //
        // inst status
        //
        clsInstState _InstStatus = null;

        /// &lt;summary&gt;
        /// Constructor
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;shutdownEvent&quot;&gt;&lt;/param&gt;

        public clsTcpService(ManualResetEvent shutdownEvent)
        {
            _eventHandles = new ManualResetEvent[MAX_EVENTS];
            _eventHandles[SHUTDOWN_EVENT] = shutdownEvent;
            _eventHandles[SENDDONE_EVENT] = _acceptDone;

            try
            {
                _Logger = new clsEpicenterLoggerClient();

                //
                // Connect to the pub/sub service so that we
                // can listen for events.
                //
                InstanceContext context = new InstanceContext(this);
                _eventBrokerClient = new clsEventPubSubClient(context);

                //
                // register for events we care about
                //
                ConnectToPubSubService();


                //
                // inst status service object to report instrument
                // status on.
                //
                _InstStatus = new clsInstState();

                //
                // send initial status
                //
                _InstStatus.ServiceState = EN_SERVICE_STATE.SS_ONLINE;
                _InstStatus.StatusText = &quot;Interface Service Starting&quot;;
                SendEvent((object)_InstStatus, EN_EVENT_TYPE.ET_INST_STATUS);
            }
            catch (Exception ex)
            {
                _Logger.LoggerProxy.LogEvent(string.Format(&quot;clsTcpService::Constructor - Failed to construct server components:{0}&quot;,
                    ex.ToString()));

                throw;
            }
        }

        /// &lt;summary&gt;
        /// Dispose
        /// Overridden Dispose from IDispose
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// History
        ///	Date        Author          Description of Change
        ///	11/23/2010  Michael Fenske  Created
        /// &lt;/remarks&gt;
        public void Dispose()
        {
            _eventBrokerClient.Unsubscribe();
        }

        /// &lt;summary&gt;
        /// AcceptSocketCallback
        /// Connection request made, complete the conneciton
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ar&quot;&gt;TcpListener object&lt;/param&gt;

        public void AcceptSocketCallback(IAsyncResult ar)
        {
            string macAddr = string.Empty;
            clsStateObject so = null;

            try
            {
               .
               .
               .

                _maldiInstStatus.InstState = EN_INST_STATE.IS_ONLINE;
                _maldiInstStatus.StatusText = &quot;Instrument connected to Interface&quot;;
                SendEvent((object)_maldiInstStatus, EN_EVENT_TYPE.ET_MALDI_INST_STATUS);

               .
               .
               .

            }
               .
               .
               .
        }

        /// &lt;summary&gt;
        /// ConnectToPubSubService
        /// Called from the form load to get us
        /// connected to the pubsub service
        /// &lt;/summary&gt;

        private void ConnectToPubSubService()
        {
            try
            {
                _eventBrokerClient.Subscribe(EN_EVENT_TYPE.ET_REQUEST_STATUS);
                _Logger.LoggerProxy.LogTrace(string.Format(&quot;clsTcpService::ConnectToPubSubService - subscribed to request maldi status event&quot;));
            }
            catch (Exception ex)
            {
                _Logger.LoggerProxy.LogTrace(string.Format(&quot;clsTcpService::ConnectToPubSubService - Error connecting to pubsub server:{0}&quot;,
                    ex.Message));
            }
        }

        /// &lt;summary&gt;
        /// EventCallback
        /// the callback method from IEventPubSubServiceCallback
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;evt&quot;&gt; event payload&lt;/param&gt;
        /// &lt;param name=&quot;evtType&quot;&gt;event identifier&lt;/param&gt;

        public void EventCallback(object evt, EN_EVENT_TYPE evtType)
        {
            //
            // handle the event based on its identifier
            //
            switch (evtType)
            {
                case EN_EVENT_TYPE.ET_REQUEST_STATUS:
                    clsBaseEvent baseEvt = (clsBaseEvent)evt;

                    _Logger.LoggerProxy.LogTrace(string.Format(&quot;clsMaldiTcpService::EventCallback - Received request for current status, sending it out&quot;));

                    SendEvent((object)_InstStatus, EN_EVENT_TYPE.ET_INST_STATUS);

                    break;
            }
        }

        /// &lt;summary&gt;
        /// Listen
        /// Wait for a connection to the port to
        /// communicate MALDI results
        /// &lt;/summary&gt;

        public void Listen()
        {
               .
               .
               .

            _InstStatus.ServiceState = EN_SERVICE_STATE.SS_OFFLINE;
            _InstStatus.InstState = EN_INST_STATE.IS_OFFLINE;
            _InstStatus.XmitState = false;
            _InstStatus.RecvState = false;
            _InstStatus.StatusText = &quot;Interface Service Stopping&quot;;

            SendEvent((object)_InstStatus, EN_EVENT_TYPE.ET_INST_STATUS);

            _Logger.LoggerProxy.LogTrace(string.Format(&quot;clsTcpService::Listen - Shutdown occurred&quot;));
        }

        /// &lt;summary&gt;
        /// decode and process bytes received
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;

        private bool ProcessBuffer(clsStateObject so)
        {
            bool ret = true;
            string respSent = string.Empty;

            _Logger.LoggerProxy.LogTrace(string.Format(&quot;clsMaldiTcpService::ProcessBuffer - Received:{0}&quot;,
                Encoding.ASCII.GetString(so.recvBuffer)));

            try
            {
               .
               .
               .
               _InstStatus.StatusText = string.Format(&quot;Received: {0}&quot;, Buffer.RecordData);
               .
               .
               .

                SendEvent((object)_InstStatus, EN_EVENT_TYPE.ET_INST_STATUS);

               .
               .
               .

                respSent = string.Format(&quot;ACK&quot;);
                if (so.sendBuffer[0] == clsInstrumentInterfaceConstants.NAK)
                {
                    respSent = string.Format(&quot;NAK&quot;);
                    respSent += FormatResponseText(astmBuffer, so.MaldiResults);

                    _InstStatus.InstState = EN_INST_STATE.IS_ERROR;
                }

                _InstStatus.XmitState = true;
                _InstStatus.StatusText = string.Format(&quot;Sending response: {0}&quot;, respSent);
                SendEvent((object)_InstStatus, EN_EVENT_TYPE.ET_INST_STATUS);

               .
               .
               .

            }
            catch (Exception ex)
            {
                _Logger.LoggerProxy.LogTrace(string.Format(&quot;*** clsTcpService::ProcessBuffer - General Exception ***\r\n{0}&quot;,
                    ex.Message));
            }

            return ret;
        }

        /// &lt;summary&gt;
        /// get bytes from socket
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ar&quot;&gt;&lt;/param&gt;

        public void ReceiveCallback(IAsyncResult ar)
        {
            clsStateObject so = (clsStateObject)ar.AsyncState;

            try
            {
                //
                // done receiving
                //
                so.BytesReceived = so.workSocket.EndReceive(ar);

                _InstStatus.RecvState = true;
                _InstStatus.StatusText = &quot;&quot;;
                SendEvent((object)_maldiInstStatus, EN_EVENT_TYPE.ET_INST_STATUS);

                //
                // we get some bytes?
                //
                if (so.BytesReceived &gt; 0)
                {
                    _Logger.LoggerProxy.LogTrace(String.Format(&quot;clsTcpService::ReceiveCallback - Read {0} bytes from socket&quot;,
                        so.BytesReceived));

                    if (ProcessBuffer(so))
                    {
                        _InstStatus.RecvState = false;
                        _InstStatus.StatusText = &quot;&quot;;
                        SendEvent((object)_InstStatus, EN_EVENT_TYPE.ET_INST_STATUS);

                        so.ClearRecvBuffer();

                        so.workSocket.BeginReceive(so.recvBuffer, 0, so.BytesToRecv, 0,
                            ReceiveCallback, so);
                    }
                }
                else
                {
                    _InstStatus.XmitState = false;
                    _InstStatus.RecvState = false;

                    if (_InstStatus.InstState != EN_INST_STATE.IS_ERROR)
                    {
                        _InstStatus.InstState = EN_INST_STATE.IS_OFFLINE;
                    }

                    _InstStatus.StatusText = &quot;Instrument disconnected&quot;;

                    SendEvent((object)_InstStatus, EN_EVENT_TYPE.ET_INST_STATUS);

                    _Logger.LoggerProxy.LogTrace(String.Format(&quot;clsTcpService::ReceiveCallback - Client disconnected, cleaning up&quot;));
                }
            }
            catch (Exception ex)
            {
                _Logger.LoggerProxy.LogTrace(String.Format(&quot;clsTcpService::ReceiveCallback - Exception:\r\n{0}&quot;,
                    ex.Message));

                so.workSocket.Close();
            }
        }

        /// &lt;summary&gt;
        /// SendEvent
        /// Centralized routine to send pub/sub event
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;payLoad&quot;&gt;generic payload that goes with the event&lt;/param&gt;
        /// &lt;param name=&quot;evtType&quot;&gt;event type&lt;/param&gt;

        private void SendEvent(object payLoad, EN_EVENT_TYPE evtType)
        {
            _epiLogger.LoggerProxy.LogTrace(String.Format(&quot;clsTcpService::SendEvent - evtType:{0}:{1}&quot;,
                evtType, ((clsBaseEvent)payLoad).EventId));

            _eventBrokerClient.PostEvent(payLoad, evtType);

            _Logger.LoggerProxy.LogTrace(String.Format(&quot;clsTcpService::SendEvent - Done!&quot;));
        }

        /// &lt;summary&gt;
        /// send ACK/NAK back to MALDI Inst
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;ar&quot;&gt;&lt;/param&gt;

        private void SendResponse(IAsyncResult ar)
        {
            try
            {
                clsStateObject so = (clsStateObject)ar.AsyncState;

                so.BytesSent = so.workSocket.EndSend(ar);

                string response = string.Empty;
                if (so.sendBuffer[0] == clsInstrumentInterfaceConstants.ACK)
                {
                    response = &quot;ACK&quot;;
                }
                else
                {
                    if (so.sendBuffer[0] == clsInstrumentInterfaceConstants.NAK)
                    {
                        response = &quot;NAK&quot;;
                    }
                }
                _Logger.LoggerProxy.LogTrace(String.Format(&quot;clsTcpService::SendResponse - Sent {0} bytes:{1}&quot;,
                    so.BytesSent, response));

                _sendDone.Set();

                _InstStatus.XmitState = false;
                _InstStatus.StatusText = &quot;&quot;;
                SendEvent((object)_InstStatus, EN_EVENT_TYPE.ET_INST_STATUS);
            }
            catch (Exception ex)
            {
                _Logger.LoggerProxy.LogTrace(string.Format(&quot;clsTcpService::SendResponse - SendCallback Exception:\r\n{0}&quot;,
                    ex.Message));
            }
        }
    }
}


================================================
Event consumer
================================================

using System;
using System.Windows.Forms;
using System.ServiceModel;
using System.Drawing;
using System.Threading;
using EventObjects;
using Shared.Interfaces;
using EventPubSubClient;
using EpiCenterLoggerClient;

namespace InterfaceStatusClient
{

    [ServiceContract(CallbackContract = typeof(IEventPubSubServiceCallback))]
    [CallbackBehavior(ConcurrencyMode = ConcurrencyMode.Single)]
    public partial class clsInstInteraceStatusClient : Form, IEventPubSubServiceCallback
    {
        private clsLoggerClient _epiLogger = null;
        private clsEventPubSubClient _eventBrokerClient = null;
        private clsInstState _currentState = null;

        public delegate void UpdatePicCallback(Image img);
        public delegate void UpdateListBoxCallback(string txt);

        /// &lt;summary&gt;
        /// Constructor
        /// &lt;/summary&gt;
 
        public clsInstInteraceStatusClient()
        {
            InitializeComponent();

            _Logger = new clsEpicenterLoggerClient();

            //
            // since this object implements the callback interface
            // directly we can use it as the context for the 
            // pubsub client
            //
            InstanceContext context = new InstanceContext(this);
            _eventBrokerClient = new clsEventPubSubClient(context);

            _currentState = new clsInstState();
        }

        #region AsynchControlUpdates

        private void UpdateServiceStatusMethod(Image img)
        {
            picServiceStatus.Image = img;
        }

        private void UpdateServiceStatus(Image img)
        {
            if (picServiceStatus.InvokeRequired)
            {
                BeginInvoke(new UpdatePicCallback(UpdateServiceStatusMethod),
                    new object[] { img });
            }
            else
            {
                UpdateServiceStatusMethod(img);
            }
        }

        private void UpdateInstStatusMethod(Image img)
        {
            picInstStatus.Image = img;
        }

        private void UpdateInstStatus(Image img)
        {
            if (picInstStatus.InvokeRequired)
            {
                BeginInvoke(new UpdatePicCallback(UpdateInstStatusMethod),
                    new object[] { img });
            }
            else
            {
                UpdateInstStatusMethod(img);
            }
        }

        private void UpdateXmitMethod(Image img)
        {
            picXmit.Image = img;
        }

        private void UpdateXmit(Image img)
        {
            if (picXmit.InvokeRequired)
            {
                BeginInvoke(new UpdatePicCallback(UpdateXmitMethod),
                    new object[] { img });
            }
            else
            {
                UpdateXmitMethod(img);
            }
        }

        private void UpdateRecvMethod(Image img)
        {
            picRecv.Image = img;
        }

        private void UpdateRecv(Image img)
        {
            if (picRecv.InvokeRequired)
            {
                BeginInvoke(new UpdatePicCallback(UpdateRecvMethod),
                    new object[] { img });
            }
            else
            {
                UpdateRecvMethod(img);
            }
        }

        private void UpdateListBoxMethod(string txt)
        {
            lstStatus.Items.Add(txt);

            //
            // auto scroll list
            //
            int itemsPerPage = (int)(lstStatus.Height / lstStatus.ItemHeight);
            lstStatus.TopIndex = (lstStatus.Items.Count - itemsPerPage) + 2;
        }

        private void UpdateListBox(string txt)
        {
            if (lstStatus.InvokeRequired)
            {
                BeginInvoke(new UpdateListBoxCallback(UpdateListBoxMethod),
                    new object[] { txt });
            }
            else
            {
                UpdateListBoxMethod(txt);
            }
        }


        #endregion


        /// &lt;summary&gt;
        /// EventCallback
        /// the callback method from IEventPubSubServiceCallback
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;evt&quot;&gt; event payload&lt;/param&gt;
        /// &lt;param name=&quot;evtType&quot;&gt;event identifier&lt;/param&gt;

        public void EventCallback(object evt, EN_EVENT_TYPE evtType)
        {
            Image img = null;

            _Logger.LoggerProxy.LogTrace(string.Format(&quot;clsInstInteraceStatusClient::EventCallback - received:{0}:{1}&quot;,
                evtType, ((clsBaseEvent)evt).EventId));

            //
            // handle the event based on its identifier
            //
            switch (evtType)
            {
                case EN_EVENT_TYPE.ET_INST_STATUS:
                    clsInstState state = (clsInstState)evt;

                    _currentState.StatusText = state.StatusText;

                    if (_currentState.ServiceState != state.ServiceState)
                    {
                        _currentState.ServiceState = state.ServiceState;

                        if (_currentState.ServiceState == EN_SERVICE_STATE.SS_ONLINE)
                        {
                            img = global::InterfaceStatusClient.Properties.Resources.Online;
                        }
                        else
                        {
                            img = global::InterfaceStatusClient.Properties.Resources.Offline;
                        }
                        UpdateServiceStatus(img);
                    }

                    if (_currentState.InstState != state.InstState)
                    {
                        _currentState.InstState = state.InstState;

                        if (_currentState.InstState == EN_INST_STATE.IS_ONLINE)
                        {
                            img = global::InterfaceStatusClient.Properties.Resources.Online;
                        }
                        else if (_currentState.InstState == EN_INST_STATE.IS_OFFLINE)
                        {
                            img = global::InterfaceStatusClient.Properties.Resources.Offline;
                        }
                        else if (_currentState.InstState == EN_INST_STATE.IS_ERROR)
                        {
                            img = global::InterfaceStatusClient.Properties.Resources.InstError;
                            ShowWindow();
                        }
                        UpdateInstStatus(img);
                    }

                    if (_currentState.RecvState != state.RecvState)
                    {
                        _currentState.RecvState = state.RecvState;

                        if (_currentState.RecvState)
                        {
                            img = global::InterfaceStatusClient.Properties.Resources.EpiDownOn;
                        }
                        else
                        {
                            img = global::InterfaceStatusClient.Properties.Resources.EpiDownOff;
                        }
                        UpdateRecv(img);
                    }

                    if (_currentState.XmitState != state.XmitState)
                    {
                        _currentState.XmitState = state.XmitState;

                        if (_currentState.XmitState)
                        {
                            img = global::InterfaceStatusClient.Properties.Resources.EpiUpOn;
                        }
                        else
                        {
                            img = global::InterfaceStatusClient.Properties.Resources.EpiUpOff;
                        }
                        UpdateXmit(img);
                    }

                    if (_currentState.StatusText != &quot;&quot;)
                    {
                        DateTime currDt = DateTime.Now;
                        string timestamp = string.Format(&quot;{0}:{1}&quot;,
                            currDt.ToString(), currDt.Ticks.ToString());

                        UpdateListBox(string.Format(&quot;{0}-{1}&quot;,
                            timestamp, _currentState.StatusText));
                    }

                    break;
            }
        }

        /// &lt;summary&gt;
        /// ConnectToPubSubService
        /// Called from the form load to get us
        /// connected to the pubsub service
        /// &lt;/summary&gt;

        private void ConnectToPubSubService()
        {
            try
            {
                _eventBrokerClient.Subscribe(EN_EVENT_TYPE.ET_INST_STATUS);
            }
            catch (Exception ex)
            {
                DateTime currDt = DateTime.Now;
                string timestamp = string.Format(&quot;{0}:{1}&quot;,
                    currDt.ToString(), currDt.Ticks.ToString());

                UpdateListBox(string.Format(&quot;{0}-Error connecting to pubsub server:{1}&quot;,
                    timestamp, ex.Message));
            }
        }

        /// &lt;summary&gt;
        /// InstInteraceStatusClient_Load
        /// Form load
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;

        private void InstInteraceStatusClient_Load(object sender, EventArgs e)
        {
            Visible = false;

            ShowInTaskbar = false;

            ConnectToPubSubService();

            _Logger.LoggerProxy.LogTrace(string.Format(&quot;clsInstInteraceStatusClient::InstInteraceStatusClient_Load - ask for current interface status&quot;));

            //
            // ask for current interface status
            //
            clsBaseEvent evt = new clsBaseEvent();
            _eventBrokerClient.PostEvent((object)evt, EN_EVENT_TYPE.ET_REQUEST_STATUS);
        }

        /// &lt;summary&gt;
        /// InstInteraceStatusClient_Resize
        /// Hide window on minimize
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;

        private void InstInteraceStatusClient_Resize(object sender, EventArgs e)
        {
            if (FormWindowState.Minimized == WindowState)
            {
                Hide();
            }
        }

        /// &lt;summary&gt;
        /// InstInteraceStatusClient_FormClosing
        /// Ignore the close button - minimize instead
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;

        private void InstInteraceStatusClient_FormClosing(object sender, FormClosingEventArgs e)
        {
            if (e.CloseReason == CloseReason.UserClosing)
            {
                WindowState = FormWindowState.Minimized;
                e.Cancel = true;
            }

            //Icon.Dispose();
        }

        /// &lt;summary&gt;
        /// WndProc
        /// Overrides windows event handler for show event
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;message&quot;&gt;windows event&lt;/param&gt;

        protected override void WndProc(ref Message message)
        {
            if (message.Msg == clsSingleInstance.WM_SHOWFIRSTINSTANCE)
            {
                _Logger.LoggerProxy.LogTrace(string.Format(&quot;clsInstInteraceStatusClient::WndProc - Received Show Message&quot;));

                ShowWindow();
            }
            base.WndProc(ref message);
        }

        /// &lt;summary&gt;
        /// InstInterfaceSystemTrayIcon_DoubleClick
        /// Double click on tray icon brings up form
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;

        private void InstInterfaceSystemTrayIcon_DoubleClick(object sender, EventArgs e)
        {
            ShowWindow();
        }

        /// &lt;summary&gt;
        /// showToolStripMenuItem_Click
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;

        private void showToolStripMenuItem_Click(object sender, EventArgs e)
        {
            ShowWindow();
        }

        private void ShowWindow()
        {
            BringToFront();
            Show();
            WindowState = FormWindowState.Normal;
        }

        /// &lt;summary&gt;
        /// exitToolStripMenuItem_Click
        /// Someone clicked exit from menu so shut down app
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;sender&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;e&quot;&gt;&lt;/param&gt;

        private void exitToolStripMenuItem_Click(object sender, EventArgs e)
        {
            try
            {
                _eventBrokerClient.Unsubscribe();
            }
            finally
            {
                Application.Exit();
            }
        }
    }
}
</code>
                                  </pre>
                                  <pre class="line-numbers">1:
2:
3:
4:
5:
6:
7:
8:
9:
10:
11:
12:
13:
14:
15:
16:
17:
18:
19:
20:
21:
22:
23:
24:
25:
26:
27:
28:
29:
30:
31:
32:
33:
34:
35:
36:
37:
38:
39:
40:
41:
42:
43:
44:
45:
46:
47:
48:
49:
50:
51:
52:
53:
54:
55:
56:
57:
58:
59:
60:
61:
62:
63:
64:
65:
66:
67:
68:
69:
70:
71:
72:
73:
74:
75:
76:
77:
78:
79:
80:
81:
82:
83:
84:
85:
86:
87:
88:
89:
90:
91:
92:
93:
94:
95:
96:
97:
98:
99:
100:
101:
102:
103:
104:
105:
106:
107:
108:
109:
110:
111:
112:
113:
114:
115:
116:
117:
118:
119:
120:
121:
122:
123:
124:
125:
126:
127:
128:
129:
130:
131:
132:
133:
134:
135:
136:
137:
138:
139:
140:
141:
142:
143:
144:
145:
146:
147:
148:
149:
150:
151:
152:
153:
154:
155:
156:
157:
158:
159:
160:
161:
162:
163:
164:
165:
166:
167:
168:
169:
170:
171:
172:
173:
174:
175:
176:
177:
178:
179:
180:
181:
182:
183:
184:
185:
186:
187:
188:
189:
190:
191:
192:
193:
194:
195:
196:
197:
198:
199:
200:
201:
202:
203:
204:
205:
206:
207:
208:
209:
210:
211:
212:
213:
214:
215:
216:
217:
218:
219:
220:
221:
222:
223:
224:
225:
226:
227:
228:
229:
230:
231:
232:
233:
234:
235:
236:
237:
238:
239:
240:
241:
242:
243:
244:
245:
246:
247:
248:
249:
250:
251:
252:
253:
254:
255:
256:
257:
258:
259:
260:
261:
262:
263:
264:
265:
266:
267:
268:
269:
270:
271:
272:
273:
274:
275:
276:
277:
278:
279:
280:
281:
282:
283:
284:
285:
286:
287:
288:
289:
290:
291:
292:
293:
294:
295:
296:
297:
298:
299:
300:
301:
302:
303:
304:
305:
306:
307:
308:
309:
310:
311:
312:
313:
314:
315:
316:
317:
318:
319:
320:
321:
322:
323:
324:
325:
326:
327:
328:
329:
330:
331:
332:
333:
334:
335:
336:
337:
338:
339:
340:
341:
342:
343:
344:
345:
346:
347:
348:
349:
350:
351:
352:
353:
354:
355:
356:
357:
358:
359:
360:
361:
362:
363:
364:
365:
366:
367:
368:
369:
370:
371:
372:
373:
374:
375:
376:
377:
378:
379:
380:
381:
382:
383:
384:
385:
386:
387:
388:
389:
390:
391:
392:
393:
394:
395:
396:
397:
398:
399:
400:
401:
402:
403:
404:
405:
406:
407:
408:
409:
410:
411:
412:
413:
414:
415:
416:
417:
418:
419:
420:
421:
422:
423:
424:
425:
426:
427:
428:
429:
430:
431:
432:
433:
434:
435:
436:
437:
438:
439:
440:
441:
442:
443:
444:
445:
446:
447:
448:
449:
450:
451:
452:
453:
454:
455:
456:
457:
458:
459:
460:
461:
462:
463:
464:
465:
466:
467:
468:
469:
470:
471:
472:
473:
474:
475:
476:
477:
478:
479:
480:
481:
482:
483:
484:
485:
486:
487:
488:
489:
490:
491:
492:
493:
494:
495:
496:
497:
498:
499:
500:
501:
502:
503:
504:
505:
506:
507:
508:
509:
510:
511:
512:
513:
514:
515:
516:
517:
518:
519:
520:
521:
522:
523:
524:
525:
526:
527:
528:
529:
530:
531:
532:
533:
534:
535:
536:
537:
538:
539:
540:
541:
542:
543:
544:
545:
546:
547:
548:
549:
550:
551:
552:
553:
554:
555:
556:
557:
558:
559:
560:
561:
562:
563:
564:
565:
566:
567:
568:
569:
570:
571:
572:
573:
574:
575:
576:
577:
578:
579:
580:
581:
582:
583:
584:
585:
586:
587:
588:
589:
590:
591:
592:
593:
594:
595:
596:
597:
598:
599:
600:
601:
602:
603:
604:
605:
606:
607:
608:
609:
610:
611:
612:
613:
614:
615:
616:
617:
618:
619:
620:
621:
622:
623:
624:
625:
626:
627:
628:
629:
630:
631:
632:
633:
634:
635:
636:
637:
638:
639:
640:
641:
642:
643:
644:
645:
646:
647:
648:
649:
650:
651:
652:
653:
654:
655:
656:
657:
658:
659:
660:
661:
662:
663:
664:
665:
666:
667:
668:
669:
670:
671:
672:
673:
674:
675:
676:
677:
678:
679:
680:
681:
682:
683:
684:
685:
686:
687:
688:
689:
690:
691:
692:
693:
694:
695:
696:
697:
698:
699:
700:
701:
702:
703:
704:
705:
706:
707:
708:
709:
710:
711:
712:
713:
714:
715:
716:
717:
718:
719:
720:
721:
722:
723:
724:
725:
726:
727:
728:
729:
730:
731:
732:
733:
734:
735:
736:
737:
738:
739:
740:
741:
742:
743:
744:
745:
746:
747:
748:
749:
750:
751:
752:
753:
754:
755:
756:
757:
758:
759:
760:
761:
762:
763:
764:
765:
766:
767:
768:
769:
770:
771:
772:
773:
774:
775:
776:
777:
778:
779:
780:
781:
782:
783:
784:
785:
786:
787:
788:
789:
790:
791:
792:
793:
794:
795:
796:
797:
798:
799:
800:
801:
802:
803:
804:
805:
806:
807:
808:
809:
810:
811:
812:
813:
814:
815:
816:
817:
818:
819:
820:
821:
822:
823:
824:
825:
826:
827:
828:
829:
830:
831:
832:
833:
834:
835:
836:
837:
838:
839:
840:
841:
842:
843:
844:
845:
846:
847:
848:
849:
850:
851:
852:
853:
854:
855:
856:
857:
858:
859:
860:
861:
862:
863:
864:
865:
866:
867:
868:
869:
870:
871:
872:
873:
874:
875:
876:
877:
878:
879:
880:
881:
882:
883:
884:
885:
886:
887:
888:
889:
890:
891:
892:
893:
894:
895:
896:
897:
898:
899:
900:
901:
902:
903:
904:
905:
906:
907:
908:
909:
910:
911:
912:
913:
914:
915:
916:
917:
918:
919:
920:
921:
922:
923:
924:
925:
926:
927:
928:
929:
930:
931:
932:
933:
934:
935:
936:
937:
938:
939:
940:
941:
942:
943:
944:
945:
946:
947:
948:
949:
950:
951:
952:
953:
954:
955:
956:
957:
958:
959:
960:
961:
962:
963:
964:
965:
966:
967:
968:
969:
970:
971:
972:
973:
974:
975:
976:
977:
978:
979:
980:
981:
982:
983:
984:
985:
986:
987:
988:
989:
990:
991:
992:
993:
994:
995:
996:
997:
998:
999:
1000:
1001:
1002:
1003:
1004:
1005:
1006:
1007:
1008:
1009:
1010:
1011:
1012:
1013:
1014:
1015:
1016:
1017:
1018:
1019:
1020:
1021:
1022:
1023:
1024:
1025:
1026:
1027:
1028:
1029:
1030:
1031:
1032:
1033:
1034:
1035:
1036:
1037:
1038:
1039:
1040:
1041:
1042:
1043:
1044:
1045:
1046:
1047:
1048:
1049:
1050:
1051:
1052:
1053:
1054:
1055:
1056:
1057:
1058:
1059:
1060:
1061:
1062:
1063:
1064:
1065:
1066:
1067:
1068:
1069:
1070:
1071:
1072:
1073:
1074:
1075:
1076:
1077:
1078:
1079:
1080:
1081:
1082:
1083:
1084:
1085:
1086:
1087:
1088:
1089:
1090:
1091:
1092:
1093:
1094:
1095:
1096:
1097:
1098:
1099:
1100:
1101:
1102:
1103:
1104:
1105:
1106:
1107:
1108:
1109:
1110:
1111:
1112:
1113:
1114:
1115:
1116:
1117:
1118:
1119:
1120:
1121:
1122:
1123:
1124:
1125:
1126:
1127:
1128:
1129:
1130:
1131:
1132:
1133:
1134:
1135:
1136:
1137:
1138:
1139:
1140:
1141:
1142:
1143:
1144:
1145:
1146:
1147:
1148:
1149:
1150:
1151:
1152:
1153:
1154:
1155:
1156:
1157:
1158:
1159:
1160:
1161:
1162:
1163:
1164:
1165:
1166:
1167:
1168:
1169:
1170:
1171:
1172:
1173:
1174:
1175:
1176:
1177:
1178:
1179:
1180:
1181:
1182:
1183:
1184:
1185:
1186:
1187:
1188:
1189:
1190:
1191:
1192:
1193:
1194:
1195:
1196:
1197:
1198:
1199:
1200:
1201:
1202:
1203:
1204:
1205:
1206:
1207:
1208:
1209:
1210:
1211:
1212:
1213:
1214:
1215:
1216:
1217:
1218:
1219:
1220:
1221:
1222:
1223:
1224:
1225:
1226:
1227:
1228:
1229:
1230:
1231:
1232:
1233:
1234:
1235:
1236:
1237:
1238:
1239:
1240:
1241:
1242:
1243:
1244:
1245:
1246:
1247:
1248:
1249:
1250:
1251:
1252:
1253:
1254:
1255:
1256:
1257:
1258:
1259:
1260:
1261:
1262:
1263:
1264:
1265:
1266:
1267:
1268:
1269:
1270:
1271:
1272:
1273:
1274:
1275:
1276:
1277:
1278:
1279:
1280:
1281:
1282:
1283:
1284:
1285:
1286:
1287:
1288:
1289:
1290:
1291:
1292:
1293:
1294:
1295:
1296:
1297:
1298:
1299:
1300:
1301:
1302:
1303:
1304:
1305:
1306:
1307:
1308:
1309:
1310:
1311:
1312:
1313:
1314:
1315:
1316:
1317:
1318:
1319:
1320:
1321:
1322:
1323:
1324:
1325:
1326:
1327:
1328:
1329:
1330:
1331:
1332:
1333:
1334:
1335:
1336:
1337:
1338:
1339:
1340:
1341:
1342:
1343:
1344:
1345:
1346:
1347:
1348:
1349:
1350:
1351:
1352:
1353:
1354:
1355:
1356:
1357:
1358:
1359:
1360:
1361:
1362:
1363:
1364:
1365:
1366:
1367:
1368:
1369:
1370:
1371:
1372:
1373:
1374:
1375:
1376:
1377:
1378:
1379:
1380:
1381:
1382:
1383:
1384:
1385:
1386:
1387:
1388:
1389:
1390:
1391:
1392:
1393:
1394:
1395:
1396:
1397:
1398:
1399:
1400:
1401:
1402:
1403:
1404:
1405:
1406:
1407:
1408:
1409:
1410:
1411:
1412:
1413:
1414:
1415:
1416:
1417:
1418:
1419:
1420:
1421:
1422:
1423:
1424:
1425:
1426:
1427:
1428:
1429:
1430:
1431:
1432:
1433:
1434:
1435:
1436:
1437:
1438:
1439:
1440:
1441:
1442:
1443:
1444:
</pre>
                                </div>
                              </div>
                              <p class="buttons"><a class="button # alt copy buttons10-26718112-6331404" href="#"><span>Select all</span></a><a class="button # alt blank" href="/viewCodeSnippet.jsp?codeSnippetId=6331404" rel="nofollow" target="_blank"><span>Open in new window</span></a></p>
                              <script type="text/javascript">
                                jqBind('#questionView .buttons10-26718112-6331404','click',function(e){selectElementById('questionViewCode10-26718112-6331404');return false;});
                              </script>
                            </div>
                            <div class="attachment"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="component textComponent viewQuestionAnswerOverlay" id="textComponent-id3">
                      <div class="body">
                        <div class="section">
                          <div class="answerOverlayContainer">
                          
                          <p>
                          
                          	<span class="notAnswered">This question is in <b>progress</b>.</span>
                          
                          	
                          
                          	<span class="openSubtext">Our experts are working on an answer right now.<br>Sign up for immediate access to the solution once it becomes available.</span>
                          
                          	
                          
                          </p>
                          
                          <h3>Subscribe now for full access to Experts Exchange and get</h3>
                          
                          <h2 class="subtitle">Instant Access to this Solution</h2>
                          
                          <ul>
                          
                          	<li><span class="plus">Plus...</span></li>
                          
                          </ul>
                          
                          <ul>
                          
                          	<li>30 Day FREE access, no risk, no obligation</li><li>Collaborate with the world's top tech experts</li><li>Unlimited access to our exclusive solution database</li><li>Never be left without tech help again</li>
                          
                          	
                          
                          </ul>
                          
                          <p class="buttons">
                          
                          		<a class="button confirm" href="/register.jsp?redirect=/Programming/Languages/.NET/Web_Services/Q_26718112.html" target="_self"><span>Subscribe Now</span></a>
                          
                          	</p>
                          
                          </div>
                          
                          <div class="image-container character notSolved overlay" title="Sign Up Now!"></div>
                        </div>
                      </div>
                    </div>
                    <div class="meta trailing-meta">
                      <div class="component questionTrailingMeta" id="questionTrailingMeta">
                        <div class="body">
                          <div class="section">
                            <div class="meta trailing-meta">
                              <dl>
                                <dt class="label stamp"><strong>Asked On</strong></dt>
                                <dd class="stamp first last"><span class="posted">2011-01-05 at 12:31:51</span><span class="id">ID: 26718112</span></dd>
                                <dt class="label tags"><strong>Tags</strong></dt>
                                <dd class="tag first last">
                                  <h2><a href="/searchResults.jsp?searchTag=WCF+DuplexClientChannel" rel="tag nofollow noindex">WCF DuplexClientChannel</a></h2>
                                </dd>
                                <dt class="label topics"><strong>Topic</strong></dt>
                                <dd class="topics first last">
                                  <h3><a href="/Programming/Languages/.NET/Web_Services/"><span>Web Services and WCF</span></a></h3>
                                </dd>
                                <dt class="label participating-experts"><strong>Participating Experts</strong></dt>
                                <dd class="value participating-experts first last">1</dd>
                                <dt class="label points"><strong>Points</strong></dt>
                                <dd class="points first last">500</dd>
                                <dt class="label comments"><strong>Comments</strong></dt>
                                <dd class="value comments first last">17</dd>
                              </dl>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <span class="component textComponent condensed" id="textComponent-id4"><div class="bffr_trusted">
                    <h2>Trusted by hundreds of thousands everyday for fast, accurate and reliable tech support.</h2>
                    <div class="image-container trusted-by" title="Companies like CVS, Honeywell, Chevron, Toyoto, TriStar Pictures, the U.S. Army, and Accenture"></div>
                    </div>
                    </span>
                    <div class="stlco viewQuestionBuffer frcomponent-alt-bg2 ">
                      <div class="ft-v1-contentWrapper">
                        <div class="component textComponent techResourceHeader" id="textComponent-id5">
                          <div class="head">
                            <h2 class="subtitle">Your Complete Technology Resource</h2>
                            <div class="ui-chrome"></div>
                          </div>
                          <div class="body">
                            <div class="section">
                              <p>900+ topic areas (and counting)</p>
                            </div>
                          </div>
                        </div>
                        <div class="component relatedContent stlco relatedSidebar relatedSolutions" id="relatedContent">
                          <div class="head">
                            <h3>Related Solutions</h3>
                            <div class="ui-chrome"></div>
                          </div>
                          <div class="body">
                            <div class="section">
                              <div class="sort-options"></div>
                              <div class="subsection">
                                <div class="row-contents">
                                  <ol>
                                    <li class="row-content odd first"><a href="/Microsoft/Development/Q_28256012.html" title="WCF Service Application"><span>WCF Service Application</span></a>
                                      <div class="desc">
                                           In visual studio 2008, I am practicing hosting a WCF Service in different environments such as a Console Application, and WCF Service Application (Using Visual Studio Development Server) .
                                          
                                          I do the following: Set my Client program and a Console Application( which host t…
                                      </div>
                                    </li>
                                    <li class="row-content even"><a href="/Microsoft/Development/Q_28258752.html" title="WCF Service - connecting by net.tcp"><span>WCF Service - connecting by net.tcp</span></a>
                                      <div class="desc">
                                           I receive the following calling my WCF Service using the net.tcp protocol on IIS7(WAS)
                                          
                                          [The message could not be dispatched because the service at the endpoint address 'net.tcp://localhost:9090/AppointmentServiceIISHost/AppointmentServiceIISHost.svc' is u…
                                      </div>
                                    </li>
                                    <li class="row-content odd"><a href="/Programming/Languages/.NET/Web_Services/Q_28264336.html" title="WCF Service and Message"><span>WCF Service and Message</span></a>
                                      <div class="desc">
                                           Hi All,
                                          
                                          I have a question on a WCF Service. 
                                          
                                          Lets say I have a customer that is sending me a set of transactions. Those transactions deal with cars.
                                          
                                          And I know this is in a soap message but let's say the list of transactions are like something in simplistic terms like:
                                          
                                          Ca…
                                      </div>
                                    </li>
                                    <li class="row-content even"><a href="/Microsoft/Development/Q_28261222.html" title="WCF Service - could not be activated"><span>WCF Service - could not be activated</span></a>
                                      <div class="desc">
                                           I receive the following error when I make a request to WCF Service:
                                          
                                          The requested service, 'net.tcp://localhost:9090/AppointmentServiceIISHost/AppointmentServiceIISHost.svc' could not be activated. See the server's diagnostic trace logs for more information…
                                      </div>
                                    </li>
                                    <li class="row-content odd"><a href="/Programming/Languages/.NET/Web_Services/Q_28249777.html" title="WCF service w/ NATed firewall"><span>WCF service w/ NATed firewall</span></a>
                                      <div class="desc">
                                           We have WCF service setup on a web server and i am trying setup our watchguard firewall to make this work from outside our network (going throught the firewall).  I am not sure what ports to allow or what the best way to configure the firewall rule is.
                                          
                                          Does anyone have a littl…
                                      </div>
                                    </li>
                                    <li class="row-content even last"><a href="/Programming/Languages/.NET/Web_Services/Q_28155886.html" title="Host WCF Service locally"><span>Host WCF Service locally</span></a>
                                      <div class="desc">
                                           I am trying to host the WCF service locally on my PC. Here is what happened:
                                          
                                          1. Create a new website in IIS and point to the Host project in my solution: MyClient.Services.ServiceHost
                                          You can see the .svc files.
                                          It works fine.
                                          
                                          2. Copy the deployed WCF from com…
                                      </div>
                                    </li>
                                  </ol>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="component textComponent completeTechResource" id="textComponent-id6">
                          <div class="body">
                            <div class="section">
                              <div class="image-container tutorials character tackle-problems" title="Tutorials are great ways to tackle hard problems!"></div>
                              
                              <div class="tutorials">
                              
                              	<h3>Featured Video Tutorials</h3>
                              
                              	<div class="image-container access-hero" title="Microsoft Access Tutorials"></div>
                              
                              	<ul>
                              
                              		<li class="first"><a href="/tutorials/access-beginner.jsp">Access <br> Beginner Series</a></li>
                              
                              		<li><a href="/tutorials/access-intermediate.jsp">Access <br> Intermediate Series</a></li>
                              
                              		<li class="last"><a href="/tutorials/access-advanced.jsp">Access <br> Advanced Series</a></li>
                              
                              	</ul>
                              
                              	<div class="more">
                              
                              		<h3>More Technology Tutorials</h3>
                              
                              		<ul>
                              
                              			<li class="thumb">
                              
                              				<a class="cThumb" href="/tutorials/cTutorial-intermediate.jsp">
                              
                              				<a href="/tutorials/cTutorial-intermediate.jsp">C Programming for Intermediate Users</a>
                              
                              			</li>
                              
                              			<li class="thumb">
                              
                              				<a class="wordpressThumb" href="/tutorials/wordpressTutorial-beginner.jsp" />
                              
                              				<a href="/tutorials/wordpressTutorial-beginner.jsp">WordPress for Beginners</a>
                              
                              			</li>
                              
                              			<li class="thumb last">
                              
                              				<a class="powershellThumb" href="/tutorials/windowsPowershell.jsp" />
                              
                              				<a href="/tutorials/windowsPowershell.jsp">Windows Powershell</a>
                              
                              			</li>
                              
                              		</ul>
                              
                              		<p class="view-more"><a href="/tutorials/">View All Tutorials</a></p>
                              
                              	</div>
                              
                              </div>
                              
                              <div class="articles">
                              
                              	<h3>Featured Articles</h3>
                              
                              	<div class="featured">
                              
                              		<div class="image-container article-hero" title="Experts Exchange Articles"></div>
                              
                              		<h4><a href="/ITPro/Consulting/A_2111-WARNING-5-Reasons-why-you-should-NEVER-fix-a-computer-for-free.html">WARNING: 5 Reasons why you should NEVER fix a computer for free.</a></h4>
                              
                              		<p>It is in our nature to love the puzzle. We are obsessed. The lot of us. We love puzzles. We love the challenge. We thrive on finding the answer. We hate disarray. It bothers us deep in our soul.</p>
                              
                              		<p>We love the accolades. We love to be seen as the digital white knight who fixed the server, the computer, the email, and anything else that life depends on.</p>
                              
                              		<p>We love it so much, we sometimes make horrible decisions. Sometimes, we work "FOR FREE."</p>
                              
                              	</div>
                              
                              	<div class="featured last">
                              
                              		<div class="image-container article-hero-2" title="Experts Exchange Articles"></div>
                              
                              		<h4><a href="/OS/Microsoft_Operating_Systems/Server/Systems_Management_Server/A_1259-SCCM-OSD-Basic-troubleshooting.html">SCCM OSD Basic Troubleshooting</a></h4>
                              
                              		<p>SCCM 2007 OSD is a fantastic way to deploy operating systems, however, like most things SCCM issues can sometimes be difficult to resolve due to the sheer volume of logs to sift through and the dispersed nature of the blog posts that deal with some of these issues. This article will help SCCM OSD newbies with some of these issues.</p>
                              
                              		<h5>Integrating SCCM and MDT 2008.</h5>
                              
                              		<p>For our deployments, we always install MDT 2008 on our SCCM server and select Configure ConfigMgr Integration from the MDT area on the start menu. This gives us:</p>
                              
                              		<ul>
                              
                              			<li>Templated task sequences we can import into SCCM</li>
                              
                              			<li>Additional TS Variables for use in our task sequences</li>
                              
                              			<li>Additional options and flexibility around computer backup...</li>
                              
                              		</ul>
                              
                              	</div>
                              
                              <div class="image-container articles character articles-experts" title="Read through articles written by top experts!"></div>
                                      <div class="more">
                              
                              		<h3>More Articles</h3>
                              
                              		<ul>
                              
                              			<li class="thumb">
                              
                              				<a class="sbsThumb" href="/Software/Server_Software/Email_Servers/Exchange/A_2881-Migrate-Small-Business-Server-2003-to-Exchange-2010-and-Windows-2008-R2.html" />
                              
                              				<a href="/Software/Server_Software/Email_Servers/Exchange/A_2881-Migrate-Small-Business-Server-2003-to-Exchange-2010-and-Windows-2008-R2.html">Migrate Small Business Server 2003 to Excha...</a>
                              
                              			</li>
                              
                              			<li class="thumb">
                              
                              				<a class="win7Thumb" href="/Programming/System/Windows__Programming/A_2000-Create-a-Win7-Gadget.html" />
                              
                              				<a href="/Programming/System/Windows__Programming/A_2000-Create-a-Win7-Gadget.html">Create a Win7 Gadget</a>
                              
                              			</li>
                              
                              			<li class="thumb last">
                              
                              				<a class="exchangeThumb" href="/Software/Server_Software/Email_Servers/Exchange/A_1798-Exchange-2003-Activesync-Connection-Problems-FAQ.html" />
                              
                              				<a href="/Software/Server_Software/Email_Servers/Exchange/A_1798-Exchange-2003-Activesync-Connection-Problems-FAQ.html">Exchange 2003 - Activesync Connection Prob...</a>
                              
                              			</li>
                              
                              		</ul>
                              
                              		<p class="view-more"><a href="/articles/">Read More Articles</a></p>
                              
                              	</div>
                              
                              </div>
                            </div>
                          </div>
                        </div><div class="component textComponent expertWebinars" id="textComponent-id7">
                          <div class="body">
                            <div class="section">
                              <h3>Expert Live Instructional Videos</h3>
                              <ul>
                              	<li class="thumb">
                              		<a class="databaseThumb" href="/cloud-class-live/introduction-application-database-design.jsp" />
                              		<a href="/cloud-class-live/introduction-application-database-design.jsp">Instructions to Application & Database Design</a>
                              	</li>
                              	<li class="thumb">
                              		<a class="accessThumb" href="/cloud-class-live/avoiding-bugs-in-access.jsp" />
                              		<a href="/cloud-class-live/avoiding-bugs-in-access.jsp">Avoiding Bugs in Microsoft Access</a>
                              	</li>
                              	<li class="thumb">
                              		<a class="disasterThumb" href="/cloud-class-live/disaster-recovery-and-continuity-planning.jsp" />
                              		<a href="/cloud-class-live/disaster-recovery-and-continuity-planning.jsp">Disaster Recovery and Business Continuity</a>
                              	</li>
                              	<li class="thumb">
                              		<a class="sql1Thumb" href="/cloud-class-live/writing-faster-sql-part1.jsp" />
                              		<a href="/cloud-class-live/writing-faster-sql-part1.jsp">Writing Faster SQL Server Queries <br> Part 1</a>
                              	</li>
                              	<li class="thumb last">
                              		<a class="sql2Thumb" href="/cloud-class-live/writing-faster-sql-part2.jsp" />
                              		<a href="/cloud-class-live/writing-faster-sql-part2.jsp">Writing Faster SQL Server Queries <br> Part 2</a>
                              	</li>
                              </ul>
                              <p class="view-more"><a href="/cloud-class-live/">View More Live Instructional Videos</a></p>
                            </div>
                          </div>
                        </div>
                        <div class="newsCTA">
                          <span class="component textComponent" id="textComponent-id8"><!-- Subscribe to EE -->
                          <div class="bffr_vqpSubscribe">
                          	<p>Get full access to the help you need.</p>
                          	<p class="buttons">
                          		<a class="button confirm" href="/register.jsp?redirect=/Programming/Languages/.NET/Web_Services/Q_26718112.html" target="_self"><span>Subscribe Now</span></a>
                          	</p>
                          	<p class="freeTrial">30 Day free trial. Register in 60 seconds.</p>
                          </div>
                          </span>
                        </div>
                        <div class="latestTech">
                          <div class="component headingComponent tech-header" id="headingComponent">
                            <div class="head">
                              <h2 class="subtitle uiExpanded">The Latest Technology News and Tips</h2>
                              <div class="ui-chrome"></div>
                            </div>
                          </div>
                          <div class="component textComponent techNews" id="textComponent-id9">
                            <div class="body">
                              <div class="section">
                                <div class="blogs">
                                	<h3>EE Tech News Blog</h3>
                                	<p class="subheader">Bringing you the latest in technology</p>
                                	<table>
                                		<tr>
                                			<td class="name"><a href="http://blog.experts-exchange.com/ee-tech-news/congressman-proposes-bill-to-ban-internet-laws-for-awhile/">Congressman Proposes Bill to Ban...</a></td>
                                			<td class="date">11/28/12</td>
                                		</tr>
                                		<tr>
                                			<td class="name"><a href="http://blog.experts-exchange.com/ee-tech-news/death-to-internet-anonymity-google-requires-google-id-to-comment-on-play-store/">Death to Internet Anonymity: Google...</a></td>
                                			<td class="date">11/27/12</td>
                                		</tr>
                                		<tr>
                                			<td class="name"><a href="http://blog.experts-exchange.com/tedx-san-luis-obispo/">TEDx San Luis Obispo</a></td>
                                			<td class="date">11/20/12</td>
                                		</tr>
                                		<tr>
                                			<td class="name"><a href="http://blog.experts-exchange.com/ee-tech-news/video-sharepoint2010-no-code-solutions-for-power-users-webinar-recording-now-available/">SharePoint 2010 No-Code Solutions...</a></td>
                                			<td class="date">11/19/12</td>
                                		</tr>
                                		<tr>
                                			<td class="name"><a href="http://blog.experts-exchange.com/ee-tech-news/keeping-your-passwords-and-your-windows-8-machine-secure-natas-corner/"> Keeping Your Passwords And Your Win...</a></td>
                                			<td class="date">11/15/12</td>
                                		</tr>
                                		<tr>
                                			<td class="name"><a href="http://blog.experts-exchange.com/ee-tech-news/fun-and-games-with-hackers-how-to-fend-off-a-script-kiddie/">Fun and Games with Hackers: How to...</a></td>
                                			<td class="date">11/15/12</td>
                                		</tr>
                                	</table>
                                </div>
                                <div class="podcasts">
                                	<h3>EE Tech News Podcasts</h3>
                                	<p class="subheader">Listen while you work</p>
                                	<ul>
                                		<li class="thumb">
                                			<a class="podcastThumb" href="http://blog.experts-exchange.com/ee-tech-news/twitter-changes-infrastructure-and-kills-fail-whale-drackula-saves-sys-admins-podcast/" />
                                			<a href="http://blog.experts-exchange.com/ee-tech-news/twitter-changes-infrastructure-and-kills-fail-whale-drackula-saves-sys-admins-podcast/">Twitter Changes Infrastructure, Kills Fail Whale; dRACK...</a>
                                		</li>
                                		<li class="thumb">
                                			<a class="podcastThumb" href="http://blog.experts-exchange.com/ee-tech-news/new-tablet-week-apple-microsoft-hawk-ipad-mini-and-surface-podcast/" />
                                			<a href="http://blog.experts-exchange.com/ee-tech-news/new-tablet-week-apple-microsoft-hawk-ipad-mini-and-surface-podcast/">New Tablet Week: Apple, Microsoft...</a>
                                		</li>
                                		<li class="thumb last">
                                			<a class="podcastThumb" href="http://blog.experts-exchange.com/ee-tech-news/how-technology-is-changing-politics-podcast/" />
                                			<a href="http://blog.experts-exchange.com/ee-tech-news/how-technology-is-changing-politics-podcast/">How Technology is Changing Politics</a>
                                		</li>
                                </div>
                              </div>
                            </div>
                          </div><div class="component textComponent newSolutions" id="textComponent-id10">
                            <div class="body">
                              <div class="section">
                                <div class="image-container character answer" title="Your answer is only minutes away!"></div>
                                <h3>New Solutions Everyday</h3>
                                <p>Because of our active community of experts, on average new questions receive their first comment in under 30 minutes.</p>
                              </div>
                            </div>
                          </div>
                          <div class="taPopWrap">
                            <div class="component questionPopular taPopularQuestions" id="questionPopular">
                              <div class="head">
                                <h3>Top Web Services and WCF Questions</h3>
                                <div class="ui-chrome"></div>
                              </div>
                              <div class="body">
                                <ul class="tabs daysToggle">
                                  <li><a class="tab todayTab" href="#"><span>Today</span></a></li>
                                  <li><a class="tab allTimeTab" href="#"><span>All Time</span></a></li>
                                </ul>
                                <div class="popularList section">
                                  <ul>
                                    <li class="first"><a href="/Database/Oracle/Q_28250013.html" title="Oracle.DataAccess.dll typeinitialization error when running in IIS"><span>Oracle.DataAccess.dll typ…</span></a>182 Views</li>
                                    <li><a href="/Programming/Languages/.NET/ASP.NET/Q_28243389.html" title="Error: HttpException (0x80004005): Request timed out"><span>Error: HttpException (0x…</span></a>134 Views</li>
                                    <li><a href="/Programming/Languages/.NET/Web_Services/Q_28240720.html" title="Having a WCF service with InstanceContextMode of Single and ConcurrencyMode Multiple"><span>Having a WCF service with I…</span></a>101 Views</li>
                                    <li><a href="/Software/Server_Software/Web_Servers/Microsoft_IIS/Q_28293474.html" title="Asp mvc, wcf, IIS, Error 413 &quot;Request Entity too large&quot;."><span>Asp mvc, wcf, IIS, Error…</span></a>100 Views</li>
                                    <li><a href="/Microsoft/Development/Q_28260254.html" title="Consume AS400 Web Service Problem"><span>Consume AS400 Web Ser…</span></a>91 Views</li>
                                    <li><a href="/Programming/Languages/.NET/Web_Services/Q_28265297.html" title="Unit Testing WCF Async Calls in VS2010"><span>Unit Testing WCF Async Call…</span></a>89 Views</li>
                                    <li><a href="/Programming/Languages/.NET/Visual_CPP/Q_28267292.html" title="How can I bound this gridview with this List&lt;&gt; code?"><span>How can I bound this gridvie…</span></a>85 Views</li>
                                    <li><a href="/Programming/Languages/.NET/Web_Services/Q_28234279.html" title="Can 2 separate calls to the same web service &nbsp;change the varible values of each other?"><span>Can 2 separate calls to the …</span></a>83 Views</li>
                                    <li><a href="/Programming/Languages/.NET/Web_Services/Q_28233387.html" title="Location Code"><span>Location Code</span></a>78 Views</li>
                                    <li class="last"><a href="/Programming/Languages/.NET/Web_Services/Q_28275787.html" title="mvc, razor"><span>mvc, razor</span></a>78 Views</li>
                                  </ul>
                                  <p class="buttons"><a class="button confirm" href="Hot_Solutions.html" title="View More"><span>View More</span></a></p>
                                </div>
                                <div class="popularList section">
                                  <ul>
                                    <li class="first"><a href="/Software/System_Utilities/Remote_Access/Citrix/Q_25796630.html" title="Cannot connect to the Citrix XenApp server. Socket operation on non-socket."><span>Cannot connect to the Citrix …</span></a>643 Views</li>
                                    <li><a href="/Programming/Languages/.NET/Web_Services/Q_27045481.html" title="How to pass complex object as a parameter to WCF Rest from Windows form application."><span>How to pass complex object …</span></a>461 Views</li>
                                    <li><a href="/Programming/Languages/C_Sharp/Q_24367361.html" title=".Net URL Encoding: should a space be '+' (plus symbol) or '%20'?"><span>.Net URL Encoding: shoul…</span></a>453 Views</li>
                                    <li><a href="/Programming/Languages/Java/J2EE/Q_25148617.html" title="SOAP request object is null"><span>SOAP request object is null</span></a>399 Views</li>
                                    <li><a href="/OS/Microsoft_Operating_Systems/Server/MS-SharePoint/Q_27591359.html" title="&lt;nativehr&gt;0x80070002&lt;/nativehr&gt;&lt;nativestack&gt;&lt;/nativestack&gt; When creating Sharepoint Site"><span>&lt;nativehr&gt;0x800700…</span></a>391 Views</li>
                                    <li><a href="/Programming/Languages/.NET/Web_Services/Q_26359468.html" title="How to add SOAP HEADER SECURITY in C# WCF 3.5 (http)"><span>How to add SOAP HEADER …</span></a>381 Views</li>
                                    <li><a href="/Programming/Languages/.NET/Web_Services/Q_23744334.html" title="TimeoutException &nbsp;The request channel timed out while waiting for a reply after 00:01:00. WCF web service"><span>TimeoutException &nbsp;The reque…</span></a>360 Views</li>
                                    <li><a href="/Programming/Languages/.NET/Web_Services/Q_28096261.html" title="Failed to add a service. Service metadata may not be accessible?"><span>Failed to add a service. Ser…</span></a>343 Views</li>
                                    <li><a href="/Microsoft/Development/MS-SQL-Server/SQL_Server_2008/Q_27586472.html" title="Interview questions for 7+ years exp in .NET"><span>Interview questions for 7+ …</span></a>336 Views</li>
                                    <li class="last"><a href="/Microsoft/Development/Q_28184964.html" title="web service asmx to return json without &quot;&lt;string xmlns=&quot;http://tempuri.org/&quot;&gt;&quot; tacked on to"><span>web service asmx to return j…</span></a>324 Views</li>
                                  </ul>
                                  <p class="buttons"><a class="button confirm" href="Top_Solutions.html" title="View More"><span>View More</span></a></p>
                                </div>
                                <script type="text/javascript">
                                  jqTabs('#questionPopular .tabs.daysToggle li','#questionPopular .popularList.section',readCookie('LISTDAYS'));
                                  jqBind('#questionPopular .tab.todayTab','focus',function(e){setCookie('LISTDAYS','0');return false;});
                                  jqBind('#questionPopular .tab.allTimeTab','focus',function(e){setCookie('LISTDAYS','1');return false;});
                                  jqBind('#questionPopular .detailTab','click',function(e){jqAsyncPost('','#',[{name:'rafView',value:'2'},{name:'asid',value:''}]);return false;});
                                  jqBind('#questionPopular .listTab','click',function(e){jqAsyncPost('','#',[{name:'rafView',value:'1'},{name:'asid',value:''}]);return false;});
                                </script>
                              </div>
                            </div>
                          </div>
                        </div>
                        <span class="component textComponent" id="textComponent-id11"><!-- Why EE -->
                        <div class="bffr_whyEE">
                                <h2>Hear What our Users are Saying</h2>
                        	<div class="bffr_whyEEPlayer">
                        	<!-- Start of Brightcove Player -->
                        
                        <div style="display:none">
                        
                        </div>
                        
                        <!--
                        By use of this code snippet, I agree to the Brightcove Publisher T and C 
                        found at https://accounts.brightcove.com/en/terms-and-conditions/. 
                        -->
                        
                        <script language="JavaScript" type="text/javascript" src="http://admin.brightcove.com/js/BrightcoveExperiences.js"></script>
                        
                        <object id="myExperience2688827047001" class="BrightcoveExperience">
                          <param name="bgcolor" value="#FFFFFF" />
                          <param name="width" value="595" />
                          <param name="height" value="335" />
                          <param name="playerID" value="2113120686001" />
                          <param name="playerKey" value="AQ~~,AAAB6-dsdLk~,Xv-VYbShZQb0QJlZ0g2AB-6sr0US6kUS" />
                          <param name="isVid" value="true" />
                          <param name="isUI" value="true" />
                          <param name="dynamicStreaming" value="true" />
                          
                          <param name="@videoPlayer" value="2688827047001" />
                        </object>
                        
                        <!-- 
                        This script tag will cause the Brightcove Players defined above it to be created as soon
                        as the line is read by the browser. If you wish to have the player instantiated only after
                        the rest of the HTML is processed and the page load is complete, remove the line.
                        -->
                        <script type="text/javascript">brightcove.createExperiences();</script>
                        
                        <!-- End of Brightcove Player -->
                        	</div>
                        	<p>Members of the expert community talk about why the experience at Experts Exchange is different than what you will find anywhere else.</p>
                        </div></span>
                        <div class="newsCTA">
                          <span class="component textComponent" id="textComponent-id12"><!-- Subscribe to EE -->
                          <div class="bffr_vqpSubscribe">
                          	<p>Try it out and discover for yourself.</p>
                          	<p class="buttons">
                          		<a class="button confirm" href="/register.jsp?redirect=/Programming/Languages/.NET/Web_Services/Q_26718112.html" target="_self"><span>Subscribe Now</span></a>
                          	</p>
                          	<p class="freeTrial">30 Day free trial. Register in 60 seconds.</p>
                          </div>
                          </span>
                        </div>
                      </div>
                    </div>
                    <div class="sansCommentType">
                    </div>
                  </div>
                  <span class="component textComponent bottomPageID" id="textComponent-id13">201309-EE-VQP-052</span>
                </div>
              </div>
              <div id="col2Wrap">
                <div id="col2">
                  <div class="component contentSlider subscribeSlider" id="contentSlider">
                    <div class="head">
                      <h4 class="title">3 Ways to Join </h4>
                      <div class="ui-chrome"></div>
                    </div>
                    <div class="body">
                      <div class="section section-1 expanded">
                        <div class="subtitle">
                            <p>30-Day Free Trial</p>
                            
                        </div>
                        <div class="content">
                            <ul>
                            <li>For individual users</li>
                            <li>Instant access to solutions</li>
                            <li>Ask your tech questions</li>
                            <li class="signUpFree"><a href="/registration.jsp?redirect=/Programming/Languages/.NET/Web_Services/Q_26718112.html" >Start your 30-day Free Trial</a></li> 
                            </ul>
                            
                        </div>
                      </div>
                      <div class="section section-2 collapsed">
                        <div class="subtitle">
                            <p>Business Accounts</p>
                            
                        </div>
                        <div class="content">
                            <ul>
                            <li>Perfect for organizations</li>
                            <li>Multiple users</li>
                            <li>Save over 36%</li>
                            <li class="signUp"><a href="/subscribeBusinessAccount.jsp?redirect=/Programming/Languages/.NET/Web_Services/Q_26718112.html" target="_self">Create a Business Account</a></li>
                            </ul>
                            
                        </div>
                      </div>
                      <div class="section section-3 collapsed">
                        <div class="subtitle">
                            <p>Answer for Membership</p>
                            
                        </div>
                        <div class="content">
                            <ul>
                            <li>Earn free access</li>
                            <li>Showcase your knowledge</li>
                            <li>No credit card required</li>
                            <li class="signUp"><a href="/expertSignUp.jsp?redirect=/Programming/Languages/.NET/Web_Services/Q_26718112.html" target="_self">Sign Up to Answer</a></li>
                            </ul>
                            
                        </div>
                      </div>
                      <script type="text/javascript">
                        jqBind('#contentSlider .section-1','click',function(e){jqAddClass('#contentSlider .section-1','expanded');jqRemoveClass('#contentSlider .section-1','collapsed');jqRemoveClass('#contentSlider .section-2','expanded');jqAddClass('#contentSlider .section-2','collapsed');jqRemoveClass('#contentSlider .section-3','expanded');jqAddClass('#contentSlider .section-3','collapsed');});
                        jqBind('#contentSlider .section-2','click',function(e){jqRemoveClass('#contentSlider .section-1','expanded');jqAddClass('#contentSlider .section-1','collapsed');jqAddClass('#contentSlider .section-2','expanded');jqRemoveClass('#contentSlider .section-2','collapsed');jqRemoveClass('#contentSlider .section-3','expanded');jqAddClass('#contentSlider .section-3','collapsed');});
                        jqBind('#contentSlider .section-3','click',function(e){jqRemoveClass('#contentSlider .section-1','expanded');jqAddClass('#contentSlider .section-1','collapsed');jqRemoveClass('#contentSlider .section-2','expanded');jqAddClass('#contentSlider .section-2','collapsed');jqAddClass('#contentSlider .section-3','expanded');jqRemoveClass('#contentSlider .section-3','collapsed');});
                        
                      </script>
                    </div>
                  </div>
                  <div class="component messagingHero whyEE meetExperts slideshow" id="messagingHero">
                    <div class="body">
                      <ul class="tabs">
                        <li><a class="tab" href="#" rel="nofollow"><span><span class="ee">Why Experts Exchange?</span></span></a></li>
                        <li><a class="tab" href="#" rel="nofollow"><span><span class="ee">Why Experts Exchange?</span></span></a></li>
                        <li><a class="tab" href="#" rel="nofollow"><span><span class="ee">Why Experts Exchange?</span></span></a></li>
                        <li><a class="tab" href="#" rel="nofollow"><span><span class="ee">Why Experts Exchange?</span></span></a></li>
                        <li><a class="tab" href="#" rel="nofollow"><span><span class="ee">Why Experts Exchange?</span></span></a></li>
                      </ul>
                      <div class="section section-1 ">
                        <h3 class="subtitle"><span class="ee">Why Experts Exchange?</span></h3>
                        <div class="content">
                          <p><img src="/images/experts-exchange/trusted/Trusted.jpg" alt="Trusted by 44 of the Top Fortune 50 Companies." />
                          <img class="companies" src="/images/experts-exchange/trusted/fortune50.png" alt="Verizon, Bank of America, IBM, Windows, Dell, Target, Boeing, Comcast, AT&amp;T" /></p>
                          
                        </div>
                        <p class="buttons"><a class="button small " target="_self"></a></p>
                      </div>
                      <div class="section section-2 ">
                        <h3 class="subtitle"><span class="ee">Why Experts Exchange?</span></h3>
                        <div class="content">
                          <p><img src="/images/experts-exchange/trusted/TechResource.jpg" alt="The go-to tech resource for hundreds of thousands."></p>
                          
                          <p>"With the help of Experts Exchange -- I have been able to meet my deadlines and produce effective products"</p>
                          
                          <p class="author">Jan Miller</p>
                          
                          <p>"I just today started my third contract assignment which I attribute to the skills I am learning from other experts."</p>
                          
                          <p class="author">Robert Antonellis</p>
                          
                          <p>"It's my sole resource as I'm kind of an MS Access loner at my company.  It's like having colleagues available when I run out of my own steam."</p>
                          
                          <p class="author">Karen Ruskin</p>
                          
                        </div>
                        <p class="buttons"><a class="button small " target="_self"></a></p>
                      </div>
                      <div class="section section-3 ">
                        <h3 class="subtitle"><span class="ee">Why Experts Exchange?</span></h3>
                        <div class="content">
                          <p><img src="/images/experts-exchange/trusted/TechExperts.jpg" alt="50K Tech Experts available to help"></p>
                          
                          <p><a href="/M_152751.html" target="_blank">Leew</a> has been an expert here since 1997 and is a master at Windows 2000 and XP, hard drives/storage and Small Business Server.</p>
                          
                          <p><a href="/M_388333.html" target="_blank">lrmoore</a> has been an expert here since 2000 and is a six-time Microsoft MVP with over 18 years experience in the networking industry.</p>
                          
                          <p><a href="/M_302115.html" target="_blank">angeliii</a> has been an expert here since 2000 and is a Microsoft MVP for his work with MS SQL Server and Development</p>
                          
                        </div>
                        <p class="buttons"><a class="button small " target="_self"></a></p>
                      </div>
                      <div class="section section-4 ">
                        <h3 class="subtitle"><span class="ee">Why Experts Exchange?</span></h3>
                        <div class="content">
                          <p><img src="/images/experts-exchange/trusted/3Million.jpg" alt="3 Million+ Questions Solved"></p>
                          
                          <p>"The experts approach solutions with patience and innovative ideas, and ultimately I have my problem solved."</p>
                          
                          <p class="author">Gary Serkhoshian</p>
                          
                          <p>"Most every situation is already posted and answered, a quick search usually gives a solution.  EE is truly a bargain."</p>
                          
                          <p class="author">Bob Schatzman</p>
                          
                          <p>"9 out of 10 times Experts Exchange has the accepted solution or an open discussion of the potential solutions to the problem."</p>
                          
                          <p class="author">Kenny Red</p>
                          
                        </div>
                        <p class="buttons"><a class="button small " target="_self"></a></p>
                      </div>
                      <div class="section section-5 ">
                        <h3 class="subtitle"><span class="ee">Why Experts Exchange?</span></h3>
                        <div class="content">
                          <p><img src="/images/experts-exchange/trusted/Serving.jpg" alt="Serving tech professionals since 1996."></p>
                          
                          <p>At Experts Exchange, we treat each question as unique and deserving of an answer.</p>
                          
                          <p>As one of the most enduring technology resources, our community knows the importance of helping each individual with their problem, no matter how complex or how simple.  We're here to collaborate with you.</p>
                          
                        </div>
                        <p class="buttons"><a class="button small " target="_self"></a></p>
                      </div>
                      <script type="text/javascript">
                        jqSlideshow('#messagingHero .section','#messagingHero .tabs li')
                      </script>
                    </div>
                  </div>
                  <span class="component textComponent baVqpBtn" id="textComponent-id14"><p class="buttons">
                  		<a class="button confirm" href="/business.jsp?redirect=/Programming/Languages/.NET/Web_Services/Q_26718112.html" target="_self"><span>Business Account Plans</span></a>
                  	</p></span>
                </div>
              </div>
            </div>
          </div>
          <div id="flex3"></div>
        </div>
        <div id="footer">
          <div id="footerInnerWrap">
            <div class="fatty-footer">
              <div class="component textComponent site-links" id="textComponent-id15">
                <div class="body">
                  <div class="section">
                    <div class="links">
                    	<p class="title">What is Experts Exchange?</p>
                    	<ul>
                    		<li><a href="/whatIsEE.jsp">Overview</a></li>
                    		<li><a href="/whatIsEE.jsp?ts=how-it-works">How it works</a></li>
                    		<li><a href="/whatIsEE.jsp?ts=features">Features</a></li>
                    		<li><a href="/whatIsEE.jsp?ts=view-topics">View Topics</a></li>
                    		<li><a href="/whatIsEE.jsp?ts=plans-and-pricing">Plans & Pricing</a></li>
                    		<li><a href="/whatIsEE.jsp?ts=our-customers">Our Customers</a></li>
                    	</ul>
                    </div>
                    
                    <div class="links">
                    	<p class="title">Our Community</p>
                    	<ul>
                    		<li><a href="/community">Point System</a></li>
                    		<li><a href="/community/expertBenefits.jsp">Expert Benefits</a></li>
                    		<li><a href="/expertAwards/">Expert Awards</a></li>
                    		<li><a href="/discoverBusinessAccounts.jsp">Business Accounts</a></li>
                    		<li><a href="/contactUs.jsp">Customer Support</a></li>
                    		<li><a href="http://careers.experts-exchange.com/">Job Board</a></li>
                    	</ul>
                    </div>
                    
                    <div class="links">
                    	<p class="title">Get Support</p>
                    	<ul>
                    		<li><a href="http://support.experts-exchange.com" target="_blank">Site Help</a></li>
                    		<li><a href="/terms.jsp">Terms of Use</a></li>
                    		<li><a href="/privacyPolicy.jsp">Privacy Policy</a></li>
                    		<li><a href="/siteMap.jsp">Site Map</a></li>
                    		<li><a href="/shortener.jsp">URL Shortener</a></li>
                    	</ul>
                    </div>
                    
                    <div class="links">
                    	<p class="title">The Company</p>
                    	<ul>
                    		<li><a href="/aboutUs.jsp">About Us</a></li>
                    		<li><a href="/contactUs.jsp">Contact Us</a></li>
                    		<li><a href="http://blog.experts-exchange.com/">EE Blog</a></li>
                    		<li><a href="http://shop.experts-exchange.com">EE Store</a></li>
                    	</ul>
                    </div>
                  </div>
                </div>
              </div><div class="component textComponent site-highlights" id="textComponent-id16">
                <div class="body">
                  <div class="section">
                    <div class="main-topics">	
                    	<p class="title">Main Topics</p>
                    	<a href="/allTopics.jsp" class="browse-all">Browse All Topics</a>
                    	<div class="topics">	
                    		<ul>
                    			<li><a href="/Microsoft/">Microsoft</a></li>
                    			<li><a href="/Apple/">Apple</a></li>
                    			<li><a href="/Internet/">Internet</a></li>
                    			<li><a href="/Gamers/">Gamers</a></li>
                    		</ul>
                    		<ul>
                    			<li><a href="/Digital_Living/">Digital Living</a></li>
                    			<li><a href="/Virus_and_Spyware/">Virus & Spyware</a></li>
                    			<li><a href="/Hardware/">Hardware</a></li>
                    			<li><a href="/Software/">Software</a></li>
                    		</ul>
                    		<ul>
                    			<li><a href="/Security/">Security</a></li>
                    			<li><a href="/Programming/">Programming</a></li>
                    			<li><a href="/Web_Development/">Web Development</a></li>
                    			<li><a href="/Networking/">Networking</a></li>
                    		</ul>
                    		<ul>
                    			<li><a href="/Developer/">Developer</a></li>
                    			<li><a href="/Storage/">Storage</a></li>
                    			<li><a href="/OS/">OS</a></li>
                    			<li><a href="/Database/">Database</a></li>
                    		</ul>
                    	</div>
                    </div>
                    <div class="trending-topics">	
                    	<p class="title">Trending Topics</p>
                    	<div class="topics">	
                    		<ul>
                    			<li><a href="/Apple/Programming/iOS/">iOS</a></li>
                    			<li><a href="/Programming/Languages/Scripting/JavaScript/">JavaScript</a></li>
                    			<li><a href="/Microsoft/Development/MS_Access/">MS Access</a></li>
                    			<li><a href="/Programming/Languages/Java/">Java</a></li>
                    		</ul>
                    		<ul>
                    			<li><a href="/Microsoft/Development/MS-SQL-Server/">MS SQL Server</a></li>
                    			<li><a href="/Programming/Languages/Java/Android/">Android</a></li>
                    			<li><a href="/Programming/Languages/.NET/Visual_Basic.NET/">Visual Basic .NET</a></li>
                    			<li><a href="/Software/Office_Productivity/Office_Suites/MS_Office/Excel/">MS Excel</a></li>
                    		</ul>
                    		<ul>
                    			<li><a href="/Software/Server_Software/Email_Servers/Exchange/">Exchange</a></li>
                    			<li><a href="/Programming/Languages/C_Sharp/">C#</a></li>
                    			<li><a href="/Software/Office_Productivity/Groupware/Outlook/">Outlook</a></li>
                    			<li><a href="/Web_Development/Web_Languages-Standards/PHP/">PHP</a></li>
                    		</ul>
                    		<ul>
                    			<li><a href="/Web_Development/WebBased_CMS/WordPress/">WordPress</a></li>
                    			<li><a href="/Database/Oracle/">Oracle Database</a></li>
                    			<li><a href="/Programming/Languages/Visual_Basic/">Visual Basic Classic</a></li>
                    			<li><a href="/Programming/Languages/.NET/">.NET Programming</a></li>
                    		</ul>
                    	</div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="copyright">
                <div class="component mobileButton non-mobile-true" id="mobileButton-id2">
                  <div class="body">
                    <a class="button mobileButton return-to-mobile" href="http://mobile.experts-exchange.com/Programming/Languages/.NET/Web_Services/Q_26718112.html?mobileFullSite=false" rel="nofollow" title="View Experts Exchange Mobile Site"><span>Mobile Site</span></a>
                  </div>
                </div>
                <span class="component textComponent copy" id="textComponent-id17"><span>&copy; 1996-2013 <a href="/index.jsp">Experts Exchange, LLC.</a> All rights reserved. Covered by US Patent. <a href="/askerCertified.jsp" class="askerCert">Asker Certified</a></span></span>
              </div>
            </div>
            <script id="contentJavascript-id3" type="text/javascript">
              popupHandlerPort();
            </script>
            <div id="deprecatedBrowserWarning">
              <span class="component textComponent" id="textComponent-id18"></span>
            </div>
            <span class="component textComponent" id="textComponent-id19"></span>
            <script id="contentJavascript-id4" type="text/javascript">
              bpBrickHeight();
            </script>
            <script id="contentJavascript-id5" type="text/javascript">
              bpPlanCount();
            </script>
            <script id="contentJavascript-id6" type="text/javascript">
              notificationHeaderActions();
            </script>
          </div>
        </div>
      </div>
    </div>
    <script id="contentJavascript-id7" type="text/javascript">
      fileUploadLO();
    </script>
    <script type="text/javascript">
      jqBind('#toggleButton .toggleButton','click',function(e){jqToggle('#loginToggle');jqToggleClass('#loginToggle','selected');jqToggleClass(this,'selected');return false;});
    </script>
    <script type="text/javascript">
      adroll_adv_id = "GGCU75PN5NCQBI5IAY2KOE";
      adroll_pix_id = "YHVUTU3HGBGZNEYV4XVWXH";
      (function () {
      var oldonload = window.onload;
      window.onload = function(){
         __adroll_loaded=true;
         var scr = document.createElement("script");
         var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
         scr.setAttribute('async', 'true');
         scr.type = "text/javascript";
         scr.src = host + "/j/roundtrip.js";
         ((document.getElementsByTagName('head') || [null])[0] ||
          document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
         if(oldonload){oldonload()}};
      }());
    </script>
    <script type="text/javascript">
        /* <![CDATA[ */
        var google_conversion_id = 988514747;
        var google_conversion_label = "7snGCP3lmAcQu5Ou1wM";
        var google_custom_params = window.google_tag_params;
        var google_remarketing_only = true;
        /* ]]> */
    </script>
    <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js"></script>
    <noscript>
      <div style="display:inline;">
        <img alt="" height="1" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/988514747/?value=0&amp;label=7snGCP3lmAcQu5Ou1wM&amp;guid=ON&amp;script=0" style="border-style:none;" width="1" />
      </div>
    </noscript>
    <script type="text/javascript">
        <!--
        (function() {
          var ga = document.createElement('script');     ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:'   == document.location.protocol ? 'https://ssl'   : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
        //-->
    </script>
    <script type="text/javascript" language="Javascript">
        <!--
        function getOmnitureFuntion()
        {
          var s = setUpOmnitureVariable('eexchangeprod');
          s.pageName='LO - 201309-EE-VQP-052';
          s.server='cms41.dc5.redsrci.com';
          s.channel='/Programming/Languages/.NET/Web_Services/';
          s.pageType='';
          s.eVar31='128.233.63.37';
          s.eVar30='Friday';
          s.eVar29='4PM';
          s.eVar6='Free Trial Guest';
          s.eVar35='201309-EE-VQP-052';
          s.eVar33='/Programming/Languages/.NET/Web_Services/';
          s.hier='/Programming/Languages/.NET/Web_Services/';
          s.events='event4';
          return s;
        }
        //-->
    </script>
    <script type="text/javascript" language="Javascript">
        /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
        var s1386980515055 = getOmnitureFuntion();
        var s_code=s1386980515055.t();
        if(s_code)document.write(s_code)
    </script>
    <noscript>
        <img
        src="http://metrics.experts-exchange.com/b/ss/eexchangeprod/1/H.7--NS/0"
        height="1" width="1" border="0" alt="" /><!--/DO NOT REMOVE/-->
        <!-- End SiteCatalyst code version: H.7. -->
    </noscript>
    <script type="text/javascript">
      $.ajax({url: '//munchkin.marketo.net/munchkin-beta.js',dataType: 'script',cache: true,success: function() {Munchkin.init('013-NVV-408'); }});
    </script>
    <!-- cms41.dc5.redsrci.com:80 - Page: 841943 -->
  </body>
</html>
