<!DOCTYPE HTML>
<!--
         _____________ 
        < TUICOOL.COM >
         ------------- 
              \                    / \  //\
               \    |\___/|      /   \//  \\
                    /0  0  \__  /    //  | \ \    
                   /     /  \/_/    //   |  \  \  
                   @_^_@'/   \/_   //    |   \   \ 
                   //_^_/     \/_ //     |    \    \
                ( //) |        \///      |     \     \
              ( / /) _|_ /   )  //       |      \     _\
            ( // /) '/,_ _ _/  ( ; -.    |    _ _\.-~        .-~~~^-.
          (( / / )) ,-{        _      `-.|.-~-.           .~         `.
         (( // / ))  '/\      /                 ~-. _ .-~      .-~^-.  \
         (( /// ))      `.   {            }                   /      \  \
          (( / ))     .----~-.\        \-'                 .~         \  `. \^-.
                     ///.----..>        \             _ -~             `.  ^-`  ^-_
                       ///-._ _ _ _ _ _ _}^ - - - - ~                     ~-- ,.-~
                                                                          /.-~
-->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta content="authenticity_token" name="csrf-param" />
<meta content="EAHuska/LsFett688hmGK7FwMGSHiJdOa0vjQlrHU5E=" name="csrf-token" />
		<title>Programming HTML5 Web Sockets in ASP.NET 4.5 - æŽ¨é…·</title>
		<meta name="description" content="Programming HTML5 Web Sockets in ASP.NET 4.5"/>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  
  <link href="/assets/application-37c63992069f265dd83b68bfe513ee01.css" media="all" rel="stylesheet" type="text/css" />
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">

  <script src="/assets/application-9099d0b3b5c543383457b904797e6210.js" type="text/javascript"></script>
  <script src="/assets/bootstrap-popover-85edfa8a100b8e35ba76575e06738efc.js" type="text/javascript"></script>

  <!--[if IE 7]>
  <link rel="stylesheet" href="/assets/font-awesome-ie7.min.css">
  <![endif]--> 

    <script src="/assets/tip-a32d188a95cbab85121e3a6059dab75f.js" type="text/javascript"></script>

    
 	<link href="/assets/art_zoom-48eda4c0f1a722be6edc5f6d8bc65a9b.css" media="screen" rel="stylesheet" type="text/css" />
<script src="/assets/weibo-7585d869cd63846c6f174a8c58396405.js" type="text/javascript"></script>


</head>
<body>
  
  <div id="header" class="navbar-fixed-top">
    
      <div class="container">
        <div class="navbar">
          <div class="navbar-inner">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> 
              <span class="icon-bar"></span> 
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
    		      <span class="icon-bar"></span> 
            </a>
            <a href="/" class="brand">æŽ¨é…·<sub style="font-size:12px;">&nbsp;ä¸ªæ€§åŒ–ä½ çš„é˜…è¯»</sub></a>        
		      <nav class="nav-collapse collapse">
  		      <ul class="nav">
                  <li>
                  <a href="/ah/">
                    æ–‡ç«                     
                  </a>
                </li>
                  <li>
                  <a href="/qt/">
                    å¾®å?š                    
                  </a>
                </li>
                  <li>
                  <a href="/topics/">
                    ä¸»é¢˜                    
                  </a>
                </li>
                  <li>
                  <a href="/sites/">
                    ç«™ç‚¹                    
                  </a>
                </li>
                  <li>
                  <a href="/huodong/">
                    æ´»åŠ¨                    
                  </a>
                </li>
                  <li>
                  <a href="/mags/">
                    å‘¨åˆŠ                    
                  </a>
                </li>
  	        </ul>
            <form class="navbar-search pull-left" action="/topics/search">
              <input type="text" class="search-query span2" name="kw" placeholder="æ?œç´¢ä¸»é¢˜">
            </form>
            <ul class="nav pull-right">
              	<li><a href="/login" >ç™»å½•</a>
                </li>
    	      </ul>
        </nav>
      </div>
    </div>
	 </div>	
	</div>
  <div id ="flash_container" class="noPrint">    
    <!-- <a href='#'' class='close' data-dismiss='alert'>Ã—</a> -->
  </div>
    
<div class="container-fluid">  
  <!-- body start-->
  <script src="/assets/spin-e9abeea86a7144c7709122728dc4612e.min" type="text/javascript"></script>
<link rel="stylesheet" href="/assets/prettify/github.css">
<div class="row-fluid">
	<!--show start-->	
	<div class="span8 contant">
		<h1>Programming HTML5 Web Sockets in ASP.NET 4.5</h1>
		<div class="article_meta">
			<span class="timestamp">
				æ—¶é—´
     		2012-11-05 22:52:00
     	</span>

			<span class="from">				
				<i class="icon-globe"></i>
				<a class="cut cut28 from" href="/sites/uANjei" target="_blank">
					CodeGuru.com
				</a>
			</span>
			
			<span id="dup-cnt">
				<a href="/articles/dup?id=zaqMru" target="_blank">ç›¸ä¼¼æ–‡ç« </a>
				(<i id="dup">0</i>)
			</span>

			<span class="pdf">
			</span>     
     	
     	<span class="source" style="display:block;">
     		<i style="float:left;">åŽŸæ–‡</i>&nbsp;
				<a class="cut cut70" href="http://www.codeguru.com/csharp/csharp/programming-html5-web-sockets-in-asp.net-4.5.htm" style="display:inline-block;">http://www.codeguru.com/csharp/csharp/programming-html5-web-sockets-in-asp.net-4.5.htm</a>
      </span>

          <a href="#add-article-to-kan" id="add-article-to-kan-btn" class="btn" data-toggle="modal" style="display:none;">æ·»åŠ åˆ°æŽ¨åˆŠ</a>  
          <!-- add_article to kan -->
<div id="add-article-to-kan" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <span class="add-title">æ”¶è—?åˆ°ä½ çš„æŽ¨åˆŠ</span>
    <a href="#new-kan" class="btn btn-success pull-right" data-toggle="modal">åˆ›å»ºæŽ¨åˆŠ</a>
    <i class="clearfix"></i>
  </div>
  <div class="modal-body">
    <div class="add-article-to-kan-title">Programming HTML5 Web Sockets in ASP.NET 4.5</div>
    <label>é€‰æ‹©æŽ¨åˆŠ</label>
    <ul id="add-kan-list">
    </ul>
  </div>
  <div class="modal-footer">
    <input type="hidden" value="zaqMru" class="article-id" /> 
    <button class="btn btn-primary pull-left add-to-btn">æ”¶è—?</button>
    <button class="btn" data-dismiss="modal" aria-hidden="true">å?–æ¶ˆ</button>
  </div>
</div>
<div class="add-article-to-kan-alert">
  å·²æ”¶è—?åˆ°æŽ¨åˆŠï¼?
</div>

          <div id="new-kan" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<!--
    <a href="new-kan" class="btn" data-toggle="modal">åˆ›å»ºæŽ¨åˆŠ</a>
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
    <h3 id="myModalLabel">Modal header</h3>
  </div>
-->
  <div class="modal-body">
    <input type="text" name="name" id="new-kan-name"  placeholder="æŽ¨åˆŠå??(å¿…å¡«)" required data-validation-required-message="è¯·å¡«å†™æŽ¨åˆŠå??" />
    <span class="new-ness-name">è¯·å¡«å†™æŽ¨åˆŠå??</span>
    <br/>
    <textarea name="desc" id="desc" rows="6" placeholder="æŽ¨åˆŠæ??è¿°"></textarea>
    <span class="new-ness-desc">æ??è¿°ä¸?èƒ½å¤§äºŽ100ä¸ªå­—ç¬¦!</span>
    <br/>
    æ?ƒé™?è®¾ç½®ï¼š<input type="radio" name="type" value="1" checked="checked" /> å…¬å¼€
    <input type="radio" name="type" value="0"> ä»…è‡ªå·±å?¯è§?
  </div>
  <div class="modal-footer">
    <button class="btn btn-primary pull-left create-kan-btn" disabled>åˆ›å»º</button>
    <button class="btn dismiss-new-kan" data-dismiss="modal" aria-hidden="true">å?–æ¶ˆ</button>
  </div>
</div>


      
		</div>
		<div class="article_body"  id="nei">
			<article>
  <span>
    <h2>Introduction</h2>
    <p>
      <a href="http://www.htmlgoodies.com/html5/index.php">HTML5</a>
      WebSockets allow you to perform two-way (duplex) communication between the client browser and the server. ASP.NET 4.5 and IIS 8 provide support for WebSocket protocol so that you can program WebSockets in your ASP.NET web forms and ASP.NET MVC applications. This article discusses what WebSockets are and how to develop web applications that take advantage of HTML5 WebSockets.
    </p>
    <h2>Overview of HTML5 Web Sockets</h2>
    <p>Typically a communication over the web is comprised of two distinct parties participating in the communication, viz. the client and the web server. An ordinary web page uses a request-response model of communication wherein the browser sends a request to the server and the server then sends back a response. Each request and response uses a new connection and that connection is closed once the response is returned by the server. As you might have guessed, such a communication is poor in terms of performance since a new connection is established between the same client and the server every time. Additionally, such a communication can't be two way, i.e. client talking to server and server talking to the client simultaneously.</p>
    <p>In the case of two-way or duplex communication both the parties participating in the communication can communicate at the same time. A common application of the duplex communication is chat systems such as MSN or Yahoo Messenger and Google Talk. In any chat system, two or more members can chat with each other at the same time. As far as HTML5 is concerned, the technique to achieve two way communications is Web Sockets.</p>
    <p>Unlike the request-response model, WebSockets keep the underlying communication channel open throughout the course of communication. A WebSocket based communication typically involves three steps:</p>
    <ul>
      <li>Establishing a connection between the client and the server or Hand Shake.</li>
      <li>Asking the Web Socket server to listen to the incoming communication</li>
      <li>Sending and receiving data</li>
    </ul>
    <p>Web applications use HTTP protocol for their functioning and HTTP protocol essentially makes use of the request-response model. The plain HTTP protocol isn't well suited for performing two-way communications. The WebSockets therefore, need to &quot;upgrade&quot; the plain HTTP protocol to WebSocket protocol. This &quot;upgrade&quot; takes place while establishing the connection between the client and the server. In order to upgrade the communication from plain HTTP to WebSocket, you need a web server that is capable of doing this upgrade.</p>
    <h2>Enabling WebSocket Protocol in Windows 8</h2>
    <p>As far IIS is concerned, IIS 8.0 that ships with Windows 8 is capable of accepting Web Socket communications. If you are developing a web application that makes use of HTML5 Web Sockets, you may need to install WebSocket support in IIS 8.0. The following figure shows the &quot;Turn Windows features on or off&quot; option from the control panel. It can be used to install WebSocket protocol.</p>
    <p>
      <img alt="Turn Windows Features on or off" src="http://img0.tuicool.com/63EJJv.jpg" class="alignCenter" />
      <br/>
      <span style="">Turn Windows Features on or off</span>
    </p>
    <p>Notice how the &quot;WebSocket Protocol&quot; feature is checked under &quot;World Wide Web Services&quot;. If the IIS installation doesn't have WebSocket protocol enabled your ASP.NET applications won't be able to receive and respond to the WebSocket requests on the server.</p>
    <p>A WebSocket based application consists of two parts, viz. WebSocket server side code and WebSocket client side code. The WebSocket server side code sits on the web server and &quot;listens&quot; to the incoming communication from clients. When some communication is received from the client it processes the communication and typically sends some communication back to the client. If there is no communication from the client the WebSocket server can either keep waiting for the communication or can terminate the communication channel. The WebSocket client side code makes use of the WebSocket object of HTML5 for the purpose of sending and receiving data to and from the WebSocket server side code.</p>
    <p>The WebSocket client side code follows the same coding pattern regardless of your web server software. As far as ASP.NET is concerned, IIS 8 and certain .NET framework classes together allow you to develop WebSocket server side functionality. To understand how the client side and server side code goes hand in hand let's develop a simple application that performs a two-way communication. The web form that acts as a WebSocket client is shown below:</p>
    <p>
      <img alt="The web form that acts as a WebSocket client " src="http://img1.tuicool.com/a2MrAr.jpg" class="alignCenter" />
      <br/>
      <span style="">The web form that acts as a WebSocket client</span>
    </p>
    <p>Using the above web form you can send a text message from the client to the server. The server then sends the same message back to the client (this is purely for the sake of simplicity and testing purposes. You can send any other data from the server. Clicking on the Stop button stops the server and no further communication can take place between the client and the server.</p>
    <h2>Coding the Client Side</h2>
    <p>Open the default web form and add the following jQuery code to a &lt;script&gt; block:</p>
    <pre class="prettyprint">var socket;
$(document).ready(function () {
&nbsp;&nbsp;&nbsp; socket = new WebSocket(&quot;ws://localhost:1046/WebSocketGenericHandler.ashx&quot;);
&nbsp;&nbsp;&nbsp; socket.addEventListener(&quot;open&quot;, function (evt) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(&quot;#divHistory&quot;).append('&lt;h3&gt;Connection Opened with the Echo server.&lt;/h3&gt; ');}, 
&nbsp;&nbsp;&nbsp; false);&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp; socket.addEventListener(&quot;message&quot;, function (evt) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(&quot;#divHistory&quot;).append('&lt;h3^gt;' + evt.data + '&lt;/h3&gt; ');&nbsp;&nbsp; }, 
&nbsp; &nbsp;&nbsp;false);&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp; socket.addEventListener(&quot;error&quot;, function (evt) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(&quot;#divHistory&quot;).append('&lt;h3&gt;Unexpected Error.&lt;/h3&gt; ');}, 
&nbsp;&nbsp;&nbsp; false);
&nbsp;&nbsp;&nbsp; ...
});</pre>
    <p>The code shown above declares a global variable named socket to hold a reference to a WebSocket object. A WebSocket instance is then created by passing the URL of the WebSocketHandler.ashx. The WebSocketHandler.ashx contains the WebSocket server side code that &quot;listens&quot; to the client requests. You will develop WebSocketHandler.ashx later in this article. Notice how the URL uses ws:// protocol instead of http://. Next, event handlers for the three events, viz. open, message, and error, are wired using the addEventListener() method. The open event is raised when the readyState property (discussed next) changes to 1 (OPEN) and indicates that the connection is ready to send and receive data. The message event is raised when a message is received from the WebSocket server. The error event is raised when an error occurs during the communication with the Web Socket server.</p>
    <p>Inside the message event handler the data sent by the server is retrieved using the evt.data property. The returned data is then appended to a &lt;div&gt; element. The other event handlers simply output the specified messages in the &lt;div&gt; element. The data from the client is sent to the server when the Send button is clicked. The click event handler of the Send button looks like this:</p>
    <pre class="prettyprint">$(&quot;#btnSend&quot;).click(function () {
&nbsp;&nbsp;&nbsp; if (socket.readyState == WebSocket.OPEN) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; socket.send($(&quot;#txtMsg&quot;).val());
&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp; else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(&quot;#divHistory&quot;).append('&lt;h3&gt;The underlying connection is closed.&lt;/h3&gt; ');
&nbsp; }
});</pre>
    <p>The click event handler of the Send button checks the readyState property of the WebSocket object. If the readyState is OPEN, it calls the send() method on the WebSocket instance. This read only property returns the current state of the connection. Possible values are 0 - CONNECTING, 1 - OPEN, 2 - CLOSING, 3 - CLOSED. The send() method sends data to the WebSocket server side code over an established connection. The text entered in the textbox is passed as a parameter to the send() method.</p>
    <p>You can close the underlying connection by calling the close() method of the WebSocket object as follows:</p>
    <pre class="prettyprint">$(&quot;#btnStop&quot;).click(function () {
&nbsp;&nbsp;socket.close();
});</pre>
    <h2>Coding the Server Side</h2>
    <p>The WebSocketHandler.ashx contains the server side code that listens and responds to the client requests. This code is shown below:</p>
    <pre class="prettyprint">public class WebSocketHandler : IHttpHandler
{
&nbsp;&nbsp;&nbsp; public void ProcessRequest(HttpContext context)
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (context.IsWebSocketRequest)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.AcceptWebSocketRequest(DoTalking);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp; ...
}</pre>
    <p>The above code shows an ASP.NET generic handler - WebSocketHandler - that triggers the WebSocket server. The ProcessRequest() method of the generic handler first checks whether the incoming request is a WebSocket request. This is done by checking the IsWebSocketRequest property of the HttpContext object. This property works hand-in-hand with the IIS 8.0 WebSocket module and returns true if an incoming request is a WebSocket request. A Web Socket request is different than an ordinary HTTP request in that instead of using http:// protocol it uses ws:// (Web Socket) protocol.</p>
    <p>If the IsWebSocketRequest returns true, the AcceptWebSocketRequest() method of the HttpContext is called. This method takes one parameter - user function - that supplies a function that listens and responds to the client requests. In this case the user function contains the logic to listen to the incoming data and send it back to the client. The user function supplied to the AcceptWebSocketRequest() method should be an asynchronous function as shown below:</p>
    <pre class="prettyprint">public async Task DoTalking(AspNetWebSocketContext context)
{
&nbsp;&nbsp;&nbsp; WebSocket socket = context.WebSocket;
&nbsp;&nbsp;&nbsp; while (true)
&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ArraySegment buffer = new ArraySegment(new byte[1024]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WebSocketReceiveResult result = await socket.ReceiveAsync(buffer, CancellationToken.None);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (socket.State == WebSocketState.Open)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string userMessage = Encoding.UTF8.GetString(buffer.Array, 0, result.Count);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; userMessage = &quot;You sent: &quot; + userMessage + &quot; at &quot; +&nbsp; DateTime.Now.ToLongTimeString();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; buffer = new ArraySegment(Encoding.UTF8.GetBytes(userMessage));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; await socket.SendAsync(buffer, WebSocketMessageType.Text, true, CancellationToken.None);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp; }
}</pre>
    <p>The DoTalking() method is marked as &quot;async&quot; indicating that the code inside it is going to run in asynchronous fashion. The DoTalking() method returns a Task object. The Task class acts as a wrapper to the asynchronous code. The DoTalking() method receives a parameter of type AspNetWebSocketContext. The AspNetWebSocketContext class gives you access to the WebSocket through its WebSocket property. The WebSocket class is the server side counterpart of the HTML5 WebSocket object. An endless while loop is then started so that the server can continuously listen to the incoming requests. To receive the incoming data, the ReceiveAsync() method of the WebSocket class is used. The ReceiveAsync() method is invoked along with the await operator. In this case the awaited task is to receive incoming data and store it in an ArraySegment, a byte array. The results of the receive operation are stored in WebSocketReceiveResult object. If the WebSocket is open as indicated by the State property, the received data is sent back to the client using the SendAsync() method. If the State property has any value other than Open, the while loop is exited thus terminating the server.</p>
    <h2>Summary</h2>
    <p>HTML5 WebSockets allow you to perform two-way (duplex) communication. To use HTML5 WebSockets in an ASP.NET application you need to enable the WebSocket protocol in IIS 8.0. You can then use IsWebSocketRequest property and AcceptWebSocketRequest() method to start the client-server communication. Using WebSockets, you can develop web applications such as Chat systems that require the ability to send and receive data simultaneously between the client and the server.</p>
    <h3>About the Author:</h3>
    <p>
      <strong>Bipin Joshi</strong>
      is a blogger and author who writes about apparently unrelated topics - Yoga &amp; technology! A former Software Consultant and Trainer by profession, Bipin is programming since 1995 and is working with .NET framework ever since its inception. He has authored or co-authored half a dozen books and numerous articles on .NET technologies. He has also penned a few books on Yoga. Having embraced Yoga way of life he now writes about Yoga, life and technology on his
      <a href="http://www.bipinjoshi.net">website</a>
      . He can also be reached there.
    </p>
  </span>
</article>

		</div>		
	</div>
	<div class="span4">
			<div id ="related_topics" class="related_topics">

			</div>
		<div class="operate_zone">
			<h4 class="side_article_list_title">å¦‚æžœä½ æ„Ÿå…´è¶£</h4>
			<div class="article_like">
					<button class="btn btn-large liked" id="my_like2" data_id="zaqMru">
						<!-- <i class="icon-thumbs-up"></i>-->
						<i class="icon-heart-empty"></i>
						å–œ æ¬¢
					</button>
					<button class="btn btn-large liked" id="my_like" data_id="zaqMru">
						<i class="icon-star-empty"></i>
						æ”¶ è—?
					</button>
			</div>

			<h4 class="side_article_list_title">åˆ†äº«è¯¥æ–‡ç« </h4>
			<div class="share_zone">				
				<script type="text/javascript" charset="utf-8">
				(function(){
				  var _w = 32 , _h = 32;
				  var param = {
				    url:location.href,
				    type:'1',
				    count:'', /**æ˜¯å?¦æ˜¾ç¤ºåˆ†äº«æ•°ï¼Œ1æ˜¾ç¤º(å?¯é€‰)*/
				    appkey:'', /**æ‚¨ç”³è¯·çš„åº”ç”¨appkey,æ˜¾ç¤ºåˆ†äº«æ?¥æº?(å?¯é€‰)*/
				    title:'Programming HTML5 Web Sockets in ASP.NET 4.5', /**åˆ†äº«çš„æ–‡å­—å†…å®¹(å?¯é€‰ï¼Œé»˜è®¤ä¸ºæ‰€åœ¨é¡µé?¢çš„title)*/
				    pic:'', /**åˆ†äº«å›¾ç‰‡çš„è·¯å¾„(å?¯é€‰)*/
				    ralateUid:'2609648351', /**å…³è?”ç”¨æˆ·çš„UIDï¼Œåˆ†äº«å¾®å?šä¼š@è¯¥ç”¨æˆ·(å?¯é€‰)*/
						language:'zh_cn', /**è®¾ç½®è¯­è¨€ï¼Œzh_cn|zh_tw(å?¯é€‰)*/
				    rnd:new Date().valueOf()
				  }
				  var temp = [];
				  for( var p in param ){
				    temp.push(p + '=' + encodeURIComponent( param[p] || '' ) )
				  }
				  document.write('<iframe id="sina_share" allowTransparency="true" frameborder="0" scrolling="no" src="http://hits.sinajs.cn/A1/weiboshare.html?' + temp.join('&') + '" width="'+ _w+'" height="'+_h+'"></iframe>')
				})()
				</script>	
				<div id="qqwb_share__" data-appkey="801319615" data-icon="0" data-counter="0" data-content="Programming HTML5 Web Sockets in ASP.NET 4.5 ï¼ˆåˆ†äº«è‡ª @tuicoolï¼‰" data-pic="http://img0.tuicool.com/63EJJv.jpg"></div>
				<script src="http://mat1.gtimg.com/app/openjs/openjs.js#autoboot=no&debug=no"></script>
										
				<a id="douban_share" target="_blank" href="http://share.baidu.com/s?type=text&amp;searchPic=0&amp;sign=on&amp;to=douban&amp;url=http://www.tuicool.com/articles/zaqMru&amp;title=Programming HTML5 Web Sockets in ASP.NET 4.5" title="åˆ†äº«åˆ°è±†ç“£"></a>
				
				<a id="qqzone_share" target="_blank" href="http://share.baidu.com/s?type=text&amp;searchPic=0&amp;sign=on&amp;to=qzone&amp;url=http://www.tuicool.com/articles/zaqMru&amp;title=Programming HTML5 Web Sockets in ASP.NET 4.5 ï¼ˆåˆ†äº«è‡ª @tuicoolï¼‰" title="åˆ†äº«åˆ°QQç©ºé—´"></a>

				<div class="pull-left btn-group">
	        <button style="height: 32px; font-size:14px" class="btn btn-primary dropdown-toggle pull-right tohide" data-toggle="dropdown"><i class="icon icon-share-alt icon-white"></i> åˆ†äº«åˆ° <span class="caret"></span></button>
	        <ul class="dropdown-menu">	         
	          <li><a target="_blank" href="http://s.evernote.com/grclip?url=http://www.tuicool.com/articles/zaqMru&amp;title=Programming HTML5 Web Sockets in ASP.NET 4.5">å?°è±¡ç¬”è®°</a></li>
	          <li><a target="_blank" href="http://share.baidu.com/s?type=text&amp;searchPic=0&amp;sign=on&amp;to=renren&amp;url=http://www.tuicool.com/articles/zaqMru&amp;title=Programming HTML5 Web Sockets in ASP.NET 4.5" title="åˆ†äº«åˆ°äººäººç½‘">äººäººç½‘</a></li>
	          <li><a target="_blank" href="http://share.baidu.com/s?type=text&amp;searchPic=0&amp;sign=on&amp;to=fbook&amp;url=http://www.tuicool.com/articles/zaqMru&amp;title=Programming HTML5 Web Sockets in ASP.NET 4.5" title="åˆ†äº«åˆ°Facebook">Facebook</a></li>	
	          <li><a target="_blank" href="http://share.baidu.com/s?type=text&amp;searchPic=0&amp;sign=on&amp;to=twi&amp;url=http://www.tuicool.com/articles/zaqMru&amp;title=Programming HTML5 Web Sockets in ASP.NET 4.5" title="åˆ†äº«åˆ°Twitter">Twitter</a></li>	
	          <li><a target="_blank" href="http://share.baidu.com/s?type=text&amp;searchPic=0&amp;sign=on&amp;to=linkedin&amp;url=http://www.tuicool.com/articles/zaqMru&amp;title=Programming HTML5 Web Sockets in ASP.NET 4.5" title="åˆ†äº«åˆ°Linkedin">Linkedin</a></li>
	          <li>
	          	<a href="https://plus.google.com/share?url={http://www.tuicool.com/articles/zaqMru}" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" title="åˆ†äº«åˆ°G+">
	          		Google +
	          	</a>
	          </li>
	          <li class="divider"></li>
	          <li><a href="mailto:?subject=å¥½æ–‡åˆ†äº«ï¼šProgramming HTML5 Web Sockets in ASP.NET 4.5&amp;body=/articles/zaqMru">E-Mail</a></li>
	        </ul>
	      </div>	
			</div>			
			
			<!--<a class="sept-bar " href="/septs" target="_blank">æœ‰ä¸€äº›ä¹¦è¦?é€?ç»™ä½  > </a> -->
			
		</div>		
	</div>
</div>	
	<div class="row-fluid" style="margin-top:0;">
	<div class="span8">		
		<div id="site_articles" ></div>
    
    <div id="kan_articles"></div>

    <div id="article_weibo" > 
    </div>

		<div class="comments">
			<div class="cover">
				<div class="comment-notlogin">
					è¯·ç™»å½•å?Žè¯„è®º</br>
				  <small style="margin-top: 5px;">å·²å?‘è¡¨è¯„è®ºæ•°(<span class="comment_cnt"></span>)</small>
				</div>
				<div class="comment-loading">
					<div id="spinner2"></div>
					è¯„è®ºåŠ è½½ä¸­
				</div>				
			</div>
			<div class="comments-area" style="display:none;">
				<div class="comments-list">
					<div class="empty-cmts alert alert-success" style="display:none;">æ²¡æœ‰æ›´å¤šè¯„è®ºäº†^^</div>					
				</div>
				<div class="more-comments" style="display:none;">
          <!--
					<a href="/articles/zaqMru/comments" target="_blank">æ‰€æœ‰è¯„è®º</a>-->
					<a href=""  >æ›´å¤šè¯„è®º</a>
				</div>
					<div class="load-fail" style="display:none;">è¯„è®ºåŠ è½½å¤±è´¥ï¼Œ<a href="javascript:reload_comments('zaqMru',1,0,-1);">é‡?æ–°åŠ è½½</a></div>
			</div>
		</div>

	</div>

	<div class="span4">		

	</div>
	</div>
<div id="article-correct-modal" class="modal hide fade in" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
  <div class="modal-header">
  	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3>æ–‡ç« çº é”™</h3>
  </div>
  <div class="modal-body">
  	<input type="hidden" value="zaqMru" id="article-correct-source">
  		<div>
		  	<label for="article-correct-email">é‚®ç®±</label>
		    <input type="email" id="article-correct-email" class="input-large" />
		  </div>
	  <div>
	  	<label for="article-correct-select">é”™è¯¯ç±»åž‹</label>
	  	<select id="article-correct-select">
	  		<option value="æ­£æ–‡ä¸?å‡†ç¡®">æ­£æ–‡ä¸?å‡†ç¡®</option>
	  		<option value="æŽ’ç‰ˆæœ‰é—®é¢˜">æŽ’ç‰ˆæœ‰é—®é¢˜</option>
	  		<option value="æ²¡æœ‰åˆ†é¡µå†…å®¹">æ²¡æœ‰åˆ†é¡µå†…å®¹</option>
	  		<option value="è§†é¢‘æ— æ³•æ˜¾ç¤º">è§†é¢‘æ— æ³•æ˜¾ç¤º</option>
	  		<option value="å›¾ç‰‡æ— æ³•æ˜¾ç¤º">å›¾ç‰‡æ— æ³•æ˜¾ç¤º</option>	  			  		
	  	</select>
	  </div>
	  <div>
	  	<label for="article-correct-other">è¡¥å……ä¿¡æ?¯</label>
	    <textarea id="article-correct-other" class="span6"></textarea>
	  </div>
  </div>
  <div class="modal-footer">
    <button class="btn btn-primary pull-right huodong_correct_submit" id="article-correct-submit">æ??äº¤</button>
  </div>
</div>
<div id="myLoginModal" class="modal hide fade">
	<div class="modal-header">
		<a class="close" data-dismiss="modal" >&times;</a>
		<h3>ç”¨æˆ·ç™»é™†</h3>
	</div>
	<div class="modal-body">
		<form method="post" action="/login" class="form-horizontal" id="login-form">
			<div class="control-group">
				<span class="control-label" for="xlEmail">é‚®ç®±</span>
				<div class="login-controls">
					<input class="input-medium" id="xlEmail" name="email" type="text" />
				</div>
			</div>
			<div class="control-group">
				<span class="control-label">å¯†ç ?</span>
				<div class="login-controls">
					<input id="xlPassword" name="password" class="input-medium" type="password" />
				</div>
			</div>
			<div class="form-actions">
				<button type="submit" class="btn btn-primary">
					&nbsp;&nbsp;ç™»&nbsp;&nbsp;&nbsp;é™†&nbsp;&nbsp;
				</button>
			</div>
		</form>
	</div>
</div>

<div class="read-later-alert"></div>
<style type="text/css">
#dup-cnt{
	display: none;
}
.btn-large{
	padding: 0;
}
.load-fail{
  display:none;
}
.header-title{
  margin-bottom:10px;
  line-height:25px;
}
.header-title span{
  font-size:16px;
  height:25px;
}
</style>	
<script src="/assets/highlight.pack.js"></script>

<script type="text/javascript">
		$(document).ready( function() {
	  	$.get("/articles/last_article_by_site_async?sid=uANjei&aid=zaqMru",function(data){$('#site_articles').append(data)});
	  		$.get("/articles/related_with_topics_async?aid=zaqMru",function(data){$('#related_topics').append(data)});
		});	
		$.get('/articles/dup_count?id=zaqMru',function(data){
			if(data.success){
				if(data.data > 0){
					$('#dup-cnt').show();
				}
				$('#dup').text(data.data);
			}
		})	

$(document).ready( function() {
	$('pre').each(function(i, e) {
		hljs.highlightBlock(e, "<span class='indent'>  </span>", false)		
	});
  // åŠ è½½ç›¸å…³å¾®
  get_weibo("zaqMru");
	//async_do_like_article();
    // åŠ è½½ç›¸å…³çš„æŽ¨åˆŠ
  related_kan("zaqMru");
  open_add_article_to_kan("false");
	async_do_like2_article(); 
	window.page = 0;
	window.last = 0;	
	window.first = true;	
	resize_article_image('#nei', 550);	
			$('.btn-submit').hide();
			load_comments("zaqMru",1,0,-1);
			window.uid = -1;				
	
});
	  

</script>

  <!-- body end -->
</div>

      <!--tc_footer start -->
<div class="footer" style="margin-top:50px;">
    <p>
      <a href="/about" target="_blank">å…³äºŽ</a>
      <a href="/mobile" target="_blank">åº”ç”¨</a>
      <a href="/bbs/go/issues" target="_blank">å??é¦ˆ</a>
      <a href="/bbs" target="_blank">è®¨è®º</a>
      <a href="/links" target="_blank">å?‹é“¾</a>
      <a href="http://chuang.tuicool.com" class="chuang">æŽ¨åˆ›</a>    
    </p>
</div>

<!--   <div class="sept-notify">
    <a href="javascript:close_sept();" class="close pull-right">&times;</a>
    <a class="sept-notify-body" href="/septs" target="_blank">æœ‰ä¸€äº›ä¹¦è¦?é€?ç»™ä½ [ç¬¬ä¸€å­£]</a>
  </div> -->

      <!--tc_footer end -->

<script src="http://s22.cnzz.com/stat.php?id=5541078&web_id=5541078&show=pic" language="JavaScript"></script>
</body>
</html>
