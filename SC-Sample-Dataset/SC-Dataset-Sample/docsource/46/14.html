<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="author" content="archiveorange.com" />
<meta name="copyright" content="&copy; respective authors" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<!--[if IE 8]><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" /><![endif]--> <!-- Blargh Microsoft, you stink (disables IE8's "compatibility mode") -->
<title>ClosedChannelException thrown when stopping Channel - Netty Users - ArchiveOrange</title>
<link rel="icon" type="image/ico" href="http://m3.archiveorange.com/m/im/favicon.ico" />

<link rel="stylesheet" type="text/css" href="http://m3.archiveorange.com/m/css/ao.1930.css" />
<!--[if IE 6]><link rel="stylesheet" type="text/css" href="http://m3.archiveorange.com/m/css/ie6.1930.css" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" type="text/css" href="http://m3.archiveorange.com/m/css/ie7.1930.css" /><![endif]-->
<!--[if IE 8]><link rel="stylesheet" type="text/css" href="http://m3.archiveorange.com/m/css/ie8.1930.css" /><![endif]-->

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>

<script type="text/javascript" src="http://m3.archiveorange.com/m/js/ao.1930.js"></script>


<meta name="description" content="08 Jul 2009 (4 replies) - Hi, In my connection pool Im invalidating and closing connections when they are no longer needed (i.e. pools hightwater mark is reached) and I seem to..." />

<link rel="alternate" type="application/rss+xml" title="Atom" href="/atom/list/ZVMdI/" />
<link rel="alternate" type="application/atom+xml" title="RSS" href="/rss/list/ZVMdI/" />

<script type="text/javascript">var StaticServer = "http://m3.archiveorange.com/m/";</script>


<script type="text/javascript" src="http://m3.archiveorange.com/m/js/view.1930.js"></script>

<script type="text/javascript">var viewarg = "ZVMdIqk29NKI7yaHzdP8";</script>

</head>
<body>

<div class="yui-d0">
<div id="hd"><a href="/"><img width="186" height="19" src="http://m3.archiveorange.com/m/im/archiveorange.png" alt="ArchiveOrange" /></a><span class="aotitletext">mail archive</span> <span class="headerlink"></span></div>
<div class="yui-main"><div class="yui-b"><div class="yui-gc">


<!-- google_ad_section_start(weight=ignore) -->


<div id="sr" class="yui-u">

<div id="src1">
<div><div class="orangebox">
<h3 class="orangeheading">Netty Users</h3><br />
<i>netty-users.lists.jboss.org</i><br /> 
(<a class="aonav" href="/archive/listinfo/ZVMdI">List home</a>) (<a class="aonav" href="/archive/list/ZVMdI">Recent threads</a>) (<a class="aonav" href="/archive/project/lists.jboss.org/">125 other JBoss Community lists</a>)
<div class="orangecontents">
<div class="aolistdetail">
<div class="showhide"><a class="sh"></a></div>
<div class="quoted">
<h4>Subscription Options</h4>
<ul>
<li><a title="RSS" href="/rss/list/ZVMdI"><b>RSS</b></a> or <a title="Atom" href="/atom/list/ZVMdI"><b>Atom</b></a>: Read-only subscription using a browser or aggregator.  This is the recommended way if you don&#39;t need to send messages to the list.  You can learn more about feed syndication and clients <a href="http://en.wikipedia.org/wiki/Web_feed"><b>here</b></a>.</li>
<li><b>Conventional</b>: All messages are delivered to your mail address, and you can reply.  To subscribe, send an email to the list&#39;s <a class="nml" href="http://mailhide.recaptcha.net/d?k=01Vgu1OPoq87OnAPuqo0xFMg==&amp;c=BY7pSrwKml628gat2DT9ed64wSNcIU8qqdJu7zOJshogPcG0q7iTXFoApcR5enNEvIaz0tNSy3vP4c2Es08zkQ==" onclick="window.open('http://mailhide.recaptcha.net/d?k=01Vgu1OPoq87OnAPuqo0xFMg==&amp;c=BY7pSrwKml628gat2DT9ed64wSNcIU8qqdJu7zOJshogPcG0q7iTXFoApcR5enNEvIaz0tNSy3vP4c2Es08zkQ==', '', 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=500,height=300'); return false;" title="Reveal this e-mail address"><b>subscribe</b></a> address with &quot;subscribe&quot; in the subject line, or visit the list&#39;s homepage <a href="https://lists.jboss.org/mailman/listinfo/netty-users"><b>here</b></a>.</li>
</ul>
</div></div>
<ul>

<li>This list contains about 5,353 messages, beginning Aug 2008</li>
<li>This list doesn&#39;t seem to be active</li>
</ul>
</div></div></div>
</div>


<div id="src2">
	<div id="reportsection">
		<div id="reportsectiontitle">Report the Spam</div>
		<div id="reportsectiondesc">This button sends a spam report to the moderator.  Please use it sparingly.  For other removal requests, <a class="aonav" href="/articles/about.html#removal">read this</a>.</div>
		<button id="reportspambutton" class="ao_button" type="submit">Report Spam</button>
		<div id="reportsectionconfirm">Are you sure? <span class="confirmtext" id="confirm-yes">yes</span> <span class="confirmtext" id="confirm-no">no</span></div>
		<div id="reportsectionresults"></div>
	</div>
</div>




</div>



<!-- google_ad_section_end -->


<div class="h1container"><h1>
<!-- google_ad_section_start -->
ClosedChannelException thrown when stopping Channel
<!-- google_ad_section_end -->
</h1> <span class="aosubtitle"></span></div>



<div class="adframe adframetop">
	<script type="text/javascript">
	window.google_analytics_uacct = "UA-3601455-4";
	</script>
	<script type="text/javascript"><!--
google_ad_client = "pub-3417341829819905";
/* AOAd_300x250_combined */
google_ad_slot = "4559678717";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


	
	
	<script type="text/javascript"><!--
google_ad_client = "pub-3417341829819905";
/* AOAd_300x250_combined */
google_ad_slot = "4559678717";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


	
	
	
	<div class="adframelabel">Ad</div>
</div>
<div class="clearleft"></div>






<div class="ao_msgframe" style="margin-left: 0%;">
	<div class="ao_msghead">
		<!-- Buttons -->
		<div class="ao_msgbtn"><a rel="nofollow" href="/archive/print/ZVMdIqk29NKI7yaHzdP8" title="Print view"><img width="16" height="16" src="http://m3.archiveorange.com/m/im/print.png" /></a></div>
		<div class="ao_msgbtn"><a href="#qk29NKI7yaHzdP8" title="Link to this message"><img width="16" height="16" src="http://m3.archiveorange.com/m/im/link.png" /></a></div>
		
		<div>
			<a name="qk29NKI7yaHzdP8"></a>
				<span class="ao_from">neilson9 </span> &mdash; <span class="datetimecontainer"><span class="unixdate">1247055685</span><span class="readabledate">Wed, 08 Jul 2009 12:21:25  +0000 (UTC)</span></span>
				
				
		</div>
		
		
	</div>
	
	<div class="ao_msgbody">
		<!-- google_ad_section_start -->
		<pre>Hi,
In my connection pool Im invalidating and closing connections when they are
no longer needed (i.e. pools hightwater mark is reached) and I seem to get
many ClosedChannelExceptions. Looking at the Stack and the Source Code
[below] it looks like I will either get a NotYetConnectedException OR a
ClosedChannelException - when stopping a channel.

Is it possible to prevent this from happening? 
Regards Neil.

&gt;From NioWorker.cleanUpWriteBuffer
             // Create the exception only once to avoid the excessive
overhead
                // caused by fillStackTrace.
                if (channel.isOpen()) {
                    cause = new NotYetConnectedException();
                } else {
                    cause = new ClosedChannelException();
                }
                evt.getFuture().setFailure(cause);

                fireExceptionCaught(channel, cause);

The exception picked up by my Handler
2009-07-08 13:10:16,272 WARN 3:10000-10-10 (netty.NettyClientHandler)	
com.liquidlabs.transport.netty.NettyClientHandler at 3f84e8 m:null
Client[null]] Unexpected exception from downstream, latch[null]
java.nio.channels.ClosedChannelException
	at
org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:609)
	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:568)
	at
org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink.eventSunk(NioClientSocketPipelineSink.java:97)
	at org.jboss.netty.channel.Channels.close(Channels.java:1043)
	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:185)
	at com.ll.transport.netty.NettySenderImpl.stop(NettySenderImpl.java:118)</pre>
		<!-- google_ad_section_end -->
	</div>
</div>



<div class="ao_msgframe" style="margin-left: 2%;">
	<div class="ao_msghead">
		<!-- Buttons -->
		<div class="ao_msgbtn"><a rel="nofollow" href="/archive/print/ZVMdIFSOKoMS8wzglJMh" title="Print view"><img width="16" height="16" src="http://m3.archiveorange.com/m/im/print.png" /></a></div>
		<div class="ao_msgbtn"><a href="#FSOKoMS8wzglJMh" title="Link to this message"><img width="16" height="16" src="http://m3.archiveorange.com/m/im/link.png" /></a></div>
		
		<div>
			<a name="FSOKoMS8wzglJMh"></a>
				<span class="ao_from"><span class="oplabel">neilson9 </span></span> &mdash; <span class="datetimecontainer"><span class="unixdate">1247055889</span><span class="readabledate">Wed, 08 Jul 2009 12:24:49  +0000 (UTC)</span></span>
				
				
		</div>
		
		
	</div>
	
	<div class="ao_msgbody">
		<!-- google_ad_section_start -->
		<pre>Platform: java6u13, win2003Server, Netty 3.1CR1 SS from July 1st<!-- AOStartQuote --><span class="aoquote"><span class="showhide"><a class="sh"></a></span><span class="quoted">neilson9 wrote:
&gt; 
&gt; Hi,
&gt; In my connection pool Im invalidating and closing connections when they
&gt; are no longer needed (i.e. pools hightwater mark is reached) and I seem to
&gt; get many ClosedChannelExceptions. Looking at the Stack and the Source Code
&gt; [below] it looks like I will either get a NotYetConnectedException OR a
&gt; ClosedChannelException - when stopping a channel.
&gt; 
&gt; Is it possible to prevent this from happening? 
&gt; Regards Neil.
&gt; 
&gt; From NioWorker.cleanUpWriteBuffer
&gt;              // Create the exception only once to avoid the excessive
&gt; overhead
&gt;                 // caused by fillStackTrace.
&gt;                 if (channel.isOpen()) {
&gt;                     cause = new NotYetConnectedException();
&gt;                 } else {
&gt;                     cause = new ClosedChannelException();
&gt;                 }
&gt;                 evt.getFuture().setFailure(cause);
&gt; 
&gt;                 fireExceptionCaught(channel, cause);
&gt; 
&gt; The exception picked up by my Handler
&gt; 2009-07-08 13:10:16,272 WARN 3:10000-10-10 (netty.NettyClientHandler)	
&gt; com.liquidlabs.transport.netty.NettyClientHandler at 3f84e8 m:null
&gt; Client[null]] Unexpected exception from downstream, latch[null]
&gt; java.nio.channels.ClosedChannelException
&gt; 	at
&gt; org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:609)
&gt; 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:568)
&gt; 	at
&gt; org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink.eventSunk(NioClientSocketPipelineSink.java:97)
&gt; 	at org.jboss.netty.channel.Channels.close(Channels.java:1043)
&gt; 	at
&gt; org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:185)
&gt; 	at com.ll.transport.netty.NettySenderImpl.stop(NettySenderImpl.java:118)
&gt; 
&gt; 
&gt;</span></span><!-- AOEndQuote --></pre>
		<!-- google_ad_section_end -->
	</div>
</div>



<div class="ao_msgframe" style="margin-left: 2%;">
	<div class="ao_msghead">
		<!-- Buttons -->
		<div class="ao_msgbtn"><a rel="nofollow" href="/archive/print/ZVMdIKjjKjJwWYlay5mL" title="Print view"><img width="16" height="16" src="http://m3.archiveorange.com/m/im/print.png" /></a></div>
		<div class="ao_msgbtn"><a href="#KjjKjJwWYlay5mL" title="Link to this message"><img width="16" height="16" src="http://m3.archiveorange.com/m/im/link.png" /></a></div>
		
		<div>
			<a name="KjjKjJwWYlay5mL"></a>
				<span class="ao_from">&quot;ì?´í?¬ìŠ¹ (Trustin Lee)&quot; </span> &mdash; <span class="datetimecontainer"><span class="unixdate">1247056078</span><span class="readabledate">Wed, 08 Jul 2009 12:27:58  +0000 (UTC)</span></span>
				
				
		</div>
		
		
	</div>
	
	<div class="ao_msgbody">
		<!-- google_ad_section_start -->
		<pre>If a channel has been closed and there are pending writes which were not
written yet, ClosedChannelException is raised for each write request.
You can simply discard the exception if it was intentional.

One idea though is it might be a better idea to fire exceptionCaught
event only once while notifying all futures.  I&#39;m still not sure about
the negative side effect of this change.  WDYT?

Thanks,
Trustin<!-- AOStartQuote --><span class="aoquote"><span class="showhide"><a class="sh"></a></span><span class="quoted">On 07/08/2009 09:21 PM, neilson9 wrote:
&gt; Hi,
&gt; In my connection pool Im invalidating and closing connections when they are
&gt; no longer needed (i.e. pools hightwater mark is reached) and I seem to get
&gt; many ClosedChannelExceptions. Looking at the Stack and the Source Code
&gt; [below] it looks like I will either get a NotYetConnectedException OR a
&gt; ClosedChannelException - when stopping a channel.
&gt; 
&gt; Is it possible to prevent this from happening? 
&gt; Regards Neil.
&gt; 
&gt;&gt;From NioWorker.cleanUpWriteBuffer
&gt;              // Create the exception only once to avoid the excessive
&gt; overhead
&gt;                 // caused by fillStackTrace.
&gt;                 if (channel.isOpen()) {
&gt;                     cause = new NotYetConnectedException();
&gt;                 } else {
&gt;                     cause = new ClosedChannelException();
&gt;                 }
&gt;                 evt.getFuture().setFailure(cause);
&gt; 
&gt;                 fireExceptionCaught(channel, cause);
&gt; 
&gt; The exception picked up by my Handler
&gt; 2009-07-08 13:10:16,272 WARN 3:10000-10-10 (netty.NettyClientHandler)	
&gt; com.liquidlabs.transport.netty.NettyClientHandler at 3f84e8 m:null
&gt; Client[null]] Unexpected exception from downstream, latch[null]
&gt; java.nio.channels.ClosedChannelException
&gt; 	at
&gt; org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:609)
&gt; 	at org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:568)
&gt; 	at
&gt; org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink.eventSunk(NioClientSocketPipelineSink.java:97)
&gt; 	at org.jboss.netty.channel.Channels.close(Channels.java:1043)
&gt; 	at org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:185)
&gt; 	at com.ll.transport.netty.NettySenderImpl.stop(NettySenderImpl.java:118)
&gt; 
&gt;</span></span><!-- AOEndQuote --></pre>
		<!-- google_ad_section_end -->
	</div>
</div>



<div class="ao_msgframe" style="margin-left: 4%;">
	<div class="ao_msghead">
		<!-- Buttons -->
		<div class="ao_msgbtn"><a rel="nofollow" href="/archive/print/ZVMdIcKMLQydfljVS3ns" title="Print view"><img width="16" height="16" src="http://m3.archiveorange.com/m/im/print.png" /></a></div>
		<div class="ao_msgbtn"><a href="#cKMLQydfljVS3ns" title="Link to this message"><img width="16" height="16" src="http://m3.archiveorange.com/m/im/link.png" /></a></div>
		
		<div>
			<a name="cKMLQydfljVS3ns"></a>
				<span class="ao_from"><span class="oplabel">neilson9 </span></span> &mdash; <span class="datetimecontainer"><span class="unixdate">1247056311</span><span class="readabledate">Wed, 08 Jul 2009 12:31:51  +0000 (UTC)</span></span>
				
				
		</div>
		
		
	</div>
	
	<div class="ao_msgbody">
		<!-- google_ad_section_start -->
		<pre>Sorry - I realised my mistake after the post - throwing an exception makes
sense when a write event is pending...
Regards Neil.<!-- AOStartQuote --><span class="aoquote"><span class="showhide"><a class="sh"></a></span><span class="quoted">Trustin Lee wrote:
&gt; 
&gt; If a channel has been closed and there are pending writes which were not
&gt; written yet, ClosedChannelException is raised for each write request.
&gt; You can simply discard the exception if it was intentional.
&gt; 
&gt; One idea though is it might be a better idea to fire exceptionCaught
&gt; event only once while notifying all futures.  I&#39;m still not sure about
&gt; the negative side effect of this change.  WDYT?
&gt; 
&gt; Thanks,
&gt; Trustin
&gt; 
&gt; On 07/08/2009 09:21 PM, neilson9 wrote:
&gt;&gt; Hi,
&gt;&gt; In my connection pool Im invalidating and closing connections when they
&gt;&gt; are
&gt;&gt; no longer needed (i.e. pools hightwater mark is reached) and I seem to
&gt;&gt; get
&gt;&gt; many ClosedChannelExceptions. Looking at the Stack and the Source Code
&gt;&gt; [below] it looks like I will either get a NotYetConnectedException OR a
&gt;&gt; ClosedChannelException - when stopping a channel.
&gt;&gt; 
&gt;&gt; Is it possible to prevent this from happening? 
&gt;&gt; Regards Neil.
&gt;&gt; 
&gt;&gt;&gt;From NioWorker.cleanUpWriteBuffer
&gt;&gt;              // Create the exception only once to avoid the excessive
&gt;&gt; overhead
&gt;&gt;                 // caused by fillStackTrace.
&gt;&gt;                 if (channel.isOpen()) {
&gt;&gt;                     cause = new NotYetConnectedException();
&gt;&gt;                 } else {
&gt;&gt;                     cause = new ClosedChannelException();
&gt;&gt;                 }
&gt;&gt;                 evt.getFuture().setFailure(cause);
&gt;&gt; 
&gt;&gt;                 fireExceptionCaught(channel, cause);
&gt;&gt; 
&gt;&gt; The exception picked up by my Handler
&gt;&gt; 2009-07-08 13:10:16,272 WARN 3:10000-10-10 (netty.NettyClientHandler)	
&gt;&gt; com.liquidlabs.transport.netty.NettyClientHandler at 3f84e8 m:null
&gt;&gt; Client[null]] Unexpected exception from downstream, latch[null]
&gt;&gt; java.nio.channels.ClosedChannelException
&gt;&gt; 	at
&gt;&gt; org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:609)
&gt;&gt; 	at
&gt;&gt; org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:568)
&gt;&gt; 	at
&gt;&gt; org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink.eventSunk(NioClientSocketPipelineSink.java:97)
&gt;&gt; 	at org.jboss.netty.channel.Channels.close(Channels.java:1043)
&gt;&gt; 	at
&gt;&gt; org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:185)
&gt;&gt; 	at com.ll.transport.netty.NettySenderImpl.stop(NettySenderImpl.java:118)
&gt;&gt; 
&gt;&gt; 
&gt; 
&gt; _______________________________________________
&gt; netty-users mailing list
&gt; netty-users at lists.jboss.org
&gt; <!-- AOStartLink 48 --><a class="nml" href="https://lists.jboss.org/mailman/listinfo/netty-users" rel="nofollow">https://lists.jboss.org/mailman/listinfo/nett...</a><!-- AOEndLink -->
&gt; 
&gt;</span></span><!-- AOEndQuote --></pre>
		<!-- google_ad_section_end -->
	</div>
</div>



<div class="ao_msgframe" style="margin-left: 6%;">
	<div class="ao_msghead">
		<!-- Buttons -->
		<div class="ao_msgbtn"><a rel="nofollow" href="/archive/print/ZVMdIg6gXc1znhWo2gAA" title="Print view"><img width="16" height="16" src="http://m3.archiveorange.com/m/im/print.png" /></a></div>
		<div class="ao_msgbtn"><a href="#g6gXc1znhWo2gAA" title="Link to this message"><img width="16" height="16" src="http://m3.archiveorange.com/m/im/link.png" /></a></div>
		
		<div>
			<a name="g6gXc1znhWo2gAA"></a>
				<span class="ao_from">&quot;ì?´í?¬ìŠ¹ (Trustin Lee)&quot; </span> &mdash; <span class="datetimecontainer"><span class="unixdate">1247121146</span><span class="readabledate">Thu, 09 Jul 2009 06:32:26  +0000 (UTC)</span></span>
				
				
		</div>
		
		
	</div>
	
	<div class="ao_msgbody">
		<!-- google_ad_section_start -->
		<pre>I modified Netty NIO transport implementation to raise
ClosedChannelException only once even if there were many pending write
requests, because I couldn&#39;t think of any negative side effect but
speedup in connection cleanup.  Let me know if this change breaks your
application.

Thanks for a good idea,
Trustin<!-- AOStartQuote --><span class="aoquote"><span class="showhide"><a class="sh"></a></span><span class="quoted">On 07/08/2009 09:31 PM, neilson9 wrote:
&gt; Sorry - I realised my mistake after the post - throwing an exception makes
&gt; sense when a write event is pending...
&gt; Regards Neil.
&gt; 
&gt; 
&gt; Trustin Lee wrote:
&gt;&gt; If a channel has been closed and there are pending writes which were not
&gt;&gt; written yet, ClosedChannelException is raised for each write request.
&gt;&gt; You can simply discard the exception if it was intentional.
&gt;&gt;
&gt;&gt; One idea though is it might be a better idea to fire exceptionCaught
&gt;&gt; event only once while notifying all futures.  I&#39;m still not sure about
&gt;&gt; the negative side effect of this change.  WDYT?
&gt;&gt;
&gt;&gt; Thanks,
&gt;&gt; Trustin
&gt;&gt;
&gt;&gt; On 07/08/2009 09:21 PM, neilson9 wrote:
&gt;&gt;&gt; Hi,
&gt;&gt;&gt; In my connection pool Im invalidating and closing connections when they
&gt;&gt;&gt; are
&gt;&gt;&gt; no longer needed (i.e. pools hightwater mark is reached) and I seem to
&gt;&gt;&gt; get
&gt;&gt;&gt; many ClosedChannelExceptions. Looking at the Stack and the Source Code
&gt;&gt;&gt; [below] it looks like I will either get a NotYetConnectedException OR a
&gt;&gt;&gt; ClosedChannelException - when stopping a channel.
&gt;&gt;&gt;
&gt;&gt;&gt; Is it possible to prevent this from happening? 
&gt;&gt;&gt; Regards Neil.
&gt;&gt;&gt;
&gt;&gt;&gt; &gt;From NioWorker.cleanUpWriteBuffer
&gt;&gt;&gt;              // Create the exception only once to avoid the excessive
&gt;&gt;&gt; overhead
&gt;&gt;&gt;                 // caused by fillStackTrace.
&gt;&gt;&gt;                 if (channel.isOpen()) {
&gt;&gt;&gt;                     cause = new NotYetConnectedException();
&gt;&gt;&gt;                 } else {
&gt;&gt;&gt;                     cause = new ClosedChannelException();
&gt;&gt;&gt;                 }
&gt;&gt;&gt;                 evt.getFuture().setFailure(cause);
&gt;&gt;&gt;
&gt;&gt;&gt;                 fireExceptionCaught(channel, cause);
&gt;&gt;&gt;
&gt;&gt;&gt; The exception picked up by my Handler
&gt;&gt;&gt; 2009-07-08 13:10:16,272 WARN 3:10000-10-10 (netty.NettyClientHandler)	
&gt;&gt;&gt; com.liquidlabs.transport.netty.NettyClientHandler at 3f84e8 m:null
&gt;&gt;&gt; Client[null]] Unexpected exception from downstream, latch[null]
&gt;&gt;&gt; java.nio.channels.ClosedChannelException
&gt;&gt;&gt; 	at
&gt;&gt;&gt; org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:609)
&gt;&gt;&gt; 	at
&gt;&gt;&gt; org.jboss.netty.channel.socket.nio.NioWorker.close(NioWorker.java:568)
&gt;&gt;&gt; 	at
&gt;&gt;&gt; org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink.eventSunk(NioClientSocketPipelineSink.java:97)
&gt;&gt;&gt; 	at org.jboss.netty.channel.Channels.close(Channels.java:1043)
&gt;&gt;&gt; 	at
&gt;&gt;&gt; org.jboss.netty.channel.AbstractChannel.close(AbstractChannel.java:185)
&gt;&gt;&gt; 	at com.ll.transport.netty.NettySenderImpl.stop(NettySenderImpl.java:118)
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; netty-users mailing list
&gt;&gt; netty-users at lists.jboss.org
&gt;&gt; <!-- AOStartLink 48 --><a class="nml" href="https://lists.jboss.org/mailman/listinfo/netty-users" rel="nofollow">https://lists.jboss.org/mailman/listinfo/nett...</a><!-- AOEndLink -->
&gt;&gt;
&gt;&gt;
&gt;</span></span><!-- AOEndQuote --></pre>
		<!-- google_ad_section_end -->
	</div>
</div>






</div></div></div>

<div id="ft"><a class="aonav" href="/">Home</a> | <a class="aonav" href="/articles/about.html">About</a> | <a class="aonav" href="/articles/privacy.html">Privacy</a></div>
</div>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-3601455-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 
        'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>




<!-- Some analytical data that will help us improve the service. -->
<!-- Which list, how old are the threads, etc. -->
<script type="text/javascript">
_gaq.push(['_trackEvent', 'list_lang', 'en']);
_gaq.push(['_trackEvent', 'org', 'lists.jboss.org']);
_gaq.push(['_trackEvent', 'list_view', 'ZVMdI']);
_gaq.push(['_trackEvent', 'list_data', 'ZVMdI', 'thread_age', 139924825]);
_gaq.push(['_trackEvent', 'list_ref', 'ZVMdI', refcls()]);
</script>


</body></html>

