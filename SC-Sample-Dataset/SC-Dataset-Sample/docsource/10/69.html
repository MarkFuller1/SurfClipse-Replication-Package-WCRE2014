














<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">














<html>
<head>
    <title>[#GLASSFISH-16767] Glassfish classloader attack causes IllegalStateException on undeployment - Java.net JIRA </title>

    <meta content="issuesummary" name="decorator" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="-1" />
    <link rel="shortcut icon" href="/jira/s/472/1/_/favicon.ico">
    <link rel="icon" type="image/png" href="/jira/s/472/1/_/images/icons/favicon.png">
    


	




<link rel="stylesheet" type="text/css" media="print" href="/jira/s/472/1/_/styles/combined-printable.css">
<link type="text/css" rel="StyleSheet" media="all" href="/jira/s/472/1/_/styles/combined.css"/>
<link type="text/css" rel="StyleSheet" media="all" href="/jira/s/472/1/0/_/styles/global.css"/>

    
    <script type="text/javascript">var contextPath = '/jira';</script>
<link type="text/css" rel="stylesheet" href="/jira/s/472/1/1.2.4/_/download/batch/com.atlassian.auiplugin:ajs/com.atlassian.auiplugin:ajs.css" media="all">
<!--[if IE]>
<link type="text/css" rel="stylesheet" href="/jira/s/472/1/1.2.4/_/download/batch/com.atlassian.auiplugin:ajs/com.atlassian.auiplugin:ajs.css?ieonly=true" media="all">
<![endif]-->
<script type="text/javascript" src="/jira/s/472/1/1.2.4/_/download/batch/com.atlassian.auiplugin:ajs/com.atlassian.auiplugin:ajs.js" ></script>
<script type="text/javascript" src="/jira/s/472/1/1.0/_/download/batch/jira.webresources:jira-global/jira.webresources:jira-global.js" ></script>
<link type="text/css" rel="stylesheet" href="/jira/s/472/1/1.0/_/download/batch/jira.webresources:jira-global/jira.webresources:jira-global.css" media="all">
<!--[if IE]>
<link type="text/css" rel="stylesheet" href="/jira/s/472/1/1.0/_/download/batch/jira.webresources:jira-global/jira.webresources:jira-global.css?ieonly=true" media="all">
<![endif]-->
<script type="text/javascript" src="/jira/s/472/1/1.0/_/download/batch/jira.webresources:autocomplete/jira.webresources:autocomplete.js" ></script>
<link type="text/css" rel="stylesheet" href="/jira/s/472/1/1.0/_/download/batch/jira.webresources:autocomplete/jira.webresources:autocomplete.css" media="all">
<link type="text/css" rel="stylesheet" href="/jira/s/472/1/2.3.1/_/download/batch/com.atlassian.jira.plugin.labels:labels-files/com.atlassian.jira.plugin.labels:labels-files.css" media="all">
<script type="text/javascript" src="/jira/s/472/1/2.3.1/_/download/batch/com.atlassian.jira.plugin.labels:labels-files/com.atlassian.jira.plugin.labels:labels-files.js" ></script>
<script type="text/javascript" src="/jira/s/472/1/1.0/_/download/batch/jira.webresources:header/jira.webresources:header.js" ></script>

</head>





















<body id="jira"  >


<div id="header">
    <div id="header-top">
        <a id="logo" href="/jira/secure/Dashboard.jspa">
                        <img class="logo" src="/jira/s/472/1/_/images/jira111x30.png" width="111" height="30" border="0" alt="Java.net JIRA">
                    </a>
                <form id="quicksearch" action="/jira/secure/QuickSearch.jspa" method="post">
            <label for="quickSearchInput" class="overlabel">Quick Search
                <span id="quicksearchhelp" class="informationBox">
                                                 Learn more about <a href='http://docs.atlassian.com/jira/docs-040/Using+Quick+Search?clicked=jirahelp' target='_jirahelp'>Quick Search</a>
                </span>
            </label>
            <input id="quickSearchInput" class="quickSearchInput" title="Go directly to an issue by typing a valid issue key, or run a free-text search." type="text" size="25" name="searchString" accessKey="q"  valign="absmiddle" />
        </form>
                
        <div id="header-details-user" class="aui-dd-parent header-link-container">
         <a class="lnk" rel="nofollow" href="https://java.net/people/login?original_uri=https%3A%2F%2Fjava.net%2Fjira%2Fbrowse%2FGLASSFISH-16767">Log In</a>
        <span class="drop-wrap">
        <a class="drop aui-dd-link"
                        href="#"><span>Access more options</span>
        </a>
    </span>
    <div class="aui-dropdown standard hidden">
                                                                <ul id="jira-help" class="  first     last  ">
                                            <li><a  id="view_help"   class=""  title="Goto the online documentation for JIRA" href="http://docs.atlassian.com/jira/docs-040/Home?clicked=jirahelp">Online Help</a></li>
                                            <li><a  id="user_history"   class=""  title="Get more information about JIRA" href="http://www.atlassian.com/software/jira">About JIRA</a></li>
                                    </ul>
                        </div>
</div>
        
    </div>
    <div id="header-bottom">
                <div id="menu">
            
            
<ul id="main-nav" class="menu-bar">
                        <li class="aui-dd-parent lazy  ">
                    <a class="lnk"
                href="/jira/secure/Dashboard.jspa"
                 id="home_link"                 accessKey="h"                 title="View your current Dashboard"                >Dashboards</a>

                    <span class="drop-wrap">
            <a class="drop aui-dd-link"
                                    id="home_link_drop"
                    rel="home_link"
                    accessKey="d"
                    title="Access more options (Alt+D)"
                                href="#"><span>Access more options (Alt+D)</span></a></span>
            <div class="aui-dropdown standard hidden"></div>
                </li>
                        <li class="aui-dd-parent lazy  ">
                    <a class="lnk"
                href="/jira/browse/GLASSFISH"
                 id="browse_link"                 accessKey="b"                 title="Browse currently active project 'glassfish'"                >Projects</a>

                    <span class="drop-wrap">
            <a class="drop aui-dd-link"
                                    id="browse_link_drop"
                    rel="browse_link"
                    accessKey="p"
                    title="Access more options (Alt+P)"
                                href="#"><span>Access more options (Alt+P)</span></a></span>
            <div class="aui-dropdown standard hidden"></div>
                </li>
                        <li class="aui-dd-parent lazy  selected  ">
                    <a class="lnk"
                href="/jira/secure/IssueNavigator.jspa"
                 id="find_link"                 accessKey="f"                 title="View your current filter"                >Issues</a>

                    <span class="drop-wrap">
            <a class="drop aui-dd-link"
                                    id="find_link_drop"
                    rel="find_link"
                    accessKey="i"
                    title="Access more options (Alt+I)"
                                href="#"><span>Access more options (Alt+I)</span></a></span>
            <div class="aui-dropdown standard hidden"></div>
                </li>
                        <li class="aui-dd-parent nonlazy  ">
                    <a class="lnk"
                href="/jira/secure/GreenHopper.jspa"
                 id="greenhopper_menu"                                 title="Manage your project with GreenHopper"                >Agile</a>

                                                                                                            <span class="drop-wrap">
                            <a class="drop aui-dd-link"
                                                                    id="greenhopper_menu_drop"
                                    accessKey="g"
                                    rel="greenhopper_menu"
                                    title="Access more options (Alt+G)"
                                                                href="#"><span>Access more options</span></a></span>
                            <div class="aui-dropdown standard hidden"><div>
                                                                        <ul id="greenhopper_menu_dropdown" class=" first   last  ">
                                                            <li class="dropdown-item"><a
                                     id="planningboard-mlink"                                     class="    "
                                                                                                            href="/jira/secure/VersionBoard.jspa">Planning Board</a></li>
                                                            <li class="dropdown-item"><a
                                     id="taskboard-mlink"                                     class="    "
                                                                                                            href="/jira/secure/TaskBoard.jspa">Task Board</a></li>
                                                            <li class="dropdown-item"><a
                                     id="chartboard-mlink"                                     class="    "
                                                                                                            href="/jira/secure/ChartBoard.jspa">Chart Board</a></li>
                                                            <li class="dropdown-item"><a
                                     id="releasedboard-mlink"                                     class="    "
                                                                                                            href="/jira/secure/ArchiveChartBoard.jspa">Released Board</a></li>
                                                    </ul>
                                                                        </div></div>
                                            </li>
    </ul>

            
        </div>

    </div>
</div>



<fieldset class="hidden parameters">
    <input type="hidden" id="dirtyMessage" value="You have entered new data on this page. If you navigate away from this page without first saving your data, the changes will be lost.">
</fieldset>

<!--This should always be included as it is not part of a themable plugin, instead it is core functionality-->






<table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
        <td width="200" bgcolor="#f0f0f0" valign="top" style="border-right:1px solid #bbb">
            <table cellpadding="0" cellspacing="0" border="0" width="200">
<tr><td>
        <table cellpadding="3" cellspacing="0" border="0" width="100%">
    <tr><td bgcolor="#dddddd">
        <span style="float:left"><b>Issue Details</b></span>
        <span class="small" style="float:right">
                                        (<a rel="nofollow" class="small" href="/jira/si/jira.issueviews:issue-xml/GLASSFISH-16767/GLASSFISH-16767.xml">XML</a> | <a rel="nofollow" class="small" href="/jira/si/jira.issueviews:issue-word/GLASSFISH-16767/GLASSFISH-16767.doc">Word</a> | <a rel="nofollow" class="small" href="/jira/si/jira.issueviews:issue-html/GLASSFISH-16767/GLASSFISH-16767.html">Printable</a>)
                    </span>
    </td></tr>
    </table>
                        <img src="/jira/images/bluepixel.gif" width="100%" height="1" border="0" alt=""><br>
                <table id="issuedetails" cellpadding="3" cellspacing="0" border="0">
            <tr>
                <td valign="top"><b>Key:</b></td>
                <td valign="top">
                    <b><a id="issue_key_GLASSFISH-16767" href="/jira/browse/GLASSFISH-16767">GLASSFISH-16767</a></b>
                </td>
            </tr>

            <tr>
                <td valign="top"><b>Type:</b></td>
                <td valign="top">
                                                                <img src="/jira/images/icons/bug.gif" height="16" width="16" border="0" align="absmiddle" alt="Bug" title="Bug - A problem which impairs or prevents the functions of the product.">
             Bug
                </td>
            </tr>

            <tr>
                <td valign="top"><b>Status:</b></td>
                <td valign="top">
                                                                <img src="/jira/images/icons/status_resolved.gif" height="16" width="16" border="0" align="absmiddle" alt="Resolved" title="Resolved - A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">
             Resolved
                </td>
            </tr>

                        <tr>
                <td valign="top"><b>Resolution:</b></td>
                <td valign="top">
                                             Invalid
                </td>
            </tr>
            
                        <tr>
                <td valign="top"><b>Priority:</b></td>
                <td valign="top">
                                                                <img src="/jira/images/icons/priority_major.gif" height="16" width="16" border="0" align="absmiddle" alt="Major" title="Major - Major loss of function.">
             Major
                </td>
            </tr>
            

                        <tr>
                <td valign="top"><b>Assignee:</b></td>
                <td valign="top">
                            <a id="issue_summary_assignee_amyroh" href="/jira/secure/ViewProfile.jspa?name=amyroh">Amy Roh</a>
                </td>
            </tr>
            
                        <tr>
                <td valign="top"><b>Reporter:</b></td>
                <td valign="top">
                            <a id="issue_summary_reporter_nbw" href="/jira/secure/ViewProfile.jspa?name=nbw">nbw</a>
                </td>
            </tr>
            
                        <tr>
                <td valign="top"><b>Votes:</b></td>
                <td valign="top">
                                                                        0
                                                            </td>
            </tr>
            
                        <tr>
                <td valign="top"><b>Watchers:</b></td>
                <td valign="top">
                                                                                    1
                                    </td>
            </tr>
                    </table>
        
        
                <div class="operations">
        <table cellpadding="3" cellspacing="0" border="0" width="100%">
        <tr><td bgcolor="#dddddd">
            <b>Operations</b>
        </td></tr>
        </table>
        <img src="/jira/images/bluepixel.gif" width="100%" height="1" border="0" alt=""><br>
        <table cellpadding="3" cellspacing="0" border="0" id="operationsSection">
                    <tr><td class="issueOperation lazyOperation">
                If you were <a class="lnk" rel="nofollow" href="https://java.net/people/login?original_uri=https%3A%2F%2Fjava.net%2Fjira%2Fbrowse%2FGLASSFISH-16767">logged in</a> you would be able to see more operations.
            </td></tr>
                </table>
        </div>
            </td></tr>
</table>
        </td>
        <td bgcolor="#ffffff" valign="top">
            <div style="padding:1em" id="issueContent">
                <style type="text/css">
<!--
.fieldArea .fieldLabelArea { width: 10%; }
.fieldArea .fieldValueArea { width: 90%; }
#pinCommentContainer { float: right; font-size: 10px; }
#pinCommentContainer a { margin: 0 0.2em; }
-->
</style>














<table cellpadding="1" cellspacing="0" border="0" bgcolor="#bbbbbb" width="100%" align="center">
<tr><td width="100%" colspan="2" valign="top">
<table id="issue_header" cellpadding="4" cellspacing="0" border="0" width="100%" bgcolor="#ffffff">
<tr>
    <td bgcolor="#f0f0f0" width="100%" colspan="2" valign="top">
    <table id="issue_header_summary" width="100%" cellpadding="0" cellspacing="0">
        <tr><td bgcolor="#f0f0f0" width="80%" valign="top">
            <b><a href="/jira/browse/GLASSFISH">
                glassfish</a></b><br>

            

            <h3 class="formtitle"><img src="/jira/images/icons/link_out_bot.gif" width="16" height="16"
                              border="0" alt="" /> Glassfish classloader attack causes IllegalStateException on undeployment</h3>
            <font size="1">
                Created: <span class="date">31/May/11 09:54 AM</span> &nbsp;
                Updated: <span class="date">08/Jun/11 11:39 AM</span>

                
                    
                
                
                    &nbsp; Resolved: <span class="date">08/Jun/11 11:39 AM</span>
                
            </font>
        </td>
            
            
        </tr></table>
</tr>


    
        <tr>
            <td width="20%"><b>Component/s:</b></td>
            <td width="80%">
                
                    


    
        <a href="/jira/browse/GLASSFISH/component/10640" title="classloader Classloader issues">classloader</a>
    



                
            </td>
        </tr>
    

    
        <tr>
            <td width="20%"><b>Affects Version/s:</b></td>
            <td width="80%">
                
                    


    
        3.1
    



                
            </td>
        </tr>
    

    
        <tr>
            <td width="20%"><b>Fix Version/s:</b></td>
            <td width="80%">
                
                    



    None


                
            </td>
        </tr>
    
    
        
        
            
        
    

</table>
</td></tr></table>




    
        


<br/>
<table width="100%" cellpadding="0" cellspacing="0">
    <tr>
        <td>
            <table cellpadding="4" cellspacing="1" class="tt_outer">
                <tr>
                    <td id="tt_heading" class="tt_heading" style="line-height:150%;">
                        Time Tracking:
                        
                    </td>
                    <td class="tt_infoarea">
                        
                        
                            


<table id="tt_single_table_info" class="tt_inner">
    
        <tr>
            <td>
                Not Specified
            </td>
        </tr>
    
    
</table>


                        
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>



    
    
        <br>
        <table cellpadding="0" cellspacing="0" border="0" bgcolor="#bbbbbb" WIDTH="100%" align="center"><tr><td>
        <table cellpadding="4" cellspacing="1" border="0" width="100%" bgcolor="#bbbbbb" id="issueDetailsTable">

        







        
            <tr>

                <td bgcolor="#f0f0f0" width="20%" valign="top">
                    <b>Environment:</b>
                </td>
                <td id="environment_field" bgcolor="#ffffff" valign="top">
                                  <div id="environment-open">
            <div style="float:right;">
                <a id="environment-hide" href="" onClick="toggleDivsWithCookie('environment-closed', 'environment-open'); return false;" class="smallgrey">&laquo; Hide</a>
            </div>
            <div>
                <p>Windows 7 Ultimate Edition x64, Glassfish 3.1 FCS (bld 43), JDK 1.6.0u22-b04 32 bit, log4j 1.2.16</p>
            </div>
        </div>
        <div id="environment-closed" style="display: none;">
            <div style="float:right;">
                <a id="environment-show" href="" onClick="toggleDivsWithCookie('environment-open', 'environment-closed'); return false;" class="smallgrey">Show &raquo;</a>
            </div>
            <div style="height: 1.2em; overflow: hidden;">
                                    Windows 7 Ultimate Edition x64, Glassfish 3.1 FCS (bld 43), JDK 1.6.0u22-b04 32 bit, log4j 1.2.16
                            </div>
        </div>
        <script language="JavaScript" type="text/javascript">
        <!--
            restoreDivFromCookie('environment-open', 'jira.viewissue.cong.cookie', '1');
            restoreDivFromCookie('environment-closed', 'jira.viewissue.cong.cookie', '0');
        //-->
        </script>
      
                </td>
            </tr>
        

        



        




        </table>
        </td></tr></table>
    


<br>







<table id="tab1" class="gridTabBox" cellpadding="3" cellspacing="1" align="center" width="100%">
    
    
        
             
            
                <tr id="rowForcustomfield_10002">
                    <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Tags:</b></td>
                    <td bgcolor="#ffffff" width="80%">
                            <!-- This is separated out here so I can quickly change between debuging where I want scripts and css loaded from the file system
      and runtime when I want it all laoded from the class loaded via jira methos. -->
<!-- Load Via JIRA -->

    <span class="suggestedlabels plugin_label_labels_101873_customfield_10002">  <a href='/jira/secure/IssueNavigator.jspa?reset=true&amp;customfield_10002=classloader'>classloader</a>
  <a href='/jira/secure/IssueNavigator.jspa?reset=true&amp;customfield_10002=log4j'>log4j</a>
  <a href='/jira/secure/IssueNavigator.jspa?reset=true&amp;customfield_10002=undeployment'>undeployment</a>
</span>
    
                    </td>
                </tr>
            
        
    
        
             
            
                <tr id="rowForcustomfield_10010">
                    <td bgcolor="#f0f0f0" width="20%" valign="top"><b>Participants:</b></td>
                    <td bgcolor="#ffffff" width="80%">
                                    <a class="nowrap" title="Find all issues Amy Roh participated in" href="/jira/secure/IssueNavigator.jspa?reset=true&customfield_10010=amyroh">Amy Roh</a>,             <a class="nowrap" title="Find all issues nbw participated in" href="/jira/secure/IssueNavigator.jspa?reset=true&customfield_10010=nbw">nbw</a> and             <a class="nowrap" title="Find all issues Sanjeeb Sahoo participated in" href="/jira/secure/IssueNavigator.jspa?reset=true&customfield_10010=ss141213">Sanjeeb Sahoo</a>    
                    </td>
                </tr>
            
        
    
</table>



<br>




























<br>

<div id="description-open">
<table cellpadding="2" cellspacing="0" border="0" width="100%" align="center">
<tr>
	<td bgcolor="#bbbbbb" width="1%" nowrap align="center">
			&nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
	</td>
    <td align="right"><a id="description-hide" href="" onClick="toggleDivsWithCookie('description-closed', 'description-open'); return false;" class="smallgrey">&laquo; Hide</a></td>
</tr>
</table>

<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tr>
	<td id="descriptionArea">
        <div id="description_full">
            <p>When undeploying my web application which includes log4j 1.2.16 and log4j extras 1.1 the following IllegalStateException <span class="error">&#91;1&#93;</span> is caused by a Glassfish classloader attack described here<span class="error">&#91;2&#93;</span>.</p>

<p>-Noah</p>

<p><span class="error">&#91;1&#93;</span> -<br/>
[#|2011-05-31T12:41:33.017-0400|SEVERE|glassfish3.1|javax.enterprise.system.std.com.sun.enterprise.server.logging|_ThreadID=109;_ThreadName=Thread-1;|java.lang.IllegalStateException: Class invariant violation<br/>
	at org.apache.log4j.LogManager.getLoggerRepository(LogManager.java:199)<br/>
	at org.apache.log4j.LogManager.getLogger(LogManager.java:228)<br/>
	at org.apache.log4j.Logger.getLogger(Logger.java:117)<br/>
	at com.Foo.&lt;clinit&gt;(Foo.java:33)<br/>
	at sun.misc.Unsafe.ensureClassInitialized(Native Method)<br/>
	at sun.reflect.UnsafeFieldAccessorFactory.newFieldAccessor(UnsafeFieldAccessorFactory.java:25)<br/>
	at sun.reflect.ReflectionFactory.newFieldAccessor(ReflectionFactory.java:122)<br/>
	at java.lang.reflect.Field.acquireFieldAccessor(Field.java:918)<br/>
	at java.lang.reflect.Field.getFieldAccessor(Field.java:899)<br/>
	at java.lang.reflect.Field.get(Field.java:358)<br/>
	at org.glassfish.web.loader.WebappClassLoader.clearReferences(WebappClassLoader.java:1835)<br/>
	at org.glassfish.web.loader.WebappClassLoader.stop(WebappClassLoader.java:1664)<br/>
	at org.glassfish.web.loader.WebappClassLoader.preDestroy(WebappClassLoader.java:1633)<br/>
	at org.glassfish.internal.data.ApplicationInfo.unload(ApplicationInfo.java:350)<br/>
	at com.sun.enterprise.v3.server.ApplicationLifecycle.unload(ApplicationLifecycle.java:998)<br/>
	at com.sun.enterprise.v3.server.ApplicationLifecycle.disable(ApplicationLifecycle.java:1952)<br/>
	at com.sun.enterprise.v3.server.ApplicationLoaderService.stopApplication(ApplicationLoaderService.java:443)<br/>
	at com.sun.enterprise.v3.server.ApplicationLoaderService.preDestroy(ApplicationLoaderService.java:411)<br/>
	at com.sun.hk2.component.AbstractCreatorInhabitantImpl.dispose(AbstractCreatorInhabitantImpl.java:83)<br/>
	at com.sun.hk2.component.SingletonInhabitant.release(SingletonInhabitant.java:81)<br/>
	at com.sun.hk2.component.EventPublishingInhabitant.release(EventPublishingInhabitant.java:108)<br/>
	at com.sun.hk2.component.LazyInhabitant.release(LazyInhabitant.java:133)<br/>
	at com.sun.enterprise.v3.server.AppServerStartup.stop(AppServerStartup.java:415)<br/>
	at com.sun.enterprise.glassfish.bootstrap.GlassFishImpl.stop(GlassFishImpl.java:88)<br/>
	at com.sun.enterprise.v3.admin.StopServer.doExecute(StopServer.java:70)<br/>
	at com.sun.enterprise.v3.admin.StopDomainCommand.execute(StopDomainCommand.java:95)<br/>
	at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:355)<br/>
	at com.sun.enterprise.v3.admin.CommandRunnerImpl$2.run(CommandRunnerImpl.java:383)</p>

<p><span class="error">&#91;2&#93;</span> - <span class="nobr"><a href="http://logging.apache.org/log4j/1.2/faq.html#unload">http://logging.apache.org/log4j/1.2/faq.html#unload<sup><img class="rendericon" src="/jira/images/icons/linkext7.gif" height="7" width="7" align="absmiddle" alt="" border="0"/></sup></a></span></p><br />
        </div>
    </td>
</tr>
</table>
</div>

<div id="description-closed" style="display:none;">
<table cellpadding="2" cellspacing="0" border="0" width="100%" align="center" class="table-layout: fixed;">
<tr>
	<td bgcolor="#bbbbbb" width="1%" nowrap align="center">
			&nbsp;<font color="#ffffff"><b>Description</b></font>&nbsp;
	</td>
    <td style="padding: 1px; margin: 0px; border-bottom: #bbb 1px solid;"><div style="height: 1.2em; overflow: hidden; text-overflow: ellipsis;">&nbsp; &nbsp;When undeploying my web application which includes log4j 1.2.16 and log4j extras 1.1 the following IllegalStateException <span class="error">&#91;1&#93;</span> is caused by a Glassfish classloader attack described here<span class="error">&#91;2&#93;</span>.

-Noah

<span class="error">&#91;1&#93;</span> -
[#|2011-05-31T12:41:33.017-0400|SEVERE|glassfish3.1|javax.enterprise.system.std.com.sun.enterprise.server.logging|_ThreadID=109;_ThreadName=Thread-1;|java.lang.IllegalStateException: Class invariant violation
	at org.apache.log4j.LogManager.getLoggerRepository(LogManager.java:199)
	at org.apache.log4j.LogManager.getLogger(LogManager.java:228)
	at org.apache.log4j.Logger.getLogger(Logger.java:117)
	at com.Foo.&lt;clinit&gt;(Foo.java:33)
	at sun.misc.Unsafe.ensureClassInitialized(Native Method)
	at sun.reflect.UnsafeFieldAccessorFactory.newFieldAccessor(UnsafeFieldAccessorFactory.java:25)
	at sun.reflect.ReflectionFactory.newFieldAccessor(ReflectionFactory.java:122)
	at java.lang.reflect.Field.acquireFieldAccessor(Field.java:918)
	at java.lang.reflect.Field.getFieldAccessor(Field.java:899)
	at java.lang.reflect.Field.get(Field.java:358)
	at org.glassfish.web.loader.WebappClassLoader.clearReferences(WebappClassLoader.java:1835)
	at org.glassfish.web.loader.WebappClassLoader.stop(WebappClassLoader.java:1664)
	at org.glassfish.web.loader.WebappClassLoader.preDestroy(WebappClassLoader.java:1633)
	at org.glassfish.internal.data.ApplicationInfo.unload(ApplicationInfo.java:350)
	at com.sun.enterprise.v3.server.ApplicationLifecycle.unload(ApplicationLifecycle.java:998)
	at com.sun.enterprise.v3.server.ApplicationLifecycle.disable(ApplicationLifecycle.java:1952)
	at com.sun.enterprise.v3.server.ApplicationLoaderService.stopApplication(ApplicationLoaderService.java:443)
	at com.sun.enterprise.v3.server.ApplicationLoaderService.preDestroy(ApplicationLoaderService.java:411)
	at com.sun.hk2.component.AbstractCreatorInhabitantImpl.dispose(AbstractCreatorInhabitantImpl.java:83)
	at com.sun.hk2.component.SingletonInhabitant.release(SingletonInhabitant.java:81)
	at com.sun.hk2.component.EventPublishingInhabitant.release(EventPublishingInhabitant.java:108)
	at com.sun.hk2.component.LazyInhabitant.release(LazyInhabitant.java:133)
	at com.sun.enterprise.v3.server.AppServerStartup.stop(AppServerStartup.java:415)
	at com.sun.enterprise.glassfish.bootstrap.GlassFishImpl.stop(GlassFishImpl.java:88)
	at com.sun.enterprise.v3.admin.StopServer.doExecute(StopServer.java:70)
	at com.sun.enterprise.v3.admin.StopDomainCommand.execute(StopDomainCommand.java:95)
	at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:355)
	at com.sun.enterprise.v3.admin.CommandRunnerImpl$2.run(CommandRunnerImpl.java:383)

<span class="error">&#91;2&#93;</span> - <span class="nobr"><a href="http://logging.apache.org/log4j/1.2/faq.html#unload">http://logging.apache.org/log4j/1.2/faq.html#unload<sup><img class="rendericon" src="/jira/images/icons/linkext7.gif" height="7" width="7" align="absmiddle" alt="" border="0"/></sup></a></span></div></td>
    <td width="1%" align="right" nowrap style="padding: 1px; margin: 0px; border-bottom: #bbb 1px solid;"><a id="description-show" href="" onClick="toggleDivsWithCookie('description-open', 'description-closed'); return false;" class="smallgrey">Show &raquo;</a></td>
</tr>
</table>
</div>

<script language="JavaScript" type="text/javascript">
<!--
    restoreDivFromCookie('description-open', 'jira.viewissue.cong.cookie', '1');
    restoreDivFromCookie('description-closed', 'jira.viewissue.cong.cookie', '0');
//-->
</script>














<br>




    <div class="tabwrap">
        
            <div class="sortwrap">
                Sort Order:
                
                    <a rel="nofollow" href="/jira/browse/GLASSFISH-16767?actionOrder=desc"><img src="/jira/images/icons/arrow_down_blue_small.gif" class="sortArrow" alt="Ascending order - Click to sort in descending order" title="Ascending order - Click to sort in descending order" border="0" /></a>
                
                
            </div>
        
        <ul class="tabs horizontal">
        
            
            
                <li><a href="/jira/browse/GLASSFISH-16767?page=com.atlassian.jira.plugin.system.issuetabpanels%3Aall-tabpanel"><strong>All</strong></a></li>
            
        
            
                <li class="active"><strong>Comments</strong></li>
            
            
        
            
            
                <li><a href="/jira/browse/GLASSFISH-16767?page=com.atlassian.jira.plugin.system.issuetabpanels%3Aworklog-tabpanel"><strong>Work Log</strong></a></li>
            
        
            
            
                <li><a href="/jira/browse/GLASSFISH-16767?page=com.atlassian.jira.plugin.system.issuetabpanels%3Achangehistory-tabpanel"><strong>Change History</strong></a></li>
            
        
            
            
                <li><a href="/jira/browse/GLASSFISH-16767?page=com.atlassian.streams.streams-jira-plugin%3Aactivity-stream-issue-tab"><strong>Activity Stream</strong></a></li>
            
        
        </ul>
    </div>

    
        <div class="issuePanelContainer" id="issue_actions_container">
        
            
                
                <div id="comment-310744-open">
<div class="actionContainer">
    <div class="action-links subText smallgrey">
    [
        <a href="/jira/browse/GLASSFISH-16767?focusedCommentId=310744&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_310744" title="A permanent link to this comment." class="smallgrey">Permalink</a>
                      | <a id="comment-310744-hide" href="" onClick="toggleDivsWithCookie('comment-310744-closed', 'comment-310744-open'); return false;" class="smallgrey">&laquo; Hide</a>
    ]
    </div>
    <div class="action-details">    <a name="action_310744" />
    
                                                
    
                <a id="comment_310744_header_nbw" href="/jira/secure/ViewProfile.jspa?name=nbw">nbw</a> added a comment  - <span class=subText><span class=date>31/May/11 10:07 AM</span></span>   - <span class="redText subText" title="nbw - 31/May/11 10:07 AM">edited</span> </div>
    <div class="action-body"><p>Another related stack trace, this was triggered from a Admin Console UI undeploy whereas the previous one was triggered from a asadmin cmd line stop-domain command -</p>


<p>[#|2011-05-31T13:05:28.730-0400|SEVERE|glassfish3.1|javax.enterprise.system.std.com.sun.enterprise.server.logging|_ThreadID=110;_ThreadName=Thread-1;|java.lang.IllegalStateException: Class invariant violation<br/>
	at org.apache.log4j.LogManager.getLoggerRepository(LogManager.java:199)<br/>
	at org.apache.log4j.LogManager.getLogger(LogManager.java:228)<br/>
	at org.apache.log4j.Logger.getLogger(Logger.java:117)<br/>
	at com.Foo.&lt;clinit&gt;(Foo.java:33)<br/>
	at sun.misc.Unsafe.ensureClassInitialized(Native Method)<br/>
	at sun.reflect.UnsafeFieldAccessorFactory.newFieldAccessor(UnsafeFieldAccessorFactory.java:25)<br/>
	at sun.reflect.ReflectionFactory.newFieldAccessor(ReflectionFactory.java:122)<br/>
	at java.lang.reflect.Field.acquireFieldAccessor(Field.java:918)<br/>
	at java.lang.reflect.Field.getFieldAccessor(Field.java:899)<br/>
	at java.lang.reflect.Field.get(Field.java:358)<br/>
	at org.glassfish.web.loader.WebappClassLoader.clearReferences(WebappClassLoader.java:1835)<br/>
	at org.glassfish.web.loader.WebappClassLoader.stop(WebappClassLoader.java:1664)<br/>
	at org.glassfish.web.loader.WebappClassLoader.preDestroy(WebappClassLoader.java:1633)<br/>
	at org.glassfish.internal.data.ApplicationInfo.unload(ApplicationInfo.java:350)<br/>
	at com.sun.enterprise.v3.server.ApplicationLifecycle.unload(ApplicationLifecycle.java:998)<br/>
	at com.sun.enterprise.v3.server.ApplicationLifecycle.undeploy(ApplicationLifecycle.java:1023)<br/>
	at org.glassfish.deployment.admin.UndeployCommand.execute(UndeployCommand.java:333)<br/>
	at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:355)<br/>
	at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:370)<br/>
	at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1067)<br/>
	at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:96)<br/>
	at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1247)<br/>
	at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1235)<br/>
	at org.glassfish.admingui.common.util.LocalDeploymentFacility$LocalDFCommandRunner.run(LocalDeploymentFacility.java:143)<br/>
	at org.glassfish.deployment.client.AbstractDeploymentFacility.undeploy(AbstractDeploymentFacility.java:1049)<br/>
	at org.glassfish.admingui.common.handlers.DeploymentHandler.undeploy(DeploymentHandler.java:309)<br/>
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br/>
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)<br/>
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)<br/>
	at java.lang.reflect.Method.invoke(Method.java:597)<br/>
	at com.sun.jsftemplating.layout.descriptors.handler.Handler.invoke(Handler.java:442)<br/>
	at com.sun.jsftemplating.layout.descriptors.LayoutElementBase.dispatchHandlers(LayoutElementBase.java:420)<br/>
	at com.sun.jsftemplating.layout.descriptors.LayoutElementBase.dispatchHandlers(LayoutElementBase.java:394)<br/>
	at com.sun.jsftemplating.layout.event.CommandActionListener.invokeCommandHandlers(CommandActionListener.java:150)<br/>
	at com.sun.jsftemplating.layout.event.CommandActionListener.processAction(CommandActionListener.java:98)<br/>
	at javax.faces.event.ActionEvent.processListener(ActionEvent.java:88)<br/>
	at javax.faces.component.UIComponentBase.broadcast(UIComponentBase.java:769)<br/>
	at javax.faces.component.UICommand.broadcast(UICommand.java:300)<br/>
	at com.sun.webui.jsf.component.WebuiCommand.broadcast(WebuiCommand.java:166)<br/>
	at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)<br/>
	at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)<br/>
	at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)<br/>
	at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)<br/>
	at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)<br/>
	at javax.faces.webapp.FacesServlet.service(FacesServlet.java:409)<br/>
	at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1534)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)<br/>
	at com.sun.webui.jsf.util.UploadFilter.doFilter(UploadFilter.java:233)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)<br/>
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)<br/>
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)<br/>
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)<br/>
	at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)<br/>
	at org.apache.catalina.core.StandardPipeline.doChainInvoke(StandardPipeline.java:600)<br/>
	at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:96)<br/>
	at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)<br/>
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)<br/>
	at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)<br/>
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)<br/>
	at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:323)<br/>
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:227)<br/>
	at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:228)<br/>
	at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:822)<br/>
	at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:719)<br/>
	at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1013)<br/>
	at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)<br/>
	at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)<br/>
	at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)<br/>
	at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)<br/>
	at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)<br/>
	at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)<br/>
	at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)<br/>
	at com.sun.grizzly.ContextTask.run(ContextTask.java:71)<br/>
	at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)<br/>
	at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)<br/>
	at java.lang.Thread.run(Thread.java:662)</p>
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>#]</td>
</tr>
</tbody></table> </div>
</div>
</div>


<div id="comment-310744-closed" style="display: none;">
<div class="actionContainer" style="background-color:#f0f0f0;">
    <div class="action-links subText smallgrey">
    [ <a id="comment-310744-show" href="" onClick="toggleDivsWithCookie('comment-310744-open', 'comment-310744-closed'); return false;" class="smallgrey">Show &raquo;</a> ]
    </div>
    <div class="action-details" style="overflow: hidden; height: 1em;">
                <a name="action_310744" />
    
                                                
    
                <a id="comment_310744_header_nbw" href="/jira/secure/ViewProfile.jspa?name=nbw">nbw</a> added a comment  - <span class=subText><span class=date>31/May/11 10:07 AM</span></span>   - <span class="redText subText" title="nbw - 31/May/11 10:07 AM">edited</span>              Another related stack trace, this was triggered from a Admin Console UI undeploy whereas the previous one was triggered from a asadmin cmd line stop-domain command -


[#|2011-05-31T13:05:28.730-0400|SEVERE|glassfish3.1|javax.enterprise.system.std.com.sun.enterprise.server.logging|_ThreadID=110;_ThreadName=Thread-1;|java.lang.IllegalStateException: Class invariant violation
	at org.apache.log4j.LogManager.getLoggerRepository(LogManager.java:199)
	at org.apache.log4j.LogManager.getLogger(LogManager.java:228)
	at org.apache.log4j.Logger.getLogger(Logger.java:117)
	at com.Foo.&lt;clinit&gt;(Foo.java:33)
	at sun.misc.Unsafe.ensureClassInitialized(Native Method)
	at sun.reflect.UnsafeFieldAccessorFactory.newFieldAccessor(UnsafeFieldAccessorFactory.java:25)
	at sun.reflect.ReflectionFactory.newFieldAccessor(ReflectionFactory.java:122)
	at java.lang.reflect.Field.acquireFieldAccessor(Field.java:918)
	at java.lang.reflect.Field.getFieldAccessor(Field.java:899)
	at java.lang.reflect.Field.get(Field.java:358)
	at org.glassfish.web.loader.WebappClassLoader.clearReferences(WebappClassLoader.java:1835)
	at org.glassfish.web.loader.WebappClassLoader.stop(WebappClassLoader.java:1664)
	at org.glassfish.web.loader.WebappClassLoader.preDestroy(WebappClassLoader.java:1633)
	at org.glassfish.internal.data.ApplicationInfo.unload(ApplicationInfo.java:350)
	at com.sun.enterprise.v3.server.ApplicationLifecycle.unload(ApplicationLifecycle.java:998)
	at com.sun.enterprise.v3.server.ApplicationLifecycle.undeploy(ApplicationLifecycle.java:1023)
	at org.glassfish.deployment.admin.UndeployCommand.execute(UndeployCommand.java:333)
	at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:355)
	at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:370)
	at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1067)
	at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:96)
	at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1247)
	at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1235)
	at org.glassfish.admingui.common.util.LocalDeploymentFacility$LocalDFCommandRunner.run(LocalDeploymentFacility.java:143)
	at org.glassfish.deployment.client.AbstractDeploymentFacility.undeploy(AbstractDeploymentFacility.java:1049)
	at org.glassfish.admingui.common.handlers.DeploymentHandler.undeploy(DeploymentHandler.java:309)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at com.sun.jsftemplating.layout.descriptors.handler.Handler.invoke(Handler.java:442)
	at com.sun.jsftemplating.layout.descriptors.LayoutElementBase.dispatchHandlers(LayoutElementBase.java:420)
	at com.sun.jsftemplating.layout.descriptors.LayoutElementBase.dispatchHandlers(LayoutElementBase.java:394)
	at com.sun.jsftemplating.layout.event.CommandActionListener.invokeCommandHandlers(CommandActionListener.java:150)
	at com.sun.jsftemplating.layout.event.CommandActionListener.processAction(CommandActionListener.java:98)
	at javax.faces.event.ActionEvent.processListener(ActionEvent.java:88)
	at javax.faces.component.UIComponentBase.broadcast(UIComponentBase.java:769)
	at javax.faces.component.UICommand.broadcast(UICommand.java:300)
	at com.sun.webui.jsf.component.WebuiCommand.broadcast(WebuiCommand.java:166)
	at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
	at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
	at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
	at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
	at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
	at javax.faces.webapp.FacesServlet.service(FacesServlet.java:409)
	at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1534)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
	at com.sun.webui.jsf.util.UploadFilter.doFilter(UploadFilter.java:233)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:215)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
	at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
	at org.apache.catalina.core.StandardPipeline.doChainInvoke(StandardPipeline.java:600)
	at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:96)
	at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:91)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:162)
	at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
	at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:323)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:227)
	at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:228)
	at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:822)
	at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:719)
	at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1013)
	at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:225)
	at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
	at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
	at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
	at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
	at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
	at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
	at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
	at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
	at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
	at java.lang.Thread.run(Thread.java:662)
<table class='confluenceTable'><tbody>
<tr>
<td class='confluenceTd'>#]</td>
</tr>
</tbody></table>     </div>
</div>
</div>
<br clear="all" />
<script language="JavaScript" type="text/javascript">
<!--
    restoreDivFromCookie('comment-310744-open', 'jira.viewissue.cong.cookie', '1');
    restoreDivFromCookie('comment-310744-closed', 'jira.viewissue.cong.cookie', '0');
//-->
</script>

                
            
                
                <div id="comment-311512-open">
<div class="actionContainer">
    <div class="action-links subText smallgrey">
    [
        <a href="/jira/browse/GLASSFISH-16767?focusedCommentId=311512&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_311512" title="A permanent link to this comment." class="smallgrey">Permalink</a>
                      | <a id="comment-311512-hide" href="" onClick="toggleDivsWithCookie('comment-311512-closed', 'comment-311512-open'); return false;" class="smallgrey">&laquo; Hide</a>
    ]
    </div>
    <div class="action-details">    <a name="action_311512" />
    
    
    
                <a id="comment_311512_header_ss141213" href="/jira/secure/ViewProfile.jspa?name=ss141213">Sanjeeb Sahoo</a> added a comment  - <span class=subText><span class=date>06/Jun/11 10:30 PM</span></span>  </div>
    <div class="action-body"><p>This is a WebappClassLoader issue, so assigning to web container team, but I do feel the bug could be in log4j. I suggest user to try seeting org.apache.catalina.loader.WebappClassLoader.ENABLE_CLEAR_REFERENCES system property to false. That should avoid the problem.</p> </div>
</div>
</div>


<div id="comment-311512-closed" style="display: none;">
<div class="actionContainer" style="background-color:#f0f0f0;">
    <div class="action-links subText smallgrey">
    [ <a id="comment-311512-show" href="" onClick="toggleDivsWithCookie('comment-311512-open', 'comment-311512-closed'); return false;" class="smallgrey">Show &raquo;</a> ]
    </div>
    <div class="action-details" style="overflow: hidden; height: 1em;">
                <a name="action_311512" />
    
    
    
                <a id="comment_311512_header_ss141213" href="/jira/secure/ViewProfile.jspa?name=ss141213">Sanjeeb Sahoo</a> added a comment  - <span class=subText><span class=date>06/Jun/11 10:30 PM</span></span>               This is a WebappClassLoader issue, so assigning to web container team, but I do feel the bug could be in log4j. I suggest user to try seeting org.apache.catalina.loader.WebappClassLoader.ENABLE_CLEAR_REFERENCES system property to false. That should avoid the problem.     </div>
</div>
</div>
<br clear="all" />
<script language="JavaScript" type="text/javascript">
<!--
    restoreDivFromCookie('comment-311512-open', 'jira.viewissue.cong.cookie', '1');
    restoreDivFromCookie('comment-311512-closed', 'jira.viewissue.cong.cookie', '0');
//-->
</script>

                
            
                
                <div id="comment-311685-open">
<div class="actionContainer">
    <div class="action-links subText smallgrey">
    [
        <a href="/jira/browse/GLASSFISH-16767?focusedCommentId=311685&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_311685" title="A permanent link to this comment." class="smallgrey">Permalink</a>
                      | <a id="comment-311685-hide" href="" onClick="toggleDivsWithCookie('comment-311685-closed', 'comment-311685-open'); return false;" class="smallgrey">&laquo; Hide</a>
    ]
    </div>
    <div class="action-details">    <a name="action_311685" />
    
    
    
                <a id="comment_311685_header_amyroh" href="/jira/secure/ViewProfile.jspa?name=amyroh">Amy Roh</a> added a comment  - <span class=subText><span class=date>08/Jun/11 11:39 AM</span></span>  </div>
    <div class="action-body"><p>This is an issue reported with log4j when org.apache.catalina.loader.WebappClassLoader.ENABLE_CLEAR_REFERENCES is true (default value).	</p>

<p>If true, GF/Tomcat attempts to null out any static or final fields from loaded classes when a web application is stopped as a work around for apparent garbage collection bugs and application coding errors.</p>

<p>Applications without memory leaks using recent JVMs should operate correctly with this option set to false.</p>

<p>Please set the org.apache.catalina.loader.WebappClassLoader.ENABLE_CLEAR_REFERENCES system property to false as recommended by log4j to avoid this issue.</p> </div>
</div>
</div>


<div id="comment-311685-closed" style="display: none;">
<div class="actionContainer" style="background-color:#f0f0f0;">
    <div class="action-links subText smallgrey">
    [ <a id="comment-311685-show" href="" onClick="toggleDivsWithCookie('comment-311685-open', 'comment-311685-closed'); return false;" class="smallgrey">Show &raquo;</a> ]
    </div>
    <div class="action-details" style="overflow: hidden; height: 1em;">
                <a name="action_311685" />
    
    
    
                <a id="comment_311685_header_amyroh" href="/jira/secure/ViewProfile.jspa?name=amyroh">Amy Roh</a> added a comment  - <span class=subText><span class=date>08/Jun/11 11:39 AM</span></span>               This is an issue reported with log4j when org.apache.catalina.loader.WebappClassLoader.ENABLE_CLEAR_REFERENCES is true (default value).	

If true, GF/Tomcat attempts to null out any static or final fields from loaded classes when a web application is stopped as a work around for apparent garbage collection bugs and application coding errors.

Applications without memory leaks using recent JVMs should operate correctly with this option set to false.

Please set the org.apache.catalina.loader.WebappClassLoader.ENABLE_CLEAR_REFERENCES system property to false as recommended by log4j to avoid this issue.     </div>
</div>
</div>
<br clear="all" />
<script language="JavaScript" type="text/javascript">
<!--
    restoreDivFromCookie('comment-311685-open', 'jira.viewissue.cong.cookie', '1');
    restoreDivFromCookie('comment-311685-closed', 'jira.viewissue.cong.cookie', '0');
//-->
</script>

                
            
        
        
        </div>
            </div>
        </td>
    </tr>
</table>











<div class="footer">
<div  class="poweredbymessage" >
        <a class="seo-link" href="http://www.atlassian.com/software/jira/bug-tracking.jsp">Bug tracking</a>, <a class="seo-link" href="http://www.atlassian.com/software/jira/issue-tracking.jsp">issue tracking</a> and <a class="seo-link" href="http://www.atlassian.com/software/jira/tour/project-management.jsp">project management software</a> powered by <a href="http://www.atlassian.com/software/jira" class="smalltext">Atlassian JIRA</a>
        <span id="footer-build-information"  style="color: #666666;" >(v4.0.2#472)</span>        | <a href="http://support.atlassian.com/secure/CreateIssue.jspa?issuetype=1&pid=10000">Report a problem</a>
        | <a href="http://jira.atlassian.com/secure/CreateIssue.jspa?pid=10240&issuetype=2">Request a feature</a>
        | <a href="/jira/secure/Administrators.jspa">Contact administrators</a>
    </div>
                
    

    



    
</div>



<!--
	                 REQUEST ID : 84996x3201657x1
	          REQUEST TIMESTAMP : [13/Dec/2013:23:36:36 +0000]
	               REQUEST TIME : 0.2790
	                 ASESSIONID : 95dr80
-->

</body>
</html>



