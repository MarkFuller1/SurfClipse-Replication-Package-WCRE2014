<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Re: standalone EJB client, failed</title>
  <link rel="stylesheet" type="text/css" href="/archives/style.css" />
 </head>

 <body id="archives">
  <h1>openejb-users mailing list archives</h1>

  <h5>
<a href="http://mail-archives.apache.org/mod_mbox/" title="Back to the archives depot">Site index</a> &middot; <a href="/mod_mbox/openejb-users" title="Back to the list index">List index</a></h5>  <table class="static" id="msgview">
   <thead>
    <tr>
    <th class="title">Message view</th>
    <th class="nav"><a href="/mod_mbox/openejb-users/201105.mbox/%3cBANLkTinAyZC4J95kyOVccA-tBLJfuy+_ug@mail.gmail.com%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/openejb-users/201105.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/openejb-users/201105.mbox/%3c9009CC74-F638-40C1-9BC4-1EC0C3FA3530@gmail.com%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/openejb-users/201105.mbox/%3cBANLkTi=wCrZ27fpSir3Zh4nDE4HAaNe4jg@mail.gmail.com%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/openejb-users/201105.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/openejb-users/201105.mbox/%3c9009CC74-F638-40C1-9BC4-1EC0C3FA3530@gmail.com%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </thead>

   <tfoot>
    <tr>
    <th class="title"><a href="#archives">Top</a></th>
    <th class="nav"><a href="/mod_mbox/openejb-users/201105.mbox/%3cBANLkTinAyZC4J95kyOVccA-tBLJfuy+_ug@mail.gmail.com%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/openejb-users/201105.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/openejb-users/201105.mbox/%3c9009CC74-F638-40C1-9BC4-1EC0C3FA3530@gmail.com%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/openejb-users/201105.mbox/%3cBANLkTi=wCrZ27fpSir3Zh4nDE4HAaNe4jg@mail.gmail.com%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/openejb-users/201105.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/openejb-users/201105.mbox/%3c9009CC74-F638-40C1-9BC4-1EC0C3FA3530@gmail.com%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </tfoot>

   <tbody>
   <tr class="from">
    <td class="left">From</td>
    <td class="right">edward &lt;java...@gmail.com&gt;</td>
   </tr>
   <tr class="subject">
    <td class="left">Subject</td>
    <td class="right">Re: standalone EJB client, failed</td>
   </tr>
   <tr class="date">
    <td class="left">Date</td>
    <td class="right">Thu, 12 May 2011 02:51:30 GMT</td>
   </tr>
   <tr class="contents"><td colspan="2"><pre>
Hi, what do you mean "openejb-client-3.1.4 " ? and how ?

Thanks.
Edward

On 5/11/2011 1:03 AM, Romain Manni-Bucau wrote:
&gt; hi,
&gt;
&gt; can you have a try doing a client with openejb-client-3.1.4?
&gt;
&gt; - Romain
&gt;
&gt; 2011/5/11 edward&lt;java148@gmail.com&gt;
&gt;
&gt;&gt; Hi, Romain,
&gt;&gt; I am not using Tomcat, just openEJB 3.1.4,  ejb jar is copied into app
&gt;&gt; folder. I tried : properties.put(Context.PROVIDER_URL,
&gt;&gt; "ejbd://localhost:4201"), still doesn't work.
&gt;&gt;
&gt;&gt; //////////////
&gt;&gt; C:\openejb-3.1.4\bin&gt;openejb start
&gt;&gt; Apache OpenEJB 3.1.4    build: 20101112-03:32
&gt;&gt; http://openejb.apache.org/
&gt;&gt; log4j:WARN No appenders could be found for logger
&gt;&gt; (org.apache.openejb.resource.activemq.ActiveMQResourceAdapter).
&gt;&gt; log4j:WARN Please initialize the log4j system properly.
&gt;&gt; [init] OpenEJB Remote Server
&gt;&gt;   ** Starting Services **
&gt;&gt;   NAME                 IP              PORT
&gt;&gt;   httpejbd             127.0.0.1       4204
&gt;&gt;   admin thread         127.0.0.1       4200
&gt;&gt;   ejbd                 127.0.0.1       4201
&gt;&gt;   ejbd                 127.0.0.1       4203
&gt;&gt;   hsql                 127.0.0.1       9001
&gt;&gt;   telnet               127.0.0.1       4202
&gt;&gt; -------
&gt;&gt; Ready!
&gt;&gt; ///////////////////
&gt;&gt;
&gt;&gt; error message is
&gt;&gt; ///////////
&gt;&gt; Exception in thread "main" javax.naming.NamingException: Cannot lookup
&gt;&gt; '/CalculatorImplRemote'. [Root exception is java.rmi.RemoteException: Cannot
&gt;&gt; deternmine server protocol version: Received null/0.0; nested exception is:
&gt;&gt;     java.io.IOException: Unable to read protocol version.  Reached the end
&gt;&gt; of the stream.]
&gt;&gt;
&gt;&gt;     at org.apache.openejb.client.JNDIContext.lookup(JNDIContext.java:240)
&gt;&gt;     at javax.naming.InitialContext.lookup(Unknown Source)
&gt;&gt;     at com.Test.main(Test.java:20)
&gt;&gt; Caused by: java.rmi.RemoteException: Cannot deternmine server protocol
&gt;&gt; version: Received null/0.0; nested exception is:
&gt;&gt;     java.io.IOException: Unable to read protocol version.  Reached the end
&gt;&gt; of the stream.
&gt;&gt;     at org.apache.openejb.client.Client.processRequest(Client.java:151)
&gt;&gt;
&gt;&gt;     at org.apache.openejb.client.Client.request(Client.java:42)
&gt;&gt;     at org.apache.openejb.client.JNDIContext.request(JNDIContext.java:87)
&gt;&gt;     at org.apache.openejb.client.JNDIContext.lookup(JNDIContext.java:234)
&gt;&gt;     ... 2 more
&gt;&gt; Caused by: java.io.IOException: Unable to read protocol version.  Reached
&gt;&gt; the end of the stream.
&gt;&gt;     at
&gt;&gt; org.apache.openejb.client.ProtocolMetaData.readExternal(ProtocolMetaData.java:89)
&gt;&gt;     at org.apache.openejb.client.Client.processRequest(Client.java:148)
&gt;&gt;     ... 5 more
&gt;&gt;
&gt;&gt; ///////////////////
&gt;&gt;
&gt;&gt; Thanks.
&gt;&gt; Edward
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On 5/10/2011 1:20 AM, Romain Manni-Bucau wrote:
&gt;&gt;
&gt;&gt;&gt; Hi Edward,
&gt;&gt;&gt;
&gt;&gt;&gt; i guess yo are trying to lookup an object in tomcat (because of the http
&gt;&gt;&gt; url), if tomcat is on the 4204 port the url should be
&gt;&gt;&gt; http://localhost:4204/&lt;openejb
&gt;&gt;&gt; context name&gt;/ejb, it is often http://localhost/openejb/ejb.
&gt;&gt;&gt;
&gt;&gt;&gt; If you are not using tomcat can you please explain us how you run your
&gt;&gt;&gt; server.
&gt;&gt;&gt;
&gt;&gt;&gt; - Romain
&gt;&gt;&gt;
&gt;&gt;&gt; 2011/5/10 edward&lt;java148@gmail.com&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;   Hi, ALL,
&gt;&gt;&gt;&gt; I am trying to write a standalone EJB client, but failed.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; I have a standalone OpenEJB in C drive, I place simple-stateless-1.0.jar
&gt;&gt;&gt;&gt; into its app folder. This jar is from OpenEjb example. It works, from log
&gt;&gt;&gt;&gt; I
&gt;&gt;&gt;&gt; can see,
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ///////////////
&gt;&gt;&gt;&gt; 2011-05-09 21:07:30,825 - INFO  - Jndi(name=CalculatorImplLocal) --&gt;
&gt;&gt;&gt;&gt; Ejb(deployment-id=CalculatorImpl)
&gt;&gt;&gt;&gt; 2011-05-09 21:07:30,827 - INFO  - Jndi(name=CalculatorImplRemote) --&gt;
&gt;&gt;&gt;&gt; Ejb(deployment-id=CalculatorImpl)
&gt;&gt;&gt;&gt; 2011-05-09 21:07:30,856 - INFO  - Created
&gt;&gt;&gt;&gt; Ejb(deployment-id=CalculatorImpl,
&gt;&gt;&gt;&gt; ejb-name=CalculatorImpl, container=My Stateless Container)
&gt;&gt;&gt;&gt; 2011-05-09 21:07:30,856 - INFO  - Deployed
&gt;&gt;&gt;&gt; Application(path=C:\openejb-3.1.4\apps\simple-stateless-1.0.jar)
&gt;&gt;&gt;&gt; ///////////////
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Now the clinent is
&gt;&gt;&gt;&gt; //////////////////////
&gt;&gt;&gt;&gt; Properties properties = new Properties();
&gt;&gt;&gt;&gt;         properties.setProperty(Context.INITIAL_CONTEXT_FACTORY,
&gt;&gt;&gt;&gt; "org.apache.openejb.client.RemoteInitialContextFactory");
&gt;&gt;&gt;&gt;         //properties.put("java.naming.provider.url",
&gt;&gt;&gt;&gt; "ejbd://localhost:4201");
&gt;&gt;&gt;&gt;         properties.put("java.naming.provider.url", "
&gt;&gt;&gt;&gt; http://localhost:4204/ejb");
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;         InitialContext initialContext = new InitialContext(properties);
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;         Object object = initialContext.lookup("CalculatorImplRemote");
&gt;&gt;&gt;&gt; /////////////////////////////
&gt;&gt;&gt;&gt; It always give me error:
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; /////////////////
&gt;&gt;&gt;&gt; Exception in thread "main" javax.naming.NamingException: Cannot lookup
&gt;&gt;&gt;&gt; '/CalculatorImplRemote'. [Root exception is java.rmi.RemoteException:
&gt;&gt;&gt;&gt; Cannot
&gt;&gt;&gt;&gt; open object input stream to server (OEJP/3.1) : null; nested exception
&gt;&gt;&gt;&gt; is:
&gt;&gt;&gt;&gt;     java.io.EOFException]
&gt;&gt;&gt;&gt;     at org.apache.openejb.client.JNDIContext.lookup(JNDIContext.java:240)
&gt;&gt;&gt;&gt;     at javax.naming.InitialContext.lookup(Unknown Source)
&gt;&gt;&gt;&gt;     at com.Test.main(Test.java:20)
&gt;&gt;&gt;&gt; Caused by: java.rmi.RemoteException: Cannot open object input stream to
&gt;&gt;&gt;&gt; server (OEJP/3.1) : null; nested exception is:
&gt;&gt;&gt;&gt;     java.io.EOFException
&gt;&gt;&gt;&gt;     at org.apache.openejb.client.Client.processRequest(Client.java:159)
&gt;&gt;&gt;&gt;     at org.apache.openejb.client.Client.request(Client.java:42)
&gt;&gt;&gt;&gt;     at org.apache.openejb.client.JNDIContext.request(JNDIContext.java:87)
&gt;&gt;&gt;&gt;     at org.apache.openejb.client.JNDIContext.lookup(JNDIContext.java:234)
&gt;&gt;&gt;&gt;     ... 2 more
&gt;&gt;&gt;&gt; Caused by: java.io.EOFException
&gt;&gt;&gt;&gt;     at java.io.ObjectInputStream$PeekInputStream.readFully(Unknown Source)
&gt;&gt;&gt;&gt;     at java.io.ObjectInputStream$BlockDataInputStream.readShort(Unknown
&gt;&gt;&gt;&gt; Source)
&gt;&gt;&gt;&gt;     at java.io.ObjectInputStream.readStreamHeader(Unknown Source)
&gt;&gt;&gt;&gt;     at java.io.ObjectInputStream.&lt;init&gt;(Unknown Source)
&gt;&gt;&gt;&gt;     at
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; org.apache.openejb.client.EjbObjectInputStream.&lt;init&gt;(EjbObjectInputStream.java:31)
&gt;&gt;&gt;&gt;     at org.apache.openejb.client.Client.processRequest(Client.java:156)
&gt;&gt;&gt;&gt;     ... 5 more
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; ////////
&gt;&gt;&gt;&gt; I am using  openejb-itests-standalone-client-3.0.jar as its reference
&gt;&gt;&gt;&gt; api.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Please help me on this.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt; Thanks
&gt;&gt;&gt;&gt; Edward
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;


</pre></td></tr>
   <tr class="mime">
    <td class="left">Mime</td>
    <td class="right">
<ul>
<li><a rel="nofollow" href="/mod_mbox/openejb-users/201105.mbox/raw/%3c4DCB4B32.2000709@gmail.com%3e/">Unnamed text/plain</a> (inline, 7-Bit, 6249 bytes)</li>
</ul>
</td>
</tr>
   <tr class="raw">
    <td class="left"></td>
    <td class="right"><a href="/mod_mbox/openejb-users/201105.mbox/raw/%3c4DCB4B32.2000709@gmail.com%3e" rel="nofollow">View raw message</a></td>
   </tr>
   </tbody>
  </table>
 </body>
</html>
