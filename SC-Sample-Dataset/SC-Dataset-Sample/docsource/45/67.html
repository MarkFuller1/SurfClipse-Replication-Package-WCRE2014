



<!DOCTYPE html>
<html>
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
 <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" >
 
 <meta name="ROBOTS" content="NOARCHIVE">
 
 <link rel="icon" type="image/vnd.microsoft.icon" href="http://www.gstatic.com/codesite/ph/images/phosting.ico">
 
 
 <script type="text/javascript">
 
 
 
 
 var codesite_token = null;
 
 
 var CS_env = {"assetVersionPath": "http://www.gstatic.com/codesite/ph/3076573747170053082", "projectName": "gitblit", "projectHomeUrl": "/p/gitblit", "relativeBaseUrl": "", "loggedInUserEmail": null, "profileUrl": null, "token": null, "domainName": null, "assetHostPath": "http://www.gstatic.com/codesite/ph"};
 var _gaq = _gaq || [];
 _gaq.push(
 ['siteTracker._setAccount', 'UA-18071-1'],
 ['siteTracker._trackPageview']);
 
 _gaq.push(
 ['projectTracker._setAccount', 'UA-24377072-2'],
 ['projectTracker._trackPageview']);
 
 (function() {
 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
 (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
 
 </script>
 
 
 <title>Issue 170 - 
 gitblit -
 
 Federation request using https/ssl protocol - 
 a pure Java Git solution - Google Project Hosting
 </title>
 <link type="text/css" rel="stylesheet" href="http://www.gstatic.com/codesite/ph/3076573747170053082/css/core.css">
 
 <link type="text/css" rel="stylesheet" href="http://www.gstatic.com/codesite/ph/3076573747170053082/css/ph_detail.css" >
 
 
 
 
<!--[if IE]>
 <link type="text/css" rel="stylesheet" href="http://www.gstatic.com/codesite/ph/3076573747170053082/css/d_ie.css" >
<![endif]-->
 <style type="text/css">
 .menuIcon.off { background: no-repeat url(http://www.gstatic.com/codesite/ph/images/dropdown_sprite.gif) 0 -42px }
 .menuIcon.on { background: no-repeat url(http://www.gstatic.com/codesite/ph/images/dropdown_sprite.gif) 0 -28px }
 .menuIcon.down { background: no-repeat url(http://www.gstatic.com/codesite/ph/images/dropdown_sprite.gif) 0 0; }
 
 
 .attachments { width:33%; border-top:2px solid #999; padding-top: 3px; margin-left: .7em;}
 .attachments table { margin-bottom: 0.75em; }
 .attachments table tr td { padding: 0; margin: 0; font-size: 95%; }
 .preview { border: 2px solid #c3d9ff; padding: 1px; }
 .preview:hover { border: 2px solid blue; }
 .label { white-space: nowrap; }
 .derived { font-style:italic }
 .cursor_on .author {
 background: url(http://www.gstatic.com/codesite/ph/images/show-arrow.gif) no-repeat 2px;
 }
 .hiddenform {
 display: none;
 }

 
 </style>
</head>
<body class="t3">
<script type="text/javascript">
 window.___gcfg = {lang: 'en'};
 (function() 
 {var po = document.createElement("script");
 po.type = "text/javascript"; po.async = true;po.src = "https://apis.google.com/js/plusone.js";
 var s = document.getElementsByTagName("script")[0];
 s.parentNode.insertBefore(po, s);
 })();
</script>
<div class="headbg">

 <div id="gaia">
 

 <span>
 
 
 <a href="#" id="projects-dropdown" onclick="return false;"><u>My favorites</u> <small>&#9660;</small></a>
 | <a href="https://www.google.com/accounts/ServiceLogin?service=code&amp;ltmpl=phosting&amp;continue=http%3A%2F%2Fcode.google.com%2Fp%2Fgitblit%2Fissues%2Fdetail%3Fid%3D170&amp;followup=http%3A%2F%2Fcode.google.com%2Fp%2Fgitblit%2Fissues%2Fdetail%3Fid%3D170" onclick="_CS_click('/gb/ph/signin');"><u>Sign in</u></a>
 
 </span>

 </div>

 <div class="gbh" style="left: 0pt;"></div>
 <div class="gbh" style="right: 0pt;"></div>
 
 
 <div style="height: 1px"></div>
<!--[if lte IE 7]>
<div style="text-align:center;">
Your version of Internet Explorer is not supported. Try a browser that
contributes to open source, such as <a href="http://www.firefox.com">Firefox</a>,
<a href="http://www.google.com/chrome">Google Chrome</a>, or
<a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>.
</div>
<![endif]-->



 <table style="padding:0px; margin: 0px 0px 10px 0px; width:100%" cellpadding="0" cellspacing="0"
 itemscope itemtype="http://schema.org/CreativeWork">
 <tr style="height: 58px;">
 
 
 
 <td id="plogo">
 <link itemprop="url" href="/p/gitblit">
 <a href="/p/gitblit/">
 
 
 <img src="/p/gitblit/logo?cct=1374790391"
 alt="Logo" itemprop="image">
 
 </a>
 </td>
 
 <td style="padding-left: 0.5em">
 
 <div id="pname">
 <a href="/p/gitblit/"><span itemprop="name">gitblit</span></a>
 </div>
 
 <div id="psum">
 <a id="project_summary_link"
 href="/p/gitblit/"><span itemprop="description">a pure Java Git solution</span></a>
 
 </div>
 
 
 </td>
 <td style="white-space:nowrap;text-align:right; vertical-align:bottom;">
 
 <form action="/hosting/search">
 <input size="30" name="q" value="" type="text">
 
 <input type="submit" name="projectsearch" value="Search projects" >
 </form>
 
 </tr>
 </table>

</div>

 
<div id="mt" class="gtb"> 
 <a href="/p/gitblit/" class="tab ">Project&nbsp;Home</a>
 
 
 
 
 <a href="/p/gitblit/downloads/list" class="tab ">Downloads</a>
 
 
 
 
 
 
 
 <a href="/p/gitblit/issues/list"
 class="tab active">Issues</a>
 
 
 
 
 
 <a href="/p/gitblit/source/checkout"
 class="tab ">Source</a>
 
 
 
 
 
 
 
 
 <div class=gtbc></div>
</div>
<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0" class="st">
 <tr>
 
 
 
 
 
 <td class="subt">
 <div class="issueDetail">
<div class="isf">
 
 
 <span class="inIssueEntry">
 <a class="buttonify" href="entry" onclick="return _newIssuePrompt();">New issue</a>
 </span> &nbsp;
 
 <span class="inIssueList">
 <span>Search</span>
 <form action="list" method="GET" style="display:inline">
 <select id="can" name="can">
 
<option disabled="disabled">Search within:</option>
<option value="1" >&nbsp;All issues</option>
<option value="2" selected=selected>&nbsp;Open issues</option>

<option value="6" >&nbsp;New issues</option>
<option value="7" >&nbsp;Issues to verify</option>

 </select>
 <span>for</span>
 <span id="qq"><input type="text" size="38" id="searchq" name="q"
 value="" autocomplete="off"
 
 onkeydown="_blurOnEsc(event)"></span>
 
 
 <span id="search_colspec"><input type="hidden" name="colspec" value="ID Type Status Priority Milestone Owner Summary" ></span>
 
 
 
 <input type="hidden" name="cells" value="tiles" >
 <input type="submit" value="Search">
 </form>
 </span> &nbsp;
 <span class="inIssueAdvSearch">
 <a href="advsearch">Advanced search</a>
 </span> &nbsp;
 <span class="inIssueSearchTips">
 <a href="searchtips">Search tips</a>
 </span> &nbsp;
 <span class="inIssueSubscriptions">
 <a href="/p/gitblit/issues/subscriptions">Subscriptions</a>
 </span>
</div>
</div>
 </td>
 
 
 
 
 <td align="right" valign="top" class="bevel-right"></td>
 </tr>
</table>


<script type="text/javascript">
 var cancelBubble = false;
 function _go(url) { document.location = url; }
</script>
<div id="maincol"
 
>

 






 

 

 

 

 

 

 

 

 

 

 

 

 


 

<div id="color_control" class="closed_colors">
<div id="issueheader">
<table cellpadding="0" cellspacing="0" width="100%"><tbody>
 <tr>
 <td class="vt h3" nowrap="nowrap" style="padding:0 5px">
 
 
 Issue <a href="detail?id=170">170</a>:
 </td>
 <td width="90%" class="vt">
 <span class="h3" >Federation request using https/ssl protocol</span>
 </td>
 <td>
 
 </td>
 </tr>
 <tr>
 <td></td>
 <td nowrap="nowrap">
 
 
 2 people starred this issue and may be notified of changes.
 
 
 
 </td>
 <td align="center" nowrap="nowrap">
 
 <a href="http://code.google.com/p/gitblit/issues/list?cursor=gitblit%3A170">Back to list</a>
 
 </td>
 </tr>
 
</tbody></table>
</div>
<table width="100%" cellpadding="0" cellspacing="0" border="0" class="issuepage" id="meta-container">
<tbody class="collapse"> 
 <tr>
 <td id="issuemeta">
 <div id="meta-float">
 
<table cellspacing="0" cellpadding="0">
 <tr><th align="left">Status:&nbsp;</th>
 <td width="100%">
 
 <span title="Developer made source code changes, QA should verify">Fixed</span>
 
 </td>
 </tr>
 
 
 
 
 <tr><th align="left">Owner:&nbsp;</th><td>
 
 
 ----
 
 
 </td>
 </tr>
 
 
 <tr><th align="left" valign="top">Closed:&nbsp;</th>
 <td align="left" valign="top" width="100%">
 Dec 2012
 </td>
 </tr>
 
 
 <tr><td colspan="2">
 
 
 
 <div style="padding-top:2px">
 
 <a href="list?q=label:Type-Defect"
 title="Report of a software defect"
 class="label"><b>Type-</b>Defect</a>
 
 </div>
 
 
 
 
 <div style="padding-top:2px">
 
 <a href="list?q=label:Priority-Medium"
 title="Normal priority"
 class="label"><b>Priority-</b>Medium</a>
 
 </div>
 
 
 
 
 <div style="padding-top:2px">
 
 <a href="list?q=label:Milestone-1.2.0"
 title=""
 class="label"><b>Milestone-</b>1.2.0</a>
 
 </div>
 
 
 </td></tr>
 
</table>
<div class="rel_issues">
 
 
 
</div>


 <br><br>
 
 
 <div style="white-space:nowrap"><a href="https://www.google.com/accounts/ServiceLogin?service=code&amp;ltmpl=phosting&amp;continue=http%3A%2F%2Fcode.google.com%2Fp%2Fgitblit%2Fissues%2Fdetail%3Fid%3D170&amp;followup=http%3A%2F%2Fcode.google.com%2Fp%2Fgitblit%2Fissues%2Fdetail%3Fid%3D170">Sign in</a> to add a comment</div>
 
 


 
 </div>&nbsp;
 </td>
 <td class="vt issuedescription" width="100%" id="cursorarea" >
 
<div class="cursor_off vt issuedescription" id="hc0">
 
 
 <div class="author">
 
 Reported by
 

 <a class="userlink"
 href="/u/105818736010926032455/">marbod.h...@googlemail.com</a
>,
 <span class="date" title="Thu Nov 22 06:26:12 2012">Nov 22, 2012</span>
 
 </div>
<pre>
<b>What steps will reproduce the problem?</b>
1. I use two blit-server on two different machines. blit-server A for pushing repositories and blit-server B for a backup of server A using the federation mechanism. Using the http protocol without ssl everthing works fine, but changing from http to https protocol, it doesn't work anymore


What is the expected output? 
The backupserver B does recieve the repositories.

What do you see instead?
INFO  Federation PULL_REPOSITORIES request from 192.168.248.130
INFO  4 repository models loaded for $gitblit in 0 msecs
WARN  192.168.248.130:1195 javax.net.ssl.SSLException: Received fatal alert: certificate_unknown

The backupserver B does not recieve the repositories.


<b>What version of the product are you using? On what operating system?</b>
gitblit 1.1.0, windows xp

<b>Please provide any additional information below.</b>

</pre>

</div>

 


 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc1">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Thu Nov 22 06:28:47 2012">
 Nov 22, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 
 <a name="c1" href="/p/gitblit/issues/detail?id=170#c1">#1</a>
 

 <a class="userlink"
 href="/u/105818736010926032455/">marbod.h...@googlemail.com</a
></span>
 
<pre>
The webbrowser gui in both directions for each machine works fine, using the https protocol;
</pre>
 
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc2">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Thu Nov 22 06:49:37 2012">
 Nov 22, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 <span class="role_label">Project Member</span>
 <a name="c2" href="/p/gitblit/issues/detail?id=170#c2">#2</a>
 

 <a class="userlink"
 href="/u/116428776452027956920/">James.Mo...@gmail.com</a
></span>
 
<pre>
Because backup server B is a git client, the same rules apply for SSL verification.  Backup server B requires:

git config [--global] http.sslVerify false

see <a href="http://gitblit.com/setup.html" rel="nofollow">http://gitblit.com/setup.html</a> (bottom of page)
</pre>
 
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc3">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Thu Nov 22 07:41:56 2012">
 Nov 22, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 
 <a name="c3" href="/p/gitblit/issues/detail?id=170#c3">#3</a>
 

 <a class="userlink"
 href="/u/105818736010926032455/">marbod.h...@googlemail.com</a
></span>
 
<pre>
mh, but on server B, I didn't have installed git. I just use the blit-server B. so, where do I have to enter &quot;git config [--global] http.sslVerify false&quot;? 

I either don't use Eclipse/EGit/JGit, as it is described in <a href="http://gitblit.com/setup.html" rel="nofollow">http://gitblit.com/setup.html</a> (bottom of page). so which window do I have to open in order to set:

    Window-&gt;Preferences-&gt;Team-&gt;Git-&gt;Configuration
    Click the New Entry button

    Key = http.sslVerify
    Value = false

thanks a lot and kind regards,
mh
</pre>
 
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc4">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Thu Nov 22 08:17:51 2012">
 Nov 22, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 <span class="role_label">Project Member</span>
 <a name="c4" href="/p/gitblit/issues/detail?id=170#c4">#4</a>
 

 <a class="userlink"
 href="/u/116428776452027956920/">James.Mo...@gmail.com</a
></span>
 
<pre>
The simplest thing to do is to install git and use the --global variant of the command.
Otherwise, you will have to manually create the global config file.

Unfortunately, JGit does not have an API which allows me to automatically force the equivalent of http.sslVerify=false.
</pre>
 
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc5">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Fri Nov 23 01:02:59 2012">
 Nov 23, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 
 <a name="c5" href="/p/gitblit/issues/detail?id=170#c5">#5</a>
 

 <a class="userlink"
 href="/u/105818736010926032455/">marbod.h...@googlemail.com</a
></span>
 
<pre>
now, I installed git 1.8.0 on both servers A, B and entered the command
&quot;git config --global --bool --add http.sslVerify false&quot; in the git-bash. The .gitconfig file now contains the corresponig lines.

But I still get the following message on server A (the origin gitblit-server):

INFO  Federation PULL_REPOSITORIES request from 192.168.248.130
INFO  4 repository models loaded for $gitblit in 15 msecs
WARN  192.168.248.130:1047 javax.net.ssl.SSLException: Received fatal alert: certificate_unknown

And on the pulling server B, I get a lot of messages:

INFO  Pulling federated repository repo.git from 1921682481298443 @ https
://192.168.248.129:8443
ERROR Failed to pull from federated gitblit (1921682481298443 @ https://192.168
248.129:8443)
org.eclipse.jgit.api.errors.TransportException: https://192.168.248.129:8443/git
/repo.git: cannot open git-upload-pack
        at org.eclipse.jgit.api.FetchCommand.call(FetchCommand.java:137)
        at com.gitblit.utils.JGitUtils.fetchRepository(JGitUtils.java:251)
        at com.gitblit.utils.JGitUtils.cloneRepository(JGitUtils.java:202)
        at com.gitblit.FederationPullExecutor.pull(FederationPullExecutor.java:2
20)
        at com.gitblit.FederationPullExecutor.run(FederationPullExecutor.java:10
6)
        at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
        at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.
access$201(Unknown Source)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.
run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
Caused by: org.eclipse.jgit.errors.TransportException: https://192.168.248.129:8
443/git/repo.git: cannot open git-upload-pack
        at org.eclipse.jgit.transport.TransportHttp.connect(TransportHttp.java:4
67)
        at org.eclipse.jgit.transport.TransportHttp.openFetch(TransportHttp.java
:276)
        at org.eclipse.jgit.transport.FetchProcess.executeImp(FetchProcess.java:
127)
        at org.eclipse.jgit.transport.FetchProcess.execute(FetchProcess.java:113
)
        at org.eclipse.jgit.transport.Transport.fetch(Transport.java:1069)
        at org.eclipse.jgit.api.FetchCommand.call(FetchCommand.java:128)
        ... 12 more
Caused by: javax.net.ssl.SSLHandshakeException: java.security.cert.CertificateEx
ception: No subject alternative names present
        at sun.security.ssl.Alerts.getSSLException(Unknown Source)
        at sun.security.ssl.SSLSocketImpl.fatal(Unknown Source)
        at sun.security.ssl.Handshaker.fatalSE(Unknown Source)
        at sun.security.ssl.Handshaker.fatalSE(Unknown Source)
        at sun.security.ssl.ClientHandshaker.serverCertificate(Unknown Source)
        at sun.security.ssl.ClientHandshaker.processMessage(Unknown Source)
        at sun.security.ssl.Handshaker.processLoop(Unknown Source)
        at sun.security.ssl.Handshaker.process_record(Unknown Source)
        at sun.security.ssl.SSLSocketImpl.readRecord(Unknown Source)
        at sun.security.ssl.SSLSocketImpl.performInitialHandshake(Unknown Source
)
        at sun.security.ssl.SSLSocketImpl.startHandshake(Unknown Source)
        at sun.security.ssl.SSLSocketImpl.startHandshake(Unknown Source)
        at sun.net.www.protocol.https.HttpsClient.afterConnect(Unknown Source)
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect
(Unknown Source)
        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown So
urce)
        at java.net.HttpURLConnection.getResponseCode(Unknown Source)
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(Unk
nown Source)
        at org.eclipse.jgit.util.HttpSupport.response(HttpSupport.java:167)
        at org.eclipse.jgit.transport.TransportHttp.connect(TransportHttp.java:4
30)
        ... 17 more
Caused by: java.security.cert.CertificateException: No subject alternative names
 present
        at sun.security.util.HostnameChecker.matchIP(Unknown Source)
        at sun.security.util.HostnameChecker.match(Unknown Source)
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(Unknown Source)
        at sun.security.ssl.AbstractTrustManagerWrapper.checkAdditionalTrust(Unk
nown Source)
        at sun.security.ssl.AbstractTrustManagerWrapper.checkServerTrusted(Unkno
wn Source)
        ... 32 more
INFO  Next pull of 1921682481298443 @ https://192.168.248.129:8443 scheduled for
 2012-11-23 09:47

kind regards, mh
</pre>
 
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc6">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Fri Nov 23 05:57:24 2012">
 Nov 23, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 <span class="role_label">Project Member</span>
 <a name="c6" href="/p/gitblit/issues/detail?id=170#c6">#6</a>
 

 <a class="userlink"
 href="/u/116428776452027956920/">James.Mo...@gmail.com</a
></span>
 
<pre>
When you browse to https://192.168.248.129:8443 do you get an SSL error from your browser?  Have you generated an SSL certificate for 192.168.248.129?  It almost seems like you don't have a certificate for your hostname.
</pre>
 
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc7">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Fri Nov 23 08:30:18 2012">
 Nov 23, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 
 <a name="c7" href="/p/gitblit/issues/detail?id=170#c7">#7</a>
 

 <a class="userlink"
 href="/u/105818736010926032455/">marbod.h...@googlemail.com</a
></span>
 
<pre>
When I browse to https://192.168.248.129:8443 I get no SSL error from my browser. Everything works fine on both servers using the browser. I see the gui just as I would use the non SSL protocol (http) on port 8080. Even pulls and pushes using Git-Extensions, Git 1.8.0 and https on port 8443 from a third pc works fine.

kind regards, mh
</pre>
 
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc8">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Tue Nov 27 14:33:31 2012">
 Nov 27, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 <span class="role_label">Project Member</span>
 <a name="c8" href="/p/gitblit/issues/detail?id=170#c8">#8</a>
 

 <a class="userlink"
 href="/u/116428776452027956920/">James.Mo...@gmail.com</a
></span>
 
<pre>
The error here looks like hostname verification failure.

On startup, Gitblit GO generates an SSL certificate for common name (CN) &quot;localhost&quot;.  This certificate is used for all incoming https connections, unless a matching one is found in the keystore.  Firefox, Chrome, IE, etc will all grumble about the self-signed cert with an invalid cn, but you can make them ignore those errors.

Git also has a setting to ignore those errors, http.sslVerify=false.  For native git, that setting is enough to make git work.  Unfortunately, JGit does not match native git here.  It still verifies the hostname, which is a bug.  Because of this you must generate an SSL cert for each hostname you want to serve to JGit clients (like Gitblit federation, Eclipse, etc).

192.168.248.129 != localhost

It is unclear if you have tried generating a new SSL certificate for &quot;192.168.248.129&quot;, but you need to.  Review the makekeystore.cmd file, modify it, and execute it.  I think it should work after you do that.


</pre>
 
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc9">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Wed Nov 28 00:21:13 2012">
 Nov 28, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 
 <a name="c9" href="/p/gitblit/issues/detail?id=170#c9">#9</a>
 

 <a class="userlink"
 href="/u/105818736010926032455/">marbod.h...@googlemail.com</a
></span>
 
<pre>
As far as I know, I've generated an own certifacte using makekeystore.cmd, makekeystore_....cmd, and &quot;192.168.248.129&quot; for the one and &quot;192.168.248.130&quot; for the other pc. Unfortunately, I can't check it this week, because I'm working in another office, but next week I will check this and I will give you a feedback.
kind regards, mh
</pre>
 
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc10">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Mon Dec  3 03:29:44 2012">
 Dec 3, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 
 <a name="c10" href="/p/gitblit/issues/detail?id=170#c10">#10</a>
 

 <a class="userlink"
 href="/u/105818736010926032455/">marbod.h...@googlemail.com</a
></span>
 
<pre>
I'm not sure if I've configured my two pc's correct. Can you give me a feedback, if the following configuration is correct, please?

* Server 192.168.248.129:
- in the &quot;makekeystore.cmd&quot;: @SET HOSTNAME=192.168.248.129
- in the &quot;makekeystore_jdk.cmd&quot;: @SET HOSTNAME=192.168.248.129

* Server 192.168.248.130:
- in the &quot;makekeystore.cmd&quot;: @SET HOSTNAME=192.168.248.130
- in the &quot;makekeystore_jdk.cmd&quot;: @SET HOSTNAME=192.168.248.130

the password I've used by generating the certificate on each machine is the same;
I used the same password for the following parameters in the &quot;gitblit.properties&quot;  for each machine, too: federation.passphrase and server.storePassword

I wrote in the &quot;federation.properties&quot; of 192.168.248.130:

federation.1921682481298443.url = https://192.168.248.129:8443
federation.1921682481298443.token = a6e652d897dfdfbb717bead119ad7f215c0a47bd
federation.1921682481298443.mergeAccounts = true
federation.1921682481298443.frequency = 5 mins
federation.1921682481298443.folder = 1921682481298443
federation.1921682481298443.bare = true
federation.1921682481298443.mirror = true
federation.1921682481298443.sendStatus = true
federation.1921682481298443.notifyOnError = false
federation.1921682481298443.exclude = 
federation.1921682481298443.include =

I try to access the server 192.168.248.129 from 192.168.248.130.
I call &quot;java -jar fedclient.jar&quot; in a commandline of 192.168.248.130.

On the server 192.168.248.129, I get the message:
INFO  Federation ALL token = 323a0daf12508a347b37c8de8d52dbf165030883
INFO  Federation USERS_AND_REPOSITORIES token = 3e7002799a51fa78f2cd7f3f9fba9f43
0a1076c1
INFO  Federation REPOSITORIES token = 8b6aa6797e0231c8fe84fc8760e733bc1d847cdb
INFO  jetty-7.4.3.v20110701
INFO  Extract jar:file:/C:/Blit/gitblit.jar!/ to C:\Blit\temp\webapp
INFO  Shutdown Monitor listening on port 8081
INFO  NO JSP Support for /, did not find org.apache.jasper.servlet.JspServlet
INFO  started o.e.j.w.WebAppContext{/,file:/C:/Blit/temp/webapp/},file:/C:/Blit/
gitblit.jar
INFO  [GitBlitWebApp] init: Wicket core library initializer
INFO  [GitBlitWebApp] init: Wicket extensions initializer
INFO  [GitBlitWebApp] Started Wicket version 1.4.20 in deployment mode
INFO  Started SelectChannelConnector@192.168.248.129:8080 STARTING
INFO  Started SslSelectChannelConnector@192.168.248.129:8443 STARTING
INFO  Federation PULL_REPOSITORIES request from 192.168.248.130
INFO  4 repository models loaded for $gitblit in 16 msecs
WARN  192.168.248.130:1080 javax.net.ssl.SSLException: Received fatal alert: cer
tificate_unknown

and on 192.168.248.130, I get the message:

C:\Blit&gt;java -jar fedclient.jar
Gitblit Federation Client v1.1.0 (2012-08-25)
INFO  Reading configuration from C:\Blit\federation.properties
INFO  Git repositories folder C:\Repository
INFO  Identifying available repositories...
INFO  5 repositories identified with calculated folder sizes in 172 msecs
INFO  JVM timezone is Europe/Berlin (MEZ +0100)
INFO  Gitblit timezone is Europe/Berlin (MEZ +0100)
INFO  Setting up user service GitblitUserService
INFO  GUS delegating to ConfigUserService(C:\Blit\users.conf)
WARN  Mail server is not properly configured.  Mail services disabled.
INFO  Lucene executor is scheduled to process indexed branches every 2 minutes.
INFO  Pulling federated repository rep_hopfner.git from 1921682481298443 @ https
://192.168.248.129:8443
ERROR Failed to pull from federated gitblit (1921682481298443 @ https://192.168
248.129:8443)
org.eclipse.jgit.api.errors.TransportException: https://192.168.248.129:8443/git
/rep_hopfner.git: cannot open git-upload-pack
        at org.eclipse.jgit.api.FetchCommand.call(FetchCommand.java:137)
        at com.gitblit.utils.JGitUtils.fetchRepository(JGitUtils.java:251)
        at com.gitblit.utils.JGitUtils.cloneRepository(JGitUtils.java:202)
        at com.gitblit.FederationPullExecutor.pull(FederationPullExecutor.java:2
20)
        at com.gitblit.FederationPullExecutor.run(FederationPullExecutor.java:10
6)
        at com.gitblit.FederationClient.main(FederationClient.java:81)
        at com.gitblit.FederationClientLauncher.main(FederationClientLauncher.ja
va:52)
Caused by: org.eclipse.jgit.errors.TransportException: https://192.168.248.129:8
443/git/rep_hopfner.git: cannot open git-upload-pack
        at org.eclipse.jgit.transport.TransportHttp.connect(TransportHttp.java:4
67)
        at org.eclipse.jgit.transport.TransportHttp.openFetch(TransportHttp.java
:276)
        at org.eclipse.jgit.transport.FetchProcess.executeImp(FetchProcess.java:
127)
        at org.eclipse.jgit.transport.FetchProcess.execute(FetchProcess.java:113
)
        at org.eclipse.jgit.transport.Transport.fetch(Transport.java:1069)
        at org.eclipse.jgit.api.FetchCommand.call(FetchCommand.java:128)
        ... 6 more
Caused by: javax.net.ssl.SSLHandshakeException: java.security.cert.CertificateEx
ception: No subject alternative names present
        at sun.security.ssl.Alerts.getSSLException(Unknown Source)
        at sun.security.ssl.SSLSocketImpl.fatal(Unknown Source)
        at sun.security.ssl.Handshaker.fatalSE(Unknown Source)
        at sun.security.ssl.Handshaker.fatalSE(Unknown Source)
        at sun.security.ssl.ClientHandshaker.serverCertificate(Unknown Source)
        at sun.security.ssl.ClientHandshaker.processMessage(Unknown Source)
        at sun.security.ssl.Handshaker.processLoop(Unknown Source)
        at sun.security.ssl.Handshaker.process_record(Unknown Source)
        at sun.security.ssl.SSLSocketImpl.readRecord(Unknown Source)
        at sun.security.ssl.SSLSocketImpl.performInitialHandshake(Unknown Source
)
        at sun.security.ssl.SSLSocketImpl.startHandshake(Unknown Source)
        at sun.security.ssl.SSLSocketImpl.startHandshake(Unknown Source)
        at sun.net.www.protocol.https.HttpsClient.afterConnect(Unknown Source)
        at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect
(Unknown Source)
        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown So
urce)
        at java.net.HttpURLConnection.getResponseCode(Unknown Source)
        at sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(Unk
nown Source)
        at org.eclipse.jgit.util.HttpSupport.response(HttpSupport.java:167)
        at org.eclipse.jgit.transport.TransportHttp.connect(TransportHttp.java:4
30)
        ... 11 more
Caused by: java.security.cert.CertificateException: No subject alternative names
 present
        at sun.security.util.HostnameChecker.matchIP(Unknown Source)
        at sun.security.util.HostnameChecker.match(Unknown Source)
        at sun.security.ssl.X509TrustManagerImpl.checkIdentity(Unknown Source)
        at sun.security.ssl.AbstractTrustManagerWrapper.checkAdditionalTrust(Unk
nown Source)
        at sun.security.ssl.AbstractTrustManagerWrapper.checkServerTrusted(Unkno
wn Source)
        ... 26 more
Finished.

can you give me a hint how to sove my problems ;-)
kind regards, mh
</pre>
 
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc11">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Mon Dec  3 08:35:03 2012">
 Dec 3, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 <span class="role_label">Project Member</span>
 <a name="c11" href="/p/gitblit/issues/detail?id=170#c11">#11</a>
 

 <a class="userlink"
 href="/u/116428776452027956920/">James.Mo...@gmail.com</a
></span>
 
<pre>
Ok.  In the default Java trustmanager there appears to be a special case for CN=IPAddress that I was unaware of:

<a href="http://www.grepcode.com/search/usages?type=method&amp;id=repository.grepcode.com%24java%24root@jdk%24openjdk@6-b14@sun%24security%24util@HostnameChecker@isIpAddress%28java.lang.String%29&amp;k=u" rel="nofollow">http://www.grepcode.com/search/usages?type=method&amp;id=repository.grepcode.com%24java%24root@jdk%24openjdk@6-b14@sun%24security%24util@HostnameChecker@isIpAddress%28java.lang.String%29&amp;k=u</a>

<a href="http://www.grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/sun/security/util/HostnameChecker.java#HostnameChecker.matchIP%28java.lang.String%2Cjava.security.cert.X509Certificate%29" rel="nofollow">http://www.grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/sun/security/util/HostnameChecker.java#HostnameChecker.matchIP%28java.lang.String%2Cjava.security.cert.X509Certificate%29</a>

If CN=IPAddress, the IPAddress must also be set in the certificate as a subjectAlternativeName.  makekeystore.cmd will not do this.  makekeystore_jdk.cmd will work _if_ you are using Java 7 and add a new parameter: -ext san=ip:%HOSTNAME%

I will revise Gitblit's certificate generation to set a proper subjectAlternativeName if the cert's CN=IPAddress.

All of this would be unnecessary if JGit properly disregarded hostname verification with http.sslVerify=false like native git does.  :(

<a href="http://stackoverflow.com/questions/8443081/how-are-ssl-certificate-server-names-resolved-can-i-add-alternative-names-using" rel="nofollow">http://stackoverflow.com/questions/8443081/how-are-ssl-certificate-server-names-resolved-can-i-add-alternative-names-using</a>

<a href="http://stackoverflow.com/questions/8744607/how-to-add-subject-alernative-name-to-ssl-certs" rel="nofollow">http://stackoverflow.com/questions/8744607/how-to-add-subject-alernative-name-to-ssl-certs</a>


</pre>
 
 
 <div class="updates">
 <div class="round4"></div>
 <div class="round2"></div>
 <div class="round1"></div>
 <div class="box-inner">
 
 <b>Status:</b>
 Accepted
 
 <br>
 
 <b>Labels:</b>
 Milestone-1.2.0
 
 <br>
 
 </div>
 <div class="round1"></div>
 <div class="round2"></div>
 <div class="round4"></div>
 </div>
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc12">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Mon Dec  3 14:23:03 2012">
 Dec 3, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 <span class="role_label">Project Member</span>
 <a name="c12" href="/p/gitblit/issues/detail?id=170#c12">#12</a>
 

 <a class="userlink"
 href="/u/116428776452027956920/">James.Mo...@gmail.com</a
></span>
 
<pre>
In the next release generated SSL certs will set the subjectAlternativeName like the JDK requires.  In the meantime you will have to manually generate a certificate keypair yourself using keytool or openssl.
</pre>
 
 
 <div class="updates">
 <div class="round4"></div>
 <div class="round2"></div>
 <div class="round1"></div>
 <div class="box-inner">
 
 <b>Status:</b>
 Queued
 
 <br>
 
 </div>
 <div class="round1"></div>
 <div class="round2"></div>
 <div class="round4"></div>
 </div>
 
 </div>
 

 
 
 
 
 <div class="cursor_off vt issuecomment"
 id="hc13">
 <div style="float:right; margin-right:.3em; text-align:right">
 <span class="date" title="Mon Dec 31 17:06:26 2012">
 Dec 31, 2012
 </span>
 
 
 
 </div>
 
 
 
 
 
 
 
 
 
 
 <span class="author">
 <span class="role_label">Project Member</span>
 <a name="c13" href="/p/gitblit/issues/detail?id=170#c13">#13</a>
 

 <a class="userlink"
 href="/u/116428776452027956920/">James.Mo...@gmail.com</a
></span>
 
<pre>
v1.2.0 has been deployed.
</pre>
 
 
 <div class="updates">
 <div class="round4"></div>
 <div class="round2"></div>
 <div class="round1"></div>
 <div class="box-inner">
 
 <b>Status:</b>
 Fixed
 
 <br>
 
 </div>
 <div class="round1"></div>
 <div class="round2"></div>
 <div class="round4"></div>
 </div>
 
 </div>
 


 


 </td>
 </tr>

 
 <tr>
 <td></td>
 <td class="vt issuecomment">
 <span class="indicator">&#9658;</span> <a href="https://www.google.com/accounts/ServiceLogin?service=code&ltmpl=phosting&continue=http%3A%2F%2Fcode.google.com%2Fp%2Fgitblit%2Fissues%2Fdetail%3Fid%3D170&amp;followup=http%3A%2F%2Fcode.google.com%2Fp%2Fgitblit%2Fissues%2Fdetail%3Fid%3D170"
 >Sign in</a> to add a comment
 </td>
 </tr>
 

</tbody>
</table>
<br>
<script type="text/javascript" src="http://www.gstatic.com/codesite/ph/3076573747170053082/js/dit_scripts.js"></script>



 

</div> 
<form name="delcom" action="delComment.do?q=&amp;can=2&amp;groupby=&amp;sort=&amp;colspec=ID+Type+Status+Priority+Milestone+Owner+Summary" method="POST">
 <input type="hidden" name="sequence_num" value="">
 <input type="hidden" name="mode" value="">
 <input type="hidden" name="id" value="170">
 <input type="hidden" name="token" value="">
</form>

<div id="helparea"></div>
<script type="text/javascript">
 _onload();
 function delComment(sequence_num, delete_mode) {
 var f = document.forms["delcom"];
 f.sequence_num.value = sequence_num;
 f.mode.value = delete_mode;
 
 f.submit();
 return false;
 }
 
 _floatMetadata();
</script>
<script type="text/javascript" src="http://www.gstatic.com/codesite/ph/3076573747170053082/js/kibbles.js"></script>
<script type="text/javascript">
 _setupKibblesOnDetailPage(
 'http://code.google.com/p/gitblit/issues/list?cursor\x3dgitblit%3A170',
 '/p/gitblit/issues/entry',
 '',
 '',
 '', 'gitblit', 170,
 false, false, codesite_token);
</script>
 
 
 
 <script type="text/javascript" src="http://www.gstatic.com/codesite/ph/3076573747170053082/js/ph_core.js"></script>
 
 
 
 
</div> 

<div id="footer" dir="ltr">
 <div class="text">
 <a href="/projecthosting/terms.html">Terms</a> -
 <a href="http://www.google.com/privacy.html">Privacy</a> -
 <a href="/p/support/">Project Hosting Help</a>
 </div>
</div>
 <div class="hostedBy" style="margin-top: -20px;">
 <span style="vertical-align: top;">Powered by <a href="http://code.google.com/projecthosting/">Google Project Hosting</a></span>
 </div>

 
 


 
 </body>
</html>

