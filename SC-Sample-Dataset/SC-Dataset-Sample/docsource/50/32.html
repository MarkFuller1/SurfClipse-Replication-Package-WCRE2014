
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Undefined In Context Error? Microsoft Excel Help - KnowExcel.com</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="description" content="Undefined In Context Error? - I ve attached a chopped copy of what I m working with Essentially I need to change a rate based on a date and a string I wrote a macro to handle it but it doesn t do what Microsoft Excel Help" />
<meta name="keywords" content="undefined,context,error,ve,attached,chopped,copy,working,essentially,need,change,rate,based,date,string,wrote,macro,handle,doesn,microsoft,excel,office,help,resource,questions,answers" />
<meta name="author" content="MindUse" />
<meta name="robots" content="index, follow" />
<link rel="stylesheet" type="text/css" href="/css/style.css" />
<link rel="stylesheet" type="text/css" href="/css/vs.css" />
<link rel="shortcut icon" href="/favicon.ico?v=2" />
<meta name="google-translate-customization" content="c4f96c1c3878f597-063435e9dfd5bf1f-g5ad535f416723041-11"></meta>
</head>
<body>
<div id="container">
<div id="header">
  <div id="logo" title="KnowExcel.com" onclick='javaScript:location.href="/index.php"'></div>
  <div id="top_728x90">
    	<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-0054120095371839"
     data-ad-slot="5482064163"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>  </div>
</div>
<div id="middlecontainer">
  <div id="middlecontleft"> 
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style" align="center"> <a class="addthis_button_preferred_1"></a> <a class="addthis_button_preferred_2"></a> <a class="addthis_button_preferred_3"></a> <a class="addthis_button_preferred_4"></a> <a class="addthis_button_compact"></a> <a class="addthis_counter addthis_bubble_style"></a> 
      <!-- AddThis Button END -->
      <div class="g-plusone" data-size="small" data-annotation="none"></div>
    </div>
    <br />
    <div id="google_translate_element"></div>
	<script type="text/javascript">
		function googleTranslateElementInit() {
  			new google.translate.TranslateElement({pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
		}
    </script><script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
	<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:600px"
     data-ad-client="ca-pub-0054120095371839"
     data-ad-slot="6958797362"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<br />
<!-- ValueClick Media 120x600 and 160x600 SkyScraper CODE for KnowExcel.com -->
<script type="text/javascript">var vclk_options = {sid:82170,media_id:3,media_type:7,version:"1.4"};</script><script class="vclk_pub_code" type="text/javascript" src="http://cdn.fastclick.net/js/adcodes/pubcode.min.js?sid=82170&media_id=3&media_type=7&version=1.4&exc=1"></script><noscript><a href="http://media.fastclick.net/w/click.here?sid=82170&m=3&c=1" target="_blank"><img src="http://media.fastclick.net/w/get.media?sid=82170&m=3&tp=7&d=s&c=1&vcm_acv=1.4" width="160" height="600" border="1"></a></noscript>
<!-- ValueClick Media 120x600 and 160x600 SkyScraper CODE for KnowExcel.com -->  </div>
  <div id="middlecontright"> <br />
    <div id="searchContainer"> 
      <form action="/search.php" method="get">
        <input type="text" id="field" name="q" value="undefined in context error" />
        <input type="submit" id="submit" value="Search" />
      </form>
      <!--<form action="http://www.knowexcel.com/search-results.php" id="cse-search-box">
        <div>
          <input type="hidden" name="cx" value="partner-pub-0054120095371839:8622916569" />
          <input type="hidden" name="cof" value="FORID:10" />
          <input type="hidden" name="ie" value="UTF-8" />
          <input type="text" name="q" size="55" id="field" />
          <input type="submit" name="sa" id="submit" value="Search" />
        </div>
      </form>-->
    </div>
    <div align="center">Not finding your answer? <a href="/ask/" class="ask" title="Please ask a question if you are not finding your answer in the search results"><strong>Ask a Question</strong></a></div>
    <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <h1>
          Undefined in Context error?        </h1>
        <br />
                I've attached a chopped copy of what I'm working with.  Essentially, I need to change a rate based on a date and a string.  I wrote a macro to handle it, but it doesn't do what I want it to right now.  Right now I want to make sure my LibAdj and mistring functions do something.  I've tried stepping through the code, but it always says those functions aren't defined in the context.  Ever.<br /><br />I guess I'm not really sure what that error means, but my code steps through both of the functions, following looping rules, but doesn't update values.<br /><br />Any suggestions?        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=134335" title="Undefined in Context error?" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
        <input type="hidden" name="IL_IN_TAG" value="1"/>
      </div>
    </div>
        <a name="top"></a>
    <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <h3>Sponsored Links:</h3>
        <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-0054120095371839"
     data-ad-slot="2572722967"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>      </div>
    </div>
    <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <h2>Related Results:</h2>
        <br />
                1. <a href="#1460777" class="results" />Expression not defined in context</a><br />
                2. <a href="#298200" class="results" />File in use error</a><br />
                3. <a href="#208474" class="results" />Null To Zero - ODBC Error - Undefined function 'Nz' in Expression</a><br />
                4. <a href="#822195" class="results" />undefined function error when creating xls pivot from mdb qry</a><br />
                5. <a href="#141359" class="results" />Don't make double items in context menu</a><br />
                6. <a href="#42906" class="results" />undefined function error when creating xls pivot from mdb qry</a><br />
                7. <a href="#1464183" class="results" />Formula results in #value error when looking long text strings</a><br />
                8. <a href="#1462188" class="results" />Set range variables without run-time error!</a><br />
                9. <a href="#1450650" class="results" />REF error in cell deletion</a><br />
                10. <a href="#1441487" class="results" />Error in Excel when Filtering Data</a><br />
                11. <a href="#1435563" class="results" />Open All Workbooks In Folder Error</a><br />
                12. <a href="#1424826" class="results" />Setting variable from listbox results in overflow error</a><br />
                13. <a href="#1415574" class="results" />VBA : Need help with Excel Add-in VBA error &quot;Module not</a><br />
                14. <a href="#1411507" class="results" />Assigning calculated dynamic range formula as string results in error 1004</a><br />
                15. <a href="#1404333" class="results" />Pull In Data From A Closed Workbook Without Having To Open It: Run-time Error '1004'</a><br />
                16. <a href="#1404087" class="results" />Delete Row When Formula Results In Error</a><br />
                17. <a href="#1391729" class="results" />Activating workbook elsewere in use results in runtime error 9</a><br />
                18. <a href="#1390826" class="results" />excel 97 in winxppro - &quot;not enough memory&quot; error m</a><br />
                19. <a href="#1102889" class="results" />Error occur while finding the last row in a range</a><br />
              </div>
    </div>
    <div align="center"><!-- ValueClick Media 468x60 and 728x90 Banner CODE for KnowExcel.com -->
<script type="text/javascript">var vclk_options = {sid:82170,media_id:1,media_type:5,version:"1.4"};</script><script class="vclk_pub_code" type="text/javascript" src="http://cdn.fastclick.net/js/adcodes/pubcode.min.js?sid=82170&media_id=1&media_type=5&version=1.4&exc=1"></script><noscript><a href="http://media.fastclick.net/w/click.here?sid=82170&m=1&c=1" target="_blank"><img src="http://media.fastclick.net/w/get.media?sid=82170&m=1&tp=5&d=s&c=1&vcm_acv=1.4" width="728" height="90" border="1"></a></noscript>
<!-- ValueClick Media 468x60 and 728x90 Banner CODE for KnowExcel.com --></div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1460777"></a> <a href="/view/1460777-expression-not-defined-in-context.html" class="results" title="Expression not defined in context">Expression not defined in context</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">Hi there,<br /><br />I'm very new to VBA and coding in general so brace yourself for some ugly code. <br /><br />I'm trying
to insert a formula into a range of cells that changes from data set to data set. I use strings to define each end of the
range (which is usually just in one column) and add the formula to the range. This worked beautifully for another data set
but I can't get it to work for this one. It works the first time (when the column M is empty) but the second time it stuffs
up. When I place a watch on the problem point I get "Range not defined in context" and the macro stops working. The line that
doesn't work is the on immediately above the "End If".<br /><br />Any help would be much appreciated!<br /><br /><pre
class="brush: vbnet">

	VB:
	Dim LastBrtMCell As String 
Dim LastBrtMCellAppend As String 
 
Range("B1").End(xlDown).Offset(0, 11).Activate 
LastBrtMCell = ActiveCell.Row 
If Range("M1").Value = "" Then 
    Range("M1:M" & LastBrtMCell).Formula = "=RC[-5]-0.0103*RC[-1]" 
Else 
    Range("M1").End(xlDown).Select 'finding last used row
    ActiveCell.Offset(1, 0).Activate 
    LastBrtMCellAppend = ActiveCell.Row 
    Range("LastBrtMCellAppend:M" & LastBrtMCell).Formula = "=RC[-5]-0.0103*RC[-1]" 
End If 

If you like these VB formatting tags please consider sponsoring the author in support of injured Royal Marines

</pre></div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1460777" title="Expression not defined in context" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="298200"></a> <a href="/view/298200-file-in-use-error.html" class="results" title="File in use error">File in use error</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">hi<br /><br />i'm trying to export through the response xlsm file which contains a macro.<br /><br />in the 'save/open'
dialog box if I choose to open the file then when I click on the macro<br /><br />I get the 'file in use' error. this is only
when opening the file using explorer.<br /><br />for xls file it's ok.<br /><br />here is a snippet:<br />

	

	<pre class="brush: vbnet">Response.Clear();
Response.Buffer = true;
string fileName = @&quot;C:test.xlsm&quot;;
Response.AddHeader(&quot;content-disposition&quot;, &quot;attachment;filename=&quot; + fileName);
Response.ContentType = &quot;application/vnd.ms-excel&quot;;
Response.TransmitFile(fileName);
Response.End();</pre>
any idea why i'm getting this ?<br /><br />thanks</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=298200" title="File in use error" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="208474"></a> <a href="/view/208474-null-to-zero-odbc-error-undefined-function-nz-in-expression.html" class="results" title="Null To Zero - ODBC Error - Undefined function 'Nz' in Expression">Null To Zero - ODBC Error - Undefined function 'Nz' in Expression</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">I'm trying to Import Data into Excel from an Access Query that uses the Nz<br />
function.  I'm getting an error before the data even appears in Excel.  Error<br />
is &quot;[Microsoft][ODBC Microsoft Access Driver] Undefined function 'Nz' in<br />
expression.&quot;<br /><br />I've read the email string submittted by DEI on 10/17/05 but think this is a<br />
different problem.  Any ideas how I can overcome the error?<br /><br />Thanks,<br />
Nancy</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=208474" title="Null To Zero - ODBC Error - Undefined function 'Nz' in Expression" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="822195"></a> <a href="/view/822195-undefined-function-error-when-creating-xls-pivot-from-mdb-qry.html" class="results" title="undefined function error when creating xls pivot from mdb qry">undefined function error when creating xls pivot from mdb qry</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">Happens for both user-defined and built-in functions.<br /><br />This "ExtractElement" function works in Access when used in
a query, and<br />
works in Excel when used as a formula." When attempting to create a<br />
pivottable that points to the Access query using this formula, I get a<br />
"Undefined function 'ExtractElement' in expression" error message. I was<br />
attempting to work around this by using the InStrRev function in the query<br />
the pivottable will point to, but get the same error message for that<br />
built-in function as well: "Undefined function 'InStrRev' in expression." Is<br />
there a setting that has to be enabled for Excel to recognize user-defined or<br />
built-in functions being used in a query excel is to make a pivottable out<br />
of? Thank you.<br /><br />Public Function ExtractElement(str, n, sepChar)<br />
'   Returns the nth element from a string,<br />
'   using a specified separator character<br />
Dim x As Variant<br />
x = Split(str, sepChar)<br />
If n > 0 And n - 1</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=822195" title="undefined function error when creating xls pivot from mdb qry" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="141359"></a> <a href="/view/141359-dont-make-double-items-in-context-menu.html" class="results" title="Don't make double items in context menu">Don't make double items in context menu</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">Hello,<br /><br />Under the right-click menu I added an item on a specific range in Excel. The location in Excel knows what
to add into the menu (a for creating a heading or a new line item). When I right-click somewhere else the custom menu is
removed. So far so good.<br /><br />When a right-click follows a right-click multiple times the menu item is added again and
again. The routine should check weather the items exists and if now, create.<br /><br />This is what I made (with some help
of 'Google')<br /><br />Right-click code:<br />

	

	<pre class="brush: vbnet">Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)
    If Not Application.Intersect(Target, Me.Range(&quot;A13:A31”)) Is Nothing Then
'        MsgBox (&quot;This is the right-click range in this sheet.&quot;)
        If Target.Cells.Value = &quot;&quot; Then Exit Sub 'gives an error when the full row is selected instead of one cell
        If Target.Cells.Value Like &quot;?0&quot; Then
'            MsgBox &quot;Heading&quot;
            Run &quot;CustomContextMenuKopjeAdd&quot;
            Run &quot;CustomContextMenuPostRemove&quot; 'when a heading, remove menu item
        Else
'            MsgBox &quot;Item&quot;
            Run &quot;CustomContextMenuKopjeRemove&quot; 'when a item, remove menu heading
            Run &quot;CustomContextMenuPostAdd&quot;
        End If
    Else
        ' No cell of Target in in the range A14:A31. Get Out.
        Run &quot;CustomContextMenuKopjeRemove&quot;
        Run &quot;CustomContextMenuPostRemove&quot;
        Exit Sub
    End If
End Sub</pre>
Create and remove code:<br />

	

	<pre class="brush: vbnet">Private Sub CustomContextMenuPostAdd()
Dim ctrl As CommandBarControl
Dim btn As CommandBarControl
Dim i As Integer

'MsgBox &quot;Context menu: make item&quot;
    
    'add a 'popup' control to the cell commandbar (menu)
    Set ctrl = Application.CommandBars(&quot;Cell&quot;).Controls.Add _
                (Type:=msoControlPopup, Before:=1)
    ctrl.Caption = &quot;SSK p&amp;ost...&quot;
    'first sub item
        Set btn = ctrl.Controls.Add
        btn.Caption = &quot;&amp;Add&quot; 	   	'give them a name
        btn.OnAction = &quot;RowNew&quot;                   'the routine called by the control
    'second sub item
        Set btn = ctrl.Controls.Add
        btn.Caption = &quot;&amp;Remove&quot; 	     'give them a name
        btn.OnAction = &quot;RowRemove&quot;                   'the routine called by the control
End Sub


Private Sub CustomContextMenuPostRemove()
Dim ctrl As CommandBarControl
    
'MsgBox &quot;Context menu: remove item&quot;
     
    'go thru all the cell commandbar controls and delete our menu item
    For Each ctrl In Application.CommandBars(&quot;Cell&quot;).Controls
        If ctrl.Caption = &quot;SSK p&amp;ost...&quot; Then ctrl.Delete
    Next

End Sub</pre>
Does anybody know what I did wrong or how I can improve this?<br /><br />Thank you in advance!<br />
Erik</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=141359" title="Don't make double items in context menu" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="42906"></a> <a href="/view/42906-undefined-function-error-when-creating-xls-pivot-from-mdb-qry.html" class="results" title="undefined function error when creating xls pivot from mdb qry">undefined function error when creating xls pivot from mdb qry</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">Happens for both user-defined and built-in functions.<br /><br />This &quot;ExtractElement&quot; function works in Access
when used in a query, and<br />
works in Excel when used as a formula.&quot; When attempting to create a<br />
pivottable that points to the Access query using this formula, I get a<br />
&quot;Undefined function 'ExtractElement' in expression&quot; error message. I was<br />
attempting to work around this by using the InStrRev function in the query<br />
the pivottable will point to, but get the same error message for that<br />
built-in function as well: &quot;Undefined function 'InStrRev' in expression.&quot; Is<br />
there a setting that has to be enabled for Excel to recognize user-defined or<br />
built-in functions being used in a query excel is to make a pivottable out<br />
of? Thank you.<br /><br />Public Function ExtractElement(str, n, sepChar)<br />
'   Returns the nth element from a string,<br />
'   using a specified separator character<br />
Dim x As Variant<br />
x = Split(str, sepChar)<br />
If n &gt; 0 And n - 1 &lt;= UBound(x) Then<br />
ExtractElement = x(n - 1)<br />
Else<br />
ExtractElement = &quot;&quot;<br />
End If<br />
End Function</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=42906" title="undefined function error when creating xls pivot from mdb qry" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1464183"></a> <a href="/view/1464183-formula-results-in-value-error-when-looking-long-text-strings.html" class="results" title="Formula results in #value error when looking long text strings">Formula results in #value error when looking long text strings</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">Hallo,<br /><br />I am using vlookup function for a few hundred items, which are pure text strings. For few items the formula
doesnt work and throws "#value"error. I found out that the error occurs only when the length of text string exceeds 255 and
for a given text string if i reduce the length to 254, formula works. <br /><br />Is there such a character limit for vlookup
function? is there any ways to get the formula working for such long strings?? or is there any other ways to lookup for these
long text??<br /><br />plzz hhelp me.....<br /><br />thanks in advance....</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1464183" title="Formula results in #value error when looking long text strings" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1462188"></a> <a href="/view/1462188-set-range-variables-without-run-time-error-.html" class="results" title="Set range variables without run-time error!">Set range variables without run-time error!</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">Hallo all!<br /><br />I'm getting an error 'Runtime Error (91): Object variable or With block variable not set' when running
the below code.  I'm obviously doing something wrong when I try to set the values for the 'range' variables at the top.<br
/><br />When I remove the 'As Range' for the 4 range variables, it makes it all the way to the rCell.Offset(0, 1).Formula
line, where I then get an error 'Runtime Error (424): Object Required'.<br /><br />I can't work out where I've ****** up.<br
/><br />To set it in context, the procedure is supposed to look at column B, where there is a list of entries starting at B9,
determine the last non-blank cell address, and therefore the entire range of the list in column B, and for each non-blank
cell in column B, add the lookup formula in column C.<br /><br />Can anyone help?<br /><br />Much appreciated once again,<br
/><br />Mr. I R Dunce <br /><br /><pre class="brush: vbnet">

	VB:
	Sub AddFormula() 
     'Adds lookup formula to show number of times each card was found in file
     
    Dim rColumn As Range 
    Dim rCell As Range 
    Dim rLastCell As Range 
    Dim rFirstLastCellRange As Range 
     
    rLastCell = ThisWorkbook.Sheets("Summary").Range("B65000").End(xlUp).Address(RowAbsolute:=False, ColumnAbsolute:=False) 
     
     'MsgBox rLastCell when 'As Range' deleted, returns B12
     
    rFirstLastCellRange = "B9:" & rLastCell 
     
     'MsgBox rFirstLastCellRange when 'As Range' deleted, returns B9:B12
     
    rColumn = ThisWorkbook.Sheets("Summary").Range(rFirstLastCellRange) 
     
    For Each rCell In rColumn 
         
        rCell.Offset(0, 1).Formula = "=vlookup(rCell,NoPayCardFile_050712!$A$2:E200,5)" 
         
    Next rCell 
     
End Sub 

If you like these VB formatting tags please consider sponsoring the author in support of injured Royal Marines

</pre></div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1462188" title="Set range variables without run-time error!" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1450650"></a> <a href="/view/1450650-ref-error-in-cell-deletion.html" class="results" title="REF error in cell deletion">REF error in cell deletion</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">I understand that REF errors will occur if a cell is referencing another cell that gets deleted. However, let's say that I'm
looking at 2 cells: A1 and A2. I make A2 refer to A1, so A2 has entered into it =A1. Now, if I have a value such as 99 in A1,
it will be seen in A2, but if I click on A1 and press delete, A2 becomes 0 and does not give me a #REF error. <br /><br />I
ask because I'm creating a workbook in which cells of Sheet 1 have formulas based on cells of Sheet 2, but Sheet 2 has to be
updated weekly and thus its contents erased before new content can be entered. The erasing, however, results in #REF errors
instead of simply values of 0, as happens above.</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1450650" title="REF error in cell deletion" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1441487"></a> <a href="/view/1441487-error-in-excel-when-filtering-data.html" class="results" title="Error in Excel when Filtering Data">Error in Excel when Filtering Data</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">hello all, i am l1m4n<br />
i got a trouble<br /><br />if i filter data  in excel, error always occured.<br />
the error message is :<br /><br />The instruction at "0x30060a9f" referenced memory at "0x00000000". The memory could not be
"read".<br />
Click on OK to terminate the program<br />
Click on Cancel to debug the program<br /><br />that&#039;s what i am confused,... <br />
i hope to get the answer... )<br />
Thankssss for all<br /><br />Regards,<br /><br />L1m4n</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1441487" title="Error in Excel when Filtering Data" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1435563"></a> <a href="/view/1435563-open-all-workbooks-in-folder-error.html" class="results" title="Open All Workbooks In Folder Error">Open All Workbooks In Folder Error</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">Hi, I'm using this simple code found on ozgrid to open all excel files in a folder...<br /><br /><pre class="brush: vbnet">

	VB:
	Sub OpenAllWorkbooksInFolder() 
     '''''''''''''''''''''''''''''''
     'Written by www.Ozgrid.com
     
     'Open all found Workbooks in specified folder
     ''''''''''''''''''''''''''''''''
    Dim i As Integer 
     
    With Application.FileSearch 
        .LookIn = "C:Data" 
         '* represents wildcard characters
        .FileType = msoFileTypeExcelWorkbooks 
        If .Execute > 0 Then 'Workbook exists
            For i = 1 To .FoundFiles.Count 
                Workbooks.Open (.FoundFiles(i)) 
            Next i 
        Else 'There is NOt a Workbook
            MsgBox "The Workbook does not exist" 
        End If 
    End With 
End Sub 

If you like these VB formatting tags please consider sponsoring the author in support of injured Royal Marines

</pre>The only thing I've altered is the path (to C:Data). <br /><br />Whenever I try to run it, I receive run time error
1004: Method 'open' of object 'workbooks' failed.  <br /><br />There are three excel files in C:Data.  They are named:
"Aeta", "July 10 2007", and "Beta July 11 2007".  All three are excel workbooks.  <br /><br />Anyone have any ideas?  Thanks.</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1435563" title="Open All Workbooks In Folder Error" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1424826"></a> <a href="/view/1424826-setting-variable-from-listbox-results-in-overflow-error.html" class="results" title="Setting variable from listbox results in overflow error">Setting variable from listbox results in overflow error</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">This userform has two listboxes. The first populates when the userform is initialized. The second populates when the first
changes. The purpose (eventually) will be to extract start and end dates, then I'll put a bit of code on the exit of the
userform based on those two variables.<br /><br />I'm using similar code to set variable StartDate and EndDate, but when I
set EndDate, I get "Run-time error '6': Overflow" - and I cannot figure out why. Any suggestions? Here's the code, and the
spreadsheet is attached.<pre class="brush: vbnet">

	VB:
	Option Explicit 
 
Dim i, VarI, StartDate, Ender, EndDate As Integer 
 
Private Sub ListBoxEnd_Change() 
    EndDate = Format(ListBoxEnd.Value, "#") 
End Sub 
 
Private Sub ListBoxStart_Change() 
    StartDate = Format(ListBoxStart.Value, "#") 
    UserFormA.ListBoxEnd.Clear 
    UserFormA.ListBoxEnd.RowSource = "" 
    Ender = StartDate + 1 
    With UserFormA.ListBoxEnd 
        For VarI = 0 To 45 
            .AddItem Format(Ender + VarI, "MM/DD/YY") 
            If Ender + VarI = Application.RoundDown(Now, 0) Then Exit For 
        Next VarI 
    End With 
End Sub 
 
Private Sub UserForm_Initialize() 
    UserFormA.ListBoxStart.RowSource = "" 
    With UserFormA.ListBoxStart 
        For VarI = 0 To 45 
            .AddItem Format(Application.RoundDown(Now - VarI, 0), "MM/DD/YY") 
        Next VarI 
    End With 
End Sub 

If you like these VB formatting tags please consider sponsoring the author in support of injured Royal Marines

</pre>Thanks in advance! J88L</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1424826" title="Setting variable from listbox results in overflow error" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1415574"></a> <a href="/view/1415574-vba-need-help-with-excel-add-in-error-module-not.html" class="results" title="VBA : Need help with Excel Add-in VBA error "Module not">VBA : Need help with Excel Add-in VBA error "Module not</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">I am getting an error trying to load a specific add-in I downloaded from a site.  The add-in is a mathematical problem solver
from:<br />
http://www.me.utexas.edu/~jensen/ORM...lib/index.html<br /><br />The add-in is Add_ORMM.xla<br /><br />When I try to link the
Add-in i get the following window pop-up:<br />
Visual Basic Application<br />
"Module not found"<br /><br />I know the add-in works because I tried it on a laptop running XP and it worked fine.<br /><br
/>I have looked at my references and checked the Object Browser for the VBA subroutines and they SEEM to be okay.  Anyone
else have this problem?<br /><br />My system:<br />
Windows 98<br />
MS Office Professional 2000 SP-3 i believe<br />
MS Excel 2000<br /><br />hardware:  Compaq Presario  AMD K6  128MB RAM</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1415574" title="VBA : Need help with Excel Add-in VBA error "Module not" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1411507"></a> <a href="/view/1411507-assigning-calculated-dynamic-range-formula-as-string-results-in-error-1004.html" class="results" title="Assigning calculated dynamic range formula as string results in error 1004">Assigning calculated dynamic range formula as string results in error 1004</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">I'm trying to assign a calculated dynamic range formula to formula1 in for validation, that initially results in an error and
it results in 1004 error. I get the same results if I try to assign the formula to a string variable. Here is the string I'm
trying to assign: =offset(folderstart,MATCH(TRIM(MID(" & icell & ",1,FIND(" = "," & icell &
"))),Presentation_Catalog,0)-1,1,countif(Presentation_Catalog,TRIM(MID(" & icell & ",1,FIND(" = "," & icell & ")))),1)<br
/><br />The validation is a dependent list depending on the column to the left of the current column.<br /><br />Is there
anyway to get around this?</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1411507" title="Assigning calculated dynamic range formula as string results in error 1004" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1404333"></a> <a href="/view/1404333-pull-in-data-from-a-closed-workbook-without-having-to-open-it-run-time-error-1004.html" class="results" title="Pull In Data From A Closed Workbook Without Having To Open It: Run-time Error '1004'">Pull In Data From A Closed Workbook Without Having To Open It: Run-time Error '1004'</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">I have tried to use this http://www.ozgrid.com/VBA/ExtractFromClosedWorkbook.htm and have amended code for my files as
follows. <br />
My source data is in Quote_log_FMSERVER.xls and this has the following in ThisWorkbook (Code)<br />
<pre class="brush: vbnet">

	VB:
	Private Sub Workbook_BeforeSave _ 
    (ByVal SaveAsUI As Boolean, Cancel As Boolean) 
     'Put in the UsedRange Address of Sheet1 Book1.xls (this workbook)
    Sheet3.Cells(1, 1) = Sheet1.UsedRange.Address 
End Sub 

If you like these VB formatting tags please consider sponsoring the author in support of injured Royal Marines

</pre>I want to copy all used cells into QX_Chase.xls which has the following in ThisWorkbook (Code)<br />
<pre class="brush: vbnet">

	VB:
	Private Sub Workbook_Open() 
    Run "PullInSheet1" 
End Sub 

If you like these VB formatting tags please consider sponsoring the author in support of injured Royal Marines

</pre>and also has the following in a standard module.<br />
<pre class="brush: vbnet">

	VB:
	Sub PullInSheet1() 
     '''''''''''''''''''''''''''''''
     'Written By OzGrid Business Applications
     'www.ozgrid.com
     
     'Pulls in all data from sheet1 of a closed workbook.
     ''''''''''''''''''''''''''''''''
     
    Dim AreaAddress As String 
     
     'Clear sheet ready for new data
    Sheet2.UsedRange.Clear 
     'Reference the UsedRange Address of Sheet1 _
    In the closed Workbook. 
    Sheet1.Cells(1, 1) = "= 'C:Documents and SettingsSharon.OPTIPLEXDesktop" _ 
    & "Quote_log_FMSERVER.xls]Sheet3'!RC" 
     'Pass the area Address to a String
    AreaAddress = Sheet1.Cells(1, 1) 
    With Sheet1.Range(AreaAddress) 
         'If the cell in Sheet1 of the closed workbook is not _
        empty the pull In it 's content, else put in an Error.
        .FormulaR1C1 = "=IF('C:Documents and SettingsSharon.OPTIPLEXDesktop" _ 
        & "[Quote_log_FMSERVER.xls]Sheet1'!RC="""",NA(),'C:Documents and SettingsSharon.OPTIPLEX" _ 
        & "Desktop[Quote_Log_FMSERVER.xls]Sheet1'!RC)" 
         'Delete all Error cells
        On Error Resume Next 
        .SpecialCells(xlCellTypeFormulas, xlErrors).Clear 
        On Error Goto 0 
         'Change all formulas to Values only
        .Value = .Value 
    End With 
End Sub 

If you like these VB formatting tags please consider sponsoring the author in support of injured Royal Marines

</pre>When I open QX_Chase.xls I get a runtime error '1004' Application-defined or object-defined error.<br /><br />The
debugger takes me to:<br /><br /><pre class="brush: vbnet">

	VB:
	Sheet1.Cells(1, 1) = "= 'C:Documents and SettingsSharon.OPTIPLEXDesktop" _ 
& "Quote_log_FMSERVER.xls]Sheet3'!RC" 

If you like these VB formatting tags please consider sponsoring the author in support of injured Royal Marines

</pre>According to the VBAProject Explorer Quote_log_FMSERVER.xls has Sheet1 and Sheet3 listed under objects. <br />
I have got this far by trial and error, error now being my problem and would appreciate any advice.</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1404333" title="Pull In Data From A Closed Workbook Without Having To Open It: Run-time Error '1004'" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1404087"></a> <a href="/view/1404087-delete-row-when-formula-results-in-error.html" class="results" title="Delete Row When Formula Results In Error">Delete Row When Formula Results In Error</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">Hi all,<br />
I have a column with a lookup formula which for some of the cells results in an error. Can anyone help me with some code that
will delete the row whenever the formula results in an error?´<br />
Thanks in advance</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1404087" title="Delete Row When Formula Results In Error" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1391729"></a> <a href="/view/1391729-activating-workbook-elsewere-in-use-results-runtime-error-9.html" class="results" title="Activating workbook elsewere in use results in runtime error 9">Activating workbook elsewere in use results in runtime error 9</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">I have a 'masterfile' which cycles through multiple workbooks in order to extract data. For safety reasons I have copies of
these files (including the masterfile) in different locations on my corparate network. In one location it is working
perfectly, in the other it is not. The problem is a runtime 9 error (subscript out of range). Even when I copy all the files
from the working location to the other the problem persists. The only apparent difference between the two situations is that
one of the files is in use by someone else on the network. It is when this particular workbook is activated (simply
Workbooks(targetBook).Activate) I get the error (in fact the error first appeared when a different workbook was in use, but I
didn't suppose it could be a problem, now the problem appears again with a different workbook I am pretty sure this is the
problem). There is no error when the files are opened, and all files are by definition opened as read only in any case
(excepting the masterfile, of course).<br />
Does anybody know how I can get around this problem? <br />
A simple on error resume does not work, unfortunately.<br /><br />cheers, Mundo</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1391729" title="Activating workbook elsewere in use results in runtime error 9" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1390826"></a> <a href="/view/1390826-excel-97-in-winxppro-not-enough-memory-error-m.html" class="results" title="excel 97 in winxppro - "not enough memory" error m">excel 97 in winxppro - "not enough memory" error m</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">I have a spreadsheet created in excel97. It is about 100megs. I can open it on win98 machines that have only 128 megs ram
just fine. On a winxppro machine, trying to open it in either excel97 or excel2k results in the error message "not enough
memory". This machine has 512 megs of ram. I even set the swap file to 1.5 gigs to see if that would help. No dice. If I
watch the bar at the bottom of excel as the file is read, it gets about 75% loaded when I get that message. Anyone know how I
can get this to work on a winxp box? Baffled!</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1390826" title="excel 97 in winxppro - "not enough memory" error m" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div class="searchResultsWrapper" align="left">
      <div class="searchResultsItem">
        <div style="float:left;"><a name="1102889"></a> <a href="/view/1102889-error-occur-while-finding-the-last-row-in-a-range.html" class="results" title="Error occur while finding the last row in a range">Error occur while finding the last row in a range</a></div>
        <div style="float:right;"><a href="#top" class="top" title="Go back to the top">Top</a></div>
        <br />
        <br />
        <div class="result_text">I want to find the last row in within the range Z22 to AB52. However an error occur if all the cells within the range are
empty. I tried to add in "On Error Resume Next" but the lastrow value did not return a 0. <br /><br />How can i assign
lastrow value to be 0 if all the cells are empty? <br />
Thanks for any help in advance! <br /><br />Sheets("sale").Select<br />
    With Range("Z22:AB52")<br />
    On Error Resume Next<br />
        lastrow = .Find(What:="?*", After:=.Cells(1, 1), LookIn:=xlValues, _<br />
                    SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row <br /><br />End With</div>
        <br />
        <br />
        <div align="center"><a href="http://www.knowexcel.com/out.php?id=1102889" title="Error occur while finding the last row in a range" target="_blank" class="viewresponse" rel="nofollow">View Responses</a> </div>
      </div>
    </div>
        <div align="center"> 
    Not finding your answer? <a href="/ask/" class="ask" title="Please ask a question if you are not finding your answer in the search results"><strong>Ask a Question</strong></a>
    <br />
    <br />
      <!-- ValueClick Media 300x250 Medium Rectangle CODE for KnowExcel.com --> 
      <script type="text/javascript">var vclk_options = {sid:82170,media_id:6,media_type:8,version:"1.4"};</script><script class="vclk_pub_code" type="text/javascript" src="http://cdn.fastclick.net/js/adcodes/pubcode.min.js?sid=82170&media_id=6&media_type=8&version=1.4&exc=1"></script>
      <noscript>
      <a href="http://media.fastclick.net/w/click.here?sid=82170&m=6&c=1" target="_blank"><img src="http://media.fastclick.net/w/get.media?sid=82170&m=6&tp=8&d=s&c=1&vcm_acv=1.4" width="300" height="250" border="1"></a>
      </noscript>
      <!-- ValueClick Media 300x250 Medium Rectangle CODE for KnowExcel.com --> 
    </div>
</div>
 
<div id="overdiv" style="position:absolute;display:none;clear:both;"></div>
<div id="footer">
	<div id="footerinner">
		<div id="cp">KnowExcel.com - <a href="/contact.php" class="contact">Contact</a> 
        - <a href="http://www.knowexcel.com/privacy.php" class="contact">Privacy Policy</a> 
        - <a href="http://m.knowexcel.com" class="contact">Mobile</a> 
        - <a href="http://www.know-word.com/" class="contact">Microsoft Word Help</a> 
        - <a href="http://www.know-access.com" class="contact">Microsoft Access Help</a>
        - <a href="http://www.knowwindows.com/" class="contact">Microsoft Windows Help</a>
        - <a href="http://www.knowoutlook.com" class="contact">Microsoft Outlook Help</a>
        - <a href="http://www.knowmotorcycles.com" class"contact">Motorcycle Help</a></div>
        </div>
	</div>
</div>
<script src="/js/highlight.min.js"></script> 
<script>hljs.initHighlightingOnLoad();</script> 
<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js' type='text/javascript'></script> 
<script src='/js/jquery.truncatable.js' type='text/javascript'></script> 
<script type='text/javascript'>
$(function(){
$('.result_text').truncatable({limit: 500, more: '[show more]', less: true, hideText: '[show less]' }); 
});
</script> 
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=readyman"></script> 
<script type="text/javascript">
(function() {
var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
po.src = 'https://apis.google.com/js/plusone.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();
</script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37241744-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=8566237; 
var sc_invisible=1; 
var sc_security="783146b0"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="web stats"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="http://c.statcounter.com/8566237/0/783146b0/1/"
alt="web stats"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide --><script type="text/javascript">
var infolinks_pid = 281079;
var infolinks_wsid = 4;
</script> 
<script type="text/javascript" src="http://resources.infolinks.com/js/infolinks_main.js"></script>
</body>
</html>
