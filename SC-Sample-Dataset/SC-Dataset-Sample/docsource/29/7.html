<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html dir='ltr' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='http://alexgorbatchev.com/pub/sh/2.1.382/styles/shCore.css' rel='stylesheet' type='text/css'/>
<link href='http://alexgorbatchev.com/pub/sh/2.1.382/styles/shThemeDefault.css' rel='stylesheet' type='text/css'/>
<script src='http://alexgorbatchev.com/pub/sh/2.1.382/scripts/shCore.js' type='text/javascript'></script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.382/scripts/shBrushJScript.js' type='text/javascript'></script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.382/scripts/shBrushSql.js' type='text/javascript'></script>
<script src='http://alexgorbatchev.com/pub/sh/2.1.382/scripts/shBrushXml.js' type='text/javascript'></script>
<script type='text/javascript'>
SyntaxHighlighter.config.bloggerMode = true;
SyntaxHighlighter.all();
</script>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<script type="text/javascript">(function() { var b=window,f="jstiming",g="tick";(function(){function d(a){this.t={};this.tick=function(a,d,c){var e=void 0!=c?c:(new Date).getTime();this.t[a]=[e,d];if(void 0==c)try{b.console.timeStamp("CSI/"+a)}catch(h){}};this[g]("start",null,a)}var a;b.performance&&(a=b.performance.timing);var m=a?new d(a.responseStart):new d;b.jstiming={Timer:d,load:m};if(a){var c=a.navigationStart,h=a.responseStart;0<c&&h>=c&&(b[f].srt=h-c)}if(a){var e=b[f].load;0<c&&h>=c&&(e[g]("_wtsrt",void 0,c),e[g]("wtsrt_","_wtsrt",h),e[g]("tbsd_","wtsrt_"))}try{a=null,
b.chrome&&b.chrome.csi&&(a=Math.floor(b.chrome.csi().pageT),e&&0<c&&(e[g]("_tbnd",void 0,b.chrome.csi().startE),e[g]("tbnd_","_tbnd",c))),null==a&&b.gtbExternal&&(a=b.gtbExternal.pageT()),null==a&&b.external&&(a=b.external.pageT,e&&0<c&&(e[g]("_tbnd",void 0,b.external.startE),e[g]("tbnd_","_tbnd",c))),a&&(b[f].pt=a)}catch(n){}})();b.tickAboveFold=function(d){var a=0;if(d.offsetParent){do a+=d.offsetTop;while(d=d.offsetParent)}d=a;750>=d&&b[f].load[g]("aft")};var k=!1;function l(){k||(k=!0,b[f].load[g]("firstScrollTime"))}b.addEventListener?b.addEventListener("scroll",l,!1):b.attachEvent("onscroll",l);
 })();</script>
<meta content='blogger' name='generator'/>
<link href='http://monkeyonoracle.blogspot.ca/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://monkeyonoracle.blogspot.com/2010_03_01_archive.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Monkey on Oracle - Atom" href="http://monkeyonoracle.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Monkey on Oracle - RSS" href="http://monkeyonoracle.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Monkey on Oracle - Atom" href="http://www.blogger.com/feeds/8575920265455783910/posts/default" />
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>Monkey on Oracle: March 2010</title>
<link type='text/css' rel='stylesheet' href='https://www.blogger.com/static/v1/widgets/3189209027-widget_css_bundle.css' />
<link type='text/css' rel='stylesheet' href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=8575920265455783910&zx=dc1065d1-f26b-41b1-a440-51b79a22e187' />
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Minima Stretch
Date:     26 Feb 2004
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="bgcolor" description="Page Background Color"
type="color" default="#fff">
<Variable name="textcolor" description="Text Color"
type="color" default="#333">
<Variable name="linkcolor" description="Link Color"
type="color" default="#58a">
<Variable name="pagetitlecolor" description="Blog Title Color"
type="color" default="#666">
<Variable name="descriptioncolor" description="Blog Description Color"
type="color" default="#999">
<Variable name="titlecolor" description="Post Title Color"
type="color" default="#c60">
<Variable name="bordercolor" description="Border Color"
type="color" default="#ccc">
<Variable name="sidebarcolor" description="Sidebar Title Color"
type="color" default="#999">
<Variable name="sidebartextcolor" description="Sidebar Text Color"
type="color" default="#666">
<Variable name="visitedlinkcolor" description="Visited Link Color"
type="color" default="#999">
<Variable name="bodyfont" description="Text Font"
type="font" default="normal normal 100% Georgia, Serif">
<Variable name="headerfont" description="Sidebar Title Font"
type="font"
default="normal normal 78% 'Trebuchet MS',Trebuchet,Arial,Verdana,Sans-serif">
<Variable name="pagetitlefont" description="Blog Title Font"
type="font"
default="normal normal 200% Georgia, Serif">
<Variable name="descriptionfont" description="Blog Description Font"
type="font"
default="normal normal 78% 'Trebuchet MS', Trebuchet, Arial, Verdana, Sans-serif">
<Variable name="postfooterfont" description="Post Footer Font"
type="font"
default="normal normal 78% 'Trebuchet MS', Trebuchet, Arial, Verdana, Sans-serif">
<Variable name="startSide" description="Start side in blog language"
type="automatic" default="left">
<Variable name="endSide" description="End side in blog language"
type="automatic" default="right">
*/
/* Use this with templates/template-twocol.html */
body {
background:#ffffff;
margin:0;
color:#333333;
font:x-small Georgia Serif;
font-size/* */:/**/small;
font-size: /**/small;
text-align: center;
}
a:link {
color:#5588aa;
text-decoration:none;
}
a:visited {
color:#999999;
text-decoration:none;
}
a:hover {
color:#cc6600;
text-decoration:underline;
}
a img {
border-width:0;
}
/* Header
-----------------------------------------------
*/
#header-wrapper {
margin:0 2% 10px;
border:1px solid #cccccc;
}
#header {
margin: 5px;
border: 1px solid #cccccc;
text-align: center;
color:#666666;
}
#header-inner {
background-position: center;
margin-left: auto;
margin-right: auto;
}
#header h1 {
margin:5px 5px 0;
padding:15px 20px .25em;
line-height:1.2em;
text-transform:uppercase;
letter-spacing:.2em;
font: normal normal 200% Georgia, Serif;
}
#header a {
color:#666666;
text-decoration:none;
}
#header a:hover {
color:#666666;
}
#header .description {
margin:0 5px 5px;
padding:0 20px 15px;
text-transform:uppercase;
letter-spacing:.2em;
line-height: 1.4em;
font: normal normal 78% 'Trebuchet MS', Trebuchet, Arial, Verdana, Sans-serif;
color: #999999;
}
#header img {
margin-left: auto;
margin-right: auto;
}
/* Outer-Wrapper
----------------------------------------------- */
#outer-wrapper {
margin:0;
padding:10px;
text-align:left;
font: normal normal 100% Georgia, Serif;
}
#main-wrapper {
margin-left: 2%;
width: 67%;
float: left;
display: inline;       /* fix for doubling margin in IE */
word-wrap: break-word; /* fix for long text breaking sidebar float in IE */
overflow: hidden;      /* fix for long non-text content breaking IE sidebar float */
}
#sidebar-wrapper {
margin-right: 2%;
width: 25%;
float: right;
display: inline;       /* fix for doubling margin in IE */
word-wrap: break-word; /* fix for long text breaking sidebar float in IE */
overflow: hidden;      /* fix for long non-text content breaking IE sidebar float */
}
/* Headings
----------------------------------------------- */
h2 {
margin:1.5em 0 .75em;
font:normal normal 78% 'Trebuchet MS',Trebuchet,Arial,Verdana,Sans-serif;
line-height: 1.4em;
text-transform:uppercase;
letter-spacing:.2em;
color:#999999;
}
/* Posts
-----------------------------------------------
*/
h2.date-header {
margin:1.5em 0 .5em;
}
.post {
margin:.5em 0 1.5em;
border-bottom:1px dotted #cccccc;
padding-bottom:1.5em;
}
.post h3 {
margin:.25em 0 0;
padding:0 0 4px;
font-size:140%;
font-weight:normal;
line-height:1.4em;
color:#cc6600;
}
.post h3 a, .post h3 a:visited, .post h3 strong {
display:block;
text-decoration:none;
color:#cc6600;
font-weight:normal;
}
.post h3 strong, .post h3 a:hover {
color:#333333;
}
.post-body {
margin:0 0 .75em;
line-height:1.6em;
}
.post-body blockquote {
line-height:1.3em;
}
.post-footer {
margin: .75em 0;
color:#999999;
text-transform:uppercase;
letter-spacing:.1em;
font: normal normal 78% 'Trebuchet MS', Trebuchet, Arial, Verdana, Sans-serif;
line-height: 1.4em;
}
.comment-link {
margin-left:.6em;
}
.post img, table.tr-caption-container {
padding:4px;
border:none;
}
.tr-caption-container img {
border: none;
padding: 0;
}
.post blockquote {
margin:1em 20px;
}
.post blockquote p {
margin:.75em 0;
}
/* Comments
----------------------------------------------- */
#comments h4 {
margin:1em 0;
font-weight: bold;
line-height: 1.4em;
text-transform:uppercase;
letter-spacing:.2em;
color: #999999;
}
#comments-block {
margin:1em 0 1.5em;
line-height:1.6em;
}
#comments-block .comment-author {
margin:.5em 0;
}
#comments-block .comment-body {
margin:.25em 0 0;
}
#comments-block .comment-footer {
margin:-.25em 0 2em;
line-height: 1.4em;
text-transform:uppercase;
letter-spacing:.1em;
}
#comments-block .comment-body p {
margin:0 0 .75em;
}
.deleted-comment {
font-style:italic;
color:gray;
}
.feed-links {
clear: both;
line-height: 2.5em;
}
#blog-pager-newer-link {
float: left;
}
#blog-pager-older-link {
float: right;
}
#blog-pager {
text-align: center;
}
/* Sidebar Content
----------------------------------------------- */
.sidebar {
color: #666666;
line-height: 1.5em;
}
.sidebar ul {
list-style:none;
margin:0 0 0;
padding:0 0 0;
}
.sidebar li {
margin:0;
padding-top:0;
padding-right:0;
padding-bottom:.25em;
padding-left:15px;
text-indent:-15px;
line-height:1.5em;
}
.sidebar .widget, .main .widget {
border-bottom:1px dotted #cccccc;
margin:0 0 1.5em;
padding:0 0 1.5em;
}
.main .Blog {
border-bottom-width: 0;
}
/* Profile
----------------------------------------------- */
.profile-img {
float: left;
margin-top: 0;
margin-right: 5px;
margin-bottom: 5px;
margin-left: 0;
padding: 4px;
border: 1px solid #cccccc;
}
.profile-data {
margin:0;
text-transform:uppercase;
letter-spacing:.1em;
font: normal normal 78% 'Trebuchet MS', Trebuchet, Arial, Verdana, Sans-serif;
color: #999999;
font-weight: bold;
line-height: 1.6em;
}
.profile-datablock {
margin:.5em 0 .5em;
}
.profile-textblock {
margin: 0.5em 0;
line-height: 1.6em;
}
.profile-link {
font: normal normal 78% 'Trebuchet MS', Trebuchet, Arial, Verdana, Sans-serif;
text-transform: uppercase;
letter-spacing: .1em;
}
/* Footer
----------------------------------------------- */
#footer {
width:660px;
clear:both;
margin:0 auto;
padding-top:15px;
line-height: 1.6em;
text-transform:uppercase;
letter-spacing:.1em;
text-align: center;
}

--></style>
<script type="text/javascript">var a="indexOf",b="&m=1",e="(^|&)m=",f="?",g="?m=1";function h(){var c=window.location.href,d=c.split(f);switch(d.length){case 1:return c+g;case 2:return 0<=d[1].search(e)?null:c+b;default:return null}}var k=navigator.userAgent;if(-1!=k[a]("Mobile")&&-1!=k[a]("WebKit")&&-1==k[a]("iPad")||-1!=k[a]("Opera Mini")||-1!=k[a]("IEMobile")){var l=h();l&&window.location.replace(l)};
</script><script type="text/javascript">
if (window.jstiming) window.jstiming.load.tick('headEnd');
</script></head>
<body>
<div class='navbar section' id='navbar'><div class='widget Navbar' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
        gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
          if (gapi.iframes && gapi.iframes.getContext) {
            gapi.iframes.getContext().openChild({
                url: 'https://www.blogger.com/navbar.g?targetBlogID\758575920265455783910\46blogName\75Monkey+on+Oracle\46publishMode\75PUBLISH_MODE_BLOGSPOT\46navbarType\75BLUE\46layoutType\75LAYOUTS\46searchRoot\75http://monkeyonoracle.blogspot.com/search\46blogLocale\75en\46v\0752\46homepageUrl\75http://monkeyonoracle.blogspot.com/\46vt\0756937314277764406893',
                where: document.getElementById("navbar-iframe-container"),
                id: "navbar-iframe"
            });
          }
        });
      </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div id='outer-wrapper'><div id='wrap2'>
<!-- skip links for text browsers -->
<span id='skiplinks' style='display:none;'>
<a href='#main'>skip to main </a> |
      <a href='#sidebar'>skip to sidebar</a>
</span>
<div id='header-wrapper'>
<div class='header section' id='header'><div class='widget Header' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='http://monkeyonoracle.blogspot.ca/'>Monkey on Oracle</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>I read, I repeat. Sometimes I even adapt, that's called evolution.</span></p>
</div>
</div>
</div></div>
</div>
<div id='content-wrapper'>
<div id='crosscol-wrapper' style='text-align:center'>
<div class='crosscol section' id='crosscol'></div>
</div>
<div id='main-wrapper'>
<div class='main section' id='main'><div class='widget Blog' id='Blog1'>
<div class='blog-posts hfeed'>
<!-- google_ad_section_start(name=default) -->

          <div class="date-outer">
        
<h2 class='date-header'><span>Monday, March 29, 2010</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='8575920265455783910' itemprop='blogId'/>
<meta content='8942894265175354592' itemprop='postId'/>
<a name='8942894265175354592'></a>
<h3 class='post-title entry-title' itemprop='name'>
<a href='http://monkeyonoracle.blogspot.ca/2010/03/ckeditor-image-browser-apex-style.html'>CKEditor Image Browser - APEX Style</a>
</h3>
<div class='post-header'>
<div class='post-header-line-1'><div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=8942894265175354592&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=8942894265175354592&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=8942894265175354592&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=8942894265175354592&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><div class='goog-inline-block dummy-container'><g:plusone source='blogger:blog:plusone' href='http://monkeyonoracle.blogspot.com/2010/03/ckeditor-image-browser-apex-style.html' size='medium' width='300' annotation='inline'/></div>
</div>
</div>
</div>
<div class='post-body entry-content' id='post-body-8942894265175354592' itemprop='description articleBody'>
FCKEditor has been used with Oracle APEX for a long while, in APEX terms it is known as HTML Editor Standard and HTML Editor Minimal items. In APEX 4.0 it looks like the new CKEditor is included, called Rich Text Editor item. It actually looks like you are given a choice between the old FCKEditor and the new CKEditor, which is a nice touch for those that have customized FCKEditor in earlier versions.<br />
<br />
If you already have FCKEditor configured with image browsing in you current install, I would not sweat through integrating CKEditor unless you have good reason. Editors are known to change, and this particular will be included in APEX 4.0. <br />
<div class="separator" style="clear: both; text-align: center;"></div><br />
The problem with CKEditor native image browser is the default parameters it includes when launching a pop-up window. Additional parameters does not combine very well with APEX, to say the least. In this post I will give an example on how to adapt the native CKEditor image editor to include your own APEX image browser. This is similar to the earlier article by Carsten Czarski found <a href="http://www.oracle.com/global/de/community/tipps/images-fckeditor/index.html">here</a> in German, or a translated version <a href="http://translate.google.com/translate?u=http%3A%2F%2Fwww.oracle.com%2Fglobal%2Fde%2Fcommunity%2Ftipps%2Fimages-fckeditor%2Findex.html&amp;langpair=de%7Cen&amp;hl=de&amp;ie=UTF-8&amp;oe=UTF-8&amp;prev=%2Flanguage_tools">here</a>. I will not detail how to create your own image browser, but focus on how to change the CKEditor.<br />
<br />
<i>Beware: I am not a Javascript expert. I am not a CKEditor expert. This is basically just a documentation of my experience of adapting CKEditor.</i><br />
<br />
<b>Prerequisites</b><br />
To follow the example you should:<br />
<ul><li><a href="http://ckeditor.com/download">Download</a> and extract ckeditor_3.2.zip to a folder named ckeditor</li>
<li><a href="http://svn.fckeditor.net/CKPackager/trunk/bin/">Download</a> ckpackager.exe and place it under the ckeditor directory</li>
<li>Map the ckeditor directory in your webserver so it can be reached with a web browser. I will use "/js/ckeditor" in this example.</li>
</ul><br />
CKEditor comes complete with examples, source code and documentation (albeit a bit lacking). CKPackager is not as streamlined, but browsing around the <a href="http://svn.fckeditor.net/CKPackager/trunk/">subversion repository</a> you get the general idea. In short CKPackager takes care of putting together ckeditor.js and ckeditor_basic.js after you have fiddled with the source code. I chose the exe-version of CKPackager as I do my development in Windows, but there is a jar-file available as well.<br />
<br />
Create an APEX page to serve as an image browser/picker (it does not have to do anything yet, we'll get to that).<br />
<ul><li>Give the page an alias: IMAGE_PICKER</li>
<li>Create an APEX page with a text area item</li>
<li>Put the following code in the HTML-header of the APEX page:</li>
</ul><pre class="brush: js">&lt;script type="text/javascript" src="/js/ckeditor/ckeditor.js"&gt;&lt;/script&gt;
   &lt;link href="/js/ckeditor/bouvetckeditor.css" rel="stylesheet" type="text/css" /&gt;
</pre><ul><li>Put the following code in the Post Element Text of the text area item:</li>
</ul><pre class="brush: js">&lt;script type="text/javascript"&gt;
   //&lt;![CDATA[
      // Replace the &lt;textarea id="editor"&gt; with an CKEditor
      // instance, using default configurations.
      CKEDITOR.replace( 'P12_TEXT',
                        {filebrowserImageBrowseUrl : 'f?p=&amp;APP_ID.:IMAGE_PICKER:&amp;SESSION.::NO::',
                        width: '500'
                        });
   //]]&gt;
   &lt;/script&gt;
</pre><ul><li>Replace "/js/ckeditor" to match your own configuration</li>
<li>Replace "P12_TEXT" to match the item name of your text area item.</li>
</ul><br />
<b>The Problematic URL</b><br />
You should now be able to run the page described above, and have CKEditor magically appear where your text area item was supposed to be. When you click the image button in the CKEditor toolbar, the image dialog appears, but when you click the "Browse Server" button, the fun begins. The pop-up window spawns with an URL that has three extra parameters attached.<br />
<ul><li>CKEditor which contains the item name</li>
<li>CKEditorFuncNum which contains som mystic numeric ID</li>
<li>langCode which contains the language code set for the CKEditor instance</li>
</ul><br />
APEX will blow up when this URL is tried (as f has no parameters matching the three). Actually APEX won't blow, because f will never be reached as mod_plsql won't recognize any procedure with the signature required. You get the idea.<br />
<br />
<b>Changing CKEditor Source Code</b><br />
To adapt the URL to APEX style, you must get your hands dirty with Javascript. Actually I think the code of CKEditor looks quite clean, it's just so much of it :-) The source code is located in the "_source" directory, open the file "ckeditor/_source/plugins/filebrowser/plugin.js" in your favourite Javascript editor (or <a href="http://www.textpad.com/">TextPad</a> in my case).<br />
<br />
In this example I will keep the original parameters (and parameter names), but if you want to change them, they are located in the browseServer function.<br />
<br />
The addQueryString function accepts the URL and parameters, and builds the complete URL. Change the function to look something like this:<br />
<pre class="brush: js">function addQueryString( url, params )
        {
                var paramString = [];
                var queryString = [];

                if ( !params )
                        return url;
                else
                {
                        for ( var i in params ) {
                                paramString.push( i );
                                queryString.push( encodeURIComponent( params[ i ] ) );
                        }
                }

                return url + paramString.join( "," ) + ":" + queryString.join( "," );
        }
</pre>The function will now add the parameter names before the colon symbol, and the parameter values after. All in the same order, all separated by a comma. APEX style :-)<br />
<br />
<b>Re-Packing CKEditor</b><br />
Changing the code is not enough, your changes have not reached ckeditor.js yet. This is what we need the CKPackager for. It collects the source, and builds a new ckeditor.js based on the current source.<br />
<ul><li>Start a command line window and browse to the ckeditor directory</li>
<li>Execute CKPackager  like this: "CKPackager.exe ckeditor.pack -v" (or: "java -jar CKPackager.jar ckeditor.pack -v")</li>
<li>A new version of ckeditor.js and ckeditor_basic.js will be generated for you</li>
</ul><br />
ckeditor.pack contains reference to the files to be included into the ckeditor.js and ckeditor_basic.js files. The switch -v will give a verbose execution.<br />
<br />
Reload the APEX page containing the CKEditor item (a proper reload to ensure the new version of the ckeditor.js file is loaded), and this time the image picker APEX page should pop-up, so to speak.<br />
<br />
<b>Returning From APEX Pop-up Window</b><br />
The only thing missing now is the value to return to the CKEditor image dialog. This requires som additional code in your Apex application:<br />
<br />
First create three application level items (unrestricted) named:<br />
<ul><li>CKEDITOR</li>
<li>CKEDITORFUNCNUM</li>
<li>LANGCODE</li>
</ul>These items will contain the parameters recieved from CKEditor.<br />
<br />
Next, modify your image picker APEX page:<br />
<ul><li>Create a new submit button on the page, and name it ADD_IMAGE, accept the rest as defaults.</li>
<li>Create a new After Submit Page Process, type PL/SQL, and call it close_popup</li>
<li>Paste the code below into the PL/SQL Process code area:</li>
</ul><pre class="brush: sql">declare
      l_file_url varchar2(4000);
   begin
      l_file_url := '/path/of/image/imagename.jpg';
      htp.p('&lt;body&gt;');
      htp.p('&lt;script type="text/javascript"&gt;');
      htp.p('window.opener.CKEDITOR.tools.callFunction( '||:ckeditorfuncnum||', '''||l_file_url||''');');
      htp.p('window.close();');
      htp.p('&lt;/script&gt;');
      htp.p('&lt;/body&gt;');
   end;
</pre>This bit of code will call the appropriate CKEditor return function, and close the pop-up window. Modify the code to suite your needs, but beware <a href="http://forums.oracle.com/forums/thread.jspa?threadID=646784">not to put any code below the last htp.p-call</a>.<br />
<br />
<b>Testing the Code</b><br />
To test the code so far: <br />
<ul><li>Run the page containing the CKEditor item.</li>
<li>Click the image button in the CKEditor toolbar</li>
<li>Click the Browse Server button</li>
<li>A pop-up window with your image picker APEX page should now appear</li>
<li>Click the Add Images button on your APEX page, and the CKEditor image dialog URL should now reflect the URL set from your APEX image picker page</li>
</ul><br />
<b>Modifying CKEditor Image Browser Parameters</b><br />
So far you have a complete working example with CKEditor image browser and Oracle APEX, but what if you want to modify the parameters themselves? Earlier you modified the function assembling the complete URL based on the defatult parameters, to change the parameters you must modify the browseServer-function in the same file as before ("ckeditor/_source/plugins/filebrowser/plugin.js"). The only parameter the CKEditor really needs when returning image source, is the image source (duh) and CKEditorFuncNum.<br />
<br />
Here is an example of the browseServer-function when parameters CKEditor and langCode is removed, and the current APEX-page id added as a parameter called "callingPage":<br />
<pre class="brush: js">function browseServer( evt )
   {
      var dialog = this.getDialog();
      var editor = dialog.getParentEditor();

      editor._.filebrowserSe = this;

      var width = editor.config[ 'filebrowser' + ucFirst( dialog.getName() ) + 'WindowWidth' ]
          || editor.config.filebrowserWindowWidth || '80%';
      var height = editor.config[ 'filebrowser' + ucFirst( dialog.getName() ) + 'WindowHeight' ]
          || editor.config.filebrowserWindowHeight || '70%';

      var params = this.filebrowser.params || {};
      params.CKEditorFuncNum = editor._.filebrowserFn;
      
      // New parameter to get APEX pageId
      params.callingPage = $v('pFlowStepId');

   var url = addQueryString( this.filebrowser.url, params );
      editor.popup( url, width, height );
   }
</pre>To generate a new version of CKEditor, use the CKPackager as described earlier in the post. The parameters in the URL uses the same (APEX friendly) construct as before (pName,pName:pValue,pValue), but the number and names of the parameters have changed. The new pop-up URL should now look something like this: "http://&lt;yourserver&gt;/pls/apex/f?p=&lt;app_id&gt;:IMAGE_PICKER:&lt;sessionid&gt;::NO::CKEditorFuncNum,callingPage:&lt;X&gt;,&lt;pageid&gt;".<br />
<br />
<b>A Word of Caution</b><br />
When hacking the source like this, and not making your own plugin, guess what happens when you need to upgrade to the next version of CKEditor? When you push the toothbrush too far back, you have to start all over again.<br />
<br />
This hack is in the filebrowser-plugin, which in turn is used by the Flash- and Link-dialogs, so pay attention to changes there as well.<br />
<br />
Not as sleek as I would like it to be, but if moving to  CKEditor is on your list, this is a way to achieve just that.<br />
<br />
As always, use it at your own risk!<br />
<br />
Enjoy :-)
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'><span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='http://www.blogger.com/profile/13932482145147467490' itemprop='url'/>
<a class='g-profile' href='http://www.blogger.com/profile/13932482145147467490' rel='author' title='author profile'>
<span itemprop='name'>Håvard Kristiansen</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='http://monkeyonoracle.blogspot.com/2010/03/ckeditor-image-browser-apex-style.html' itemprop='url'/>
<a class='timestamp-link' href='http://monkeyonoracle.blogspot.ca/2010/03/ckeditor-image-browser-apex-style.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2010-03-29T15:51:00+02:00'>15:51</abbr></a>
</span>
<span class='post-comment-link'>
<a class='comment-link' href='http://monkeyonoracle.blogspot.ca/2010/03/ckeditor-image-browser-apex-style.html#comment-form' onclick=''>
4 comments:
    </a>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-422512928'>
<a href='http://www.blogger.com/post-edit.g?blogID=8575920265455783910&postID=8942894265175354592&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='http://img2.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
</div>
<div class='post-footer-line post-footer-line-2'><span class='post-labels'>
Labels:
<a href='http://monkeyonoracle.blogspot.ca/search/label/apex' rel='tag'>apex</a>,
<a href='http://monkeyonoracle.blogspot.ca/search/label/ckeditor' rel='tag'>ckeditor</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'></div>
</div>
</div>
</div>

            </div></div>
          

          <div class="date-outer">
        
<h2 class='date-header'><span>Tuesday, March 2, 2010</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='http://4.bp.blogspot.com/_8GtRvOur8pQ/S4zuzgUb6oI/AAAAAAAAACQ/zpzENrehA5k/s320/lupa.jpg' itemprop='image_url'/>
<meta content='8575920265455783910' itemprop='blogId'/>
<meta content='1533033544688537738' itemprop='postId'/>
<a name='1533033544688537738'></a>
<h3 class='post-title entry-title' itemprop='name'>
<a href='http://monkeyonoracle.blogspot.ca/2010/03/docx-part-ii-how-to-index-document.html'>DOCX Part II: How to Index Document Content With Oracle Text</a>
</h3>
<div class='post-header'>
<div class='post-header-line-1'><div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=1533033544688537738&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=1533033544688537738&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=1533033544688537738&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=1533033544688537738&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><div class='goog-inline-block dummy-container'><g:plusone source='blogger:blog:plusone' href='http://monkeyonoracle.blogspot.com/2010/03/docx-part-ii-how-to-index-document.html' size='medium' width='300' annotation='inline'/></div>
</div>
</div>
</div>
<div class='post-body entry-content' id='post-body-1533033544688537738' itemprop='description articleBody'>
Here I will demonstrate how to index content of CLOB data using Oracle Text. Other than the database objects used in the example, the post addresses the use of Oracle Text in a general way, and will work for any CLOB column. There is no ground breaking code here, but it completes the example on how to handle Microsoft Open Office XML Format (DOCX) documents. The examples and content here are based on <a href="http://monkeyonoracle.blogspot.com/2010/03/docx-part-i-how-to-extract-document.html">my previous post</a>.<br />
<div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_8GtRvOur8pQ/S4zuzgUb6oI/AAAAAAAAACQ/zpzENrehA5k/s1600-h/lupa.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_8GtRvOur8pQ/S4zuzgUb6oI/AAAAAAAAACQ/zpzENrehA5k/s320/lupa.jpg" /></a></div><br />
The code here is tested with Oracle database release 11.1.0.6, but should work with releases down to 10g. When I say "tested", remember I am a developer, so it basically means it does compile and it did give the expected result on <i>one</i> run trough...<br />
<br />
<b>See it in Action</b><br />
I have included a search page in my demo application. Upload a DOCX document, and try it for yourself: <a href="http://apex.oracle.com/pls/apex/f?p=28990:20">Go to demo application</a>.<br />
<br />
<b>About Oracle Text</b><br />
Oracle Text (formerly Oracle interMedia) is Oracles full-text retrieval technology, and part of Standard, Enterprise and even XE editions of the database. See <a href="http://www.oracle.com/technology/products/text/index.html">Oracle Text on oracle.com</a> for more information.<br />
<br />
In my case I will use it to index text content stored in a CLOB column, and utilize it's search capabilities to enable users to retrieve relevant results based on search phrases.<br />
<br />
<b>Indexing CLOBs</b><br />
Or BLOBs, or BFILEs, for that matter. It is very easy to get up and running with a text index. The following code is all that is needed to get a text index up and running against the TEXT_CONTENT column of the SAMPLES_DOCX table:<br />
<pre class="brush: sql">create index samples_docx_ctx on samples_docx
(text_content)
indextype is ctxsys.context
/
</pre>That's it! If you want to get fancy, there are a number of options and ways to enhance the indexing, look at <a href="http://download.oracle.com/docs/cd/B28359_01/text.111/b28303/ind.htm">the documentation</a> for more information on the subject (lexers, sections, stopword lists, etc.).<br />
<br />
<b>Searching with Oracle Text</b><br />
With the text index in place, the next step is to use the index to retrieve search results. In my example I will use a technique called "Progressive Relaxation" as described by Roger Ford <a href="http://www.oracle.com/technology/products/text/htdocs/prog_relax.html">here</a>. It uses a query template to implement a progressive relaxation of the search tokens.<br />
<br />
The following script creates a package to handle and use the new text index:<br />
<pre class="brush: sql">create or replace package samples_docx_search_p
as
   -- result types
   type t_result_rec is record (
      score         number,
      filename      samples_docx.filename%type,
      snippet       varchar2(4000));
   type t_result_tab is table of t_result_rec;
   -- synchronize search index
   procedure sync_search_index (
      p_ctx_index_name     in          varchar2 default 'SAMPLES_DOCX_CTX'
   );
   -- search docx content
   function search_text (
      p_tokens    in          varchar2
   ) return t_result_tab pipelined;
end;
/

create or replace package body samples_docx_search_p
as
   -- synchronize search index
   procedure sync_search_index (
      p_ctx_index_name     in          varchar2 default 'SAMPLES_DOCX_CTX'
   ) is
   begin
      ctx_ddl.sync_index(p_ctx_index_name, '2M');
   end;
   -- search docx content
   function search_text (
      p_tokens    in          varchar2
   ) return t_result_tab pipelined
   as 
      l_max_rows         integer := 10;
      l_counter          integer := 0;
      l_ret_rec          t_result_rec;
      l_tokens           varchar2(4000) := lower(p_tokens); 
      l_query_template   varchar2(32000):='&lt;query&gt;'
                              ||chr(10)||'   &lt;textquery&gt; heregoesthetokens'
                              ||chr(10)||'     &lt;progression&gt;'
                              ||chr(10)||'       &lt;seq&gt;&lt;rewrite&gt;transform((TOKENS, "{", "}", " "))&lt;/rewrite&gt;&lt;/seq&gt;'
                              ||chr(10)||'       &lt;seq&gt;&lt;rewrite&gt;transform((TOKENS, "{", "}", "AND"))&lt;/rewrite&gt;/seq&gt;'
                              ||chr(10)||'       &lt;seq&gt;&lt;rewrite&gt;transform((TOKENS, "?{", "}", "AND"))&lt;/rewrite&gt;&lt;/seq&gt;'
                              ||chr(10)||'       &lt;seq&gt;&lt;rewrite&gt;transform((TOKENS, "{", "}", "OR"))&lt;/rewrite&gt;&lt;/seq&gt;'
                              ||chr(10)||'       &lt;seq&gt;&lt;rewrite&gt;transform((TOKENS, "?{", "}", "OR"))&lt;/rewrite&gt;&lt;/seq&gt;'
                              ||chr(10)||'     &lt;/progression&gt;'
                              ||chr(10)||'   &lt;/textquery&gt;'
                              ||chr(10)||'&lt;/query&gt;';
      l_query            varchar2(32000);
   begin
      if l_tokens is null
      then
         return;
      end if;
      -- create query temlpate based on tokens
      l_query_template := replace(l_query_template, 'heregoesthetokens', l_tokens);
      -- restructure tokens for use with snippet
      l_tokens := replace(l_tokens, ' ', ' | ');
      for c in (select rowid
                     , filename 
                  from samples_docx 
                 where contains (text_content, l_query_template, 1) &gt; 0)
      loop
         -- crude custom score, just listing the results as they come
         l_ret_rec.score := l_counter;
         l_ret_rec.filename := c.filename;
         -- create snippet (with tokenbased highlight) of content to return to the user
         ctx_doc.set_key_type('ROWID');
         l_ret_rec.snippet :=  ctx_doc.snippet('SAMPLES_DOCX_CTX', c.rowid, l_tokens, '&lt;b&gt;', '&lt;/b&gt;', false);
         l_counter := l_counter + 1;
         -- return row
         pipe row (l_ret_rec);
         -- exit when max number of rows exceeded
         exit when l_counter &gt;= l_max_rows;
      end loop;
   end;
end;
/
</pre>Some parts of the code are more cryptic than others.<br />
<br />
First up is the "SYNC_SEARCH_INDEX" procedure. It's sole purpose is to synchronize the search index with the TEXT_CONTENT column. When you perform DML on the TEXT_CONTENT column, changes to the text index does not automatically propagate to the search index (unless the index is explicitly told to do so). So, in this example, if you insert a new row, the TEXT_CONTENT will not show up through Oracle Text searches until you have told it to synchronize the index. Indexing can be a resource demanding operation, so it makes sense to separate table DML from the indexing job.<br />
<br />
In short: <i>Make sure you synchronize the text index after DML on the indexed column has been performed</i>.<br />
<br />
Next is the "SEARCH_TEXT" function, particularly the query template. In the past I have used Oracle Text in its most simple form, but query templates adds a new dimension to controlling your searches. Basically you define how you want to use the search tokens (search phrase) to find matches in the text index. It is written in XML-form, and the &lt;seq&gt;-tag states the order of which you want to process your criteria. For more information on query templates, take a look at <a href="http://download.oracle.com/docs/cd/B28359_01/text.111/b28303/query.htm">the documentation</a>.<br />
<br />
A short explanation on the query template:<br />
<ul><li>&lt;rewrite&gt;transform((TOKENS, "{", "}", " "))&lt;/rewrite&gt;: Matches when whole phrase (tokens in order) is present within document</li>
<li>&lt;rewrite&gt;transform((TOKENS, "{", "}", "AND"))&lt;/rewrite&gt;: Matches when each token is present within document</li>
<li>&lt;rewrite&gt;transform((TOKENS, "?{", "}", "AND"))&lt;/rewrite&gt;: Matches when each token is present within docoument, allowing typos (fussy search)</li>
<li>&lt;rewrite&gt;transform((TOKENS, "{", "}", "OR"))&lt;/rewrite&gt;: Matches when any of the tokens are present within document</li>
<li>&lt;rewrite&gt;transform((TOKENS, "?{", "}", "OR"))&lt;/rewrite&gt;: Matches when any of the tokens are present within document, allowing typos (fussy search)</li>
</ul><br />
Although it will return matches according to the sequence, the "score" within the sequence will be random (as far as I could see at least), so the "score" column in the example above needs a bit of work. I also learned the hard way that structure of the XML in the query template is not validated, and it swallows typos without a word.<br />
<br />
<b>Test the Code</b><br />
You can test the code directly from SQL*Plus or your favorite weapon of choice. The following code will search for "test":<br />
<pre class="brush: sql">select filename
,      snippet
from   table(samples_docx_search_p.search_text('test'))
order  by score
/
</pre><br />
<b>Wildcards</b><br />
My query template does not support searching for parts of words, there are some reasons for this behavior.<br />
<ul><li>Wildcard searches requires more resources</li>
<li>The results returned will be unpredictable. Imagine searching for "ora*", both "oracle" and "orange" will match.</li>
<li>Wildcard searches are more suitable for look-ups in structured data</li>
</ul>What did I mean by that last statement? As I see it, users today are using a wide range of search engines and site searches every day, and wildcard matching are in most cases available only through the "advanced search"-link (that is rarely used, if ever). Let alone that people do not expect this kind of behavior anymore. If you want to help the user, add ajax autocomplete to your search field, and use the Oracle Text index. In the traditional back office application, it is another matter (look-ups and such).<br />
<br />
<b>Create a Search Page in Oracle APEX</b><br />
I will not do a detailed explanation here, but creating a report based on a query will do the trick. If you choose "Yes" for "Enable search" in the wizard it will save you some work by creating the search dialog on the page. Clean up the query in the report region so that tour query looks something like this:<br />
<pre class="brush: sql">select filename
,      snippet
from   table(samples_docx_search_p.search_text(:PXX_REPORT_SEARCH))
order  by score
</pre>When keeping the order by, I assume that you will let the score column determine the result order. For good measure you can create a row template for the result representation in the APEX report so you can have heading and snippet spread over two rows.<br />
<br />
<b>Update Sample Upload Page</b><br />
If you created the upload page described in my previous post, include a new page process (After Submit, and after the "extract_text"-process). The process should be of PL/SQL-type, and the code should look something like this:<br />
<pre class="brush: sql">samples_docx_search_p.sync_search_index;
</pre>It does not necessary have to be a page process, but it is important to synchronize the text index after DML.<br />
<br />
<b>How to Handle DOC and DOCX</b><br />
...And PDF, XLS, PPT, etc. Well, the DOCX is the exception here. Oracle Text does not understand the format yet (unless you are running on release 11.1.0.7 or higher). If you create an Oracle Text index on a BLOB column containing other file types which it does understand, they will be indexed automagically. If you want to index the content of a DOCX document in the same index, use the technique described in my last post, convert the output (plain text) into a BLOB, and insert the BLOB into the table with the other documents. Or said in a different way: you except and handle DOCX documents differently than the known document types.<br />
<br />
Querying an Oracle Text index works the same for BLOB and CLOB columns.<br />
<br />
There is definitely room for improvement in the code, but it serves well enough for demonstration purposes.<br />
<br />
Enjoy :-)
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'><span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='http://www.blogger.com/profile/13932482145147467490' itemprop='url'/>
<a class='g-profile' href='http://www.blogger.com/profile/13932482145147467490' rel='author' title='author profile'>
<span itemprop='name'>Håvard Kristiansen</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='http://monkeyonoracle.blogspot.com/2010/03/docx-part-ii-how-to-index-document.html' itemprop='url'/>
<a class='timestamp-link' href='http://monkeyonoracle.blogspot.ca/2010/03/docx-part-ii-how-to-index-document.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2010-03-02T12:35:00+01:00'>12:35</abbr></a>
</span>
<span class='post-comment-link'>
<a class='comment-link' href='http://monkeyonoracle.blogspot.ca/2010/03/docx-part-ii-how-to-index-document.html#comment-form' onclick=''>
1 comment:
    </a>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-422512928'>
<a href='http://www.blogger.com/post-edit.g?blogID=8575920265455783910&postID=1533033544688537738&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='http://img2.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
</div>
<div class='post-footer-line post-footer-line-2'><span class='post-labels'>
Labels:
<a href='http://monkeyonoracle.blogspot.ca/search/label/apex' rel='tag'>apex</a>,
<a href='http://monkeyonoracle.blogspot.ca/search/label/docx' rel='tag'>docx</a>,
<a href='http://monkeyonoracle.blogspot.ca/search/label/oracle' rel='tag'>oracle</a>,
<a href='http://monkeyonoracle.blogspot.ca/search/label/text%20index' rel='tag'>text index</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'></div>
</div>
</div>
</div>

            </div></div>
          

          <div class="date-outer">
        
<h2 class='date-header'><span>Monday, March 1, 2010</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='http://1.bp.blogspot.com/_8GtRvOur8pQ/S4vHvKHjyvI/AAAAAAAAACI/pa5eiB_fIVk/s320/text.jpg' itemprop='image_url'/>
<meta content='8575920265455783910' itemprop='blogId'/>
<meta content='396674855393371105' itemprop='postId'/>
<a name='396674855393371105'></a>
<h3 class='post-title entry-title' itemprop='name'>
<a href='http://monkeyonoracle.blogspot.ca/2010/03/docx-part-i-how-to-extract-document.html'>DOCX Part I: How to Extract Document Content as Plain Text</a>
</h3>
<div class='post-header'>
<div class='post-header-line-1'><div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=396674855393371105&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=396674855393371105&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=396674855393371105&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='http://www.blogger.com/share-post.g?blogID=8575920265455783910&postID=396674855393371105&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><div class='goog-inline-block dummy-container'><g:plusone source='blogger:blog:plusone' href='http://monkeyonoracle.blogspot.com/2010/03/docx-part-i-how-to-extract-document.html' size='medium' width='300' annotation='inline'/></div>
</div>
</div>
</div>
<div class='post-body entry-content' id='post-body-396674855393371105' itemprop='description articleBody'>
In this post I will demonstrate how to extract plain text from Microsoft Open Office XML Format (DOCX) documents stored as a BLOB data type in an Oracle database. It is part one of two posts concerning how to extract and index unstructured content stored in DOCX files. I found snippets of solutions several places, but no complete copy-paste solution, so perhaps this will save some of you a bit of work.<br />
<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_8GtRvOur8pQ/S4vHvKHjyvI/AAAAAAAAACI/pa5eiB_fIVk/s1600-h/text.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/_8GtRvOur8pQ/S4vHvKHjyvI/AAAAAAAAACI/pa5eiB_fIVk/s320/text.jpg" /></a></div><br />
The solution is tested on Oracle database Enterprise Edition release 11.1.0.6 with Apex 3.2.1 running on Windows XP, but should work down to 10g Standard Edition (not Oracle XE, since part of the code is in Java).<br />
<br />
<b>See it In Action</b><br />
I have updated my demo application with a couple of pages so you can try it out yourselves: <a href="http://apex.oracle.com/pls/apex/f?p=28990:20">Go to demo application</a>. There is a limited space available at apex.oracle.com, so please take care when uploading (and it is very easy to test in your own environment).<br />
<b><br />
</b><br />
<b>When will You Ever Need This?</b><br />
If you have an Oracle database version prior to 11.1.0.7, Oracle Text is not able to index DOCX documents (as it does DOC documents). From version 11.1.0.7 and on, Oracle uses technology from Stellent, and DOCX is indexed as the other formats. So if you want to index DOCX text content in Oracle Text in a version prior to 11.1.0.7, then this could be a way to do it.<br />
<br />
Oracle is working on a back-port to 10.x, but I have no status when (if) this will be available. Microsoft Office 2007 has been around since.. Take a wild guess! So these things obviously takes some time.<br />
<br />
<b>About Microsoft Open Office XML Format</b><br />
As seen from the eyes of a PL/SQL developer, that is. First of all, XML sounds promising, you can do a ton of things with a valid XML in an Oracle database. You get the first nasty surprise when opening a DOCX-document in your favorite text editor; it is a zip archive! The next is when you realize that utl_compress can't help you uncompressing it either.<br />
<br />
So Google next, and realizing this cannot be easily done in a pure PL/SQL solution, Google yields <a href="http://www.infoq.com/articles/cracking-office-2007-with-java">this gem from Ted Neward</a>. It is a DOCX (Open XML) walk through as seen from the eyes of a Java developer. Very educational.<br />
<br />
<b>How to Unzip in PL/SQL</b><br />
You probably can, but that would probably also involve a lot of work. The easy way is to take hold of a Java method that already does what you want. After searching the net I came up with <a href="http://www.oooforum.org/forum/viewtopic.phtml?t=24711">this post from peterv6i</a> which does exactly what I want (and more, it can also add files (BLOB) to an existing zip archive).<br />
<br />
My short version of this (as I only need to extract content), follows below. The script creates a java class with a method to extract a file from a zip archive, and a PL/SQL wrapper to the getFileFromZip method. The database user must have JAVA_DEPLOY and JAVAUSERPRIV (I think) roles.<br />
<pre class="brush: sql">create or replace java source named "ZIPImpl" 
AS 
import java.io.*; 
import java.util.zip.*; 
import java.sql.*; 
import oracle.sql.*; 
public class ZIPImpl 
{ 
public static void getFileFromZip(oracle.sql.BLOB srcBlob, oracle.sql.BLOB dstBlob[], java.lang.String name) { 
try { 
   OutputStream outBuffer = dstBlob[0].getBinaryOutputStream(); 
   InputStream inBuffer = srcBlob.getBinaryStream(); 
   ZipInputStream zip = new ZipInputStream(inBuffer); 
   ZipEntry entry; 
   byte[] tmpBuffer = new byte[2048]; 
   while((entry = zip.getNextEntry()) != null) { 
      if (entry.getName().compareTo(name)==0) { 
         int n; 
         while ((n = zip.read(tmpBuffer)) &gt;= 0) 
           outBuffer.write(tmpBuffer, 0, n); 
      } 
   } 
   outBuffer.close(); 
 } 
 catch (SQLException e) { 
   System.err.println(e); 
 } 
 catch (IOException e) { 
   System.err.println(e); 
 } 
} 
}; 
/

alter java source "ZIPImpl" compile 
/      

create or replace package zip as 
   procedure unzip( 
      p_src       in          blob
   ,  p_dst       in out      blob
   ,  p_filename  in          varchar2); 
end; 
/

create or replace package body zip as 
   procedure unzip( 
      p_src       in          blob
   ,  p_dst       in out      blob
   ,  p_filename  in          varchar2) 
   as language java 
   name 'ZIPImpl.getFileFromZip(oracle.sql.BLOB, oracle.sql.BLOB[], java.lang.String)'; 
end; 
/ 
</pre><b>How to Extract Plain Text Content from DOCX</b><br />
So, now you have a procedure to extract a file from a zip archive, next is to attack the content of the file. The DOCX file consists of several files, but the text content of the document resides in "word/document.xml". As the file is an XML document, I will perform an XML/XSL transformation of the file to be left with only plain text.<br />
<br />
The script below creates a table SAMPLES_DOCX which will hold the original DOCX file stored as a BLOB, and a CLOB containing the plain text. It also creates a package with three procedures:<br />
<ul><li>Store the DOCX (as uploaded into APEX_APPLICATION_FILES)</li>
<li>Download the original file (strictly not necessary for this exercise, but nice to have all the same)</li>
<li>Extract and store plain text from DOCX</li>
</ul><br />
The XSL used to transform the document.xml file is an (extremely) abbreviated version of the XSL <a href="http://forums.oracle.com/forums/thread.jspa?messageID=3368284">posted here in the Oracle Technical Forums</a>.<br />
<pre class="brush: sql">create table samples_docx (
   filename       varchar2(255) not null
,  mime_type      varchar2(255)
,  orig_file      blob
,  text_content   clob)
/

alter table samples_docx add constraint samples_docx_pk primary key (filename)
/

create or replace package sample_docx_p as
   -- get file from apex_application_files and store it in samples_docx table
   procedure store_docx (
      p_file_name    in       varchar2);
   -- download procedure for original docx file
   procedure retrieve_docx (
      p_file_name    in       varchar2);
   -- extract plain text from docx file (this is the meat)
   procedure store_text (
      p_file_name    in       varchar2);
end;
/

create or replace package body sample_docx_p as
   -- get file from apex_application_files and store it in samples_docx table
   procedure store_docx (
      p_file_name    in       varchar2)
   is
      l_file         blob;
      l_mime_type    apex_application_files.mime_type%type;
      l_name         apex_application_files.name%type;
   begin
      -- get file from apex files
      select  name
            , mime_type
            , blob_content
       into   l_name
            , l_mime_type
            , l_file
       from   apex_application_files
      where   name = p_file_name;
      -- insert record into samples table
      insert into samples_docx ( filename
                               , mime_type
                               , orig_file)
       values   (   l_name
                  , l_mime_type
                  , l_file);
      -- delete file from apex files when done
      delete from   apex_application_files
           where   name = p_file_name;
   end store_docx;
   -- download procedure for original docx file
   procedure retrieve_docx (
      p_file_name    in       varchar2)
   is
      l_file         blob;
      l_mime_type    apex_application_files.mime_type%type;
      l_name         apex_application_files.name%type;
      l_size         number;
   begin
      -- get file from apex files
      select  filename
            , mime_type
            , orig_file
            , dbms_lob.getlength(orig_file)
       into   l_name
            , l_mime_type
            , l_file
            , l_size
       from samples_docx   
      where   filename = p_file_name;
      -- return file
      owa_util.mime_header( nvl(l_mime_type,'application/octet'), false);
      htp.p('Content-length: ' || l_size);
      htp.p('Content-Disposition:  attachment; filename="'||replace(replace(substr(l_name,instr(l_name,'/')+1),chr(10),null),chr(13),null)|| '"');
      owa_util.http_header_close;
      wpg_docload.download_file(l_file);
   end retrieve_docx;
   -- perform xsl tranformation of document.xml
   function get_text (
      p_docx_xml     in       xmltype
   ) return clob
   is
   l_clob   clob;
   -- xsl monkeyed from http://forums.oracle.com/forums/thread.jspa?messageID=3368284
   -- abbreviated quite a bit, check out original posting by "user304344" for the original
   l_xsl    xmltype := xmltype('&lt;?xml version="1.0" encoding="utf-8"?&gt;'
                     ||chr(10)||'&lt;xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" '
                     ||chr(10)||'xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"'
                     ||chr(10)||'xmlns:v="urn:schemas-microsoft-com:vml"'
                     ||chr(10)||'exclude-result-prefixes="w v"&gt;'
                     ||chr(10)||'&lt;xsl:output method="text" indent="no" encoding="UTF-8" version="1.0"/&gt;'
                     ||chr(10)||'&lt;!-- document root --&gt;'
                     ||chr(10)||'&lt;xsl:template match="/"&gt;'
                     ||chr(10)||'&lt;!-- root element in document --&gt; '
                     ||chr(10)||'&lt;xsl:apply-templates select="w:document"/&gt; '
                     ||chr(10)||'&lt;/xsl:template&gt;'
                     ||chr(10)||'&lt;!-- ****************************start document**************************** --&gt;'
                     ||chr(10)||'&lt;xsl:template match="w:document"&gt;'
                     ||chr(10)||'&lt;xsl:for-each select="//w:p"&gt;'
                     ||chr(10)||'&lt;xsl:apply-templates select="*/w:t"/&gt; '
                     ||chr(10)||'&lt;xsl:text&gt;|&#164;&#164;&lt;/xsl:text&gt; '
                     ||chr(10)||'&lt;/xsl:for-each&gt; '
                     ||chr(10)||'&lt;/xsl:template&gt;'
                     ||chr(10)||'&lt;!-- get all text nodes within a para --&gt;'
                     ||chr(10)||'&lt;xsl:template match="*/w:t"&gt;'
                     ||chr(10)||'&lt;xsl:value-of select="."/&gt;'
                     ||chr(10)||'&lt;/xsl:template&gt;'
                     ||chr(10)||'&lt;!-- **************************** end document**************************** --&gt;'
                     ||chr(10)||'&lt;/xsl:stylesheet&gt;');
   begin
      -- "|&#164;&#164;" is just a hack to get linebreaks, should be an easier way to achieve this
      select replace(xmltransform(p_docx_xml, l_xsl).GetClobVal(), '|&#164;&#164;', chr(10))
        into l_clob
        from dual;
      return l_clob;
   end;   
   -- extract plain text from docx file (this is the meat)
   procedure store_text (
      p_file_name    in       varchar2)
   is
      l_docx            blob;
      l_docx_unzip      blob;
      l_doc             clob;
      l_dest_offset     integer := 1;
      l_src_offset      integer := 1;
      l_lang_context    integer := dbms_lob.default_lang_ctx;
      l_warning         integer;
   begin
      -- get original file
      select orig_file
        into l_docx
        from samples_docx
       where filename = p_file_name;
      -- create lob locators
      dbms_lob.createtemporary(l_docx_unzip,false);
      dbms_lob.createtemporary(l_doc,false);
      -- use java to unzip the docx file and retrieve document.xml
      zip.unzip(l_docx, l_docx_unzip, 'word/document.xml');
      -- convert blob to clob
      dbms_lob.converttoclob
               ( dest_lob =&gt; l_doc
               , src_blob =&gt; l_docx_unzip
               , amount =&gt; dbms_lob.lobmaxsize
               , dest_offset =&gt; l_dest_offset
               , src_offset =&gt; l_src_offset
               , blob_csid =&gt; nls_charset_id('AL32UTF8') --in my case, it is stored as UTF8
               , lang_context =&gt; l_lang_context
               , warning =&gt; l_warning
               );
      -- transform clob via xsl to get clean text
      l_doc := get_text(xmltype(l_doc));
      -- update the column containing document text
      update samples_docx
         set text_content = l_doc
       where filename = p_file_name;
      -- clean lob locators, should be repeated in exception block
      dbms_lob.freetemporary(l_docx_unzip);
      dbms_lob.freetemporary(l_doc);
   end;
end;
/
</pre><b>Bringing it Together in Oracle APEX</b><br />
To test the code, you can create a simple upload page in APEX:<br />
<ul><li>Create new page</li>
<li>Form</li>
<li>Form on a procedure</li>
<li>&lt;schema name&gt; where you installed the application</li>
<li>Choose "sample_docx_p.store_docx" as stored procedure name</li>
<li>Accept defaults (or change to your liking)</li>
<li>Choose desired tab options</li>
<li>Leave Invoking Page/Button Label blank if you do not want an invoking page</li>
<li>Choose branch pages (can be the same as the one you are creating)</li>
<li>Accept defaults</li>
<li>Click Finish</li>
<li>Click Edit Page</li>
<li>Choose PXX_FILE_NAME, and change "Display as" from "Text item" to "File Browse..."</li>
<li>Apply changes</li>
</ul><br />
To add post processing to extract DOCX file content:<br />
<ul><li>Click Create under Processes</li>
<li>Choose PL/SQL</li>
<li>Give the process a name like "extract_text"</li>
<li>In the "Enter PL/SQL Page Process" dialog, paste "sample_docx_p.store_text(:PXX_FILE_NAME);" (XX being your page number)</li>
<li>Create process (and ensure the process comes after "Run Stored Procedure" process created by the page wizard</li>
</ul><br />
The last process could be implemented as a trigger on the samples_docx table.<br />
<br />
Run the page and test by uploading a DOCX document (or test it in my demo application).<br />
<br />
<b>Building More</b><br />
If you have a need to manipulate DOCX documents, this could probably be achieved by using the complete "ZIPImpl" as posted in <a href="http://www.oooforum.org/forum/viewtopic.phtml?t=24711">this article</a>, and using substitution variables in the same manner as I have described with RTF documents in an earlier post.<br />
<br />
The zip/unzip may also come in handy when handling other office files (like Open Office ODF).<br />
<br />
This is only a proof of concept, and the code is not production ready. Really! I'm not just saying that out of habit.<br />
<br />
The next (and final) part of the DOCX "series" will address how to index the plain text content using Oracle Text.
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'><span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='http://www.blogger.com/profile/13932482145147467490' itemprop='url'/>
<a class='g-profile' href='http://www.blogger.com/profile/13932482145147467490' rel='author' title='author profile'>
<span itemprop='name'>Håvard Kristiansen</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='http://monkeyonoracle.blogspot.com/2010/03/docx-part-i-how-to-extract-document.html' itemprop='url'/>
<a class='timestamp-link' href='http://monkeyonoracle.blogspot.ca/2010/03/docx-part-i-how-to-extract-document.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2010-03-01T15:48:00+01:00'>15:48</abbr></a>
</span>
<span class='post-comment-link'>
<a class='comment-link' href='http://monkeyonoracle.blogspot.ca/2010/03/docx-part-i-how-to-extract-document.html#comment-form' onclick=''>
3 comments:
    </a>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-422512928'>
<a href='http://www.blogger.com/post-edit.g?blogID=8575920265455783910&postID=396674855393371105&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='http://img2.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
</div>
<div class='post-footer-line post-footer-line-2'><span class='post-labels'>
Labels:
<a href='http://monkeyonoracle.blogspot.ca/search/label/apex' rel='tag'>apex</a>,
<a href='http://monkeyonoracle.blogspot.ca/search/label/docx' rel='tag'>docx</a>,
<a href='http://monkeyonoracle.blogspot.ca/search/label/oracle' rel='tag'>oracle</a>,
<a href='http://monkeyonoracle.blogspot.ca/search/label/plsql' rel='tag'>plsql</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'></div>
</div>
</div>
</div>

        </div></div>
      
<!-- google_ad_section_end -->
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='http://monkeyonoracle.blogspot.ca/search?updated-max=2010-09-03T13:18:00%2B02:00&amp;max-results=7&amp;reverse-paginate=true' id='Blog1_blog-pager-newer-link' title='Newer Posts'>Newer Posts</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='http://monkeyonoracle.blogspot.ca/search?updated-max=2010-03-01T15:48:00%2B01:00&amp;max-results=7' id='Blog1_blog-pager-older-link' title='Older Posts'>Older Posts</a>
</span>
<a class='home-link' href='http://monkeyonoracle.blogspot.ca/'>Home</a>
</div>
<div class='clear'></div>
<div class='blog-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='http://monkeyonoracle.blogspot.com/feeds/posts/default' target='_blank' type='application/atom+xml'>Posts (Atom)</a>
</div>
</div>
<script type="text/javascript">window.___gcfg = {'lang': 'en'};</script>
</div></div>
</div>
<div id='sidebar-wrapper'>
<div class='sidebar section' id='sidebar'><div class='widget Profile' id='Profile1'>
<h2>About me</h2>
<div class='widget-content'>
<a href='http://www.blogger.com/profile/13932482145147467490'><img alt='My Photo' class='profile-img' height='80' src='http://1.bp.blogspot.com/_8GtRvOur8pQ/S0XwES-MewI/AAAAAAAAABc/5Ez0Fhw7XhY/S220/DSC00174t.jpg' width='60'/></a>
<dl class='profile-datablock'>
<dt class='profile-data'>
<a class='profile-name-link g-profile' href='http://www.blogger.com/profile/13932482145147467490' rel='author' style='background-image: url(//www.blogger.com/img/logo-16.png);'>
Håvard Kristiansen
</a>
</dt>
<dd class='profile-data'>Norway</dd>
<dd class='profile-textblock'>An Oracle consultant proficient at copying code for Oracle databases since version 7.3.4</dd>
</dl>
<a class='profile-link' href='http://www.blogger.com/profile/13932482145147467490' rel='author'>View my complete profile</a>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=8575920265455783910&widgetType=Profile&widgetId=Profile1&action=editWidget&sectionId=sidebar' onclick='return _WidgetManager._PopupConfig(document.getElementById("Profile1"));' target='configProfile1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div class='ltr' id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/search?updated-min=2012-01-01T00:00:00%2B01:00&amp;updated-max=2013-01-01T00:00:00%2B01:00&amp;max-results=7'>2012</a>
<span class='post-count' dir='ltr'>(7)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2012_03_01_archive.html'>March</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2012_02_01_archive.html'>February</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2012_01_01_archive.html'>January</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/search?updated-min=2011-01-01T00:00:00%2B01:00&amp;updated-max=2012-01-01T00:00:00%2B01:00&amp;max-results=3'>2011</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2011_10_01_archive.html'>October</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/search?updated-min=2010-01-01T00:00:00%2B01:00&amp;updated-max=2011-01-01T00:00:00%2B01:00&amp;max-results=16'>2010</a>
<span class='post-count' dir='ltr'>(16)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2010_11_01_archive.html'>November</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2010_09_01_archive.html'>September</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2010_08_01_archive.html'>August</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2010_07_01_archive.html'>July</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2010_03_01_archive.html'>March</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='posts'>
<li><a href='http://monkeyonoracle.blogspot.ca/2010/03/ckeditor-image-browser-apex-style.html'>CKEditor Image Browser - APEX Style</a></li>
<li><a href='http://monkeyonoracle.blogspot.ca/2010/03/docx-part-ii-how-to-index-document.html'>DOCX Part II: How to Index Document Content With O...</a></li>
<li><a href='http://monkeyonoracle.blogspot.ca/2010/03/docx-part-i-how-to-extract-document.html'>DOCX Part I: How to Extract Document Content as Pl...</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2010_02_01_archive.html'>February</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2010_01_01_archive.html'>January</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/search?updated-min=2009-01-01T00:00:00%2B01:00&amp;updated-max=2010-01-01T00:00:00%2B01:00&amp;max-results=13'>2009</a>
<span class='post-count' dir='ltr'>(13)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2009_11_01_archive.html'>November</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2009_10_01_archive.html'>October</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2009_07_01_archive.html'>July</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2009_06_01_archive.html'>June</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle'>
<span class='zippy'></span>
</a>
<a class='post-count-link' href='http://monkeyonoracle.blogspot.ca/2009_05_01_archive.html'>May</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=8575920265455783910&widgetType=BlogArchive&widgetId=BlogArchive1&action=editWidget&sectionId=sidebar' onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' target='configBlogArchive1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget Label' id='Label1'>
<h2>Labels</h2>
<div class='widget-content list-label-widget-content'>
<ul>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/11gxe'>11gxe</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/adf'>adf</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/apache'>apache</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/apex'>apex</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/apex40'>apex40</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/aws'>aws</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/backup'>backup</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/chrome'>chrome</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/ckeditor'>ckeditor</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/dialog'>dialog</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/docx'>docx</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/dynamic%20actions'>dynamic actions</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/fckeditor'>fckeditor</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/file%20upload'>file upload</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/google%20maps'>google maps</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/hotkeys'>hotkeys</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/listener'>listener</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/off%20topic'>off topic</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/oracle'>oracle</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/pagination'>pagination</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/pdf'>pdf</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/plsql'>plsql</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/popup'>popup</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/reports'>reports</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/rtf'>rtf</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/spatial'>spatial</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/text%20index'>text index</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/utl_smtp'>utl_smtp</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/xe'>xe</a>
</li>
<li>
<a dir='ltr' href='http://monkeyonoracle.blogspot.ca/search/label/xml'>xml</a>
</li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=8575920265455783910&widgetType=Label&widgetId=Label1&action=editWidget&sectionId=sidebar' onclick='return _WidgetManager._PopupConfig(document.getElementById("Label1"));' target='configLabel1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget LinkList' id='LinkList1'>
<h2>Blogroll</h2>
<div class='widget-content'>
<ul>
<li><a href='http://apex-at-work.blogspot.com/'>Tobias Arnhold</a></li>
<li><a href='http://dpeake.blogspot.com/'>David Peake</a></li>
<li><a href='http://joelkallman.blogspot.com/'>Joel Kallman</a></li>
<li><a href='http://ora-00001.blogspot.com/'>Morten Bråten</a></li>
<li><a href='http://c2anton.blogspot.com/'>Anton Nielsen</a></li>
<li><a href='http://www.inside-oracle-apex.com/'>Patrick Wolf</a></li>
<li><a href='http://dgielis.blogspot.com/'>Dimitri Gielis</a></li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=8575920265455783910&widgetType=LinkList&widgetId=LinkList1&action=editWidget&sectionId=sidebar' onclick='return _WidgetManager._PopupConfig(document.getElementById("LinkList1"));' target='configLinkList1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div></div>
</div>
<!-- spacer for skins that want sidebar and main to be the same height-->
<div class='clear'>&#160;</div>
</div>
<!-- end content-wrapper -->
<div id='footer-wrapper'>
<div class='footer section' id='footer'></div>
</div>
</div></div>
<!-- end outer-wrapper -->
<script type='text/javascript'>
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type='text/javascript'>
try {
var pageTracker = _gat._getTracker("UA-9454943-1");
pageTracker._trackPageview();
} catch(err) {}</script>
<script type="text/javascript">
if (window.jstiming) window.jstiming.load.tick('widgetJsBefore');
</script><script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/58075626-widgets.js"></script>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type='text/javascript'>
if (typeof(BLOG_attachCsiOnload) != 'undefined' && BLOG_attachCsiOnload != null) { window['blogger_templates_experiment_id'] = "templatesV1";window['blogger_blog_id'] = '8575920265455783910';BLOG_attachCsiOnload('archive_'); }_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d8575920265455783910','//monkeyonoracle.blogspot.ca/2010_03_01_archive.html','8575920265455783910');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '8575920265455783910', 'bloggerUrl': 'http://www.blogger.com', 'title': 'Monkey on Oracle', 'pageType': 'archive', 'url': 'http://monkeyonoracle.blogspot.ca/2010_03_01_archive.html', 'canonicalUrl': 'http://monkeyonoracle.blogspot.com/2010_03_01_archive.html', 'canonicalHomepageUrl': 'http://monkeyonoracle.blogspot.com/', 'homepageUrl': 'http://monkeyonoracle.blogspot.ca/', 'blogspotFaviconUrl': 'http://monkeyonoracle.blogspot.ca/favicon.ico', 'enabledCommentProfileImages': true, 'adultContent': false, 'disableAdSenseWidget': false, 'analyticsAccountNumber': '', 'searchLabel': '', 'searchQuery': '', 'pageName': 'March 2010', 'pageTitle': 'Monkey on Oracle: March 2010', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'languageDirection': 'ltr', 'feedLinks': '\74link rel\75\42alternate\42 type\75\42application/atom+xml\42 title\75\42Monkey on Oracle - Atom\42 href\75\42http://monkeyonoracle.blogspot.com/feeds/posts/default\42 /\76\n\74link rel\75\42alternate\42 type\75\42application/rss+xml\42 title\75\42Monkey on Oracle - RSS\42 href\75\42http://monkeyonoracle.blogspot.com/feeds/posts/default?alt\75rss\42 /\76\n\74link rel\75\42service.post\42 type\75\42application/atom+xml\42 title\75\42Monkey on Oracle - Atom\42 href\75\42http://www.blogger.com/feeds/8575920265455783910/posts/default\42 /\76\n', 'meTag': '', 'openIdOpTag': '', 'imageSrcTag': '', 'latencyHeadScript': '\74script type\75\42text/javascript\42\76(function() { var b\75window,f\75\42jstiming\42,g\75\42tick\42;(function(){function d(a){this.t\75{};this.tick\75function(a,d,c){var e\75void 0!\75c?c:(new Date).getTime();this.t[a]\75[e,d];if(void 0\75\75c)try{b.console.timeStamp(\42CSI/\42+a)}catch(h){}};this[g](\42start\42,null,a)}var a;b.performance\46\46(a\75b.performance.timing);var m\75a?new d(a.responseStart):new d;b.jstiming\75{Timer:d,load:m};if(a){var c\75a.navigationStart,h\75a.responseStart;0\74c\46\46h\76\75c\46\46(b[f].srt\75h-c)}if(a){var e\75b[f].load;0\74c\46\46h\76\75c\46\46(e[g](\42_wtsrt\42,void 0,c),e[g](\42wtsrt_\42,\42_wtsrt\42,h),e[g](\42tbsd_\42,\42wtsrt_\42))}try{a\75null,\nb.chrome\46\46b.chrome.csi\46\46(a\75Math.floor(b.chrome.csi().pageT),e\46\0460\74c\46\46(e[g](\42_tbnd\42,void 0,b.chrome.csi().startE),e[g](\42tbnd_\42,\42_tbnd\42,c))),null\75\75a\46\46b.gtbExternal\46\46(a\75b.gtbExternal.pageT()),null\75\75a\46\46b.external\46\46(a\75b.external.pageT,e\46\0460\74c\46\46(e[g](\42_tbnd\42,void 0,b.external.startE),e[g](\42tbnd_\42,\42_tbnd\42,c))),a\46\46(b[f].pt\75a)}catch(n){}})();b.tickAboveFold\75function(d){var a\0750;if(d.offsetParent){do a+\75d.offsetTop;while(d\75d.offsetParent)}d\75a;750\76\75d\46\46b[f].load[g](\42aft\42)};var k\75!1;function l(){k||(k\75!0,b[f].load[g](\42firstScrollTime\42))}b.addEventListener?b.addEventListener(\42scroll\42,l,!1):b.attachEvent(\42onscroll\42,l);\n })();\74/script\076', 'mobileHeadScript': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/d6f37bb30c327165', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'testHtml5CssSrc': 'https://www.blogger.com/static/v1/widgets/2412321170-css_bundle_html5.css', 'sf': 'n'}}, {'name': 'skin', 'data': {'vars': {'sidebartextcolor': '#666666', 'linkcolor': '#5588aa', 'visitedlinkcolor': '#999999', 'textcolor': '#333333', 'headerfont': 'normal normal 78% \47Trebuchet MS\47,Trebuchet,Arial,Verdana,Sans-serif', 'pagetitlefont': 'normal normal 200% Georgia, Serif', 'bgcolor': '#ffffff', 'descriptioncolor': '#999999', 'titlecolor': '#cc6600', 'bordercolor': '#cccccc', 'postfooterfont': 'normal normal 78% \47Trebuchet MS\47, Trebuchet, Arial, Verdana, Sans-serif', 'pagetitlecolor': '#666666', 'bodyfont': 'normal normal 100% Georgia, Serif', 'endSide': 'right', 'startSide': 'left', 'descriptionfont': 'normal normal 78% \47Trebuchet MS\47, Trebuchet, Arial, Verdana, Sans-serif', 'sidebarcolor': '#999999'}, 'override': ''}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '/?view\75classic'}, 'flipcard': {'name': 'flipcard', 'url': '/?view\75flipcard'}, 'magazine': {'name': 'magazine', 'url': '/?view\75magazine'}, 'mosaic': {'name': 'mosaic', 'url': '/?view\75mosaic'}, 'sidebar': {'name': 'sidebar', 'url': '/?view\75sidebar'}, 'snapshot': {'name': 'snapshot', 'url': '/?view\75snapshot'}, 'timeslide': {'name': 'timeslide', 'url': '/?view\75timeslide'}}}]);
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar', null, document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar', null, document.getElementById('BlogArchive1'), {'languageDirection': 'ltr'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LabelView', new _WidgetInfo('Label1', 'sidebar', null, document.getElementById('Label1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LinkListView', new _WidgetInfo('LinkList1', 'sidebar', null, document.getElementById('LinkList1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', null, document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', null, document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', null, document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/3650913290-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/4138445517-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'null', null, document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'href': 'http://monkeyonoracle.blogspot.ca/', 'title': 'Home', 'isCurrentPage': false}], 'mobile': false}, 'displayModeFull'));
</script>
</body>
</html>
