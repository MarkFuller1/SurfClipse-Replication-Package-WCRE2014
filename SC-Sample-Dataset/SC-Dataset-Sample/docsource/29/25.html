<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">
 <head>
  <title>prepared statement incompatibility</title>
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
 
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="alternate" type="application/rss+xml" title="PostgreSQL News" href="http://www.postgresql.org/news.rss" />
  <link rel="alternate" type="application/rss+xml" title="PostgreSQL Events" href="http://www.postgresql.org/events.rss" />
  <link rel="stylesheet" type="text/css" media="screen" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/themes/smoothness/jquery-ui.css" />
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.js"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.js"></script>
  <script type="text/javascript" src="/media-archives/js/jquery/jquery.ui.selectmenu.js"></script>
  <link rel="stylesheet" type="text/css" media="screen" href="/media-archives/css/jquery/jquery.ui.selectmenu.css" />
  <style type="text/css" media="screen" title="Normal Text">@import url("/media-archives/css/archives.css");</style>
  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1345454-2']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<script type="text/javascript">
function onThreadSelect() {
   document.location.href = '/message-id/' + document.getElementById('thread_select').value;
}

$(function(){
   $('select#thread_select').selectmenu({
      style:'dropdown',
      escapeHtml:true,
      icons:[
         {find:'.hasatt', icon: 'ui-icon-document'},
      ]
   });
});
</script>

 </head>
 <body>
  <div id="pgContainerWrap">
   <div id="pgContainer">
    <span class="txtOffScreen"><a href="#pgContent" title="Skip site navigation" accesskey="1">Skip site navigation</a> (1)</span>
    <span class="txtOffScreen"><a href="#pgContentWrap" title="Skip section navigation" accesskey="2">Skip section navigation</a> (2)</span>
    <div id="pgHeaderContainer">
     <div id="pgSearch">
      <form method="get" action="http://www.postgresql.org/search/">
       <div>
        <h2 class="pgBlockHide"><label for="q">Search</label></h2>
        <input id="q" name="q" type="text" size="20" maxlength="255" onfocus="if( this.value==this.defaultValue ) this.value='';" value="Search" accesskey="s" /><input name="a" type="hidden" value="1"/><input id="submit" name="submit" type="submit" value="Search" />
       </div>
      </form>
      <h2 class="pgBlockHide">Peripheral Links</h2>
      <div id="pgSearchNav">
       <ul id="pgSearchNavList">
        <li>
          Text Size: <a href="#" onkeypress="return false;" onclick="setActiveStyleSheet('Normal Text'); return false;" title="Normal Text Size">Normal</a> / <a href="#" onkeypress="return false;" onclick="setActiveStyleSheet('Large Text'); return false;" title="Large Text Size">Large</a>
        </li>
        <li>
          <a href="/about/donate">Donate</a>
        </li>
        <li>
          <a href="/about/contact">Contact</a>
        </li>
       </ul>
      </div>
     </div>
	 <div id="pgHeader">
	  <div id="pgHeaderLogoLeft">
	   <a href="http://www.postgresql.org/"><img alt="PostgreSQL" height="80" width="230" src="/media/img/layout/hdr_left.png" /></a>
	  </div>
	  <div id="pgHeaderLogoRight">
	   <a href="/"><img width="210" height="80" alt="The world's most advanced open source database." src="/media/img/layout/hdr_right.png" /></a>
	  </div>
	 </div> <!-- pgHeader -->

	 <div id="pgTopNav">
	  <div id="pgTopNavLeft"><img width="7" height="23" alt="" src="/media/img/layout/nav_lft.png" /></div>
	  <div id="pgTopNavRight"><img width="7" height="23" alt="" src="/media/img/layout/nav_rgt.png" /></div>
	  <ul id="pgTopNavList">
	   <li><a href="http://www.postgresql.org/" title="Home">Home</a></li>
	   <li><a href="http://www.postgresql.org/about" title="About">About</a></li>
	   <li><a href="http://www.postgresql.org/download" title="Download">Download</a></li>
	   <li><a href="http://www.postgresql.org/docs" title="Documentation">Documentation</a></li>
	   <li><a href="http://www.postgresql.org/community" title="Community">Community</a></li>
	   <li><a href="http://www.postgresql.org/developer" title="Developers">Developers</a></li>
	   <li><a href="http://www.postgresql.org/support" title="Support">Support</a></li>
	   <li><a href="http://www.postgresql.org/account" title="Your account">Your account</a></li>
	  </ul>
	 </div> <!-- pgTopNav -->
	</div> <!-- pgHeaderContainer -->
	<div id="pgContent">
         <div id="pgSideWrap">
          <div id="pgSideNav">
           <ul>
	     <li><a href="http://www.postgresql.org/community/">Community</a></li>
	     <li><a href="http://www.postgresql.org/community/contributors/">Contributors</a></li>
	     <li><a href="/list/">Mailing Lists</a>
	       <ul>
		 <li><a href="/community/lists/subscribe/">Subscribe</a></li>

                <li><a href="/list/group/2/">User lists</a>

	        </li>

                <li><a href="/list/group/1/">Developer lists</a>

	        </li>

                <li><a href="/list/group/4/">Regional lists</a>

	        </li>

                <li><a href="/list/group/8/">Associations</a>

	        </li>

                <li><a href="/list/group/6/">User groups</a>

	        </li>

                <li><a href="/list/group/5/">Project lists</a>

	         <ul>

                  <li><a href="/list/pgadmin-hackers/">pgadmin-hackers</a></li>

                  <li><a href="/list/pgadmin-support/">pgadmin-support</a></li>

                  <li><a href="/list/pgsql-jdbc/">pgsql-jdbc</a></li>

                  <li><a href="/list/pgsql-odbc/">pgsql-odbc</a></li>

                  <li><a href="/list/pgsql-pkg-debian/">pgsql-pkg-debian</a></li>

                  <li><a href="/list/pgsql-pkg-yum/">pgsql-pkg-yum</a></li>

                  <li><a href="/list/psycopg/">psycopg</a></li>

		 </ul>

	        </li>

                <li><a href="/list/group/7/">Inactive lists</a>

	        </li>

               </ul>
	     </li>
	     <li><a href="http://www.postgresql.org/community/irc">IRC</a></li>
	     <li><a href="http://www.postgresql.org/community/user-groups/">Local User Groups</a></li>
	     <li><a href="http://www.postgresql.org/about/users">Featured Users</a></li>
	     <li><a href="http://www.postgresql.org/community/international">International Sites</a></li>
	     <li><a href="http://www.postgresql.org/community/propaganda">Propaganda</a></li>
	     <li><a href="http://www.postgresql.org/community/resources">Resources</a></li>
	     <li><a href="http://www.postgresql.org/community/weeklynews/">Weekly News</a></li>
           </ul>
          </div>
        </div> <!-- pgSideWrap -->
        <div id="pgContentWrap">

<h2>prepared statement incompatibility</h2>
<table class="message">
 <tr>
  <th>From:</th>
  <td>&quot;Byron Nikolaidis&quot; &lt;ByronN(at)Routescape(dot)com&gt;</td>
 </tr>
 <tr>
  <th>To:</th>
  <td>&lt;pgsql-jdbc(at)postgresql(dot)org&gt;</td>
 </tr>

 <tr>
  <th>Subject:</th>
  <td>prepared statement incompatibility</td>
 </tr>
 <tr>
  <th>Date:</th>
  <td>2005-06-28 20:25:25</td>
 </tr>
 <tr>
  <th>Message-ID:</th>
  <td><a href="/message-id/6E0907A94904D94B99D7F387E08C4F57073220@FALCON.INSIGHT">6E0907A94904D94B99D7F387E08C4F57073220@FALCON.INSIGHT</a> (view <a href="/message-id/raw/6E0907A94904D94B99D7F387E08C4F57073220@FALCON.INSIGHT">raw</a> or <a href="/message-id/flat/6E0907A94904D94B99D7F387E08C4F57073220@FALCON.INSIGHT">flat</a>)</td>
 </tr>
 <tr>
  <th>Thread:</th>
  <td>
   <select id="thread_select" onchange="onThreadSelect()">
<option value="6E0907A94904D94B99D7F387E08C4F57073220@FALCON.INSIGHT" selected="selected">2005-06-28 20:25:25 from &quot;Byron Nikolaidis&quot; &lt;ByronN(at)Routescape(dot)com&gt;</option>
<option value="9542C79E-EF74-4336-86F6-85D2B140FD6C@fastcrypt.com">&nbsp;2005-06-28 20:43:30 from Dave Cramer &lt;pg(at)fastcrypt(dot)com&gt;</option>

   </select>
  </td>
 </tr>
 <tr>
  <th>Lists:</th>
  <td><span class="listname"><a href="/list/pgsql-jdbc/since/200506282025">pgsql-jdbc</a></span></td>
 </tr>
</table>
<div class="bodywrapper">

<pre>Hello all,

 

We are using Postgres 8.0.3, and are attempting to upgrade to the JDBC
8.x drivers, but have discovered that PreparedStatements that used to
work no longer do so.   This is seen where the Java type does not match
the database type, such as attempting to use
preparedStatement.setString(1, &quot;1&quot;)   where the database type is
actually an integer (see stacktrace below).     These worked fine on
previous driver versions (such as 7.4).      

 

If we set the protocolVersion=2,  the jdbc 8.x drivers will work fine
also, but I&#39;m not so sure we really want to do that.

 

At first, I thought this was related to the use of server side prepares.
But I have set the prepareThreshold=0 and verified it was being set by
checking for it in the pgconnection and pgstatement, but it appears to
have no effect.

 

Can anyone clarify what exactly has changed with prepared statements and
why it used to work previously?    

 

Thanks,

 

Byron

 

Exception in thread &quot;main&quot; java.sql.SQLException: ERROR: column &quot;ticket&quot;
is of type integer but expression is of type character varying

        at
org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecu
torImpl.java:1471)

        at
org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImp
l.java:1256)

        at
org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:
175)

        at
org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Stateme
nt.java:389)

        at
org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdb
c2Statement.java:330)

        at
org.postgresql.jdbc2.AbstractJdbc2Statement.executeUpdate(AbstractJdbc2S
tatement.java:282)

        at test.routescape.orm.util.DriverTest.main(DriverTest.java:49)

 

</pre>




<h3>Responses</h3>
<ul>

<li><a href="/message-id/9542C79E-EF74-4336-86F6-85D2B140FD6C@fastcrypt.com">Re: prepared statement incompatibility</a> at 2005-06-28 20:43:30 from Dave Cramer</li>

</ul>



<h3>pgsql-jdbc by date</h3>
<blockquote>
 <table border="0">
  
   <tr><td><a href="/message-id/1119990583.698.96.camel@archimedes.mirlogic.com">Next</a>:</td><td><b>From:</b> Mark Lewis</td><td><b>Date:</b> 2005-06-28 20:29:42</td></tr>
   <tr><td></td><td colspan="2"><b>Subject</b>: Re: OT: easiest way to create a custom PreparedStatement</td></tr>
  
  
   <tr><td><a href="/message-id/200506281455.09688.cservin@cromagnon.com">Previous</a>:</td><td><b>From</b>: Craig Servin</td><td><b>Date</b>: 2005-06-28 19:55:09</td></tr>
   <tr><td></td><td colspan="2"><b>Subject</b>: Re: OT: easiest way to create a custom PreparedStatement class</td></tr>
  
 </table>
</blockquote>




</div>

        </div> <!-- pgContentWrap-->
     <br class="pgClearBoth" />
    </div> <!-- pgContent -->
	<div id="pgFooter">
         <a class="navFooter" href="http://www.postgresql.org/about/privacypolicy">Privacy Policy</a> |
         <a class="navFooter" href="http://www.postgresql.org/about/">About PostgreSQL</a><br/>
	 Copyright &copy; 1996-2013 The PostgreSQL Global Development Group
	</div> <!-- pgFooter -->
   </div>
  </div> <!-- pgContainerWrap -->
 </body>
</html>
