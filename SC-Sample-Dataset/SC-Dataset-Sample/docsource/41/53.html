<head>
 <meta http-equiv="Content-Type" content="text/html ">
 <title>'RE: Invalid byte 2 of 2-byte UTF-8 sequence?' - MARC</title>
 <link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body bgcolor="#ffffff" text="#000000" link="#0000C0" vlink="#800080">
<pre><b>[<a href="?l=axis-c-user&m=117517701000384&w=2">prev in list</a>] [<a href="?l=axis-c-user&m=117558219922692&w=2">next in list</a>] [<a href="?l=axis-c-user&m=117517701000384&w=2">prev in thread</a>] [<font color="#c0c0c0">next in thread</font>] </b>
<b><font size=+1>
List:       <a href="?l=axis-c-user&r=1&w=2">axis-c-user</a>
Subject:    <a href="?t=117508095000001&r=1&w=2">RE: Invalid byte 2 of 2-byte UTF-8 sequence?</a>
From:       <a href="?a=109778692100002&r=1&w=2">Nadir Amra &lt;amra () us ! ibm ! com&gt;</a>
Date:       <a href="?l=axis-c-user&r=1&w=2&b=200703">2007-03-29 23:05:42</a>
Message-ID: <a href="?i=OF8FE9E0A5.CF3B5473-ON862572AD.007E75BD-862572AD.007EDDCE%20()%20us%20!%20ibm%20!%20com">OF8FE9E0A5.CF3B5473-ON862572AD.007E75BD-862572AD.007EDDCE () us ! ibm ! com</a></font>
[<a href="?l=axis-c-user&m=117520946111572&q=raw">Download message RAW</a>]</b>

Iwan,

It would be a fix if you were running only in a process that is consistent 
with ISO-8859-1 encoding, but that is not the case.  From the client-side, 
the easiest fix would be to provide a  toUTF8() function as OS/400 does. 
The proper fix for client/server side is to ensure all data stored in 
various classes is wchar and to translate wchar to utf8. 
 
Nadir K. Amra


"Iwan Tomlow" &lt;iwan.tomlow@seagha.com&gt; wrote on 03/29/2007 09:04:32 AM:

&gt; Thanks for pointing that out, I should have been able to find that one 
myself.
&gt; Most reasonable thing for me to do seems to apply the proposed 
&gt; workaround from AXISCPP-964, i.e.
&gt; 
&gt; In SoapSerializer.cpp, turn
&gt; serialize( "&lt;?xml version='1.0' encoding='utf-8' ?&gt;", NULL);
&gt; into
&gt; serialize( "&lt;?xml version='1.0' encoding='ISO-8859-1' ?&gt;", NULL); 
&gt; 
&gt; I'm no expert on character-encoding, but since "AxisChar" is defined
&gt; in Gdefine.hpp as a normal "char" anyway, isn't this simply the best
&gt; way to fix the issue completely?
&gt; 
&gt; Kind regards,
&gt; Iwan
&gt; 
&gt; 
&gt; -----Original Message-----
&gt; From: Nadir Amra [mailto:amra@us.ibm.com] 
&gt; Sent: donderdag 29 maart 2007 0:52
&gt; To: Apache AXIS C User List
&gt; Cc: Apache AXIS C User List
&gt; Subject: Re: Invalid byte 2 of 2-byte UTF-8 sequence?
&gt; 
&gt; Iwan,
&gt; 
&gt; This is an existing problem.  See AXISCPP-964.  If anyone want to 
&gt; provide a patch, I can include the patch. If you have a solution to 
&gt; fix your particular problem, then please provide the patch. 
&gt; 
&gt; Nadir K. Amra
&gt; 
&gt; 
&gt; "Iwan Tomlow" &lt;iwan.tomlow@seagha.com&gt; wrote on 03/28/2007 06:22:00 AM:
&gt; 
&gt; &gt; Hi,
&gt; &gt; 
&gt; &gt; when connecting an Axis-C client (v1.5) to an Axis-java webservice, 
&gt; &gt; the return message has the following error:
&gt; &gt; 
&gt; &gt; &lt;soapenv:Fault&gt;
&gt; &gt;   &lt;faultcode&gt;soapenv:Server.userException&lt;/faultcode&gt;
&gt; &gt;    &lt;faultstring&gt;java.io.UTFDataFormatException: Invalid byte 2 of 2- 
&gt; &gt; byte UTF-8 sequence.&lt;/faultstring&gt;
&gt; &gt; 
&gt; &gt; The only difference with all other working requests, seems the company 

&gt; &gt; name containing "GÜTER".
&gt; &gt; When debugging, the U-umlaut is showing correctly everywhere, but 
&gt; &gt; apparently the receiving webservice isn't getting it correctly.
&gt; &gt; The source message generated by Axis-C++ looks like this in 
TCPMonitor:
&gt; &gt; 
&gt; &gt; Content-Type: text/xml; charset=UTF-8
&gt; &gt; 
&gt; &gt; &lt;?xml version='1.0' encoding='utf-8' ?&gt; ...
&gt; &gt;                   &lt;ns1:company&gt;ROTTMANN HEINRICH G TER&lt;/ns1:company&gt;
&gt; &gt; 
&gt; &gt; So it seems the character is indeed being encoded incorrectly by 
Axis-C?
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Does anyone have any hints to get this working?
&gt; &gt; 
&gt; &gt; By the way, I receive this company-name via another webservice, and I 
&gt; &gt; notice that they sent me this:
&gt; &gt; 
&gt; &gt; &lt;employerName&gt;ROTTMANN HEINRICH G&amp;#xDC;TER&lt;/employerName&gt;
&gt; &gt; 
&gt; &gt; Maybe there is a way to configure Axis-C to do the same, sending a 
&gt; &gt; character reference to avoid the encoding-mismatch?
&gt; 
&gt; 
&gt; ---------------------------------------------------------------------
&gt; To unsubscribe, e-mail: axis-c-user-unsubscribe@ws.apache.org
&gt; For additional commands, e-mail: axis-c-user-help@ws.apache.org
&gt; 
&gt; 
&gt; ---------------------------------------------------------------------
&gt; To unsubscribe, e-mail: axis-c-user-unsubscribe@ws.apache.org
&gt; For additional commands, e-mail: axis-c-user-help@ws.apache.org
&gt; 


---------------------------------------------------------------------
To unsubscribe, e-mail: axis-c-user-unsubscribe@ws.apache.org
For additional commands, e-mail: axis-c-user-help@ws.apache.org


<b>[<a href="?l=axis-c-user&m=117517701000384&w=2">prev in list</a>] [<a href="?l=axis-c-user&m=117558219922692&w=2">next in list</a>] [<a href="?l=axis-c-user&m=117517701000384&w=2">prev in thread</a>] [<font color="#c0c0c0">next in thread</font>] </b>
</pre>
  </pre><br><center>
    <a href="?q=configure">Configure</a> | 

    <a href="?q=about">About</a> |
    <a href="?q=news">News</a> |
    <a href="mailto:webguy@marc.info?subject=Add a list to MARC">Add&nbsp;a&nbsp;list</a> |
    Sponsored&nbsp;by&nbsp;<a href="http://www.korelogic.com/">KoreLogic</a>
</center>
</body>
</html>
