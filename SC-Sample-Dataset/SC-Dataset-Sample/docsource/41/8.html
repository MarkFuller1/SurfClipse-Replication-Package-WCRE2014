
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link href="/style/default.css" rel="stylesheet" type="text/css" />
    <link href="/style/hidefromprint.css" rel="stylesheet" type="text/css" media="print" /> 
    <link rel="SHORTCUT ICON" href="/favicon.ico" />
    <script language="JavaScript1.2" src="/js/main.js"type="text/javascript"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
	
    <meta name="COPYRIGHT" content="Copyright (c) 2004-2013 Progress Software Corporation" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>
        java.io.utfdataformatexception invalid byte - Re:  Original encoding lost after transformation
    </title>
    <meta name="DESCRIPTION" content="Re:  Original encoding lost after transformation" />
    <meta name="KEYWORDS" content="java.io.utfdataformatexception invalid byte,utfdataformatexception,utfdataformatexception invalid byte 1,html original encoding,java.io.utfdataformatexception encoding,xslt lost encoding,java.io.utfdataformatexception,java.io.utfdataformatexception invalid byte 2 of,java.io.utfdataformatexception invalid byte sequen,java.io.utfdataformatexception invalid first byte, xml" />
    <link href="/style/lists.css" rel="stylesheet" type="text/css" />
	
	<script type="text/javascript">
		$(document).ready( function(){
			$("#scooppop").hide();
			var to=setTimeout("showDiv()",15000);        
		});
   
		function showDiv()
		{
			$("#scooppop").show();
		};
    </script>
	
	
	<script type="text/javascript">
		function toggleDiv(divId) {
		   $("#"+divId).toggle();
		}
	</script>
	
	<style type="text/css">
<!--

.popup {
	margin-left:-300px;
	margin-top:-200px;
	left:50%;
	top:50%;
	position:fixed;
	z-index:900;
	padding: 0px;
	width:600px;
	text-decoration: none;
	text-align: center;
	background: #348ec0;

	/*Box shadow*/
	-webkit-box-shadow: 0 3px 30px hsla(0, 0%, 0%, .89) /*Shadow*/;
	-moz-box-shadow: 0 3px 30px hsla(0, 0%, 0%, .89) /*Shadow*/;
	box-shadow: 0px 3px 30px hsla(0, 0%, 0%, .89) /*Shadow*/;
}

.close {
	text-align:right;
	font-family:Arial, Helvetica, sans-serif;
	font-size:11px;
	margin: 12px 20px 10px 0px;
}

-->
</style>

	
</head>
<body>
    <div id="TipLayer" style="visibility:hidden;position:absolute;z-index:1000;top:-100"></div>
    <script language="JavaScript1.2" src="/js/style.js" type="text/javascript"></script>
    <div id="wholeBody">



        <div id="pageHeader">

			<div class="header-wrap"> <!-- wrap that header yo -->

				<div class="logo-hold">
					<a href="/index.html" class="main-logo"><img border="0" alt="Stylus Studio XML Editor" src="/images/global/stylus-studio-xml.jpg" border="0" /></a>
				</div>

				<div class="head-social-links"> <!-- social links -->  
					<!-- Place this tag where you want the +1 button to render -->
					<g:plusone annotation="none"></g:plusone>
			
					<!-- Place this render call where appropriate -->
					<script type="text/javascript">
					  (function() {
						var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
						po.src = 'https://apis.google.com/js/plusone.js';
						var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
					  })();
					</script>&nbsp;&nbsp;
				</div> <!-- social links -->  
	  
				<div class="head-links"> 
					<div class="head-tm">XML PRODUCTIVITY THROUGH INNOVATION &trade;</div>
					<div class="head-links-text">
						<a runat="server" href="http://www.stylusstudio.com/SSDN/">	Stylus Studio&reg; Developer Network</a>
						&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
						<a runat="server" href="http://www.stylusstudio.com/XML-Editor-Blog/">XML Editor Blog</a>
						&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
						<a runat="server" href="http://www.stylusstudio.com/xml_contact.html">Contact Us</a>
					</div>
				</div>

			</div> <!-- wrap that header yo --> 
			
			<table id="menustrip" cellspacing="0" cellpadding="0">
                <tr>
                    <td align="center">
                        <a title="XML Products" class="menuItem" href="http://www.stylusstudio.com/xml_product_index.html">PRODUCTS</a></td>
                    <td align="center">
                        <a title="Download Stylus Studio now" class="menuItem" href="http://www.stylusstudio.com/xml_download.html">DOWNLOAD</a></td>
                    <td align="center">
                        <a title="Buy Stylus Studio XML IDE" class="menuItem" href="http://www.stylusstudio.com/buy/">BUY</a></td>
                    <td align="center">
                        <a title="XML Developer Resources" class="menuItemActive" href="http://www.stylusstudio.com/learn_xml.html">LEARN</a></td>
                    <td align="center">
                        <a title="Product support for Stylus Studio" class="menuItem" href="http://www.stylusstudio.com/xml_support.html">SUPPORT</a></td>
                    <td align="center">
                        <a title="Company Information" class="menuItem" href="http://www.stylusstudio.com/xml_company_index.html">COMPANY</a></td>

				<td style="border: 0;" align="right" nowrap="nowrap">
					<a runat="server" class="menuAlt" href="/buy/cart.html">
						<img alt="Shopping cart" hspace="3" align="middle" vspace="0" src="/images/cart.png" style="margin: -7px 0px 0px 0px;" height="17px" /> Cart</a> 
				</td>

                    <td style="border: 0;" align="right" nowrap="nowrap">
					<form style="margin: 2px; padding: 0" method="get" action="http://www.stylusstudio.com/search/">
						<input onclick="this.select();" style="border: #666 1px solid; font-size: x-small;
							vertical-align: middle;" name="q" size="30" value="" /><input type="image"
								alt="Search Stylus Studio" src="/images/search-icon.png" style="margin: 0px 7px -3px 5px; height:17px;"
								style="vertical-align: middle;" />

					</form>
            </td>



                </tr>
            </table>           
           
        </div>



        <div id="mainContent">
        
<div style="margin: 10px 0px 10px 0px;">		

<div class="quickjump-wrap top">
<a href="/xml_download.html"><img src="/images/xml-editor-download.png" border="0" class="quickjump-image" /></a><div class="quickjump"><a href="/download-xml-editor.html">XML Editor - Download a Free Trial ></a></div>
<a href="/xml_product_new_features.html"><img src="/images/new-xml-editor.png" border="0" class="quickjump-image top" /></a><div class="quickjump"><a href="/xml_product_new_features.html">See What's New ></a></div>
<a href="/buy/"><img src="/images/xml-editor-cart.png" border="0" class="quickjump-image top" /></a><div class="quickjump"><a href="/buy/">Buy Now ></a></div>
</div>

</div>

            

<table id="mainTbl">
	<tr id="mainTblRow">
		<td id="mainTblContentCell" valign="top">

		<p style="background:#D8D8D8;padding:3px">
		<a style="margin:5px;" href="/xsllist/">[XSL-LIST Mailing List Archive Home]</a>
		<a style="margin:5px;" href="bythread.html">[By Thread]</a>
		<a style="margin:5px;" href="index.html">[By Date]</a>
		<a style="margin:5px;" href="/blogs/xsllist/">[Recent Entries]</a>
		<a style="margin:5px;" href="http://www.xquery.com/forums/forum_topics.asp?FID=4">[Reply To This Message]</a>

</p>


<H1>Re:  Original encoding lost after transformation</H1> 

<div class="vidLink"><a 
href="/videos/xsltedit1/xsltedit1.html" 
title="'Editing XSL Stylesheets' video">Play the 
video</a></div>

<!--X-Head-of-Message-->
<div class="msgHead"><table><tr><td>
 
<em>Subject</em>: Re:  Original encoding lost after transformation<br>

 
<em>From</em>: David Carlisle &lt;<a href="mailto:davidc@D...">davidc@xxxxxxxxx</a>&gt;<br>

 
<em>Date</em>: Fri, 18 Feb 2005 11:30:58 GMT<br>

</td></tr></table></div>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<div>
<!--X-Head-Body-Sep-End-->
<div style="float:left;padding:0px 10px 10px 0"><a 
href="http://www.stylusstudio.com/xml_download.html" 
alt="Download A Free Trial of Stylus Studio 6 XML Enterprise Edition Today!"
><img src="/images/get_stylus.gif" alt="java.io.utfdataformatexception invalid byte"></a></div><!--X-Body-of-Message-->
<pre>The encoding of the source file is interpreted by the XML parser which
just reports unicode character positions in an encoding neutral way so
xslt doesn't have any record of the original encoding.

You can ask that it outputs in latin 1 by going
&lt;xsl:output encoding=&quot;iso-8859-1&quot;/&gt;

Note however that every XML application has to accept utf8 but support
for iso-8859-1 is an optional feature so (in theory at least) your
resulting document will be less portable.

You say you got:

  Some transformations (depending on the source xml) now fail on the
  second pass as the first pass returns data with the wrong UTF-8 declaration
  above. The error message is:
  
  java.io.UTFDataFormatException: Invalid byte 2 of 2-byte UTF-8 sequence

It's most unlikely that XSLT writes out a file with a bad encoding
declaration so this is probably an indication of another error
somewhere in your processing chain.

Note that if you are doing two transformations back to back from java
(or any other similar API)  you almost certainly should not be encoding
and decoding the intermediate stage at all. Most XSLT processors will
allow you to pass the result tree of the first transform directly to the
second transform without having to serialise it in some encoding and
then re-parse it.

David


________________________________________________________________________
This e-mail has been scanned for all viruses by Star. The
service is powered by MessageLabs. For more information on a proactive
anti-virus service working around the clock, around the globe, visit:
http://www.star.net.uk
________________________________________________________________________

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI--><div align='center' style='border:0'><a href='http://www.xquery.com/forums/forum_topics.asp?FID=4'><img border='0' src='/images/reply_button_r01.gif' ></img></a></div>
<div class="botThread">
<table><tr><th>Current Thread</th></tr>
       <tr><td><ul>
<LI><a href="bythread.html#00971"> Original encoding lost after transformation</A>
    <UL><LI><A name="00971" href="post10970.html" title="Hi list,

I seem to have an encoding problem with my xsl transformations. I'm
trying to transform incoming xml data using two stylesheets.

The incoming xml has the ISO-8859-1 encoding. Its declaration is like
this:

&lt;?xml version=&quot;1.0&quot; encodi......">guray</A> - 18 Feb 2005 11:02:46 -0000
<ul>
<li><span class="botThread"><em>David Carlisle</em> - 18 Feb 2005 11:31:38 -0000</span>&nbsp;<b>&lt;=</b>
<ul>
<LI><a name="00973" href="post30970.html" title="Hmm, I think you are right. The problem must occur somewhere else. I can
properly pass the 2nd transformation after specifying the ISO-8859-1
encoding when serializing the resulting DOM document to a string.
However, the XML declaration still specifies UTF......">guray</a> - 18 Feb 2005 13:36:18 -0000
</li>
</ul>
</li>
</ul>
</UL>
</ul>
</td></tr>
</table>
</div>

<div class="botLinks">
<table>
<tr><th><- Previous</th><th>Index</th><th>Next -></th></tr>
<tr><td><a href="post10970.html" title="Hi list,

I seem to have an encoding problem with my xsl transformations. I'm
trying to transform incoming xml data using two stylesheets.

The incoming xml has the ISO-8859-1 encoding. Its declaration is like
this:

&lt;?xml version=&quot;1.0&quot; encodi......"> Original encoding lost after </a>, <em>guray</em>
</td>
    <td><a href="bythread.html#00972">Thread</a></td>
    <td><a href="post30970.html" title="Hmm, I think you are right. The problem must occur somewhere else. I can
properly pass the 2nd transformation after specifying the ISO-8859-1
encoding when serializing the resulting DOM document to a string.
However, the XML declaration still specifies UTF......">Re:  Original encoding lost af</a>, <em>guray</em>
</td>
</tr>
<tr><td><a href="post10970.html" title="Hi list,

I seem to have an encoding problem with my xsl transformations. I'm
trying to transform incoming xml data using two stylesheets.

The incoming xml has the ISO-8859-1 encoding. Its declaration is like
this:

&lt;?xml version=&quot;1.0&quot; encodi......"> Original encoding lost after </a>, <em>guray</em>
</td>
    <td><a href="index.html#00972">Date</a></td>
    <td><a href="post30970.html" title="Hmm, I think you are right. The problem must occur somewhere else. I can
properly pass the 2nd transformation after specifying the ISO-8859-1
encoding when serializing the resulting DOM document to a string.
However, the XML declaration still specifies UTF......">Re:  Original encoding lost af</a>, <em>guray</em>
</td>
</tr>
<tr><td></td>
    <td><a href="../">Month</a></td>
    <td></td>
</tr>
</table>
<p>
</div>

 </td>
		<td id="mainTbladCol1">
		
<div class="calloutbuy">      
    
   
     <h3 class="icon2">PURCHASE STYLUS STUDIO ONLINE TODAY!</h3>
         <p><i>Purchasing Stylus Studio from our online shop is Easy, Secure and Value Priced! </i></p>
<!--    <p style="margin-bottom:0;"><i>Get our award-winning XML development environment for 50% off when you purchase from any product from our easy, secure, <a href=\"/buy/\">online shop!</a><br><br> Coupon Code:<br /> <code>HALF-QKQ2-OFF</code></i></p>
-->        
    
    <div style="text-align:center">
        <a runat="server" href="http://www.stylusstudio.com/buy/"><img src="/images/buynow1.gif" alt="Buy Stylus Studio Now" /></a>
    </div>
</div>


 
    <div class="calloutfeatured"> 
        <h3 class="icon0">Download The World's Best XML IDE!</h3>
        <p>Accelerate XML development with our award-winning XML IDE - <a href="/xml_download.html" runat="server">Download</a> a free trial today!</p> 
    </div>
        <!-- 
<map name="xml">
	<area href="/xquery_debugger.html?refsrc=xsllist&reftype=xquery" shape="rect" coords="0, 476, 120, 512"
	alt="Troubleshoot Advanced XQuery Applications With Stylus Studio's Updated XQuery Debugger!">
	<area href="/convert_to_xml.html?refsrc=xsllist&reftype=converttoxml" shape="rect" coords="0, 438, 120, 474"
	alt="Simplify Legacy Data Integration Projects With Convert to XML!">
	<area href="/xml_grid_view.html?refsrc=xsllist&reftype=grid" shape="rect" coords="0, 398, 120, 438"
	alt="A Powerful New XML Editing View for Working with Tabluar XML Data!">
	<area href="/xslt.html?refsrc=xsllist&reftype=xslt" shape="rect" coords="0, 358, 120, 399"
	alt="Advanced Support for XSLT 2.0 Editing, Debugging, and Perforance Benchmarking!">
	<area href="/xml_schema_editor.html?refsrc=xsllist&reftype=schema" shape="rect" coords="0, 317, 120, 358"
	alt="Visually Develop XML Data Models with an All-New XML Schema Editor!">
	<area href="/xml_product_index.html?refsrc=xsllist" shape="rect" coords="0, 195, 120, 252"
	alt="Learn More About Stylus Studio, the World's Leading XML IDE!">
	<area href="/xml_product_new_features.html?refsrc=xsllist" shape="rect" coords="0, 276, 120, 306"
	alt="Read About Stylus Studio 6 XML Professional Editions Exciting New Features!">
	<area href="/?refsrc=xsllist" shape="rect" alt="Stylus Studio &#151; A Leading Provider of XML Tools for Advanced XML Data Integration"
	coords="0, 0, 120, 75">
	<area href="/xml_download.html?refsrc=xsllist" alt="Download A Free Trial of Stylus Studio 6 XML Professional Edition Today!"
	shape="rect" coords="0, 75, 120, 600">
</map>
<img border="0" src="/images/ad1.gif" usemap="#xml" alt="Download Stylus Studio 6 XML Professional Edition"></p>
 -->
	   <!-- <div class="calloutfeatured1">
        <h3 class="icon1">Free XML Developer Resources</h3>
       <ul class="plain">
		<li><a runat="server" class="list" href="/xmldev/">XML Development Forum</a></li>
		<li><a runat="server" class="list" href="/xsllist/">XSL Development Forum</a></li>
		<li><a runat="server" class="list" href="/xquerytalk/">XQuery Discussion Forum</a></li>
		<li><a runat="server" class="list" href="/edifact/">EDIFACT Reference</a></li>
		<li><a runat="server" href="http://schemas.stylusstudio.com">XML Schema Library</a></li>
		<li><a runat="server" class="list" href="/api/">XML Component References</a></li>		  
		<li><a runat="server" class="list" href="/w3c/">W3C Standard Reference</a></li>		  
	</ul>
</div>-->
		
<div style="text-align:center;">
<form target="_blank" action="/formsubmit/subscribe.aspx?context=7" method="post" style="margin-bottom: 5px;
    padding: 4px; border: 1px solid black; font-size: 9px">
    Don't miss another message! Subscribe to this list today.
    <div style="margin-top: 3px;">
        Email</div>
    <input style="font-size: 10px; height: 18px; width: 110px;" size="14" name="klqoufhxme"
        maxlength="60">
    <div>
        First Name</div>
    <input style="font-size: 10px; height: 18px; width: 110px;" size="14" name="firstname">
    <div>
        Last Name</div>
    <input style="font-size: 10px; height: 18px; width: 110px;" size="14" name="lastname">
    <div>
        Company</div>
    <input style="font-size: 10px; height: 18px; width: 110px;" size="14" name="company"
        maxlength="60">
    <div style="margin-top: 4px" align="center">
        <input name="Submit" src="/media/general/buttons/submit.gif" type="image"></div>


    <input type="hidden" name="notes" value="referrer:" />
    <input type="hidden" name="notes" value="/xsllist/" />

    <input type="hidden" name="redirect" value="http://www.mulberrytech.com/xsl/xsl-list/subscribe-unsubscribe.html" />

</form>
</div>



<div style="font-weight:bold;text-align:center;">Subscribe in XML format</div>
<div style="border:1px solid #000;padding:2px">
<table>
<tr>
<td align="right">RSS 2.0</td>
<td><a href="http://www.stylusstudio.com/feeds/rss/?f=1" title="XSL-List RSS feed"><img src="/images/rss.png"></a>
</td>
</tr>
<tr>
<td align="right">Atom 0.3</td>
<td><a href="http://www.stylusstudio.com/feeds/atom/?f=1" title="XSL-List  Atom feed"><img src="/images/atom.png"></a>
</td>
</tr>
</table>
</div>


	</td>



	</tr>
</table>

        </div>

 
<div style="margin: 20px 0px 10px 0px;">		
<div class="quickjump-wrap">
<div class="quickjump-row"><a href="/xml_download.html"><img src="/images/xml-editor-download.png" border="0" class="quickjump-image" /></a><div class="quickjump"><a href="/download-xml-editor.html">XML Editor - Download a 15 Day Free Trial Now ></a></div></div>
<div class="quickjump-row"><a href="/xml_product_new_features.html"><img src="/images/new-xml-editor.png" border="0" class="quickjump-image" /></a><div class="quickjump"><a href="/xml_product_new_features.html">See What's New in Stylus Studio ></a></div></div>
<div class="quickjump-row last"><a href="/buy/"><img src="/images/xml-editor-cart.png" border="0" class="quickjump-image" /></a><div class="quickjump"><a href="/buy/">Buy Stylus Studio - XML Editor -  Now ></a></div></div>
</div> <!-- quickJump Wrap -->
</div> 


    </div>   
    
    <div id="footing">
        <table id="footing1" cellpadding="0" cellspacing="0" width="100%">
            <tr>
                <td align="left" valign="middle" nowrap="nowrap">
                    <a title="Stylus Studio Site Map" href="http://www.stylusstudio.com/site_map.html">Site
                        Map</a> | <a title="Stylus Studio Privacy Policy" href="http://www.stylusstudio.com/privacy_policy.html">
                            Privacy Policy</a> | <a title="Stylus Studio Terms of Use" href="http://www.stylusstudio.com/terms_of_use.html">
                                Terms of Use</a> | <a title="Trademarks" target="_blank" href="http://www.progress.com/trademarks/">
                                    Trademarks</a>
                </td>
                <td align="right" valign="middle" nowrap="nowrap">
                    <form style="margin: 0; padding: 0" method="post" action="http://www.stylusstudio.com/formsubmit/scoopBrief.aspx">
                        <span style="vertical-align: middle;">Free Stylus Studio XML Training:</span>
                        <input onClick="this.select();" style="border: #666 1px solid; font-size: x-small;
                            vertical-align: middle;" name="klqoufhxme" size="45" value="your email" /><input type="image"
                                alt="Sign Up for the Stylus Scoop" src="/images/signup.gif"
                                style="vertical-align: middle;" />
                    </form>
                </td>
            </tr>
        </table>
        <div id="footing3">
           <a rel="nofollow" title="Visit www.w3c.org" href="http://www.w3c.org" target="_blank"><img border="0" alt="W3C Member" src="/images/w3c.gif"/></a>
        </div>
        <div id="footing2">
                 Stylus Studio&reg; and DataDirect XQuery &trade;are products from DataDirect Technologies, is a registered trademark of 
                Progress Software Corporation, in the
        U.S. and other countries. &copy; 2004-2013 All Rights Reserved. 
            

        </div>
    </div>

	<!-- NEWSLETTER SUBSCRIBE POP -->
<div id="scooppop">
	<div class="popup" id="pop-up">
		<div class="close"><a href="javascript:toggleDiv('pop-up');" style="color: #dbdbdb; text-decoration: underline;">No Thanks</a></div>
		<a href="/xml_newsletter.html"><img src="/images/newsletter-pop.jpg" style="margin: 0 auto;" /></a>
	</div>
</div>


		<script type="text/javascript">
	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-1285854-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();
	</script>
	
	<!-- NEW GOOGLE ANALYTICS -->
<script type="text/javascript">

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-1441351-1']);
_gaq.push(['_setDomainName', 'none']);
_gaq.push(['_setAllowLinker', true]);
_gaq.push(['_setAllowHash', false]);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

</script>


<!-- Google Code for Remarketing tag -->
<script type="text/javascript">
/* <![CDATA[ */
var google_conversion_id = 1056769547;
var google_conversion_label = "kI4dCKmmwQQQi4z09wM";
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
</script>
<script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
</script>
<noscript>
<div style="display:inline;">
<img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/1056769547/?value=0&amp;label=kI4dCKmmwQQQi4z09wM&amp;guid=ON&amp;script=0"/>
</div>
</noscript>
	
    

	
	
    </body>
</html>
