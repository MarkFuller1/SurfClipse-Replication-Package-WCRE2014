<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
<head>
    <title>You can try the http.maxRedirects property:  System.setProperty(&quot;http.maxRedirects&quot;, &quot;3&quot;);  - CodeInPro</title>
    <meta name="keywords" content="java,http,url"/>
    <meta name="description" content=" conn.connect();   I can only see an option to enable/disable redirects  conn.setFollowRedirects(true)   I want to set a max follow of 3 (it seems the default is 20), to prevent exceptions like this:   java.net.ProtocolException: Server redirected too many  times (20)   that are caused by circular redirects on some servers. "/>
    <link rel="stylesheet" type="text/css" href="/ui/css.css"/>
</head>
<body>
<div id="wrap">
<div id="header">
    <a href="/" title="Programming FAQ">CodeInPro</a>
</div>    <div id="content">
        <h1 class="q_h1">You can try the http.maxRedirects property:  System.setProperty(&quot;http.maxRedirects&quot;, &quot;3&quot;); </h1>

        <div class="q_title">Set maximum number of server redirects followed when using HttpURLConnection</div>

        <div class="q_con">
            <div class="r">
                <a href="http://t4240.codeinpro.us/q/508107a84f1eba38a4eb4f77">browser (firefox, chrome). I&#39;m getting an error 500.  With the same code I can get &quot;anyother&quot; page (google, for example). My </a>

                <div class="r_con">I&#39;m trying to &lt;em&gt;connect&lt;/em&gt; to a web page through a &lt;em&gt;HttpURLConnection&lt;/em&gt; but it&#39;s not responding the same as a regular browser (firefox, chrome). I&#39;m getting an error 500.

With the same code I can get &quot;anyother&quot; page (google, for example). My code is posted below, but I&#39;m pretty sure it is ok. 

&lt;em&gt;Using&lt;/em&gt;...</div>
            </div>
            <div class="l">
                <div class="l_sense">
                    <div class="l_1">
                        <script type="text/javascript"><!--
                        google_ad_client = "ca-pub-7610814771568026";
                        google_ad_slot = "0144905949";
                        google_ad_width = 336;
                        google_ad_height = 280;
                        //-->
                        </script>
                        <script type="text/javascript"
                                src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
                        </script>
                    </div>
                    <div class="l_2">
                        <script type="text/javascript"><!--
                        google_ad_client = "ca-pub-7610814771568026";
                        google_ad_slot = "0144905949";
                        google_ad_width = 336;
                        google_ad_height = 280;
                        //-->
                        </script>
                        <script type="text/javascript"
                                src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
                        </script>
                    </div>
                </div>
                <div class="l_txt">
                <p>Is there a way to mandate the maximum number of redirects that are followed when using HttpURLConnection?</p>

<pre><code>        HttpURLConnection conn = (HttpURLConnection) uri.getURI().toURL();
        conn.connect();
</code></pre>

<p>I can only see an option to enable/disable redirects</p>

<pre><code>conn.setFollowRedirects(true)
</code></pre>

<p>I want to set a max follow of 3 (it seems the default is 20), to prevent exceptions like this: </p>

<pre><code>java.net.ProtocolException: Server redirected too many  times (20)
</code></pre>

<p>that are caused by circular redirects on some servers.</p>

                </div>
                <div class="l_tag">2013-10-06 10:44</div>
                <div class="l_sense2">
                    <script type="text/javascript"><!--
                    google_ad_client = "ca-pub-7610814771568026";
                    google_ad_slot = "4091204029";
                    google_ad_width = 728;
                    google_ad_height = 90;
                    //-->
                    </script>
                    <script type="text/javascript"
                            src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
                    </script>
                </div>
            </div>
                <div class="r">
                    <a href="http://t6918.codeinpro.us/q/508108044f1eba38a4ebdf5f">browser but in the android code InputStream returning zero. this is my code.....  URL url = new URL(&quot;https://certify.securenet.com/payment.scrnt&quot;);      HttpURLConnection httpCon = </a>

                    <div class="r_con">HI, i am doing a &lt;em&gt;HttpUrlConnection&lt;/em&gt; in android application with an URL. The uRL is giving me response in the browser but in the android code InputStream returning zero. this is my code.....

URL url = new URL(&quot;https://certify.securenet.com/payment.scrnt&quot;);

    &lt;em&gt;HttpURLConnection&lt;/em&gt; httpCon = (HttpURLConnection)url.open&lt;em&gt;Connection&lt;/em&gt;...</div>
                </div>
                <div class="l ">
                    <div class="l_txt">
                    <p>Why don't you just catch the exception? Changing the threshold number won't change the fact that the function has to report failure to you when it exceeds that number. In fact, lowering the threshold will increase the chances that the function will have to report failure in complex-but-legitimate redirect situations when it would have ultimately succeeded with a higher threshold.</p>

                    </div>
                    <div class="l_user">
                    </div>
                        <div class="l_comment">
                                <div class="a_comment">
                                I already do. The reason I want to limit the number of redirects has more to do with efficiency. Why follow a redirect 20 times? It's a waste of time if i'm crawling 1000s of sites at once and don't need this. Plus, seems strange not to have the option.
                                </div>
                        </div>
                </div>
                <div class="r">
                    <a href="http://t1661.codeinpro.us/q/50812af34f1eba38a41f1867">via a POST with X number of records from the current file. I&#39;m using HttpUrlConnection to make the API call. </a>

                    <div class="r_con">I have a high volume application that reads in data from files, and then hits an internal API (local network) via a POST with X number of records from the current file. I&#39;m &lt;em&gt;using&lt;/em&gt; &lt;em&gt;HttpUrlConnection&lt;/em&gt; to make the API call. Without the API call, it runs extremely fast, but once I put in the API call...</div>
                </div>
                <div class="l acc">
                    <div class="l_txt">
                    <p>You can try the <a href="http://download.oracle.com/javase/7/docs/api/java/net/doc-files/net-properties.html" rel="nofollow">http.maxRedirects</a> property:</p>

<p><code>System.setProperty("http.maxRedirects", "3");</code></p>

                    </div>
                    <div class="l_user">
                            <img class="accepted" src="/ui/images/check.png"/>
                    </div>
                        <div class="l_comment">
                                <div class="a_comment">
                                Thanks, it works. Although the property is only read once on startup so it needs to be set as a runtime property using "-Dhttp.maxRedirects=3"
                                </div>
                                <div class="a_comment">
                                @Joel actually it's enough to set this parameter before http calls, for example in some initialization method
                                </div>
                                <div class="a_comment">
                                @VitaliiFedorenko How do you know that?
                                </div>
                        </div>
                </div>
                <div class="r">
                    <a href="http://t9235.codeinpro.us/q/50813fb44f1eba38a43f6ade">understand how it works. Basically, I want to know the following:   On which point does HTTPURLConnection try to establish a connection </a>

                    <div class="r_con">I am &lt;em&gt;using&lt;/em&gt; &lt;em&gt;HTTPURLConnection&lt;/em&gt; to &lt;em&gt;connect&lt;/em&gt; to a web service. I know how to &lt;em&gt;use&lt;/em&gt; &lt;em&gt;HTTPURLConnection&lt;/em&gt; but I want to understand how it works. Basically, I want to know the &lt;em&gt;following&lt;/em&gt;:


On which point does &lt;em&gt;HTTPURLConnection&lt;/em&gt; try to establish a &lt;em&gt;connection&lt;/em&gt; to the given URL?
On which point can I know...</div>
                </div>
                <div class="l ">
                    <div class="l_txt">
                    <p>Accroding to <a href="http://www.freesoft.org/CIE/RFC/1945/46.htm" rel="nofollow">HTTP RFC</a></p>

<blockquote>
  <p>A user agent should never
  automatically redirect a request more
  than 5 times, since such redirections
  usually indicate an infinite loop.</p>
</blockquote>

<p><a href="http://www.jguru.com/faq/view.jsp?EID=267915" rel="nofollow">This forum post explains</a> how to work around this</p>

                    </div>
                    <div class="l_user">
                    </div>
                </div>
                <div class="r">
                    <a href="http://t2973.codeinpro.us/q/5081420d4f1eba38a443b52d">try {             url = new URL(&quot;http://www.android.com/&quot;);         } catch (MalformedURLException e) {             // TODO Auto-generated catch block             e.printStackTrace();         }        HttpURLConnection urlConnection </a>

                    <div class="r_con">I have problem with Android &lt;em&gt;using&lt;/em&gt; the class &lt;em&gt;HttpUrlConnection&lt;/em&gt; my method is this:

public InputStream test() {
        URL url = null;
        try {
            url = new URL(&quot;http://www.android.com/&quot;);
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block...</div>
                </div>
                <div class="r">
                    <a href="http://t7077.codeinpro.us/q/508147ec4f1eba38a44f0a4d">URL   But when i use the same code block and run as Java application, it returns 200 response and works fine.  URL </a>

                    <div class="r_con">Reader(new InputStreamReader(&lt;em&gt;conn&lt;/em&gt;.getInputStream()));


The above is the code I &lt;em&gt;used&lt;/em&gt; in both of my applications. &lt;em&gt;Using&lt;/em&gt; HTTPClient might solve the problem but I haven&#39;t tried yet. But since I&#39;ve been &lt;em&gt;using&lt;/em&gt; &lt;em&gt;HTTPURLConnection&lt;/em&gt; throughout, I would like to know if there is a possible solution to this.

This is the trace...</div>
                </div>
                <div class="r">
                    <a href="http://t3947.codeinpro.us/q/50812df04f1eba38a4235b94">authentication:  String encoded = Base64.encode(username+&quot;:&quot;+password); connection.setRequestProperty(&quot;Authorization&quot;, &quot;Basic &quot;+encoded);    However I keep getting this error:  java.io.IOException: Server returned HTTP response code: 401 for URL: </a>

                    <div class="r_con">I am trying to &lt;em&gt;connect&lt;/em&gt; to a page &lt;em&gt;using&lt;/em&gt; &lt;em&gt;HttpUrlConnection&lt;/em&gt; but I am getting Unauthorized results even after &lt;em&gt;using&lt;/em&gt; Basic authentication:

String encoded = Base64.encode(username+&quot;:&quot;+password);
&lt;em&gt;connection&lt;/em&gt;.setRequestProperty(&quot;Authorization&quot;, &quot;Basic &quot;+encoded); 


However I keep getting this error:

java...</div>
                </div>
                <div class="r">
                    <a href="http://t159.codeinpro.us/q/5080e9824f1eba38a4be1736">is that some servers block a request if the user agent is a Java VM. Another problem is that the </a>

                    <div class="r_con">Im trying to improve the Java Html Document a little but i&#39;m running into problems with the HttpUrlConntion. One thing is that some servers block a request if the user agent is a Java VM. Another problem is that the &lt;em&gt;HttpUrlConnection&lt;/em&gt; does not set the Referrer or Location header field...</div>
                </div>
                <div class="r">
                    <a href="http://t1411.codeinpro.us/q/508148644f1eba38a4500264">URL(&quot;https://www.google.com&quot;)         HttpURLConnection connection = (HttpURLConnection) url.openConnection()         connection.setRequestMethod(&quot;GET&quot;)         // connection.setConnectTimeout(10000)         connection.connect()         if (connection.responseCode == 200 || connection.responseCode == 201) {             def </a>

                    <div class="r_con">I am always getting the &quot;Error &lt;em&gt;Connecting&lt;/em&gt; to ${url}&quot; message?

Can anyone please show me my mistake?

        def url = new URL(&quot;https://www.google.com&quot;)
        &lt;em&gt;HttpURLConnection&lt;/em&gt; &lt;em&gt;connection&lt;/em&gt; = (&lt;em&gt;HttpURLConnection&lt;/em&gt;) url.open&lt;em&gt;Connection&lt;/em&gt;()
        &lt;em&gt;connection&lt;/em&gt;.setRequestMethod(&quot;GET&quot;)
        // &lt;em&gt;connection.setConnect&lt;/em&gt;...</div>
                </div>
                <div class="r">
                    <a href="http://t705.codeinpro.us/q/515016d0e8432c042604eb5a">in a row (one after each other) and then wait a given time and loop again with doing the 3 </a>

                    <div class="r_con"> setting on the server is set to 60s while the time waiting on the app is for example 5 seconds. Also when I switch to WIFI this behavior I cannot see. With the same time waiting all requests are fast.

The http &lt;em&gt;connect&lt;/em&gt; code is &lt;em&gt;using&lt;/em&gt; &lt;em&gt;HttpURLConnection&lt;/em&gt; and looks like the &lt;em&gt;following&lt;/em&gt;:

m_res.error = null;
&lt;em&gt;HttpURLConnection&lt;/em&gt;...</div>
                </div>
        </div>
    </div>
    <div class="clear"></div>
<div id="footer">
    Logo, design and layout © 2013 <a href="/" title="Programming FAQ">CodeInPro</a>
</div></div>
</body>
</html>

