<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head profile="http://gmpg.org/xfn/11">
<title>   Jersey Client: java.net.ProtocolException: Server redirected too many times/Setting cookies on request at Mark Needham</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="description" content="Thoughts on Software Development" />
<meta name="generator" content="WordPress 3.7.1" /> <!-- leave this for stats please -->
<link href="http://www.markhneedham.com/blog/wp-content/themes/journalist/style.css" rel="stylesheet" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="Mark Needham RSS Feed" href="http://feeds2.feedburner.com/MarkNeedham" />
<link rel="shortcut icon" type="image/x-png" href="http://www.markhneedham.com/blog/wp-content/themes/journalist/favicon.png" />
<link rel="pingback" href="http://www.markhneedham.com/blog/xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="Mark Needham &raquo; Jersey Client: java.net.ProtocolException: Server redirected too many times/Setting cookies on request Comments Feed" href="http://www.markhneedham.com/blog/2013/08/17/jersey-client-java-net-protocolexception-server-redirected-too-many-timessetting-cookies-on-request/feed/" />
<link rel='stylesheet' id='wp-syntax-css-css'  href='http://www.markhneedham.com/blog/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='http://www.markhneedham.com/blog/wp-includes/js/jquery/jquery.js?ver=1.10.2'></script>
<script type='text/javascript' src='http://www.markhneedham.com/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://www.markhneedham.com/blog/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.4.3'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.markhneedham.com/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.markhneedham.com/blog/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Python: for/list comprehensions and dictionaries' href='http://www.markhneedham.com/blog/2013/08/13/python-forlist-comprehensions-and-dictionaries/' />
<link rel='next' title='BT Internet: Non existent hosts mapping to 92.242.132.15' href='http://www.markhneedham.com/blog/2013/08/17/bt-internet-non-existent-hosts-mapping-to-92-242-132-15/' />
<meta name="generator" content="WordPress 3.7.1" />
<link rel='canonical' href='http://www.markhneedham.com/blog/2013/08/17/jersey-client-java-net-protocolexception-server-redirected-too-many-timessetting-cookies-on-request/' />
<link rel='shortlink' href='http://wp.me/piQMd-1rQ' />
<!-- Google Analytics Tracking by Google Analyticator 6.4.4.3: http://www.videousermanuals.com/google-analyticator/ -->
<script type="text/javascript">
	var analyticsFileTypes = [''];
	var analyticsEventTracking = 'enabled';
</script>
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-9991626-1']);
        _gaq.push(['_addDevId', 'i9k95']); // Google Analyticator App ID with Google 
        
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
</head>

<body>
<div id="container" class="group">

<h1><a href="http://www.markhneedham.com/blog/">Mark Needham</a></h1>
<div id="bubble"><p>Thoughts on Software Development</p></div> <!-- erase this line if you want to turn the bubble off -->

<div id="content" class="group">

<h2 id="post-5570"><a href="http://www.markhneedham.com/blog/2013/08/17/jersey-client-java-net-protocolexception-server-redirected-too-many-timessetting-cookies-on-request/" rel="bookmark">Jersey Client: java.net.ProtocolException: Server redirected too many times/Setting cookies on request</a></h2>
<p class="comments"><a href="http://www.markhneedham.com/blog/2013/08/17/jersey-client-java-net-protocolexception-server-redirected-too-many-timessetting-cookies-on-request/#comments"><span class="dsq-postid" rel="5570 http://www.markhneedham.com/blog/?p=5570">without comments</span></a></p>

<div class="main">
	<p>A couple of weeks ago I was trying to write a test around some OAuth code that we have on an internal application and I was using <a href="https://jersey.java.net/documentation/latest/user-guide.html#client">Jersey Client</a> to send the various requests.</p>
<p>I initially started with the following code:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="java" style="font-family:monospace;">Client <span style="color: #339933;">=</span> Client.<span style="color: #006633;">create</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
ClientResponse response <span style="color: #339933;">=</span> client.<span style="color: #006633;">resource</span><span style="color: #009900;">&#40;</span> <span style="color: #0000ff;">&quot;http://localhost:59680&quot;</span> <span style="color: #009900;">&#41;</span>.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span> ClientResponse.<span style="color: #000000; font-weight: bold;">class</span> <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table></div>

<p>but when I ran the test I was getting the following exception:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="text" style="font-family:monospace;">com.sun.jersey.api.client.ClientHandlerException: java.net.ProtocolException: Server redirected too many  times (20)
	at com.sun.jersey.client.urlconnection.URLConnectionClientHandler.handle(URLConnectionClientHandler.java:151)
	at com.sun.jersey.api.client.Client.handle(Client.java:648)
	at com.sun.jersey.api.client.WebResource.handle(WebResource.java:680)
	at com.sun.jersey.api.client.WebResource.get(WebResource.java:191)
	at com.neotechnology.testlab.manager.webapp.AuthenticationIntegrationTest.shouldRedirectToGitHubForAuthentication(AuthenticationIntegrationTest.java:81)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at com.neotechnology.kirkaldy.testing.Resources$1.evaluate(Resources.java:84)
	at com.neotechnology.kirkaldy.testing.FailureOutput$2.evaluate(FailureOutput.java:37)
	at org.junit.rules.RunRules.evaluate(RunRules.java:18)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:63)
Caused by: java.net.ProtocolException: Server redirected too many  times (20)
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1446)
	at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:379)
	at com.sun.jersey.client.urlconnection.URLConnectionClientHandler._invoke(URLConnectionClientHandler.java:249)
	at com.sun.jersey.client.urlconnection.URLConnectionClientHandler.handle(URLConnectionClientHandler.java:149)
	... 28 more</pre></td></tr></table></div>

<p>If we check the traffic going across port 59680 we can see what&#8217;s going wrong:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="text" style="font-family:monospace;">$ sudo ngrep -d lo0 port 59680
interface: lo0 (127.0.0.0/255.0.0.0)
filter: (ip) and ( port 59680 )
#####
T 127.0.0.1:59704 -&gt; 127.0.0.1:59680 [AP]
  GET / HTTP/1.1..User-Agent: Java/1.6.0_45..Host: localhost:59680..Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2..Connection: keep-alive....
##
T 127.0.0.1:59680 -&gt; 127.0.0.1:59704 [AP]
  HTTP/1.1 302 Found..Set-Cookie: JSESSIONID=mdyw3a4fmqc1b6p53birm4dd;Path=/..Expires: Thu, 01 Jan 1970 00:00:00 GMT..Location: http://localhost:59679/authorize?client_id=basic-client&amp;state=the-state&amp;scope=user%2Crepo..Content-Length
  : 0..Server: Jetty(8.1.8.v20121106)....
###########
T 127.0.0.1:59707 -&gt; 127.0.0.1:59680 [AP]
  GET /auth/callback?code=timey-wimey&amp;state=the-state HTTP/1.1..User-Agent: Java/1.6.0_45..Host: localhost:59680..Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2..Connection: keep-alive....
##
T 127.0.0.1:59680 -&gt; 127.0.0.1:59707 [AP]
  HTTP/1.1 302 Found..Cache-Control: no-cache..Set-Cookie: JSESSIONID=8gggez0ns9ftiex4314mbgz9;Path=/..Expires: Thu, 01 Jan 1970 00:00:00 GMT..Location: http://localhost:59680/..Content-Length: 0..Server: Jetty(8.1.8.v20121106)....
###########
T 127.0.0.1:59713 -&gt; 127.0.0.1:59680 [AP]
  GET / HTTP/1.1..User-Agent: Java/1.6.0_45..Host: localhost:59680..Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2..Connection: keep-alive....
##</pre></td></tr></table></div>

<p>The response we receive includes a direction to the client to store a cookie but we can see on the next request that the cookie hasn&#8217;t been included.</p>
<p>I came across <a href="http://stackoverflow.com/questions/6713893/jersey-client-adding-cookies-to-request">this post which had a few suggestions on how to get around the problem</a> but the only approach that worked for me was to use jersey-apache-client for which I added the following dependency:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="xml" style="font-family:monospace;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;dependency<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;groupId<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>com.sun.jersey.contribs<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/groupId<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;artifactId<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>jersey-apache-client<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/artifactId<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;version<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>1.13<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/version<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
  <span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;type<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>jar<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/type<span style="color: #000000; font-weight: bold;">&gt;</span></span></span>
<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/dependency<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></pre></td></tr></table></div>

<p>I then change my client code to read like this:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="java" style="font-family:monospace;">ApacheHttpClientConfig config <span style="color: #339933;">=</span> <span style="color: #000000; font-weight: bold;">new</span> DefaultApacheHttpClientConfig<span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
config.<span style="color: #006633;">getProperties</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">put</span><span style="color: #009900;">&#40;</span>ApacheHttpClientConfig.<span style="color: #006633;">PROPERTY_HANDLE_COOKIES</span>, <span style="color: #000066; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
ApacheHttpClient client <span style="color: #339933;">=</span> ApacheHttpClient.<span style="color: #006633;">create</span><span style="color: #009900;">&#40;</span> config <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
client.<span style="color: #006633;">setFollowRedirects</span><span style="color: #009900;">&#40;</span><span style="color: #000066; font-weight: bold;">true</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
client.<span style="color: #006633;">getClientHandler</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">getHttpClient</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">getParams</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span>.<span style="color: #006633;">setBooleanParameter</span><span style="color: #009900;">&#40;</span> HttpClientParams.<span style="color: #006633;">ALLOW_CIRCULAR_REDIRECTS</span>, <span style="color: #000066; font-weight: bold;">true</span> <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
ClientResponse response <span style="color: #339933;">=</span> client.<span style="color: #006633;">resource</span><span style="color: #009900;">&#40;</span> <span style="color: #0000ff;">&quot;http://localhost:59680&quot;</span> <span style="color: #009900;">&#41;</span>.<span style="color: #006633;">get</span><span style="color: #009900;">&#40;</span> ClientResponse.<span style="color: #000000; font-weight: bold;">class</span> <span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td></tr></table></div>

<p>If we run that and watch the output using ngrep we can see that it now handles cookies correctly:</p>

<div class="wp_syntax"><table><tr><td class="code"><pre class="text" style="font-family:monospace;">$ sudo ngrep -d lo0 port 59680
Password:
interface: lo0 (127.0.0.0/255.0.0.0)
filter: (ip) and ( port 59680 )
	#####
T 127.0.0.1:60372 -&gt; 127.0.0.1:59680 [AP]
  GET / HTTP/1.1..User-Agent: Jakarta Commons-HttpClient/3.1..Host: localhost:59680....
##
T 127.0.0.1:59680 -&gt; 127.0.0.1:60372 [AP]
  HTTP/1.1 302 Found..Set-Cookie: JSESSIONID=vn8zzf9ep3x4mtw66ydm0n6a;Path=/..Expires: Thu, 01 Jan 1970 00:00:00 GMT..Location: http://localhost:60322/authorize?client_id=basic-client&amp;state=the-state&amp;scope=user%2Crepo..Content-Length
  : 0..Server: Jetty(8.1.8.v20121106)....
##
T 127.0.0.1:60372 -&gt; 127.0.0.1:59680 [AP]
  GET /auth/callback?code=timey-wimey&amp;state=the-state HTTP/1.1..User-Agent: Jakarta Commons-HttpClient/3.1..Host: localhost:59680..Cookie: $Version=0; JSESSIONID=vn8zzf9ep3x4mtw66ydm0n6a; $Path=/....
##
T 127.0.0.1:59680 -&gt; 127.0.0.1:60372 [AP]
  HTTP/1.1 302 Found..Cache-Control: no-cache..Location: http://localhost:59680/..Content-Length: 0..Server: Jetty(8.1.8.v20121106)....
##
T 127.0.0.1:60372 -&gt; 127.0.0.1:59680 [AP]
  GET / HTTP/1.1..User-Agent: Jakarta Commons-HttpClient/3.1..Host: localhost:59680..Cookie: $Version=0; JSESSIONID=vn8zzf9ep3x4mtw66ydm0n6a; $Path=/....
##
T 127.0.0.1:59680 -&gt; 127.0.0.1:60372 [AP]
  HTTP/1.1 200 OK..Vary: Accept-Encoding..Accept-Ranges: bytes..Content-Type: text/html..Content-Length: 2439..Last-Modified: Tue, 23 Jul 2013 10:48:15 GMT..Server: Jetty(8.1.8.v20121106)....&lt;!DOCTYPE html&gt;.&lt;html&gt;.&lt;head&gt;.  &lt;title&gt;Tes
  t Lab&lt;/title&gt;.  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width initial-scale=1.0 maximum-scale=1.0 user-scalable=0&quot;/&gt;.  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/bootstrap.css&quot;&gt;.  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; hr
  ef=&quot;css/bootstrap-responsive.css&quot;&gt;.  &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/test-lab.css&quot;&gt;.  &lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; href=&quot;images/testlab-16.png&quot;&gt;.  &lt;script src=&quot;js/require.js&quot;&gt;&lt;/script&gt;.  &lt;script src=&quot;js/d3.v3.
  js&quot; charset=&quot;UTF-8&quot;&gt;&lt;/script&gt;.  &lt;script src=&quot;js/jquery-1.8.3.min.js&quot;&gt;&lt;/script&gt;.  &lt;script src=&quot;js/bootstrap.js&quot;&gt;&lt;/script&gt;.  &lt;script src=&quot;js/test-lab.js&quot;&gt;&lt;/script&gt;.  &lt;script type=&quot;text/javascript&quot; src=&quot;js/google-analytics.js&quot;&gt;&lt;/scrip
  t&gt;.&lt;/head&gt;.&lt;body&gt;..&lt;a href=&quot;navbar.html&quot; class=&quot;inline-replacement&quot;&gt;&lt;/a&gt;..&lt;div class=&quot;container&quot;&gt;..  &lt;h1 class=&quot;title&quot;&gt;Neo Technology Test Lab&lt;/h1&gt;..  &lt;div class=&quot;dev-mode&quot;&gt;Viewing dev-mode&lt;/div&gt;..  &lt;h2&gt;Benchmark Series Results&lt;/h2
  &gt;..  &lt;table id=&quot;benchmarkseries_list&quot; class=&quot;table&quot;&gt;.    &lt;thead&gt;&lt;/thead&gt;.    &lt;tbody&gt;&lt;/tbody&gt;.  &lt;/table&gt;..  &lt;a href=&quot;new-benchmark-series.html&quot; class=&quot;btn load-modal&quot;&gt;&lt;i class=&quot;icon-plus&quot;&gt;&lt;/i&gt; Create Benchmark Series...&lt;/a&gt;..  &lt;h2&gt;T
  ests&lt;/h2&gt;..  &lt;table id=&quot;test_list&quot; class=&quot;table&quot;&gt;.    &lt;thead&gt;&lt;/thead&gt;.    &lt;tbody&gt;&lt;/tbody&gt;.  &lt;/table&gt;..  &lt;a href=&quot;run-test.html&quot; class=&quot;btn load-modal&quot;&gt;&lt;i class=&quot;icon-plus&quot;&gt;&lt;/i&gt; Run Test...&lt;/a&gt;.  &lt;a href=&quot;run-benchmark.html&quot; class=&quot;
  btn load-modal&quot;&gt;&lt;i class=&quot;icon-plus&quot;&gt;&lt;/i&gt; Run Benchmark...&lt;/a&gt;..  &lt;h2&gt;Clusters&lt;/h2&gt;..  &lt;table id=&quot;cluster_list&quot; class=&quot;table&quot;&gt;&lt;/table&gt;..  &lt;a href=&quot;new-database-cluster.html&quot; class=&quot;btn load-modal&quot;&gt;&lt;i class=&quot;icon-plus&quot;&gt;&lt;/i&gt; New Data
  base Cluster...&lt;/a&gt;.  &lt;a href=&quot;new-load-generation-cluster.html&quot; class=&quot;btn load-modal&quot;&gt;&lt;i class=&quot;icon-plus&quot;&gt;&lt;/i&gt; New Load Generation Cluster...&lt;/a&gt;..  &lt;h2&gt;Datasets&lt;/h2&gt;..  &lt;table id=&quot;dataset_list&quot; class=&quot;table&quot;&gt;.    &lt;thead&gt;&lt;/thead
  &gt;.    &lt;tbody&gt;&lt;/tbody&gt;.  &lt;/table&gt;..  &lt;a href=&quot;new-dataset.html&quot; class=&quot;btn load-modal&quot;&gt;&lt;i class=&quot;icon-plus&quot;&gt;&lt;/i&gt; Create New Dataset...&lt;/a&gt;..  &lt;a href=&quot;confirm.html&quot; class=&quot;inline-replacement&quot;&gt;&lt;/a&gt;..&lt;/div&gt;..&lt;script type=&quot;text/javascr
  ipt&quot;&gt;.  (function ().  {.    window.setInterval( function ().    {.      d3.json( &quot;/public/authenticated&quot;, function ( status ).      {.        if ( !status.authenticated ).        {.          window.location.reload();.        }.
     } );.    }, 5000 );.    kirkaldy.initializeUI();.  })();.&lt;/script&gt;..&lt;/body&gt;.&lt;/html&gt;.</pre></td></tr></table></div>

</div>

<div class="meta group">
<div class="signature">
    <p>Written by Mark Needham <span class="edit"></span></p>
    <p>August 17th, 2013 at 8:25 pm</p>
</div>	
<div class="tags">
    <p>Posted in <a href="http://www.markhneedham.com/blog/category/languages-2/java/" title="View all posts in Java" rel="category tag">Java</a></p>
    <p>Tagged with <a href="http://www.markhneedham.com/blog/tag/java/" rel="tag">Java</a>, <a href="http://www.markhneedham.com/blog/tag/jersey/" rel="tag">jersey</a></p></div>
</div>

<div class="navigation group">
    <div class="alignleft">&laquo; <a href="http://www.markhneedham.com/blog/2013/08/13/python-forlist-comprehensions-and-dictionaries/" rel="prev">Python: for/list comprehensions and dictionaries</a></div>
    <div class="alignright"><a href="http://www.markhneedham.com/blog/2013/08/17/bt-internet-non-existent-hosts-mapping-to-92-242-132-15/" rel="next">BT Internet: Non existent hosts mapping to 92.242.132.15</a> &raquo;</div>
</div>
<script src="http://feeds.feedburner.com/~s/MarkNeedham?i=http://www.markhneedham.com/blog/2013/08/17/jersey-client-java-net-protocolexception-server-redirected-too-many-timessetting-cookies-on-request/" type="text/javascript" charset="utf-8"></script>


<div id="disqus_thread">
    </div>

<script type="text/javascript">
/* <![CDATA[ */
    var disqus_url = 'http://www.markhneedham.com/blog/2013/08/17/jersey-client-java-net-protocolexception-server-redirected-too-many-timessetting-cookies-on-request/';
    var disqus_identifier = '5570 http://www.markhneedham.com/blog/?p=5570';
    var disqus_container_id = 'disqus_thread';
    var disqus_domain = 'disqus.com';
    var disqus_shortname = 'markhneedham';
    var disqus_title = "Jersey Client: java.net.ProtocolException: Server redirected too many times\/Setting cookies on request";
        var disqus_config = function () {
        var config = this; // Access to the config object
        config.language = '';

        /*
           All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
         */

        config.callbacks.preData.push(function() {
            // clear out the container (its filled for SEO/legacy purposes)
            document.getElementById(disqus_container_id).innerHTML = '';
        });
                config.callbacks.onReady.push(function() {
            // sync comments in the background so we don't block the page
            var script = document.createElement('script');
            script.async = true;
            script.src = '?cf_action=sync_comments&post_id=5570';

            var firstScript = document.getElementsByTagName( "script" )[0];
            firstScript.parentNode.insertBefore(script, firstScript);
        });
                    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
    var DsqLocal = {
        'trackbacks': [
        ],
        'trackback_url': "http:\/\/www.markhneedham.com\/blog\/2013\/08\/17\/jersey-client-java-net-protocolexception-server-redirected-too-many-timessetting-cookies-on-request\/trackback\/"    };
/* ]]> */
</script>

<script type="text/javascript">
/* <![CDATA[ */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.' + 'disqus.com' + '/embed.js?pname=wordpress&pver=2.74';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
/* ]]> */
</script>


</div> 

<div id="sidebar">
			<div class="textwidget"><div align="left" style="padding: 5px; border: 1px solid #efefef;">
	<div style="float:left;">
		<img src="http://a1.twimg.com/profile_images/58329913/me_bigger.jpg">
	</div>
	<div style="float:right;">
		<div style="margin-left: 2px; padding: 1px;"><a href="http://twitter.com/markhneedham">Twitter</a></div>
		<div style="margin-left: 2px; padding: 1px;"><a href="mailto:mark@markhneedham.com">Email</a></div>
		<div style="margin-left: 2px; padding: 1px;"><a href="http://feeds2.feedburner.com/MarkNeedham"><img src="http://feeds2.feedburner.com/~fc/MarkNeedham?bg=99CCFF&amp;fg=444444&amp;anim=0" height="26" width="88" style="border:0" alt="" /></a></div>
	</div>
	<div style="clear:both"></div>
</div>
<a href="http://feedburner.google.com/fb/a/mailverify?uri=MarkNeedham&amp;loc=en_US">Subscribe by email</a>
</div>
		<form role="search" method="get" id="searchform" class="searchform" action="http://www.markhneedham.com/blog/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form><h3>Archives</h3>		<select name="archive-dropdown" onchange='document.location.href=this.options[this.selectedIndex].value;'> <option value="">Select Month</option> 	<option value='http://www.markhneedham.com/blog/2013/12/'> December 2013 &nbsp;(1)</option>
	<option value='http://www.markhneedham.com/blog/2013/11/'> November 2013 &nbsp;(16)</option>
	<option value='http://www.markhneedham.com/blog/2013/10/'> October 2013 &nbsp;(14)</option>
	<option value='http://www.markhneedham.com/blog/2013/09/'> September 2013 &nbsp;(19)</option>
	<option value='http://www.markhneedham.com/blog/2013/08/'> August 2013 &nbsp;(16)</option>
	<option value='http://www.markhneedham.com/blog/2013/07/'> July 2013 &nbsp;(20)</option>
	<option value='http://www.markhneedham.com/blog/2013/06/'> June 2013 &nbsp;(20)</option>
	<option value='http://www.markhneedham.com/blog/2013/05/'> May 2013 &nbsp;(15)</option>
	<option value='http://www.markhneedham.com/blog/2013/04/'> April 2013 &nbsp;(19)</option>
	<option value='http://www.markhneedham.com/blog/2013/03/'> March 2013 &nbsp;(20)</option>
	<option value='http://www.markhneedham.com/blog/2013/02/'> February 2013 &nbsp;(20)</option>
	<option value='http://www.markhneedham.com/blog/2013/01/'> January 2013 &nbsp;(20)</option>
	<option value='http://www.markhneedham.com/blog/2012/12/'> December 2012 &nbsp;(23)</option>
	<option value='http://www.markhneedham.com/blog/2012/11/'> November 2012 &nbsp;(16)</option>
	<option value='http://www.markhneedham.com/blog/2012/10/'> October 2012 &nbsp;(17)</option>
	<option value='http://www.markhneedham.com/blog/2012/09/'> September 2012 &nbsp;(18)</option>
	<option value='http://www.markhneedham.com/blog/2012/08/'> August 2012 &nbsp;(8)</option>
	<option value='http://www.markhneedham.com/blog/2012/07/'> July 2012 &nbsp;(17)</option>
	<option value='http://www.markhneedham.com/blog/2012/06/'> June 2012 &nbsp;(13)</option>
	<option value='http://www.markhneedham.com/blog/2012/05/'> May 2012 &nbsp;(17)</option>
	<option value='http://www.markhneedham.com/blog/2012/04/'> April 2012 &nbsp;(17)</option>
	<option value='http://www.markhneedham.com/blog/2012/03/'> March 2012 &nbsp;(18)</option>
	<option value='http://www.markhneedham.com/blog/2012/02/'> February 2012 &nbsp;(15)</option>
	<option value='http://www.markhneedham.com/blog/2012/01/'> January 2012 &nbsp;(17)</option>
	<option value='http://www.markhneedham.com/blog/2011/12/'> December 2011 &nbsp;(14)</option>
	<option value='http://www.markhneedham.com/blog/2011/11/'> November 2011 &nbsp;(13)</option>
	<option value='http://www.markhneedham.com/blog/2011/10/'> October 2011 &nbsp;(13)</option>
	<option value='http://www.markhneedham.com/blog/2011/09/'> September 2011 &nbsp;(12)</option>
	<option value='http://www.markhneedham.com/blog/2011/08/'> August 2011 &nbsp;(6)</option>
	<option value='http://www.markhneedham.com/blog/2011/07/'> July 2011 &nbsp;(18)</option>
	<option value='http://www.markhneedham.com/blog/2011/06/'> June 2011 &nbsp;(16)</option>
	<option value='http://www.markhneedham.com/blog/2011/05/'> May 2011 &nbsp;(11)</option>
	<option value='http://www.markhneedham.com/blog/2011/04/'> April 2011 &nbsp;(12)</option>
	<option value='http://www.markhneedham.com/blog/2011/03/'> March 2011 &nbsp;(18)</option>
	<option value='http://www.markhneedham.com/blog/2011/02/'> February 2011 &nbsp;(18)</option>
	<option value='http://www.markhneedham.com/blog/2011/01/'> January 2011 &nbsp;(17)</option>
	<option value='http://www.markhneedham.com/blog/2010/12/'> December 2010 &nbsp;(15)</option>
	<option value='http://www.markhneedham.com/blog/2010/11/'> November 2010 &nbsp;(22)</option>
	<option value='http://www.markhneedham.com/blog/2010/10/'> October 2010 &nbsp;(22)</option>
	<option value='http://www.markhneedham.com/blog/2010/09/'> September 2010 &nbsp;(22)</option>
	<option value='http://www.markhneedham.com/blog/2010/08/'> August 2010 &nbsp;(21)</option>
	<option value='http://www.markhneedham.com/blog/2010/07/'> July 2010 &nbsp;(23)</option>
	<option value='http://www.markhneedham.com/blog/2010/06/'> June 2010 &nbsp;(22)</option>
	<option value='http://www.markhneedham.com/blog/2010/05/'> May 2010 &nbsp;(11)</option>
	<option value='http://www.markhneedham.com/blog/2010/04/'> April 2010 &nbsp;(22)</option>
	<option value='http://www.markhneedham.com/blog/2010/03/'> March 2010 &nbsp;(22)</option>
	<option value='http://www.markhneedham.com/blog/2010/02/'> February 2010 &nbsp;(24)</option>
	<option value='http://www.markhneedham.com/blog/2010/01/'> January 2010 &nbsp;(25)</option>
	<option value='http://www.markhneedham.com/blog/2009/12/'> December 2009 &nbsp;(24)</option>
	<option value='http://www.markhneedham.com/blog/2009/11/'> November 2009 &nbsp;(25)</option>
	<option value='http://www.markhneedham.com/blog/2009/10/'> October 2009 &nbsp;(25)</option>
	<option value='http://www.markhneedham.com/blog/2009/09/'> September 2009 &nbsp;(25)</option>
	<option value='http://www.markhneedham.com/blog/2009/08/'> August 2009 &nbsp;(25)</option>
	<option value='http://www.markhneedham.com/blog/2009/07/'> July 2009 &nbsp;(28)</option>
	<option value='http://www.markhneedham.com/blog/2009/06/'> June 2009 &nbsp;(28)</option>
	<option value='http://www.markhneedham.com/blog/2009/05/'> May 2009 &nbsp;(28)</option>
	<option value='http://www.markhneedham.com/blog/2009/04/'> April 2009 &nbsp;(24)</option>
	<option value='http://www.markhneedham.com/blog/2009/03/'> March 2009 &nbsp;(25)</option>
	<option value='http://www.markhneedham.com/blog/2009/02/'> February 2009 &nbsp;(25)</option>
	<option value='http://www.markhneedham.com/blog/2009/01/'> January 2009 &nbsp;(25)</option>
	<option value='http://www.markhneedham.com/blog/2008/12/'> December 2008 &nbsp;(26)</option>
	<option value='http://www.markhneedham.com/blog/2008/11/'> November 2008 &nbsp;(30)</option>
	<option value='http://www.markhneedham.com/blog/2008/10/'> October 2008 &nbsp;(31)</option>
	<option value='http://www.markhneedham.com/blog/2008/09/'> September 2008 &nbsp;(24)</option>
	<option value='http://www.markhneedham.com/blog/2008/08/'> August 2008 &nbsp;(38)</option>
	<option value='http://www.markhneedham.com/blog/2008/07/'> July 2008 &nbsp;(2)</option>
	<option value='http://www.markhneedham.com/blog/2008/02/'> February 2008 &nbsp;(4)</option>
	<option value='http://www.markhneedham.com/blog/2006/09/'> September 2006 &nbsp;(4)</option>
	<option value='http://www.markhneedham.com/blog/2006/08/'> August 2006 &nbsp;(1)</option>
 </select>
<h3>Categories</h3>		<ul>
	<li class="cat-item cat-item-32"><a href="http://www.markhneedham.com/blog/category/dotnet/" title="View all posts filed under .NET">.NET</a> (67)
</li>
	<li class="cat-item cat-item-37"><a href="http://www.markhneedham.com/blog/category/agile/" title="View all posts filed under Agile">Agile</a> (61)
<ul class='children'>
	<li class="cat-item cat-item-367"><a href="http://www.markhneedham.com/blog/category/agile/distributed-agile/" title="View all posts filed under Distributed Agile">Distributed Agile</a> (14)
</li>
</ul>
</li>
	<li class="cat-item cat-item-478"><a href="http://www.markhneedham.com/blog/category/algorithms-2/" title="View all posts filed under Algorithms">Algorithms</a> (12)
</li>
	<li class="cat-item cat-item-426"><a href="http://www.markhneedham.com/blog/category/android-2/" title="View all posts filed under Android">Android</a> (11)
</li>
	<li class="cat-item cat-item-282"><a href="http://www.markhneedham.com/blog/category/book-club/" title="View all posts filed under Book Club">Book Club</a> (24)
</li>
	<li class="cat-item cat-item-126"><a href="http://www.markhneedham.com/blog/category/books/" title="View all posts filed under Books">Books</a> (33)
</li>
	<li class="cat-item cat-item-33"><a href="http://www.markhneedham.com/blog/category/build/" title="View all posts filed under Build">Build</a> (25)
</li>
	<li class="cat-item cat-item-5"><a href="http://www.markhneedham.com/blog/category/coding/" title="View all posts filed under Coding">Coding</a> (111)
<ul class='children'>
	<li class="cat-item cat-item-181"><a href="http://www.markhneedham.com/blog/category/coding/code-katas/" title="View all posts filed under Code Katas">Code Katas</a> (2)
</li>
	<li class="cat-item cat-item-349"><a href="http://www.markhneedham.com/blog/category/coding/incremental-refactoring/" title="View all posts filed under Incremental Refactoring">Incremental Refactoring</a> (9)
</li>
</ul>
</li>
	<li class="cat-item cat-item-199"><a href="http://www.markhneedham.com/blog/category/coding-dojo/" title="View all posts filed under Coding Dojo">Coding Dojo</a> (23)
</li>
	<li class="cat-item cat-item-7"><a href="http://www.markhneedham.com/blog/category/communication/" title="View all posts filed under Communication">Communication</a> (21)
</li>
	<li class="cat-item cat-item-527"><a href="http://www.markhneedham.com/blog/category/conferences/" title="View all posts filed under Conferences">Conferences</a> (13)
<ul class='children'>
	<li class="cat-item cat-item-251"><a href="http://www.markhneedham.com/blog/category/conferences/qcon/" title="View all posts filed under QCon">QCon</a> (4)
</li>
	<li class="cat-item cat-item-393"><a href="http://www.markhneedham.com/blog/category/conferences/xp-2011/" title="View all posts filed under XP 2011">XP 2011</a> (5)
</li>
	<li class="cat-item cat-item-416"><a href="http://www.markhneedham.com/blog/category/conferences/xp-day/" title="View all posts filed under XP Day">XP Day</a> (4)
</li>
</ul>
</li>
	<li class="cat-item cat-item-463"><a href="http://www.markhneedham.com/blog/category/data-science/" title="View all posts filed under Data Science">Data Science</a> (9)
</li>
	<li class="cat-item cat-item-529"><a href="http://www.markhneedham.com/blog/category/databases-2/" title="View all posts filed under Databases">Databases</a> (78)
<ul class='children'>
	<li class="cat-item cat-item-273"><a href="http://www.markhneedham.com/blog/category/databases-2/couchdb/" title="View all posts filed under CouchDB">CouchDB</a> (4)
</li>
	<li class="cat-item cat-item-398"><a href="http://www.markhneedham.com/blog/category/databases-2/mark-logic/" title="View all posts filed under Mark Logic">Mark Logic</a> (2)
</li>
	<li class="cat-item cat-item-436"><a href="http://www.markhneedham.com/blog/category/databases-2/neo4j/" title="View all posts filed under neo4j">neo4j</a> (72)
</li>
</ul>
</li>
	<li class="cat-item cat-item-365"><a href="http://www.markhneedham.com/blog/category/devops/" title="View all posts filed under DevOps">DevOps</a> (21)
</li>
	<li class="cat-item cat-item-144"><a href="http://www.markhneedham.com/blog/category/domain-driven-design/" title="View all posts filed under Domain Driven Design">Domain Driven Design</a> (12)
</li>
	<li class="cat-item cat-item-8"><a href="http://www.markhneedham.com/blog/category/feedback/" title="View all posts filed under Feedback">Feedback</a> (9)
</li>
	<li class="cat-item cat-item-511"><a href="http://www.markhneedham.com/blog/category/graph-processing/" title="View all posts filed under Graph Processing">Graph Processing</a> (2)
</li>
	<li class="cat-item cat-item-193"><a href="http://www.markhneedham.com/blog/category/hibernate/" title="View all posts filed under Hibernate">Hibernate</a> (7)
</li>
	<li class="cat-item cat-item-35"><a href="http://www.markhneedham.com/blog/category/hiring/" title="View all posts filed under Hiring">Hiring</a> (3)
</li>
	<li class="cat-item cat-item-362"><a href="http://www.markhneedham.com/blog/category/ipad-2/" title="View all posts filed under iPad">iPad</a> (2)
</li>
	<li class="cat-item cat-item-221"><a href="http://www.markhneedham.com/blog/category/jquery/" title="View all posts filed under jQuery">jQuery</a> (8)
</li>
	<li class="cat-item cat-item-530"><a href="http://www.markhneedham.com/blog/category/languages-2/" title="View all posts filed under Languages">Languages</a> (299)
<ul class='children'>
	<li class="cat-item cat-item-329"><a href="http://www.markhneedham.com/blog/category/languages-2/clojure/" title="View all posts filed under Clojure">Clojure</a> (38)
</li>
	<li class="cat-item cat-item-256"><a href="http://www.markhneedham.com/blog/category/languages-2/f-dotnet/" title="View all posts filed under F#">F#</a> (54)
</li>
	<li class="cat-item cat-item-333"><a href="http://www.markhneedham.com/blog/category/languages-2/haskell/" title="View all posts filed under Haskell">Haskell</a> (46)
</li>
	<li class="cat-item cat-item-355"><a href="http://www.markhneedham.com/blog/category/languages-2/j/" title="View all posts filed under J">J</a> (1)
</li>
	<li class="cat-item cat-item-141"><a href="http://www.markhneedham.com/blog/category/languages-2/java/" title="View all posts filed under Java">Java</a> (30)
</li>
	<li class="cat-item cat-item-219"><a href="http://www.markhneedham.com/blog/category/languages-2/javascript/" title="View all posts filed under Javascript">Javascript</a> (20)
</li>
	<li class="cat-item cat-item-359"><a href="http://www.markhneedham.com/blog/category/languages-2/objective-c/" title="View all posts filed under Objective C">Objective C</a> (4)
</li>
	<li class="cat-item cat-item-488"><a href="http://www.markhneedham.com/blog/category/languages-2/python-2/" title="View all posts filed under Python">Python</a> (11)
</li>
	<li class="cat-item cat-item-451"><a href="http://www.markhneedham.com/blog/category/languages-2/r/" title="View all posts filed under R">R</a> (7)
</li>
	<li class="cat-item cat-item-30"><a href="http://www.markhneedham.com/blog/category/languages-2/ruby/" title="View all posts filed under Ruby">Ruby</a> (59)
</li>
	<li class="cat-item cat-item-316"><a href="http://www.markhneedham.com/blog/category/languages-2/scala/" title="View all posts filed under Scala">Scala</a> (34)
</li>
</ul>
</li>
	<li class="cat-item cat-item-205"><a href="http://www.markhneedham.com/blog/category/lean/" title="View all posts filed under Lean">Lean</a> (3)
</li>
	<li class="cat-item cat-item-10"><a href="http://www.markhneedham.com/blog/category/learning/" title="View all posts filed under Learning">Learning</a> (32)
</li>
	<li class="cat-item cat-item-470"><a href="http://www.markhneedham.com/blog/category/machine-learning/" title="View all posts filed under Machine Learning">Machine Learning</a> (13)
</li>
	<li class="cat-item cat-item-109"><a href="http://www.markhneedham.com/blog/category/messaging/" title="View all posts filed under Messaging">Messaging</a> (2)
</li>
	<li class="cat-item cat-item-435"><a href="http://www.markhneedham.com/blog/category/micro-services/" title="View all posts filed under Micro Services">Micro Services</a> (5)
</li>
	<li class="cat-item cat-item-449"><a href="http://www.markhneedham.com/blog/category/networking/" title="View all posts filed under Networking">Networking</a> (6)
</li>
	<li class="cat-item cat-item-40"><a href="http://www.markhneedham.com/blog/category/oop/" title="View all posts filed under OOP">OOP</a> (7)
</li>
	<li class="cat-item cat-item-391"><a href="http://www.markhneedham.com/blog/category/organisational-patterns/" title="View all posts filed under Organisational Patterns">Organisational Patterns</a> (1)
</li>
	<li class="cat-item cat-item-12"><a href="http://www.markhneedham.com/blog/category/pair-programming/" title="View all posts filed under Pair Programming">Pair Programming</a> (28)
</li>
	<li class="cat-item cat-item-387"><a href="http://www.markhneedham.com/blog/category/product-development/" title="View all posts filed under Product Development">Product Development</a> (1)
</li>
	<li class="cat-item cat-item-255"><a href="http://www.markhneedham.com/blog/category/qtb/" title="View all posts filed under QTB">QTB</a> (5)
</li>
	<li class="cat-item cat-item-521"><a href="http://www.markhneedham.com/blog/category/ranking-systems-research/" title="View all posts filed under Ranking Systems">Ranking Systems</a> (4)
</li>
	<li class="cat-item cat-item-230"><a href="http://www.markhneedham.com/blog/category/reading-code/" title="View all posts filed under Reading Code">Reading Code</a> (7)
</li>
	<li class="cat-item cat-item-526"><a href="http://www.markhneedham.com/blog/category/scripting-2/" title="View all posts filed under Scripting">Scripting</a> (34)
<ul class='children'>
	<li class="cat-item cat-item-62"><a href="http://www.markhneedham.com/blog/category/scripting-2/batch-scripting/" title="View all posts filed under Batch Scripting">Batch Scripting</a> (4)
</li>
	<li class="cat-item cat-item-157"><a href="http://www.markhneedham.com/blog/category/scripting-2/shell-scripting/" title="View all posts filed under Shell Scripting">Shell Scripting</a> (30)
</li>
</ul>
</li>
	<li class="cat-item cat-item-370"><a href="http://www.markhneedham.com/blog/category/sicp/" title="View all posts filed under SICP">SICP</a> (1)
</li>
	<li class="cat-item cat-item-36"><a href="http://www.markhneedham.com/blog/category/software-development/" title="View all posts filed under Software Development">Software Development</a> (246)
</li>
	<li class="cat-item cat-item-374"><a href="http://www.markhneedham.com/blog/category/systems-thinking/" title="View all posts filed under Systems Thinking">Systems Thinking</a> (7)
</li>
	<li class="cat-item cat-item-138"><a href="http://www.markhneedham.com/blog/category/testing/" title="View all posts filed under Testing">Testing</a> (66)
</li>
	<li class="cat-item cat-item-357"><a href="http://www.markhneedham.com/blog/category/thoughtworks-university-2/" title="View all posts filed under ThoughtWorks University">ThoughtWorks University</a> (21)
</li>
	<li class="cat-item cat-item-78"><a href="http://www.markhneedham.com/blog/category/version-control/" title="View all posts filed under Version Control">Version Control</a> (17)
</li>
		</ul>


</div>

</div>

<div id="footer">
	<p>The Journalist template by <a href="http://lucianmarin.com/" rel="designer">Lucian E. Marin</a> &mdash; Built for <a href="http://wordpress.org/">WordPress</a></p>
</div>
<!--stats_footer_test--><script src="http://stats.wordpress.com/e-201350.js" type="text/javascript"></script>
<script type="text/javascript">
st_go({blog:'4492781',v:'ext',post:'5570'});
var load_cmc = function(){linktracker_init(4492781,5570,2);};
if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
else load_cmc();
</script>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{ 
var pageTracker = _gat._getTracker("UA-9991626-1");
pageTracker._trackPageview();
} catch(err) {} 
</script>


</body>
</html>
