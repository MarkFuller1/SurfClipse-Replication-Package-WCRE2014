<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
			<html>
				<head>
					<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
					<link rel="stylesheet" href="/nabble.pack.css?v=27" type="text/css" />
	<link rel="stylesheet" href="/template/NamlServlet.jtp?macro=site_style" type="text/css" />

<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
<style type="text/css">
body, input, button, textarea, select {
font-family: 'Open Sans';
}
</style>

<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
<style type="text/css">
.second-font, h1, h2, h3, h4, h5, h6 {
font-family: 'Open Sans';
}
</style>
					<script src="/util/jquery-1.7.2.pack.js" type="text/javascript"></script>
	<script src="/util/nabbledropdown-2.4.1.pack.js" type="text/javascript"></script>
	<script src="/template/NamlServlet.jtp?macro=javascript_library&amp;v=60" type="text/javascript"></script>
					<script type="text/javascript">
		var terms = Nabble.getSearchTerms();
		var hasTurnOff = false;
		Nabble.searchHighlight = function($elem) {
			if (terms != null && terms.length > 0) {
				$elem.each(function() {
					Nabble.highlightSearchTerms(terms, this);
				});
				if (Nabble.hasHighlightedTerms && !hasTurnOff) {
					var turnOffLink = '<span id="turn-off-highlight-control"><span class="highlight">&nbsp;X&nbsp;</span> ';
					turnOffLink += '<a href="javascript:void(0)" onclick="Nabble.turnOffHighlight()">Turn off highlighting</a></span>';
					$('#topics-controls-right').prepend(turnOffLink);
					hasTurnOff = true;
				}
			}
		};
		Nabble.turnOffHighlight = function() {
			Nabble.deleteCookie("query");
			Nabble.deleteCookie("searchuser");
			Nabble.deleteCookie("searchterms");
			$('span.search-highlight').removeClass('bold highlight');
			$('#turn-off-highlight-control').hide();
		};
	</script>
	<script type="text/javascript">
		Nabble.messageTextWidth();
	</script>
			<script type="text/javascript"> $(document).ready(function() { Nabble.searchHighlight($('h2.post-subject,div.message-text')); }); </script> <script type="text/javascript"> var _hash = Nabble.hash(); if (_hash) { (function(){ var post = _hash.substr(2); var allPosts = [2152420, 2152423, 2152425, 2152473, 2152493, 2152426, 2152474, 2152429, 2152476, 2152478, 2152480, 2152484, 2152486, 2152491, 2152490, 2152487, 2152471, 2152431, 2152434, 2152437, 2152470, 2152438, 2152440, 2152462, 2152468, 2152464, 2152465, 2152443, 2152445, 2152447, 2152459, 2152448, 2152457, 2152451, 2152455, 2152453]; var allURLs = ["/java-lang-OutOfMemoryError-Java-heap-space-td2152420.html" ,"/java-lang-OutOfMemoryError-Java-heap-space-td2152420i20.html"]; var iPost = allPosts.indexOf(parseInt(post)); var lower = 0; var upper = lower + 20; if (iPost != -1 && (iPost < lower || iPost >= upper)) location.replace(allURLs[Math.floor(iPost/20)]+_hash); })(); } $(document).ready(function() { var rootId = '2152420'; var currentPostId = rootId; var isChangingViews = _hash == '#none'; if (_hash && !isChangingViews) currentPostId = _hash.substr(2); Nabble.hideQuotes(); function scrollToSelectedPost() { var $arrow = $('#red-arrow'+currentPostId).show(); if ($arrow.size() > 0) { var isRootPost = currentPostId == rootId; if (Nabble.isEmbedded) { if (Nabble.canScroll()) scrollTo(0, 0); var y = isChangingViews? null : isRootPost? 1 : $arrow.parents('div.classic-row').offset().top; Nabble.resizeFrames('', y); } else if (Nabble.canScroll() && !isRootPost) { var yPos = $arrow.offset().top; scrollTo(0,yPos-20); } } else { if (Nabble.isEmbedded && Nabble.canScroll()) { Nabble.resizeFrames('', 1); } else { var tb = $('div.top-bar').get(0); if (tb) tb.scrollIntoView(); } } }; $(window).load(scrollToSelectedPost); if (Nabble.isEmbedded) { $('div.message-text img').load(Nabble.resizeFrames); } }); </script> <style type="text/css"> div.classic-header { height:2.2em; clear:both; overflow:hidden; } div.classic-author-name { float:left; width: 140px; overflow: hidden; text-align:center; font-weight:bold; } div.classic-subject-line { left:.5em; overflow:hidden; height:1.3em; position:relative; } div.classic-right-menu { float:right; padding-left:1em; } div.classic-bar { padding:.5em .3em; clear:both; height:1.8em; } table.classic-body { border-collapse:collapse; margin-bottom:1em; table-layout: fixed; width:100%; } td.classic-author { vertical-align: top; text-align:center; width:140px; padding-bottom:1em; } td.classic-message { vertical-align:top; padding:1em; } div.message-text { cursor:text; overflow-x:auto; } div.avatar-inner { margin-left:20px; } div.avatar-outer { width:140px; text-align:left; } div.avatar-label { white-space:nowrap; font-size:80%; } </style>

	<title>Tomcat - User - java.lang.OutOfMemoryError: Java heap space</title>
			<META NAME="description" CONTENT="java.lang.OutOfMemoryError: Java heap space. Hey All, I get this error (java.lang.OutOfMemoryError: Java heap space) after my Apache 2.0/Tomcat 5.5/mod_jk installation has been up and running for a..."/>
			<META NAME="keywords" CONTENT="java, lang, outofmemoryerror, heap, space, hey, all, get, error, after, my, apache, 2, 0, tomcat, 5, mod, jk, installation, has, up, running, for, few, hours, problem, started, just, since, -, user"/>
			<style type="text/css">
			#search-box-dropdown {
				text-align:left;
				position:absolute;
				display:none;
				z-index:1000;
				overflow:hidden;
			}
		</style>
		<script type="text/javascript">
			$(document).ready(function() {
				var $sdd = $('#search-box-dropdown');
				var $sb = $('#search-input');
				var $form = $sb.parent();
				var timeout;
				$(document).click(function(o){
					var $target = $(o.target);
					if ($target.parents().hasClass('search-box-dropdown')) {
						clearTimeout(timeout);
						$sb.focus();
					}
				});
				$sb.focusin(function(e) {
					$sdd.css('left', $sb.position().left - 5);
					$sdd.width($sb.outerWidth() + 10);
					$sdd.show();
				});
				$sb.focusout(function() {
					timeout = setTimeout(function() {
						$sdd.hide();
					},250);
				});
				$('input[type=radio]', $sdd).change(function() {
					var nodeId = $(this).val();
					$('input[name="node"]', $form).val(nodeId);
				});
				$('input[name="node"]', $form).val(1968777);
			});
		</script><script type="text/javascript">
			Nabble.setView = function(view,url,post) {
				Nabble.setVar("tview",view);
				url += Nabble.getClientID(';');
				if (url.indexOf('#') == -1)
					url += '#none';
				location.replace(url);
			};
		</script><style type="text/css"> div.nabble-tooltip, div.nabble-tooltip * { color: #EEE; font-weight:bold; } div.nabble-tooltip { background: #000; font-size:90%; line-height:normal; display: none; position: absolute; z-index: 88888; padding: .5em; border: 1px solid #FFF; white-space:normal; -moz-border-radius: 3px; -webkit-border-radius: 3px; border-radius: 3px; } div.nabble-tooltip-small-row, div.nabble-tooltip-small-row * { color:#D0EAF2; } div.nabble-tooltip-small-row { font-size:80%; font-weight:normal; padding-top: .4em; } div.nabble-tooltip-arrow { font: 40px Arial, Sans-serif; line-height:1em; left:15px; position:absolute; bottom:-15px; height:15px; width:30px; overflow:hidden; } div.nabble-tooltip-arrow div { position:absolute; } div.nabble-tooltip-arrow div.d1 { top:-22px; color: #FFF; } div.nabble-tooltip-arrow div.d2 { top:-25px; color: #000; } </style> <script type="text/javascript"> Nabble.startTooltip = function(e, position, delay) { if (e.nabbletooltip) return; e.nabbletooltip = true; var $this = $(e); var $arrow = $this.children().last(); var $elem = $this.prev(); $elem.hover( function() { setTip(); setTimer(); }, function() { stopTimer(); $this.hide(); } ); function setTimer() { $this.showTipTimer = setTimeout(function() { $('div.nabble-tooltip').hide(); stopTimer(); $this.fadeTo('fast', .8); }, delay); }; function stopTimer() { clearInterval($this.showTipTimer); }; function setTip(){ if ($this.parent().get() != document.body) $(document.body).append($this); var useTitle = $this.attr('use_title') == 'true'; if (useTitle) { var title = $elem.attr('title'); if (title != '') { $arrow.remove(); $this.html(title); $elem.attr('title',''); $this.append($arrow); } } var win = $(window).width(); if (position == 'up') { var w = $this.outerWidth(); if (w > 250) { w = 250; $this.width(w); } var xMid = $elem.offset().left + $elem.outerWidth()/2; var xTip = xMid - w/2; if (xTip+w > win-5) xTip = win-w-5; if (xTip < 0) xTip = 0; var xArrow = xMid-xTip-11; var yTip = $elem.offset().top-$this.outerHeight()-12; $arrow.css('left', xArrow); $this.css({'top' : yTip, 'left' : xTip}); } else if (position == 'right') { var h = $this.outerHeight(); var yMid = $elem.offset().top + $elem.outerHeight()/2; var yTip = yMid - h/2; var xTip = $elem.offset().left + $elem.outerWidth() + 10; $arrow.width(8).height(24).css({bottom:0,left:-8}); var yArrow = (h - 24)/2; $arrow.css({top:yArrow}); var $d1 = $arrow.children().first(); var $d2 = $arrow.children().last(); $d1.css({top:-11}); $d2.css({top:-11,left:1}); $this.css({'top' : yTip, 'left' : xTip}); } }; }; </script><script type="text/javascript">
			Nabble.pinTopic = function(id) {
				var call = '/template/NamlServlet.jtp?macro=pin_topic&node=' + id + Nabble.getClientID();
				$.getScript(call, function() {
					$('#pin-icon').show();
					NabbleDropdown.show('unpinTopic');
					NabbleDropdown.hide('pinTopic');
					alert('This topic has been pinned.');
				});
			};
		</script><script type="text/javascript">
			Nabble.unpinTopic = function(id) {
				var call = '/template/NamlServlet.jtp?macro=unpin_topic&node=' + id + Nabble.getClientID();
				$.getScript(call, function() {
					$('#pin-icon').hide();
					NabbleDropdown.hide('unpinTopic');
					NabbleDropdown.show('pinTopic');
					alert('This topic has been unpinned.');
				});
			};
		</script><script type="text/javascript">
			Nabble.lockTopic = function(id) {
				var call = '/template/NamlServlet.jtp?macro=lock_topic&node=' + id + Nabble.getClientID();
				$.getScript(call, function() {
					$('#lock-icon').show();
					NabbleDropdown.show('unlockTopic');
					NabbleDropdown.hide('lockTopic');
					alert('This topic has been locked.');
				});
			};
		</script><script type="text/javascript">
			Nabble.unlockTopic = function(id) {
				var call = '/template/NamlServlet.jtp?macro=unlock_topic&node=' + id + Nabble.getClientID();
				$.getScript(call, function() {
					$('#lock-icon').hide();
					NabbleDropdown.hide('unlockTopic');
					NabbleDropdown.show('lockTopic');
					alert('This topic has been unlocked.');
				});
			};
		</script><style type="text/css">
					span.current-page { padding: .1em .4em; }
					span.page { padding: .1em; }
					span.pages a { padding: .1em .4em; }
					span.current-page { border-width:1px; border-style:solid; }
					span.pages {
						float:right;
						white-space:nowrap;
						font-weight:normal;
					}
				</style><script type="text/javascript">
		var starredImg = new Image();
		starredImg.src = "/images/icon_starred.png";
		var unstarredImg = new Image();
		unstarredImg.src = "/images/icon_unstarred.png";
		var star = '<img src="/images/icon_starred.png" class="star" alt="star"/>';

		function starInit(isStarred, c, id) {
			$('#star'+c+id)
				.css('cursor','pointer')
				.click(function(){
					starToggle(c,id);
				});

			starShow(isStarred,c,id);
		};

		function starShow(isStarred,c,id) {
			var $img = $('#img-star'+c+id);
			if (isStarred)
				$img.attr('src', starredImg.src).attr('title', "Favorite (click to remove this item from your favorites list)");
			else
				$img.attr('src', unstarredImg.src).attr('title', "Add this item to your favorites list");
			updateReadonlyStars(isStarred, id);
		};

		function updateReadonlyStars(isStarred, id) {
			var $stars = $('#starC'+id+',#starD'+id);
			$stars.html(isStarred? star : '');
		};

		function starToggle(c,id) {
			if (!Nabble.userId) {
				if( confirm("You must log in to star this item.\nWould you like to login now?") ) {
					parent.location = "/template/NamlServlet.jtp?macro=login_page&nextUrl="+encodeURIComponent(parent.location) + Nabble.getClientID();
				}
				return;
			}
			var $img = $('#img-star'+c+id);
			var isStarred = $img.attr('src') == starredImg.src;
			isStarred = !isStarred;
			var descendants = c == 'A';
			var path = "/template/NamlServlet.jtp?node=" + id;
			if( descendants && !isStarred )
				path += "&macro=clear_descendant_stars";
			else
				path += "&macro=set_star&star=" + isStarred;
			$.getScript(path + Nabble.getClientID(), function() {
				starShow(isStarred,c,id);
			});
		};
	</script><script type="text/javascript" src="http://www.adbayes.com/LoadUnit.jtp?c=1"></script>
			<script type="text/javascript">
				Nabble.adbayes();
			</script><script type="text/javascript">
			Nabble.nViews = function(id, views) {
				var $v = $('#v'+id);
				var pos = views=='1'?0:1;
				var t = $v.html()? $v.html().split('|')[pos]:'';
				$v.html(t == ''? views : t.replace(/%1/g,views)).show();
			};
		</script><style type="text/css">
			img.report-flag {
				vertical-align:middle;
				cursor: pointer;
			}
			#report-inappropriate-content {
				position: fixed;
				z-index:9999;
				display:none;
				padding:1.5em;
				left:8%;
				right:8%;
				top:8%;
				background-color:#555;
			}
			#report-inappropriate-content-inner { padding:.5em; }
			#report-inappropriate-content-inner div.big {
				height:5em;
				padding-top:2em;
				text-align:center;
				font-size:250%;
			}
			#report-inappropriate-content-inner div.big2 { font-size:70%; }
			div.inappropriate-option { margin:.5em 0; }
		</style>
		<script type="text/javascript">
			var reportNodeId = null;
			Nabble.reportContent = function(nodeId) {
				reportNodeId = nodeId;
				$('#report-inappropriate-content').show();
				var url = '/template/NamlServlet.jtp?macro=report_inappropriate_content_form';
				$.get(url, function(data) {
					$('#report-inappropriate-content-inner').html(data);
				});
			}
			Nabble.closeReport = function() {
				$('#report-inappropriate-content').hide();
			}
			Nabble.sendReport = function() {
				$('#send-report-button').attr('disabled','true').addClass('toolbar-disabled');
				var type = $('input[name=report_type]:checked').val();
				var url = '/template/NamlServlet.jtp?macro=report_inappropriate_content_submit&node='+reportNodeId+'&type='+type+Nabble.getClientID();
				$.get(url, function(data) {
					var h = 'Thank You';
					h += '<div class="weak-color big2">We will review your report soon.</div>';
					h += '<a href="javascript: void Nabble.closeReport()">Close</a>';
					$('#report-inappropriate-content-inner').html('<div class="big">'+h+'</div>');
				});
			}
		</script>
					<script type="text/javascript">
		Nabble.setFontSize();
		
	</script>
	<script type="text/javascript">
		if (Nabble.analytics) Nabble.analytics();
	</script>
	<!-- Start Quantcast tag -->
	<script type="text/javascript">
		_qoptions={ qacct:"p-34EL1DZyJypTI" };
	</script>
	<script type="text/javascript" src="http://edge.quantserve.com/quant.js"></script>
	<noscript>
		<a href="http://www.quantcast.com/p-34EL1DZyJypTI" target="_blank" rel="nofollow">
			<img src="http://pixel.quantserve.com/pixel/p-34EL1DZyJypTI.gif" style="display: none;" border="0" height="1" width="1" alt="Quantcast"/>
		</a>
	</noscript>
	<!-- End Quantcast tag -->
	<!-- Start Google Analytics -->
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['nabble._setAccount', 'UA-91855-9']);
		_gaq.push(['nabble._trackPageview']);
		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>
	<!-- End Google Analytics -->
	<script type="text/javascript">
		var site_admins = [233867, 100293];
	</script>
	<script type="text/javascript">
		var isSafe = true;
		var Ads = Ads || {};
		Ads.text = {
			daysLeft: 'Trial period ends in $1 day(s)',
			removeAds: 'Remove Ads',
			buyCredits: 'Buy credits'
		};
		$(document).ready(function() {
			if (Nabble.wasCreatedRecently && Nabble.currentCredits == 0) {
				var s = '<div class="weak-color" style="text-align:center;margin:1em;font-size:80%">';
				s += Ads.text.daysLeft.replace(/\$1/,daysLeft)+' &ndash; ';
				s += '<a href="'+Nabble.buyCreditsPath+'">'+(Nabble.isSafe?Ads.text.removeAds:Ads.text.buyCredits)+'</a>';
				s += '</div>';
				var isAdmin = Nabble.userId && site_admins.indexOf(Number(Nabble.userId)) >= 0;
				if (!isSafe || isAdmin)
					$('div.nabble').append(s);
			}
		});
	</script>
	<script type="text/javascript">
		$(document).ready(function() {
			if (Nabble.userId && site_admins.indexOf(Number(Nabble.userId)) >= 0)
				$('div.no-ads-message').show();
		});
	</script>
				</head>
				<body>
					<div id="notice" class="notice rounded-bottom"></div>
					<div class="nabble macro_classic_forum_topic" id="nabble">
						
			
			<div class="top-bar">
		<div class="breadcrumbs" style="float:left">
			<span id="breadcrumbs" class="weak-color">
		<a href="http://tomcat.10.x6.nabble.com/">Tomcat</a>
						<span> &rsaquo; </span>
				<a href="http://tomcat.10.x6.nabble.com/Tomcat-User-f1968778.html">Tomcat - User</a>
	</span>
		</div>
		<div style="text-align:right;">
			<span style="white-space:nowrap;" id="nabble-user-header"></span>
	<script type="text/javascript">Nabble.userHeader();</script>
		</div>
	</div>
			
			<div id="nabble-newsflash" class="info-message" style="display:none;padding:.5em;margin-bottom:.5em"></div>
	
			<div id="topic-search-box" class="search-box float-right" style="padding:.5em 0">
		<form action="/template/NamlServlet.jtp">
		<input type="hidden" name="macro" value="search_page" />
		<input type="hidden" name="node" value="2152420" />
		
		
		
		
		<input id="search-input" name="query" size="18" class="medium-border-color"/>
		<div id="search-box-dropdown" class="search-box-dropdown light-bg-color drop-shadow border1 medium-border-color rounded-bottom">
		<div style="margin:.5em .5em 0 .5em">
					<b>Search</b><br/>
					<input id="search-root-node" type="radio" name="n" value="1968777" checked="true"/>
					<label for="search-root-node">everywhere</label><br/>

					<input id="search-this-node" type="radio" name="n" value="2152420"/>
					<label for="search-this-node">
						only in this topic
					</label>
				</div>
		<div style="margin:.5em;line-height:2em">
			<input class="toolbar action-button float-right" type="submit" value="Search"/>
			<a href="/template/NamlServlet.jtp?macro=adv_search_page&amp;node=2152420" rel="nofollow" style="font-size:80%">Advanced Search</a>
		</div>
	</div>
	</form>
	</div>

	<h1 id="post-title" class="adbayes-content" style="margin:0.25em 0 .8em">
		java.lang.OutOfMemoryError: Java heap space
	</h1>
			<div style="margin:1.2em 0 5em">
		<div id="topics-controls-left" class="float-left nowrap">
			<table>
		<tr>
			<td style="padding-right:.1em">
		<img src="/images/view-classic.gif" width="18" height="18" style="border:none" alt="classic"/>
	</td>

	<td style="padding-right:1.1em">
		Classic
	</td>

			<td style="padding-right:.1em">
		<a href="javascript:void(0)" onclick="Nabble.setView('list', '/java-lang-OutOfMemoryError-Java-heap-space-tc2152420.html',null)"><img src="/images/view-list.gif" width="18" height="18" style="border:none" alt="list"/></a>
	</td>

	<td style="padding-right:1.1em">
		<a href="javascript:void(0)" onclick="Nabble.setView('list', '/java-lang-OutOfMemoryError-Java-heap-space-tc2152420.html',null)">List</a>
	</td>

			<td style="padding-right:.1em">
		<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html',null)"><img src="/images/view-threaded.gif" width="18" height="18" style="border:none" alt="threaded"/></a>
	</td>

	<td style="padding-right:1.1em">
		<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html',null)">Threaded</a>
	</td>
		</tr>
	</table>
		</div>
		<div id="topics-controls-right" class="float-right nowrap" style="padding-top:.3em">
			<span style="padding-right:1em;height:21px">
		<img id="pin-icon" src="/images/pin.png" width="20" height="21" title="This topic has been pinned in Tomcat - User." style="vertical-align:middle;display:none;"/>
		<div id="tooltip85579" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip85579'), 'up', 400);
	</script>
	</span>
	<span id="lock-icon" class="weak-color" style="padding:0 .5em;margin-right:.5em;display:none;">
		<img src="/images/lock_sm.png" width="10" height="15" style="vertical-align:middle"/> Locked
	</span>
	<span style="padding-right:1em">
		36 messages
	</span>
	<img src="/images/gear.png" class="image16" alt="Options"/>
	<span id="dd_topicdropdown"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("topicdropdown", "Options","Click for more options");
		
		dropdown.add('topicSubscriptionLink', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dsubscribe&amp;node\x3D2152420\" rel\x3D\"nofollow\"\x3ESubscribe via email\x3C/a\x3E');
		dropdown.addSeparator();
		dropdown.add('moveTopic', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152420\" rel\x3D\"nofollow\"\x3EMove topic\x3C/a\x3E', 'display:none');
		dropdown.add('pinTopic', '\x3Ca href\x3D\"javascript: void Nabble.pinTopic(2152420)\" rel\x3D\"nofollow\"\x3EPin topic\x3C/a\x3E', 'display:none');
		dropdown.add('unpinTopic', '\x3Ca href\x3D\"javascript: void Nabble.unpinTopic(2152420)\" rel\x3D\"nofollow\"\x3EUnpin topic\x3C/a\x3E', 'display:none');
		dropdown.add('lockTopic', '\x3Ca href\x3D\"javascript: void Nabble.lockTopic(2152420)\" rel\x3D\"nofollow\"\x3ELock topic\x3C/a\x3E', 'display:none');
		dropdown.add('unlockTopic', '\x3Ca href\x3D\"javascript: void Nabble.unlockTopic(2152420)\" rel\x3D\"nofollow\"\x3EUnlock topic\x3C/a\x3E', 'display:none');
		dropdown.add('deleteRecursively', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152420)\" rel\x3D\"nofollow\"\x3EDelete this topic\x3C/a\x3E', 'display:none');
			dropdown.add('deletePost', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152420)\" rel\x3D\"nofollow\"\x3EDelete this topic\x3C/a\x3E', 'display:none');
		dropdown.add('changeMetaTags', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_title_and_meta_tags&amp;node\x3D2152420\" rel\x3D\"nofollow\"\x3EChange title and meta tags\x3C/a\x3E', 'display:none');
		dropdown.add('embedPost2152420', '\x3Ca href\x3D\"/embed/EmbedOptions.jtp?node\x3D2152420\" rel\x3D\"nofollow\"\x3EEmbed post\x3C/a\x3E');
		dropdown.add('permalink2152420', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.build('dd_topicdropdown');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=topic_dropdown_later&node=2152420' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
		</div>
	</div>
			<div id="topic-contents" style="margin-top:1em;clear:both">
		<div id="classic-contents">
		<span class="pages" style="padding:0 .2em .5em"><span class="current-page medium-border-color">1</span><span class="page"><a href="/java-lang-OutOfMemoryError-Java-heap-space-td2152420i20.html" title="Page 2">2</a></span></span>
		<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943">Joe Hansen-2</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152420" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html',2152420)">Threaded</a>
	<div id="tooltip95459" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip95459'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152420"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152420", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152420', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152420\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152420', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152420\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152420', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152420\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152420', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152420)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152420', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152420)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152420', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152420\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152420', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152420\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152420', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152420', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152420\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152420');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152420' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152420)"/>
	<div id="tooltip27845" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip27845'), 'up', 400);
	</script>
					<span id="starB2152420">
		<img id="img-starB2152420" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip36392" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip36392'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152420" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254593274000-570"></span><script type="text/javascript">
		Nabble.get('d1254593274000-570').innerHTML= Nabble.formatDateLong(new Date(1254593274000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943" rel="nofollow" title="View profile of Joe Hansen-2" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/a375116adb0355cac9751a275da78243?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Joe Hansen-2" title="Joe Hansen-2"/><img src="/images/online.png" class="online111943 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count111943 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152420" class="message-text adbayes-content">
		Hey All,
<br/><br/>I get this error (java.lang.OutOfMemoryError: Java heap space) after
<br/>my Apache 2.0/Tomcat 5.5/mod_jk installation has been up and running
<br/>for a few hours. This problem started just since two days. Never had
<br/>this issue before!
<br/><br/>I have also noticed that as soon as I startup the server, 9 httpd
<br/>processes start. Number of httpd processes keep on increasing until I
<br/>get the OutOfMemoryError.
<br/>$ps -aef | grep httpd
<br/>root &nbsp; &nbsp; 31984 &nbsp; &nbsp; 1 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>apache &nbsp; 31987 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>apache &nbsp; 31988 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>apache &nbsp; 31989 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>apache &nbsp; 31990 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>apache &nbsp; 31991 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>apache &nbsp; 31992 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>apache &nbsp; 31993 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>apache &nbsp; 31994 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/><br/>$ps -aef | grep tomcat
<br/>root &nbsp; &nbsp; 31949 &nbsp; &nbsp; 1 43 11:23 pts/0 &nbsp; &nbsp;00:00:58 /usr/java/jdk/bin/java -Djava.u
<br/>il.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.co
<br/>fig.file=/usr/lib/apache-tomcat/conf/logging.properties -Djava.endorsed.dirs=/u
<br/>r/lib/apache-tomcat/common/endorsed -classpath :/usr/lib/apache-tomcat/bin/boot
<br/>trap.jar:/usr/lib/apache-tomcat/bin/commons-logging-api.jar -Dcatalina.base=/us
<br/>/lib/apache-tomcat -Dcatalina.home=/usr/lib/apache-tomcat -Djava.io.tmpdir=/usr
<br/>lib/apache-tomcat/temp org.apache.catalina.startup.Bootstrap start
<br/><br/>Can someone on this list please help me resolve this issue.
<br/><br/>Thanks you,
<br/>Joe
<br/><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152420&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152420&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	<script type="text/javascript">
				Nabble.ads('first_classic_message');
			</script>
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143">Rainer Jung-3</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152423" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152423',2152423)">Threaded</a>
	<div id="tooltip10919" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip10919'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152423"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152423", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152423', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152423\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152423', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152423\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152423', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152423\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152423', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152423)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152423', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152423)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152423', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152423\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152423', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152423\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152423', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152423.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152423', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152423\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152423');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152423' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152423)"/>
	<div id="tooltip35221" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip35221'), 'up', 400);
	</script>
					<span id="starB2152423">
		<img id="img-starB2152423" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip63659" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip63659'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152423" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254594285000-45"></span><script type="text/javascript">
		Nabble.get('d1254594285000-45').innerHTML= Nabble.formatDateLong(new Date(1254594285000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143" rel="nofollow" title="View profile of Rainer Jung-3" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/7ddfb840a4db40a01ac99d29e82267b0?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Rainer Jung-3" title="Rainer Jung-3"/><img src="/images/online.png" class="online102143 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count102143 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152423" class="message-text adbayes-content">
		On 03.10.2009 20:07, Joe Hansen wrote:
<div class='shrinkable-quote'><br/>&gt; Hey All,
<br/>&gt; 
<br/>&gt; I get this error (java.lang.OutOfMemoryError: Java heap space) after
<br/>&gt; my Apache 2.0/Tomcat 5.5/mod_jk installation has been up and running
<br/>&gt; for a few hours. This problem started just since two days. Never had
<br/>&gt; this issue before!
<br/>&gt; 
<br/>&gt; I have also noticed that as soon as I startup the server, 9 httpd
<br/>&gt; processes start. Number of httpd processes keep on increasing until I
<br/>&gt; get the OutOfMemoryError.
<br/>&gt; $ps -aef | grep httpd
<br/>&gt; root &nbsp; &nbsp; 31984 &nbsp; &nbsp; 1 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt; apache &nbsp; 31987 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt; apache &nbsp; 31988 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt; apache &nbsp; 31989 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt; apache &nbsp; 31990 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt; apache &nbsp; 31991 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt; apache &nbsp; 31992 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt; apache &nbsp; 31993 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt; apache &nbsp; 31994 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
</div><br/>Sounds like requests get stuck or responses are only returned very slowly.
<br/><br/>I would take thread dumps during the time requests pile up (e.g. httpd
<br/>process count increases). Thread dumps are generated by &quot;kil -QUIT&quot;
<br/>against the Tomcat process. Result is written to catalina.out. Always
<br/>take afew thread dumps shortly after each other, e.g. 3 dumps each 3
<br/>seconds apart from the previous one, so that you can find out, if a
<br/>status in a dump is pure coincidence or lasts for somewhat longer.
<br/><br/>&gt; $ps -aef | grep tomcat
<br/>&gt; root &nbsp; &nbsp; 31949 &nbsp; &nbsp; 1 43 11:23 pts/0 &nbsp; &nbsp;00:00:58 /usr/java/jdk/bin/java -Djava.u
<br/>&gt; il.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.co
<br/>&gt; fig.file=/usr/lib/apache-tomcat/conf/logging.properties -Djava.endorsed.dirs=/u
<br/>&gt; r/lib/apache-tomcat/common/endorsed -classpath :/usr/lib/apache-tomcat/bin/boot
<br/>&gt; trap.jar:/usr/lib/apache-tomcat/bin/commons-logging-api.jar -Dcatalina.base=/us
<br/>&gt; /lib/apache-tomcat -Dcatalina.home=/usr/lib/apache-tomcat -Djava.io.tmpdir=/usr
<br/>&gt; lib/apache-tomcat/temp org.apache.catalina.startup.Bootstrap start
<br/><br/>There is no Java memory configuration included above (i.e. al defaults).
<br/>It might well be, that you have to explicitely set heap size, perm size
<br/>and if you like also eden and semi spaces.
<br/><br/>&gt; Can someone on this list please help me resolve this issue.
<br/>&gt; 
<br/>&gt; Thanks you,
<br/>&gt; Joe
<br/><br/>Regards,
<br/><br/>Rainer
<br/><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152423&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152423&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943">Joe Hansen-2</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152425" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152425',2152425)">Threaded</a>
	<div id="tooltip12983" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip12983'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152425"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152425", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152425', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152425\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152425', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152425\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152425', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152425\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152425', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152425)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152425', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152425)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152425', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152425\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152425', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152425\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152425', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152425.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152425', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152425\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152425');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152425' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152425)"/>
	<div id="tooltip18347" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip18347'), 'up', 400);
	</script>
					<span id="starB2152425">
		<img id="img-starB2152425" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip55669" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip55669'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152425" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254685537000-427"></span><script type="text/javascript">
		Nabble.get('d1254685537000-427').innerHTML= Nabble.formatDateLong(new Date(1254685537000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943" rel="nofollow" title="View profile of Joe Hansen-2" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/a375116adb0355cac9751a275da78243?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Joe Hansen-2" title="Joe Hansen-2"/><img src="/images/online.png" class="online111943 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count111943 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152425" class="message-text adbayes-content">
		Rainer, Thank you so much for your kind reply!
<br/><br/>I have increased the java heap size to 512MB (-Xms512m -Xmx512m). I am
<br/>hoping that would fix the issue. I had configured our webserver to use
<br/>Jasig's Central Authentication System (CAS). Recently I increased the
<br/>session timeout from 30 minutes to 4 hours. I am guessing that must
<br/>have had an impact on the number of tickets that the CAS could store
<br/>in the Java's memory space.
<br/><br/>I did run the kill -QUIT command against the tomcat process. It did
<br/>generate a huge output in the catalina.out file. I am unable to
<br/>decipher it. I do not want to post it to the mailing list because its
<br/>very long. Would you be able to please tell me what should I be
<br/>looking for within this long thread dump?
<br/><br/>Thanks again, Rainer :)
<br/><br/>Joe
<br/><br/>On Sat, Oct 3, 2009 at 12:24 PM, Rainer Jung &lt;<a href="/user/SendEmail.jtp?type=node&node=2152425&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<div class='shrinkable-quote'><br/>&gt; On 03.10.2009 20:07, Joe Hansen wrote:
<br/>&gt;&gt; Hey All,
<br/>&gt;&gt;
<br/>&gt;&gt; I get this error (java.lang.OutOfMemoryError: Java heap space) after
<br/>&gt;&gt; my Apache 2.0/Tomcat 5.5/mod_jk installation has been up and running
<br/>&gt;&gt; for a few hours. This problem started just since two days. Never had
<br/>&gt;&gt; this issue before!
<br/>&gt;&gt;
<br/>&gt;&gt; I have also noticed that as soon as I startup the server, 9 httpd
<br/>&gt;&gt; processes start. Number of httpd processes keep on increasing until I
<br/>&gt;&gt; get the OutOfMemoryError.
<br/>&gt;&gt; $ps -aef | grep httpd
<br/>&gt;&gt; root     31984     1  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt; apache   31987 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt; apache   31988 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt; apache   31989 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt; apache   31990 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt; apache   31991 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt; apache   31992 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt; apache   31993 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt; apache   31994 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;
<br/>&gt; Sounds like requests get stuck or responses are only returned very slowly.
<br/>&gt;
<br/>&gt; I would take thread dumps during the time requests pile up (e.g. httpd
<br/>&gt; process count increases). Thread dumps are generated by &quot;kil -QUIT&quot;
<br/>&gt; against the Tomcat process. Result is written to catalina.out. Always
<br/>&gt; take afew thread dumps shortly after each other, e.g. 3 dumps each 3
<br/>&gt; seconds apart from the previous one, so that you can find out, if a
<br/>&gt; status in a dump is pure coincidence or lasts for somewhat longer.
<br/>&gt;
<br/>&gt;&gt; $ps -aef | grep tomcat
<br/>&gt;&gt; root     31949     1 43 11:23 pts/0    00:00:58 /usr/java/jdk/bin/java -Djava.u
<br/>&gt;&gt; il.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.co
<br/>&gt;&gt; fig.file=/usr/lib/apache-tomcat/conf/logging.properties -Djava.endorsed.dirs=/u
<br/>&gt;&gt; r/lib/apache-tomcat/common/endorsed -classpath :/usr/lib/apache-tomcat/bin/boot
<br/>&gt;&gt; trap.jar:/usr/lib/apache-tomcat/bin/commons-logging-api.jar -Dcatalina.base=/us
<br/>&gt;&gt; /lib/apache-tomcat -Dcatalina.home=/usr/lib/apache-tomcat -Djava.io.tmpdir=/usr
<br/>&gt;&gt; lib/apache-tomcat/temp org.apache.catalina.startup.Bootstrap start
<br/>&gt;
<br/>&gt; There is no Java memory configuration included above (i.e. al defaults).
<br/>&gt; It might well be, that you have to explicitely set heap size, perm size
<br/>&gt; and if you like also eden and semi spaces.
<br/>&gt;
<br/>&gt;&gt; Can someone on this list please help me resolve this issue.
<br/>&gt;&gt;
<br/>&gt;&gt; Thanks you,
<br/>&gt;&gt; Joe
<br/>&gt;
<br/>&gt; Regards,
<br/>&gt;
<br/>&gt; Rainer
<br/>&gt;
<br/>&gt; ---------------------------------------------------------------------
<br/>&gt; To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152425&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt; For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152425&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt;
<br/>&gt;
</div><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152425&i=3" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152425&i=4" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943">Joe Hansen-2</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152473" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152473',2152473)">Threaded</a>
	<div id="tooltip16774" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip16774'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152473"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152473", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152473', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152473\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152473', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152473\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152473', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152473\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152473', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152473)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152473', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152473)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152473', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152473\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152473', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152473\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152473', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152473.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152473', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152473\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152473');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152473' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152473)"/>
	<div id="tooltip57607" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip57607'), 'up', 400);
	</script>
					<span id="starB2152473">
		<img id="img-starB2152473" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip73904" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip73904'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152473" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254687445000-315"></span><script type="text/javascript">
		Nabble.get('d1254687445000-315').innerHTML= Nabble.formatDateLong(new Date(1254687445000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943" rel="nofollow" title="View profile of Joe Hansen-2" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/a375116adb0355cac9751a275da78243?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Joe Hansen-2" title="Joe Hansen-2"/><img src="/images/online.png" class="online111943 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count111943 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152473" class="message-text adbayes-content">
		I found the following error message in the Apache logs:
<br/>[Sat Oct 03 04:10:49 2009] [error] server reached MaxClients setting,
<br/>consider raising the MaxClients setting
<br/><br/>Here's a snippet from the httpd.conf, which deals with MaxClients.
<br/>&lt;IfModule prefork.c&gt;
<br/>StartServers &nbsp; &nbsp; &nbsp; 8
<br/>MinSpareServers &nbsp; &nbsp;5
<br/>MaxSpareServers &nbsp; 20
<br/>ServerLimit &nbsp; &nbsp; &nbsp;256
<br/>MaxClients &nbsp; &nbsp; &nbsp; 256
<br/>MaxRequestsPerChild &nbsp;4000
<br/>&lt;/IfModule&gt;
<br/><br/>&lt;IfModule worker.c&gt;
<br/>StartServers &nbsp; &nbsp; &nbsp; &nbsp; 2
<br/>MaxClients &nbsp; &nbsp; &nbsp; &nbsp; 150
<br/>MinSpareThreads &nbsp; &nbsp; 25
<br/>MaxSpareThreads &nbsp; &nbsp; 75
<br/>ThreadsPerChild &nbsp; &nbsp; 25
<br/>MaxRequestsPerChild &nbsp;0
<br/>&lt;/IfModule&gt;
<br/><br/>I will watch out for the increase in the number of httpd processes. I
<br/>am wondering if I should raise the MaxClients value in prefork.c and
<br/>worker.c modules. Can anyone on this forum please explain why new
<br/>httpd processes are spawned and why aren't the old processes
<br/>terminated?
<br/><br/>Thanks,
<br/>Joe
<br/><br/>On Sun, Oct 4, 2009 at 1:45 PM, Joe Hansen &lt;<a href="/user/SendEmail.jtp?type=node&node=2152473&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<div class='shrinkable-quote'><br/>&gt; Rainer, Thank you so much for your kind reply!
<br/>&gt;
<br/>&gt; I have increased the java heap size to 512MB (-Xms512m -Xmx512m). I am
<br/>&gt; hoping that would fix the issue. I had configured our webserver to use
<br/>&gt; Jasig's Central Authentication System (CAS). Recently I increased the
<br/>&gt; session timeout from 30 minutes to 4 hours. I am guessing that must
<br/>&gt; have had an impact on the number of tickets that the CAS could store
<br/>&gt; in the Java's memory space.
<br/>&gt;
<br/>&gt; I did run the kill -QUIT command against the tomcat process. It did
<br/>&gt; generate a huge output in the catalina.out file. I am unable to
<br/>&gt; decipher it. I do not want to post it to the mailing list because its
<br/>&gt; very long. Would you be able to please tell me what should I be
<br/>&gt; looking for within this long thread dump?
<br/>&gt;
<br/>&gt; Thanks again, Rainer :)
<br/>&gt;
<br/>&gt; Joe
<br/>&gt;
<br/>&gt; On Sat, Oct 3, 2009 at 12:24 PM, Rainer Jung &lt;<a href="/user/SendEmail.jtp?type=node&node=2152473&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<br/>&gt;&gt; On 03.10.2009 20:07, Joe Hansen wrote:
<br/>&gt;&gt;&gt; Hey All,
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; I get this error (java.lang.OutOfMemoryError: Java heap space) after
<br/>&gt;&gt;&gt; my Apache 2.0/Tomcat 5.5/mod_jk installation has been up and running
<br/>&gt;&gt;&gt; for a few hours. This problem started just since two days. Never had
<br/>&gt;&gt;&gt; this issue before!
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; I have also noticed that as soon as I startup the server, 9 httpd
<br/>&gt;&gt;&gt; processes start. Number of httpd processes keep on increasing until I
<br/>&gt;&gt;&gt; get the OutOfMemoryError.
<br/>&gt;&gt;&gt; $ps -aef | grep httpd
<br/>&gt;&gt;&gt; root     31984     1  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache   31987 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache   31988 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache   31989 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache   31990 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache   31991 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache   31992 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache   31993 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache   31994 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;
<br/>&gt;&gt; Sounds like requests get stuck or responses are only returned very slowly.
<br/>&gt;&gt;
<br/>&gt;&gt; I would take thread dumps during the time requests pile up (e.g. httpd
<br/>&gt;&gt; process count increases). Thread dumps are generated by &quot;kil -QUIT&quot;
<br/>&gt;&gt; against the Tomcat process. Result is written to catalina.out. Always
<br/>&gt;&gt; take afew thread dumps shortly after each other, e.g. 3 dumps each 3
<br/>&gt;&gt; seconds apart from the previous one, so that you can find out, if a
<br/>&gt;&gt; status in a dump is pure coincidence or lasts for somewhat longer.
<br/>&gt;&gt;
<br/>&gt;&gt;&gt; $ps -aef | grep tomcat
<br/>&gt;&gt;&gt; root     31949     1 43 11:23 pts/0    00:00:58 /usr/java/jdk/bin/java -Djava.u
<br/>&gt;&gt;&gt; il.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.co
<br/>&gt;&gt;&gt; fig.file=/usr/lib/apache-tomcat/conf/logging.properties -Djava.endorsed.dirs=/u
<br/>&gt;&gt;&gt; r/lib/apache-tomcat/common/endorsed -classpath :/usr/lib/apache-tomcat/bin/boot
<br/>&gt;&gt;&gt; trap.jar:/usr/lib/apache-tomcat/bin/commons-logging-api.jar -Dcatalina.base=/us
<br/>&gt;&gt;&gt; /lib/apache-tomcat -Dcatalina.home=/usr/lib/apache-tomcat -Djava.io.tmpdir=/usr
<br/>&gt;&gt;&gt; lib/apache-tomcat/temp org.apache.catalina.startup.Bootstrap start
<br/>&gt;&gt;
<br/>&gt;&gt; There is no Java memory configuration included above (i.e. al defaults).
<br/>&gt;&gt; It might well be, that you have to explicitely set heap size, perm size
<br/>&gt;&gt; and if you like also eden and semi spaces.
<br/>&gt;&gt;
<br/>&gt;&gt;&gt; Can someone on this list please help me resolve this issue.
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; Thanks you,
<br/>&gt;&gt;&gt; Joe
<br/>&gt;&gt;
<br/>&gt;&gt; Regards,
<br/>&gt;&gt;
<br/>&gt;&gt; Rainer
<br/>&gt;&gt;
<br/>&gt;&gt; ---------------------------------------------------------------------
<br/>&gt;&gt; To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152473&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt;&gt; For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152473&i=3" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt;&gt;
<br/>&gt;&gt;
<br/>&gt;
</div><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152473&i=4" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152473&i=5" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143">Rainer Jung-3</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152493" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152493',2152493)">Threaded</a>
	<div id="tooltip15324" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip15324'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152493"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152493", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152493', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152493\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152493', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152493\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152493', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152493\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152493', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152493)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152493', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152493)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152493', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152493\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152493', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152493\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152493', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152493.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152493', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152493\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152493');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152493' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152493)"/>
	<div id="tooltip54019" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip54019'), 'up', 400);
	</script>
					<span id="starB2152493">
		<img id="img-starB2152493" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip13501" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip13501'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152493" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254688405000-867"></span><script type="text/javascript">
		Nabble.get('d1254688405000-867').innerHTML= Nabble.formatDateLong(new Date(1254688405000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143" rel="nofollow" title="View profile of Rainer Jung-3" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/7ddfb840a4db40a01ac99d29e82267b0?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Rainer Jung-3" title="Rainer Jung-3"/><img src="/images/online.png" class="online102143 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count102143 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152493" class="message-text adbayes-content">
		On 04.10.2009 22:17, Joe Hansen wrote:
<div class='shrinkable-quote'><br/>&gt; I found the following error message in the Apache logs:
<br/>&gt; [Sat Oct 03 04:10:49 2009] [error] server reached MaxClients setting,
<br/>&gt; consider raising the MaxClients setting
<br/>&gt; 
<br/>&gt; Here's a snippet from the httpd.conf, which deals with MaxClients.
<br/>&gt; &lt;IfModule prefork.c&gt;
<br/>&gt; StartServers &nbsp; &nbsp; &nbsp; 8
<br/>&gt; MinSpareServers &nbsp; &nbsp;5
<br/>&gt; MaxSpareServers &nbsp; 20
<br/>&gt; ServerLimit &nbsp; &nbsp; &nbsp;256
<br/>&gt; MaxClients &nbsp; &nbsp; &nbsp; 256
<br/>&gt; MaxRequestsPerChild &nbsp;4000
<br/>&gt; &lt;/IfModule&gt;
<br/>&gt; 
<br/>&gt; &lt;IfModule worker.c&gt;
<br/>&gt; StartServers &nbsp; &nbsp; &nbsp; &nbsp; 2
<br/>&gt; MaxClients &nbsp; &nbsp; &nbsp; &nbsp; 150
<br/>&gt; MinSpareThreads &nbsp; &nbsp; 25
<br/>&gt; MaxSpareThreads &nbsp; &nbsp; 75
<br/>&gt; ThreadsPerChild &nbsp; &nbsp; 25
<br/>&gt; MaxRequestsPerChild &nbsp;0
<br/>&gt; &lt;/IfModule&gt;
<br/>&gt; 
<br/>&gt; I will watch out for the increase in the number of httpd processes. I
<br/>&gt; am wondering if I should raise the MaxClients value in prefork.c and
<br/>&gt; worker.c modules. Can anyone on this forum please explain why new
<br/>&gt; httpd processes are spawned and why aren't the old processes
<br/>&gt; terminated?
</div><br/>Likely because requests get stuck (no responses are returned), so the
<br/>web server waits very long for Tomcat to produce a request and the
<br/>stream of incoming new requests fill up all available threads in the web
<br/>server. To find the reason, the thread dumps will be helpful.
<br/><br/>Regards,
<br/><br/>Rainer
<br/><div class='shrinkable-quote'><br/>&gt; On Sun, Oct 4, 2009 at 1:45 PM, Joe Hansen &lt;<a href="/user/SendEmail.jtp?type=node&node=2152493&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<br/>&gt;&gt; Rainer, Thank you so much for your kind reply!
<br/>&gt;&gt;
<br/>&gt;&gt; I have increased the java heap size to 512MB (-Xms512m -Xmx512m). I am
<br/>&gt;&gt; hoping that would fix the issue. I had configured our webserver to use
<br/>&gt;&gt; Jasig's Central Authentication System (CAS). Recently I increased the
<br/>&gt;&gt; session timeout from 30 minutes to 4 hours. I am guessing that must
<br/>&gt;&gt; have had an impact on the number of tickets that the CAS could store
<br/>&gt;&gt; in the Java's memory space.
<br/>&gt;&gt;
<br/>&gt;&gt; I did run the kill -QUIT command against the tomcat process. It did
<br/>&gt;&gt; generate a huge output in the catalina.out file. I am unable to
<br/>&gt;&gt; decipher it. I do not want to post it to the mailing list because its
<br/>&gt;&gt; very long. Would you be able to please tell me what should I be
<br/>&gt;&gt; looking for within this long thread dump?
<br/>&gt;&gt;
<br/>&gt;&gt; Thanks again, Rainer :)
<br/>&gt;&gt;
<br/>&gt;&gt; Joe
<br/>&gt;&gt;
<br/>&gt;&gt; On Sat, Oct 3, 2009 at 12:24 PM, Rainer Jung &lt;<a href="/user/SendEmail.jtp?type=node&node=2152493&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<br/>&gt;&gt;&gt; On 03.10.2009 20:07, Joe Hansen wrote:
<br/>&gt;&gt;&gt;&gt; Hey All,
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; I get this error (java.lang.OutOfMemoryError: Java heap space) after
<br/>&gt;&gt;&gt;&gt; my Apache 2.0/Tomcat 5.5/mod_jk installation has been up and running
<br/>&gt;&gt;&gt;&gt; for a few hours. This problem started just since two days. Never had
<br/>&gt;&gt;&gt;&gt; this issue before!
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; I have also noticed that as soon as I startup the server, 9 httpd
<br/>&gt;&gt;&gt;&gt; processes start. Number of httpd processes keep on increasing until I
<br/>&gt;&gt;&gt;&gt; get the OutOfMemoryError.
<br/>&gt;&gt;&gt;&gt; $ps -aef | grep httpd
<br/>&gt;&gt;&gt;&gt; root &nbsp; &nbsp; 31984 &nbsp; &nbsp; 1 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache &nbsp; 31987 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache &nbsp; 31988 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache &nbsp; 31989 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache &nbsp; 31990 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache &nbsp; 31991 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache &nbsp; 31992 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache &nbsp; 31993 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache &nbsp; 31994 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; Sounds like requests get stuck or responses are only returned very slowly.
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; I would take thread dumps during the time requests pile up (e.g. httpd
<br/>&gt;&gt;&gt; process count increases). Thread dumps are generated by &quot;kil -QUIT&quot;
<br/>&gt;&gt;&gt; against the Tomcat process. Result is written to catalina.out. Always
<br/>&gt;&gt;&gt; take afew thread dumps shortly after each other, e.g. 3 dumps each 3
<br/>&gt;&gt;&gt; seconds apart from the previous one, so that you can find out, if a
<br/>&gt;&gt;&gt; status in a dump is pure coincidence or lasts for somewhat longer.
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; $ps -aef | grep tomcat
<br/>&gt;&gt;&gt;&gt; root &nbsp; &nbsp; 31949 &nbsp; &nbsp; 1 43 11:23 pts/0 &nbsp; &nbsp;00:00:58 /usr/java/jdk/bin/java -Djava.u
<br/>&gt;&gt;&gt;&gt; il.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.co
<br/>&gt;&gt;&gt;&gt; fig.file=/usr/lib/apache-tomcat/conf/logging.properties -Djava.endorsed.dirs=/u
<br/>&gt;&gt;&gt;&gt; r/lib/apache-tomcat/common/endorsed -classpath :/usr/lib/apache-tomcat/bin/boot
<br/>&gt;&gt;&gt;&gt; trap.jar:/usr/lib/apache-tomcat/bin/commons-logging-api.jar -Dcatalina.base=/us
<br/>&gt;&gt;&gt;&gt; /lib/apache-tomcat -Dcatalina.home=/usr/lib/apache-tomcat -Djava.io.tmpdir=/usr
<br/>&gt;&gt;&gt;&gt; lib/apache-tomcat/temp org.apache.catalina.startup.Bootstrap start
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; There is no Java memory configuration included above (i.e. al defaults).
<br/>&gt;&gt;&gt; It might well be, that you have to explicitely set heap size, perm size
<br/>&gt;&gt;&gt; and if you like also eden and semi spaces.
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; Can someone on this list please help me resolve this issue.
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; Thanks you,
<br/>&gt;&gt;&gt;&gt; Joe
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; Regards,
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; Rainer
</div><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152493&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152493&i=3" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143">Rainer Jung-3</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152426" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152426',2152426)">Threaded</a>
	<div id="tooltip69448" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip69448'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152426"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152426", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152426', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152426\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152426', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152426\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152426', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152426\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152426', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152426)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152426', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152426)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152426', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152426\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152426', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152426\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152426', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152426.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152426', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152426\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152426');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152426' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152426)"/>
	<div id="tooltip62352" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip62352'), 'up', 400);
	</script>
					<span id="starB2152426">
		<img id="img-starB2152426" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip38888" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip38888'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152426" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254688566000-481"></span><script type="text/javascript">
		Nabble.get('d1254688566000-481').innerHTML= Nabble.formatDateLong(new Date(1254688566000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143" rel="nofollow" title="View profile of Rainer Jung-3" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/7ddfb840a4db40a01ac99d29e82267b0?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Rainer Jung-3" title="Rainer Jung-3"/><img src="/images/online.png" class="online102143 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count102143 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	<div class="weak-color" style="font-size:80%;padding-bottom:1em">
				In reply to <a href="http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152425.html" rel="nofollow">this post</a> by Joe Hansen-2
			</div>
	<div id="message2152426" class="message-text adbayes-content">
		Hi Joe,
<br/><br/>On 04.10.2009 21:45, Joe Hansen wrote:
<div class='shrinkable-quote'><br/>&gt; Rainer, Thank you so much for your kind reply!
<br/>&gt; 
<br/>&gt; I have increased the java heap size to 512MB (-Xms512m -Xmx512m). I am
<br/>&gt; hoping that would fix the issue. I had configured our webserver to use
<br/>&gt; Jasig's Central Authentication System (CAS). Recently I increased the
<br/>&gt; session timeout from 30 minutes to 4 hours. I am guessing that must
<br/>&gt; have had an impact on the number of tickets that the CAS could store
<br/>&gt; in the Java's memory space.
<br/>&gt; 
<br/>&gt; I did run the kill -QUIT command against the tomcat process. It did
<br/>&gt; generate a huge output in the catalina.out file. I am unable to
<br/>&gt; decipher it. I do not want to post it to the mailing list because its
<br/>&gt; very long. Would you be able to please tell me what should I be
<br/>&gt; looking for within this long thread dump?
</div><br/>Can you put it somewhere on the web, so we can look at it, or are you
<br/>afraid there is something private in there? You could use pastebin or
<br/>something similar in case you do not have a public web server yourself.
<br/><br/>If you don't want to post in public, you can also mail it to me, I will
<br/>post the result, in case I find something relevant.
<br/><br/>Regards,
<br/><br/>Rainer
<br/><div class='shrinkable-quote'><br/>&gt; On Sat, Oct 3, 2009 at 12:24 PM, Rainer Jung &lt;<a href="/user/SendEmail.jtp?type=node&node=2152426&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<br/>&gt;&gt; On 03.10.2009 20:07, Joe Hansen wrote:
<br/>&gt;&gt;&gt; Hey All,
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; I get this error (java.lang.OutOfMemoryError: Java heap space) after
<br/>&gt;&gt;&gt; my Apache 2.0/Tomcat 5.5/mod_jk installation has been up and running
<br/>&gt;&gt;&gt; for a few hours. This problem started just since two days. Never had
<br/>&gt;&gt;&gt; this issue before!
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; I have also noticed that as soon as I startup the server, 9 httpd
<br/>&gt;&gt;&gt; processes start. Number of httpd processes keep on increasing until I
<br/>&gt;&gt;&gt; get the OutOfMemoryError.
<br/>&gt;&gt;&gt; $ps -aef | grep httpd
<br/>&gt;&gt;&gt; root &nbsp; &nbsp; 31984 &nbsp; &nbsp; 1 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache &nbsp; 31987 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache &nbsp; 31988 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache &nbsp; 31989 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache &nbsp; 31990 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache &nbsp; 31991 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache &nbsp; 31992 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache &nbsp; 31993 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt; apache &nbsp; 31994 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;
<br/>&gt;&gt; Sounds like requests get stuck or responses are only returned very slowly.
<br/>&gt;&gt;
<br/>&gt;&gt; I would take thread dumps during the time requests pile up (e.g. httpd
<br/>&gt;&gt; process count increases). Thread dumps are generated by &quot;kil -QUIT&quot;
<br/>&gt;&gt; against the Tomcat process. Result is written to catalina.out. Always
<br/>&gt;&gt; take afew thread dumps shortly after each other, e.g. 3 dumps each 3
<br/>&gt;&gt; seconds apart from the previous one, so that you can find out, if a
<br/>&gt;&gt; status in a dump is pure coincidence or lasts for somewhat longer.
<br/>&gt;&gt;
<br/>&gt;&gt;&gt; $ps -aef | grep tomcat
<br/>&gt;&gt;&gt; root &nbsp; &nbsp; 31949 &nbsp; &nbsp; 1 43 11:23 pts/0 &nbsp; &nbsp;00:00:58 /usr/java/jdk/bin/java -Djava.u
<br/>&gt;&gt;&gt; il.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.co
<br/>&gt;&gt;&gt; fig.file=/usr/lib/apache-tomcat/conf/logging.properties -Djava.endorsed.dirs=/u
<br/>&gt;&gt;&gt; r/lib/apache-tomcat/common/endorsed -classpath :/usr/lib/apache-tomcat/bin/boot
<br/>&gt;&gt;&gt; trap.jar:/usr/lib/apache-tomcat/bin/commons-logging-api.jar -Dcatalina.base=/us
<br/>&gt;&gt;&gt; /lib/apache-tomcat -Dcatalina.home=/usr/lib/apache-tomcat -Djava.io.tmpdir=/usr
<br/>&gt;&gt;&gt; lib/apache-tomcat/temp org.apache.catalina.startup.Bootstrap start
<br/>&gt;&gt;
<br/>&gt;&gt; There is no Java memory configuration included above (i.e. al defaults).
<br/>&gt;&gt; It might well be, that you have to explicitely set heap size, perm size
<br/>&gt;&gt; and if you like also eden and semi spaces.
<br/>&gt;&gt;
<br/>&gt;&gt;&gt; Can someone on this list please help me resolve this issue.
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; Thanks you,
<br/>&gt;&gt;&gt; Joe
<br/>&gt;&gt;
<br/>&gt;&gt; Regards,
<br/>&gt;&gt;
<br/>&gt;&gt; Rainer
<br/>&gt;&gt;
</div><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152426&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152426&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=100297">André Warnier</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152474" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152474',2152474)">Threaded</a>
	<div id="tooltip45342" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip45342'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152474"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152474", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152474', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152474\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152474', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152474\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152474', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152474\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152474', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152474)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152474', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152474)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152474', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152474\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152474', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152474\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152474', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152474.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152474', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152474\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152474');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152474' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152474)"/>
	<div id="tooltip91308" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip91308'), 'up', 400);
	</script>
					<span id="starB2152474">
		<img id="img-starB2152474" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip19805" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip19805'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152474" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254694607000-785"></span><script type="text/javascript">
		Nabble.get('d1254694607000-785').innerHTML= Nabble.formatDateLong(new Date(1254694607000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=100297" rel="nofollow" title="View profile of André Warnier" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/1f75ad12f8d82a83ec9db22be5882fa8?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="André Warnier" title="André Warnier"/><img src="/images/online.png" class="online100297 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count100297 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	<div class="weak-color" style="font-size:80%;padding-bottom:1em">
				In reply to <a href="http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152473.html" rel="nofollow">this post</a> by Joe Hansen-2
			</div>
	<div id="message2152474" class="message-text adbayes-content">
		Joe Hansen wrote:
<div class='shrinkable-quote'><br/>&gt; I found the following error message in the Apache logs:
<br/>&gt; [Sat Oct 03 04:10:49 2009] [error] server reached MaxClients setting,
<br/>&gt; consider raising the MaxClients setting
<br/>&gt; 
<br/>&gt; Here's a snippet from the httpd.conf, which deals with MaxClients.
<br/>&gt; &lt;IfModule prefork.c&gt;
<br/>&gt; StartServers &nbsp; &nbsp; &nbsp; 8
<br/>&gt; MinSpareServers &nbsp; &nbsp;5
<br/>&gt; MaxSpareServers &nbsp; 20
<br/>&gt; ServerLimit &nbsp; &nbsp; &nbsp;256
<br/>&gt; MaxClients &nbsp; &nbsp; &nbsp; 256
<br/>&gt; MaxRequestsPerChild &nbsp;4000
<br/>&gt; &lt;/IfModule&gt;
<br/>&gt; 
<br/>&gt; &lt;IfModule worker.c&gt;
<br/>&gt; StartServers &nbsp; &nbsp; &nbsp; &nbsp; 2
<br/>&gt; MaxClients &nbsp; &nbsp; &nbsp; &nbsp; 150
<br/>&gt; MinSpareThreads &nbsp; &nbsp; 25
<br/>&gt; MaxSpareThreads &nbsp; &nbsp; 75
<br/>&gt; ThreadsPerChild &nbsp; &nbsp; 25
<br/>&gt; MaxRequestsPerChild &nbsp;0
<br/>&gt; &lt;/IfModule&gt;
<br/>&gt; 
<br/>&gt; I will watch out for the increase in the number of httpd processes. I
<br/>&gt; am wondering if I should raise the MaxClients value in prefork.c and
<br/>&gt; worker.c modules. Can anyone on this forum please explain why new
<br/>&gt; httpd processes are spawned and why aren't the old processes
<br/>&gt; terminated?
<br/>&gt; 
</div>What are your KeepAlive* settings ?
<br/><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152474&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152474&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943">Joe Hansen-2</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152429" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152429',2152429)">Threaded</a>
	<div id="tooltip39346" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip39346'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152429"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152429", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152429', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152429\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152429', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152429\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152429', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152429\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152429', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152429)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152429', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152429)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152429', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152429\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152429', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152429\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152429', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152429.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152429', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152429\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152429');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152429' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152429)"/>
	<div id="tooltip72500" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip72500'), 'up', 400);
	</script>
					<span id="starB2152429">
		<img id="img-starB2152429" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip10673" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip10673'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152429" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254761890000-762"></span><script type="text/javascript">
		Nabble.get('d1254761890000-762').innerHTML= Nabble.formatDateLong(new Date(1254761890000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943" rel="nofollow" title="View profile of Joe Hansen-2" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/a375116adb0355cac9751a275da78243?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Joe Hansen-2" title="Joe Hansen-2"/><img src="/images/online.png" class="online111943 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count111943 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	<div class="weak-color" style="font-size:80%;padding-bottom:1em">
				In reply to <a href="http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152426.html" rel="nofollow">this post</a> by Rainer Jung-3
			</div>
	<div id="message2152429" class="message-text adbayes-content">
		Thank you so much for your tips, Rainer!
<br/><br/>The websites went down yet again. Increasing the java heap size took
<br/>care of the OutOfMemoryError, but the number of httpd processes keep
<br/>increasing until the websites crash. I haven't added any new code in
<br/>the past few months, hence I am surprised why the requests are getting
<br/>stuck. Here's a link to the tomcat thread dumps:
<br/><a href="http://pastebin.com/m17eea139" target="_top" rel="nofollow" link="external">http://pastebin.com/m17eea139</a><br/><br/>Please let me know if you cannot view it and I will email the relevant
<br/>portion of the catalina.out file to you. Is there an easy way to find
<br/>out what code is causing the requests to get stuck?
<br/><br/>Thank you!
<br/><br/>Joe
<br/><br/><br/>On Sun, Oct 4, 2009 at 2:36 PM, Rainer Jung &lt;<a href="/user/SendEmail.jtp?type=node&node=2152429&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<div class='shrinkable-quote'><br/>&gt; Hi Joe,
<br/>&gt;
<br/>&gt; On 04.10.2009 21:45, Joe Hansen wrote:
<br/>&gt;&gt; Rainer, Thank you so much for your kind reply!
<br/>&gt;&gt;
<br/>&gt;&gt; I have increased the java heap size to 512MB (-Xms512m -Xmx512m). I am
<br/>&gt;&gt; hoping that would fix the issue. I had configured our webserver to use
<br/>&gt;&gt; Jasig's Central Authentication System (CAS). Recently I increased the
<br/>&gt;&gt; session timeout from 30 minutes to 4 hours. I am guessing that must
<br/>&gt;&gt; have had an impact on the number of tickets that the CAS could store
<br/>&gt;&gt; in the Java's memory space.
<br/>&gt;&gt;
<br/>&gt;&gt; I did run the kill -QUIT command against the tomcat process. It did
<br/>&gt;&gt; generate a huge output in the catalina.out file. I am unable to
<br/>&gt;&gt; decipher it. I do not want to post it to the mailing list because its
<br/>&gt;&gt; very long. Would you be able to please tell me what should I be
<br/>&gt;&gt; looking for within this long thread dump?
<br/>&gt;
<br/>&gt; Can you put it somewhere on the web, so we can look at it, or are you
<br/>&gt; afraid there is something private in there? You could use pastebin or
<br/>&gt; something similar in case you do not have a public web server yourself.
<br/>&gt;
<br/>&gt; If you don't want to post in public, you can also mail it to me, I will
<br/>&gt; post the result, in case I find something relevant.
<br/>&gt;
<br/>&gt; Regards,
<br/>&gt;
<br/>&gt; Rainer
<br/>&gt;
<br/>&gt;&gt; On Sat, Oct 3, 2009 at 12:24 PM, Rainer Jung &lt;<a href="/user/SendEmail.jtp?type=node&node=2152429&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<br/>&gt;&gt;&gt; On 03.10.2009 20:07, Joe Hansen wrote:
<br/>&gt;&gt;&gt;&gt; Hey All,
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; I get this error (java.lang.OutOfMemoryError: Java heap space) after
<br/>&gt;&gt;&gt;&gt; my Apache 2.0/Tomcat 5.5/mod_jk installation has been up and running
<br/>&gt;&gt;&gt;&gt; for a few hours. This problem started just since two days. Never had
<br/>&gt;&gt;&gt;&gt; this issue before!
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; I have also noticed that as soon as I startup the server, 9 httpd
<br/>&gt;&gt;&gt;&gt; processes start. Number of httpd processes keep on increasing until I
<br/>&gt;&gt;&gt;&gt; get the OutOfMemoryError.
<br/>&gt;&gt;&gt;&gt; $ps -aef | grep httpd
<br/>&gt;&gt;&gt;&gt; root     31984     1  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache   31987 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache   31988 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache   31989 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache   31990 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache   31991 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache   31992 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache   31993 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt; apache   31994 31984  0 11:23 ?        00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; Sounds like requests get stuck or responses are only returned very slowly.
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; I would take thread dumps during the time requests pile up (e.g. httpd
<br/>&gt;&gt;&gt; process count increases). Thread dumps are generated by &quot;kil -QUIT&quot;
<br/>&gt;&gt;&gt; against the Tomcat process. Result is written to catalina.out. Always
<br/>&gt;&gt;&gt; take afew thread dumps shortly after each other, e.g. 3 dumps each 3
<br/>&gt;&gt;&gt; seconds apart from the previous one, so that you can find out, if a
<br/>&gt;&gt;&gt; status in a dump is pure coincidence or lasts for somewhat longer.
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; $ps -aef | grep tomcat
<br/>&gt;&gt;&gt;&gt; root     31949     1 43 11:23 pts/0    00:00:58 /usr/java/jdk/bin/java -Djava.u
<br/>&gt;&gt;&gt;&gt; il.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.co
<br/>&gt;&gt;&gt;&gt; fig.file=/usr/lib/apache-tomcat/conf/logging.properties -Djava.endorsed.dirs=/u
<br/>&gt;&gt;&gt;&gt; r/lib/apache-tomcat/common/endorsed -classpath :/usr/lib/apache-tomcat/bin/boot
<br/>&gt;&gt;&gt;&gt; trap.jar:/usr/lib/apache-tomcat/bin/commons-logging-api.jar -Dcatalina.base=/us
<br/>&gt;&gt;&gt;&gt; /lib/apache-tomcat -Dcatalina.home=/usr/lib/apache-tomcat -Djava.io.tmpdir=/usr
<br/>&gt;&gt;&gt;&gt; lib/apache-tomcat/temp org.apache.catalina.startup.Bootstrap start
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; There is no Java memory configuration included above (i.e. al defaults).
<br/>&gt;&gt;&gt; It might well be, that you have to explicitely set heap size, perm size
<br/>&gt;&gt;&gt; and if you like also eden and semi spaces.
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; Can someone on this list please help me resolve this issue.
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; Thanks you,
<br/>&gt;&gt;&gt;&gt; Joe
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; Regards,
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; Rainer
<br/>&gt;&gt;&gt;
<br/>&gt;
<br/>&gt; ---------------------------------------------------------------------
<br/>&gt; To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152429&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt; For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152429&i=3" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt;
<br/>&gt;
</div><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152429&i=4" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152429&i=5" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943">Joe Hansen-2</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152476" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152476',2152476)">Threaded</a>
	<div id="tooltip39003" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip39003'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152476"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152476", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152476', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152476\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152476', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152476\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152476', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152476\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152476', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152476)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152476', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152476)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152476', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152476\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152476', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152476\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152476', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152476.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152476', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152476\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152476');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152476' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152476)"/>
	<div id="tooltip76383" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip76383'), 'up', 400);
	</script>
					<span id="starB2152476">
		<img id="img-starB2152476" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip2525" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip2525'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152476" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254764871000-4"></span><script type="text/javascript">
		Nabble.get('d1254764871000-4').innerHTML= Nabble.formatDateLong(new Date(1254764871000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943" rel="nofollow" title="View profile of Joe Hansen-2" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/a375116adb0355cac9751a275da78243?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Joe Hansen-2" title="Joe Hansen-2"/><img src="/images/online.png" class="online111943 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count111943 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	<div class="weak-color" style="font-size:80%;padding-bottom:1em">
				In reply to <a href="http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152474.html" rel="nofollow">this post</a> by André Warnier
			</div>
	<div id="message2152476" class="message-text adbayes-content">
		Rainer,
<br/><br/>Here are the KeepAlive values in httpd.conf:
<br/><br/>KeepAlive Off
<br/>MaxKeepAliveRequests 100
<br/>KeepAliveTimout 15
<br/><br/>Thanks,
<br/>Joe
<br/><br/>&gt; What are your KeepAlive* settings ?
<br/>&gt;
<br/><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152476&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152476&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=100297">André Warnier</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152478" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152478',2152478)">Threaded</a>
	<div id="tooltip680" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip680'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152478"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152478", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152478', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152478\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152478', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152478\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152478', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152478\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152478', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152478)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152478', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152478)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152478', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152478\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152478', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152478\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152478', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152478.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152478', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152478\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152478');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152478' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152478)"/>
	<div id="tooltip36093" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip36093'), 'up', 400);
	</script>
					<span id="starB2152478">
		<img id="img-starB2152478" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip22853" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip22853'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152478" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254769499000-606"></span><script type="text/javascript">
		Nabble.get('d1254769499000-606').innerHTML= Nabble.formatDateLong(new Date(1254769499000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=100297" rel="nofollow" title="View profile of André Warnier" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/1f75ad12f8d82a83ec9db22be5882fa8?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="André Warnier" title="André Warnier"/><img src="/images/online.png" class="online100297 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count100297 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152478" class="message-text adbayes-content">
		Joe Hansen wrote:
<br/>&gt; Rainer,
<br/>&gt; 
<br/>&gt; Here are the KeepAlive values in httpd.conf:
<br/>&gt; 
<br/>&gt; KeepAlive Off
<br/>&gt; MaxKeepAliveRequests 100
<br/>&gt; KeepAliveTimout 15
<br/>&gt; 
<br/>Well, since you have &quot;KeepAlive Off&quot;, the other 2 do not matter.
<br/>But as such, it means that each request of each browser is going to 
<br/>create a new connection to the webserver, just for that one request.
<br/>So if there is a page with 10 &lt;img&gt; links inside, you will end up 
<br/>establishing (and tearing down) a total of 11 TCP connections (one for 
<br/>the main page, one each for each &lt;img&gt;).
<br/>That may or may not have a bearing on the situation you are seeing.
<br/><br/><br/><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152478&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152478&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943">Joe Hansen-2</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152480" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152480',2152480)">Threaded</a>
	<div id="tooltip66003" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip66003'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152480"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152480", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152480', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152480\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152480', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152480\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152480', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152480\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152480', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152480)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152480', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152480)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152480', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152480\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152480', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152480\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152480', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152480.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152480', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152480\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152480');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152480' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152480)"/>
	<div id="tooltip8710" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip8710'), 'up', 400);
	</script>
					<span id="starB2152480">
		<img id="img-starB2152480" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip77470" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip77470'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152480" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254771034000-809"></span><script type="text/javascript">
		Nabble.get('d1254771034000-809').innerHTML= Nabble.formatDateLong(new Date(1254771034000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943" rel="nofollow" title="View profile of Joe Hansen-2" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/a375116adb0355cac9751a275da78243?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Joe Hansen-2" title="Joe Hansen-2"/><img src="/images/online.png" class="online111943 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count111943 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152480" class="message-text adbayes-content">
		Thank you for the reply, Andre.
<br/><br/>I now understand how setting KeepAlive to On would improve the
<br/>performance of a website (The Apache manual says that a 50% increase
<br/>in throughput could be expected). So I changed the KeepAlive to On and
<br/>restarted the server.
<br/><br/>I however wonder if this will fix the issue. The reason being, I
<br/>haven't changed the website code at all the past few months and there
<br/>hasn't been any increase in the website traffic too. Hence I am unable
<br/>to understand why we are suddenly seeing an increase in the number of
<br/>httpd processes. The only thing I changed is the session-timeout value
<br/>from 30 minutes to 240 minutes.
<br/><br/>Thanks,
<br/>Joe
<br/><br/><br/><br/><br/>On Mon, Oct 5, 2009 at 1:04 PM, André Warnier &lt;<a href="/user/SendEmail.jtp?type=node&node=2152480&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<div class='shrinkable-quote'><br/>&gt; Joe Hansen wrote:
<br/>&gt;&gt;
<br/>&gt;&gt; Rainer,
<br/>&gt;&gt;
<br/>&gt;&gt; Here are the KeepAlive values in httpd.conf:
<br/>&gt;&gt;
<br/>&gt;&gt; KeepAlive Off
<br/>&gt;&gt; MaxKeepAliveRequests 100
<br/>&gt;&gt; KeepAliveTimout 15
<br/>&gt;&gt;
<br/>&gt; Well, since you have &quot;KeepAlive Off&quot;, the other 2 do not matter.
<br/>&gt; But as such, it means that each request of each browser is going to create a
<br/>&gt; new connection to the webserver, just for that one request.
<br/>&gt; So if there is a page with 10 &lt;img&gt; links inside, you will end up
<br/>&gt; establishing (and tearing down) a total of 11 TCP connections (one for the
<br/>&gt; main page, one each for each &lt;img&gt;).
<br/>&gt; That may or may not have a bearing on the situation you are seeing.
<br/>&gt;
<br/>&gt;
<br/>&gt;
<br/>&gt; ---------------------------------------------------------------------
<br/>&gt; To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152480&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt; For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152480&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt;
<br/>&gt;
</div><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152480&i=3" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152480&i=4" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=100297">André Warnier</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152484" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152484',2152484)">Threaded</a>
	<div id="tooltip35571" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip35571'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152484"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152484", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152484', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152484\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152484', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152484\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152484', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152484\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152484', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152484)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152484', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152484)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152484', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152484\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152484', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152484\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152484', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152484.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152484', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152484\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152484');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152484' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152484)"/>
	<div id="tooltip15652" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip15652'), 'up', 400);
	</script>
					<span id="starB2152484">
		<img id="img-starB2152484" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip84308" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip84308'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152484" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254772403000-798"></span><script type="text/javascript">
		Nabble.get('d1254772403000-798').innerHTML= Nabble.formatDateLong(new Date(1254772403000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=100297" rel="nofollow" title="View profile of André Warnier" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/1f75ad12f8d82a83ec9db22be5882fa8?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="André Warnier" title="André Warnier"/><img src="/images/online.png" class="online100297 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count100297 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152484" class="message-text adbayes-content">
		Joe Hansen wrote:
<br/>&gt; Thank you for the reply, Andre.
<br/>&gt; 
<br/>&gt; I now understand how setting KeepAlive to On would improve the
<br/>&gt; performance of a website (The Apache manual says that a 50% increase
<br/>&gt; in throughput could be expected). So I changed the KeepAlive to On and
<br/>&gt; restarted the server.
<br/><br/>Now wait.
<br/>You should probably then lower your setting for KeepAliveTimeout (to 3 
<br/>e.g.), otherwise you may make the problem much worse.
<br/>Read conscienciously the relevant Apache doc page :
<br/><a href="http://httpd.apache.org/docs/2.2/mod/core.html#keepalive" target="_top" rel="nofollow" link="external">http://httpd.apache.org/docs/2.2/mod/core.html#keepalive</a><br/><br/>The point with KeepAlive is :
<br/>- the browser makes a connection and issues a first request
<br/>- the webserver dedicates a child (or thread) to this connection, and 
<br/>passes it the first request
<br/>- the child/thread responds to the first request, and then waits for more
<br/>- the browser, in the response page, finds more links. Over the same TCP 
<br/>connection, it sends the next request
<br/>- the same child/thread - which was waiting on that connection - 
<br/>receives the new request, and responds to it. Then it waits again for 
<br/>the next one.
<br/>- etc..
<br/>- until at some point, the browser does not issue any additional 
<br/>requests on the connection. Then, *after the KeepAliveTimeout has 
<br/>expired*, the child/thread gives up, closesthe connection, and returns 
<br/>to the pool available for other requests from other browsers
<br/><br/>So the point is, if the KeepAliveTimeout is long (like 15 seconds), it 
<br/>means that a child/thread may be kept waiting, for nothing, up to that 
<br/>many seconds, although there is nothing coming anymore.
<br/><br/>&gt; 
<br/>&gt; I however wonder if this will fix the issue. The reason being, I
<br/>&gt; haven't changed the website code at all the past few months and there
<br/>&gt; hasn't been any increase in the website traffic too. Hence I am unable
<br/>&gt; to understand why we are suddenly seeing an increase in the number of
<br/>&gt; httpd processes. The only thing I changed is the session-timeout value
<br/>&gt; from 30 minutes to 240 minutes.
<br/>&gt; 
<br/>I guess that this is the Tomcat session timeout. &nbsp;That should have 
<br/>nothing to do with the above. &nbsp;I don't think that for Tomcat, a 
<br/>&quot;session&quot; is linked to a connection. It is more of a set of data saved 
<br/>somewhere, linked to the Tomcat session-id (the JSESSIONID cookie for 
<br/>instance). &nbsp;Tomcar retrieves it whenever a request comes in with the 
<br/>same session-id number. &nbsp;But it should not matter whether it is on the 
<br/>same TCP connection or not.
<br/><br/>What may be linked together however, is that one request to httpd 
<br/>results in one child/thread busy with it at the Apache httpd level. If 
<br/>that request is being forwarded to Tomcat by mod_jk, then it also holds 
<br/>onto one mod_jk/Tomcat connection. This connection then holds on to one 
<br/>thread in Tomcat, until the Tomcat thread (+webapp) has supplied the 
<br/>full response. All the while, this whole chain is unavailable for other 
<br/>requests. &nbsp;Thus, if there are many such requests under way, many Apache 
<br/>children/threads are busy, and Apache httpd will start additional ones 
<br/>(up to its limit) to service new requests that come in.
<br/>So if for some reason, your Tomcat requests now take longer to be 
<br/>serviced, that should also, by retro-effect, increase the number of 
<br/>httpd children/threads being started.
<br/>The bottleneck would be in Tomcat, but it would show up at the httpd level.
<br/><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152484&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152484&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=100297">André Warnier</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152486" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152486',2152486)">Threaded</a>
	<div id="tooltip92779" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip92779'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152486"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152486", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152486', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152486\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152486', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152486\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152486', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152486\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152486', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152486)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152486', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152486)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152486', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152486\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152486', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152486\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152486', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152486.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152486', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152486\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152486');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152486' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152486)"/>
	<div id="tooltip29672" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip29672'), 'up', 400);
	</script>
					<span id="starB2152486">
		<img id="img-starB2152486" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip83893" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip83893'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152486" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254773058000-758"></span><script type="text/javascript">
		Nabble.get('d1254773058000-758').innerHTML= Nabble.formatDateLong(new Date(1254773058000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=100297" rel="nofollow" title="View profile of André Warnier" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/1f75ad12f8d82a83ec9db22be5882fa8?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="André Warnier" title="André Warnier"/><img src="/images/online.png" class="online100297 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count100297 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152486" class="message-text adbayes-content">
		André Warnier wrote:
<br/>...
<br/>and still wants to add something :
<br/><br/>- a new KeepAlive connection is made from the browser to Apache (httpd).
<br/>- then a request comes in on that connection, and it happens to be one 
<br/>that gets forwarded to Tomcat. &nbsp;So a mod_jk connection is made to 
<br/>Tomcat, Tomcat allocates a thread for it.
<br/>- I would imagine that mod_jk must pass on to Tomcat the fact that this 
<br/>is a KeepAlive connection, so that Tomcat would know that its thread for 
<br/>that connection, should also wait for subsequent requests.
<br/>- so now the webapp/thread generates the response to the first request, 
<br/>and waits on the connection for more requests.
<br/>- however, the browser does send more requests to Apache, but these are 
<br/>not ones that get forwarded to Tomcat (for example, they are for items 
<br/>that Apache serves locally) ...
<br/><br/>So now I wonder about how Apache + mod_jk + Tomcat react in such a 
<br/>situation. &nbsp;Do the mod_jk connection +Tomcat thread keep waiting anyway, 
<br/>and how long ?
<br/><br/>Rainer ?
<br/><br/><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152486&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152486&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=100398">Caldarale, Charles R</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152491" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152491',2152491)">Threaded</a>
	<div id="tooltip57061" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip57061'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152491"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152491", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152491', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152491\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152491', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152491\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152491', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152491\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152491', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152491)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152491', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152491)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152491', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152491\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152491', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152491\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152491', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152491.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152491', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152491\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152491');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152491' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152491)"/>
	<div id="tooltip29119" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip29119'), 'up', 400);
	</script>
					<span id="starB2152491">
		<img id="img-starB2152491" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip11261" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip11261'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152491" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254774106000-43"></span><script type="text/javascript">
		Nabble.get('d1254774106000-43').innerHTML= Nabble.formatDateLong(new Date(1254774106000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		RE: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=100398" rel="nofollow" title="View profile of Caldarale, Charles R" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/8e94d530fd23bc5544add90d8cd69491?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Caldarale, Charles R" title="Caldarale, Charles R"/><img src="/images/online.png" class="online100398 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count100398 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	<div class="weak-color" style="font-size:80%;padding-bottom:1em">
				In reply to <a href="http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152484.html" rel="nofollow">this post</a> by André Warnier
			</div>
	<div id="message2152491" class="message-text adbayes-content">
		&gt; From: André Warnier [mailto:<a href="/user/SendEmail.jtp?type=node&node=2152491&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>]
<br/>&gt; Subject: Re: java.lang.OutOfMemoryError: Java heap space
<br/>&gt; 
<br/>&gt; The bottleneck would be in Tomcat, but it would show up at the
<br/>&gt; httpd level.
<br/><br/>The bottleneck might also be in something external to Tomcat, such as a database or some external web service used by the webapps. &nbsp;The result may still only be visible at the front end.
<br/><br/>&nbsp;- Chuck
<br/><br/><br/>THIS COMMUNICATION MAY CONTAIN CONFIDENTIAL AND/OR OTHERWISE PROPRIETARY MATERIAL and is thus for use only by the intended recipient. If you received this in error, please contact the sender and delete the e-mail and its attachments from all computers.
<br/><br/><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152491&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152491&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943">Joe Hansen-2</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152490" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152490',2152490)">Threaded</a>
	<div id="tooltip60340" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip60340'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152490"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152490", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152490', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152490\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152490', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152490\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152490', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152490\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152490', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152490)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152490', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152490)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152490', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152490\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152490', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152490\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152490', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152490.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152490', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152490\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152490');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152490' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152490)"/>
	<div id="tooltip8028" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip8028'), 'up', 400);
	</script>
					<span id="starB2152490">
		<img id="img-starB2152490" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip42622" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip42622'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152490" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254779242000-790"></span><script type="text/javascript">
		Nabble.get('d1254779242000-790').innerHTML= Nabble.formatDateLong(new Date(1254779242000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943" rel="nofollow" title="View profile of Joe Hansen-2" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/a375116adb0355cac9751a275da78243?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Joe Hansen-2" title="Joe Hansen-2"/><img src="/images/online.png" class="online111943 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count111943 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	<div class="weak-color" style="font-size:80%;padding-bottom:1em">
				In reply to <a href="http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152484.html" rel="nofollow">this post</a> by André Warnier
			</div>
	<div id="message2152490" class="message-text adbayes-content">
		Andre, Thanks for pointing out the high KeepAliveTimeout value in the
<br/>config file. I have read the docs and have changed it to 5 seconds
<br/>(which is the default).
<br/><br/>I am hoping that Rainer could find out from the thread dump where the
<br/>requests are getting stuck, so that I can put this issue to bed.
<br/><br/>Thanks,
<br/>Joe
<br/><br/><br/>On Mon, Oct 5, 2009 at 1:53 PM, André Warnier &lt;<a href="/user/SendEmail.jtp?type=node&node=2152490&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<div class='shrinkable-quote'><br/>&gt; Joe Hansen wrote:
<br/>&gt;&gt;
<br/>&gt;&gt; Thank you for the reply, Andre.
<br/>&gt;&gt;
<br/>&gt;&gt; I now understand how setting KeepAlive to On would improve the
<br/>&gt;&gt; performance of a website (The Apache manual says that a 50% increase
<br/>&gt;&gt; in throughput could be expected). So I changed the KeepAlive to On and
<br/>&gt;&gt; restarted the server.
<br/>&gt;
<br/>&gt; Now wait.
<br/>&gt; You should probably then lower your setting for KeepAliveTimeout (to 3
<br/>&gt; e.g.), otherwise you may make the problem much worse.
<br/>&gt; Read conscienciously the relevant Apache doc page :
<br/>&gt; <a href="http://httpd.apache.org/docs/2.2/mod/core.html#keepalive" target="_top" rel="nofollow" link="external">http://httpd.apache.org/docs/2.2/mod/core.html#keepalive</a><br/>&gt;
<br/>&gt; The point with KeepAlive is :
<br/>&gt; - the browser makes a connection and issues a first request
<br/>&gt; - the webserver dedicates a child (or thread) to this connection, and passes
<br/>&gt; it the first request
<br/>&gt; - the child/thread responds to the first request, and then waits for more
<br/>&gt; - the browser, in the response page, finds more links. Over the same TCP
<br/>&gt; connection, it sends the next request
<br/>&gt; - the same child/thread - which was waiting on that connection - receives
<br/>&gt; the new request, and responds to it. Then it waits again for the next one.
<br/>&gt; - etc..
<br/>&gt; - until at some point, the browser does not issue any additional requests on
<br/>&gt; the connection. Then, *after the KeepAliveTimeout has expired*, the
<br/>&gt; child/thread gives up, closesthe connection, and returns to the pool
<br/>&gt; available for other requests from other browsers
<br/>&gt;
<br/>&gt; So the point is, if the KeepAliveTimeout is long (like 15 seconds), it means
<br/>&gt; that a child/thread may be kept waiting, for nothing, up to that many
<br/>&gt; seconds, although there is nothing coming anymore.
<br/>&gt;
<br/>&gt;&gt;
<br/>&gt;&gt; I however wonder if this will fix the issue. The reason being, I
<br/>&gt;&gt; haven't changed the website code at all the past few months and there
<br/>&gt;&gt; hasn't been any increase in the website traffic too. Hence I am unable
<br/>&gt;&gt; to understand why we are suddenly seeing an increase in the number of
<br/>&gt;&gt; httpd processes. The only thing I changed is the session-timeout value
<br/>&gt;&gt; from 30 minutes to 240 minutes.
<br/>&gt;&gt;
<br/>&gt; I guess that this is the Tomcat session timeout.  That should have nothing
<br/>&gt; to do with the above.  I don't think that for Tomcat, a &quot;session&quot; is linked
<br/>&gt; to a connection. It is more of a set of data saved somewhere, linked to the
<br/>&gt; Tomcat session-id (the JSESSIONID cookie for instance).  Tomcar retrieves it
<br/>&gt; whenever a request comes in with the same session-id number.  But it should
<br/>&gt; not matter whether it is on the same TCP connection or not.
<br/>&gt;
<br/>&gt; What may be linked together however, is that one request to httpd results in
<br/>&gt; one child/thread busy with it at the Apache httpd level. If that request is
<br/>&gt; being forwarded to Tomcat by mod_jk, then it also holds onto one
<br/>&gt; mod_jk/Tomcat connection. This connection then holds on to one thread in
<br/>&gt; Tomcat, until the Tomcat thread (+webapp) has supplied the full response.
<br/>&gt; All the while, this whole chain is unavailable for other requests.  Thus, if
<br/>&gt; there are many such requests under way, many Apache children/threads are
<br/>&gt; busy, and Apache httpd will start additional ones (up to its limit) to
<br/>&gt; service new requests that come in.
<br/>&gt; So if for some reason, your Tomcat requests now take longer to be serviced,
<br/>&gt; that should also, by retro-effect, increase the number of httpd
<br/>&gt; children/threads being started.
<br/>&gt; The bottleneck would be in Tomcat, but it would show up at the httpd level.
<br/>&gt;
<br/>&gt; ---------------------------------------------------------------------
<br/>&gt; To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152490&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt; For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152490&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt;
<br/>&gt;
</div><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152490&i=3" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152490&i=4" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143">Rainer Jung-3</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152487" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152487',2152487)">Threaded</a>
	<div id="tooltip87458" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip87458'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152487"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152487", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152487', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152487\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152487', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152487\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152487', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152487\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152487', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152487)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152487', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152487)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152487', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152487\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152487', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152487\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152487', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152487.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152487', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152487\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152487');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152487' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152487)"/>
	<div id="tooltip79928" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip79928'), 'up', 400);
	</script>
					<span id="starB2152487">
		<img id="img-starB2152487" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip16426" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip16426'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152487" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254830283000-343"></span><script type="text/javascript">
		Nabble.get('d1254830283000-343').innerHTML= Nabble.formatDateLong(new Date(1254830283000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143" rel="nofollow" title="View profile of Rainer Jung-3" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/7ddfb840a4db40a01ac99d29e82267b0?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Rainer Jung-3" title="Rainer Jung-3"/><img src="/images/online.png" class="online102143 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count102143 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	<div class="weak-color" style="font-size:80%;padding-bottom:1em">
				In reply to <a href="http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152486.html" rel="nofollow">this post</a> by André Warnier
			</div>
	<div id="message2152487" class="message-text adbayes-content">
		On 05.10.2009 22:04, André Warnier wrote:
<div class='shrinkable-quote'><br/>&gt; André Warnier wrote:
<br/>&gt; ...
<br/>&gt; and still wants to add something :
<br/>&gt; 
<br/>&gt; - a new KeepAlive connection is made from the browser to Apache (httpd).
<br/>&gt; - then a request comes in on that connection, and it happens to be one
<br/>&gt; that gets forwarded to Tomcat. &nbsp;So a mod_jk connection is made to
<br/>&gt; Tomcat, Tomcat allocates a thread for it.
<br/>&gt; - I would imagine that mod_jk must pass on to Tomcat the fact that this
<br/>&gt; is a KeepAlive connection, so that Tomcat would know that its thread for
<br/>&gt; that connection, should also wait for subsequent requests.
<br/>&gt; - so now the webapp/thread generates the response to the first request,
<br/>&gt; and waits on the connection for more requests.
<br/>&gt; - however, the browser does send more requests to Apache, but these are
<br/>&gt; not ones that get forwarded to Tomcat (for example, they are for items
<br/>&gt; that Apache serves locally) ...
<br/>&gt; 
<br/>&gt; So now I wonder about how Apache + mod_jk + Tomcat react in such a
<br/>&gt; situation. &nbsp;Do the mod_jk connection +Tomcat thread keep waiting anyway,
<br/>&gt; and how long ?
</div><br/>No in general. mod_jk only kicks in after a new request arrived over
<br/>such a connection. mod_jk is agnotic about whether the rquests came over
<br/>the same connection or not, even whether they belong to the same user or
<br/>not.
<br/><br/>But: in case you are using a prefork MPM, each connection gets assigned
<br/>to one process having one thread. This process has a connection pool of
<br/>size 1 to each backend and the backend ties a dedicated thread to that
<br/>connection (unless using tcnative). So in this case, it is a yes.
<br/>Between two Keep Alive requests, there's no way of letting the Apache
<br/>process handle other requests and thus the backend connection and
<br/>backend thread are blocked waiting for the next request. That's why e.g.
<br/>NTLM has a chance to work via mod_jk in combination with prefork.
<br/><br/>So here's a use case for the worker MPM, because then one client
<br/>connection still blocks one Apache thread. But multiple connections are
<br/>concurrently handled by the same Apache process, so mod_jk can
<br/>efficiently reuse its backend connections for requests from other
<br/>connections handled by the same process. The total used connection pool
<br/>size might then be much smaller than with the prefork MPM.
<br/><br/>Regards,
<br/><br/>Rainer
<br/><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152487&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152487&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143">Rainer Jung-3</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152471" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152471',2152471)">Threaded</a>
	<div id="tooltip434" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip434'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152471"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152471", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152471', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152471\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152471', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152471\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152471', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152471\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152471', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152471)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152471', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152471)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152471', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152471\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152471', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152471\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152471', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152471.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152471', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152471\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152471');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152471' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152471)"/>
	<div id="tooltip54207" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip54207'), 'up', 400);
	</script>
					<span id="starB2152471">
		<img id="img-starB2152471" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip5222" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip5222'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152471" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254830427000-857"></span><script type="text/javascript">
		Nabble.get('d1254830427000-857').innerHTML= Nabble.formatDateLong(new Date(1254830427000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143" rel="nofollow" title="View profile of Rainer Jung-3" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/7ddfb840a4db40a01ac99d29e82267b0?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Rainer Jung-3" title="Rainer Jung-3"/><img src="/images/online.png" class="online102143 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count102143 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	<div class="weak-color" style="font-size:80%;padding-bottom:1em">
				In reply to <a href="http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152429.html" rel="nofollow">this post</a> by Joe Hansen-2
			</div>
	<div id="message2152471" class="message-text adbayes-content">
		On 05.10.2009 18:58, Joe Hansen wrote:
<br/>&gt; Thank you so much for your tips, Rainer!
<br/>&gt; 
<br/>&gt; The websites went down yet again. Increasing the java heap size took
<br/>&gt; care of the OutOfMemoryError, but the number of httpd processes keep
<br/>&gt; increasing until the websites crash. I haven't added any new code in
<br/>&gt; the past few months, hence I am surprised why the requests are getting
<br/>&gt; stuck. Here's a link to the tomcat thread dumps:
<br/>&gt; <a href="http://pastebin.com/m17eea139" target="_top" rel="nofollow" link="external">http://pastebin.com/m17eea139</a><br/><br/>Just tried to look at it, but pastebin replies with:
<br/><br/>====================
<br/>Down for maintenance - 6th Oct 2009
<br/><br/>Pastebin.com is getting an unprecedented amount of traffic due to a news
<br/>story in which some leaked Hotmail passwords have been pasted on this site
<br/><br/>...
<br/>====================
<br/><br/>Let's see, when they will be up again. They're running Apache 1.3.33 ...
<br/><div class='shrinkable-quote'><br/>&gt; Please let me know if you cannot view it and I will email the relevant
<br/>&gt; portion of the catalina.out file to you. Is there an easy way to find
<br/>&gt; out what code is causing the requests to get stuck?
<br/>&gt; 
<br/>&gt; Thank you!
<br/>&gt; 
<br/>&gt; Joe
<br/>&gt; 
<br/>&gt; 
<br/>&gt; On Sun, Oct 4, 2009 at 2:36 PM, Rainer Jung &lt;<a href="/user/SendEmail.jtp?type=node&node=2152471&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<br/>&gt;&gt; Hi Joe,
<br/>&gt;&gt;
<br/>&gt;&gt; On 04.10.2009 21:45, Joe Hansen wrote:
<br/>&gt;&gt;&gt; Rainer, Thank you so much for your kind reply!
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; I have increased the java heap size to 512MB (-Xms512m -Xmx512m). I am
<br/>&gt;&gt;&gt; hoping that would fix the issue. I had configured our webserver to use
<br/>&gt;&gt;&gt; Jasig's Central Authentication System (CAS). Recently I increased the
<br/>&gt;&gt;&gt; session timeout from 30 minutes to 4 hours. I am guessing that must
<br/>&gt;&gt;&gt; have had an impact on the number of tickets that the CAS could store
<br/>&gt;&gt;&gt; in the Java's memory space.
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; I did run the kill -QUIT command against the tomcat process. It did
<br/>&gt;&gt;&gt; generate a huge output in the catalina.out file. I am unable to
<br/>&gt;&gt;&gt; decipher it. I do not want to post it to the mailing list because its
<br/>&gt;&gt;&gt; very long. Would you be able to please tell me what should I be
<br/>&gt;&gt;&gt; looking for within this long thread dump?
<br/>&gt;&gt;
<br/>&gt;&gt; Can you put it somewhere on the web, so we can look at it, or are you
<br/>&gt;&gt; afraid there is something private in there? You could use pastebin or
<br/>&gt;&gt; something similar in case you do not have a public web server yourself.
<br/>&gt;&gt;
<br/>&gt;&gt; If you don't want to post in public, you can also mail it to me, I will
<br/>&gt;&gt; post the result, in case I find something relevant.
<br/>&gt;&gt;
<br/>&gt;&gt; Regards,
<br/>&gt;&gt;
<br/>&gt;&gt; Rainer
<br/>&gt;&gt;
<br/>&gt;&gt;&gt; On Sat, Oct 3, 2009 at 12:24 PM, Rainer Jung &lt;<a href="/user/SendEmail.jtp?type=node&node=2152471&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<br/>&gt;&gt;&gt;&gt; On 03.10.2009 20:07, Joe Hansen wrote:
<br/>&gt;&gt;&gt;&gt;&gt; Hey All,
<br/>&gt;&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt;&gt; I get this error (java.lang.OutOfMemoryError: Java heap space) after
<br/>&gt;&gt;&gt;&gt;&gt; my Apache 2.0/Tomcat 5.5/mod_jk installation has been up and running
<br/>&gt;&gt;&gt;&gt;&gt; for a few hours. This problem started just since two days. Never had
<br/>&gt;&gt;&gt;&gt;&gt; this issue before!
<br/>&gt;&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt;&gt; I have also noticed that as soon as I startup the server, 9 httpd
<br/>&gt;&gt;&gt;&gt;&gt; processes start. Number of httpd processes keep on increasing until I
<br/>&gt;&gt;&gt;&gt;&gt; get the OutOfMemoryError.
<br/>&gt;&gt;&gt;&gt;&gt; $ps -aef | grep httpd
<br/>&gt;&gt;&gt;&gt;&gt; root &nbsp; &nbsp; 31984 &nbsp; &nbsp; 1 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt;&gt; apache &nbsp; 31987 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt;&gt; apache &nbsp; 31988 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt;&gt; apache &nbsp; 31989 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt;&gt; apache &nbsp; 31990 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt;&gt; apache &nbsp; 31991 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt;&gt; apache &nbsp; 31992 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt;&gt; apache &nbsp; 31993 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt;&gt; apache &nbsp; 31994 31984 &nbsp;0 11:23 ? &nbsp; &nbsp; &nbsp; &nbsp;00:00:00 /usr/sbin/httpd
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; Sounds like requests get stuck or responses are only returned very slowly.
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; I would take thread dumps during the time requests pile up (e.g. httpd
<br/>&gt;&gt;&gt;&gt; process count increases). Thread dumps are generated by &quot;kil -QUIT&quot;
<br/>&gt;&gt;&gt;&gt; against the Tomcat process. Result is written to catalina.out. Always
<br/>&gt;&gt;&gt;&gt; take afew thread dumps shortly after each other, e.g. 3 dumps each 3
<br/>&gt;&gt;&gt;&gt; seconds apart from the previous one, so that you can find out, if a
<br/>&gt;&gt;&gt;&gt; status in a dump is pure coincidence or lasts for somewhat longer.
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt;&gt; $ps -aef | grep tomcat
<br/>&gt;&gt;&gt;&gt;&gt; root &nbsp; &nbsp; 31949 &nbsp; &nbsp; 1 43 11:23 pts/0 &nbsp; &nbsp;00:00:58 /usr/java/jdk/bin/java -Djava.u
<br/>&gt;&gt;&gt;&gt;&gt; il.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.co
<br/>&gt;&gt;&gt;&gt;&gt; fig.file=/usr/lib/apache-tomcat/conf/logging.properties -Djava.endorsed.dirs=/u
<br/>&gt;&gt;&gt;&gt;&gt; r/lib/apache-tomcat/common/endorsed -classpath :/usr/lib/apache-tomcat/bin/boot
<br/>&gt;&gt;&gt;&gt;&gt; trap.jar:/usr/lib/apache-tomcat/bin/commons-logging-api.jar -Dcatalina.base=/us
<br/>&gt;&gt;&gt;&gt;&gt; /lib/apache-tomcat -Dcatalina.home=/usr/lib/apache-tomcat -Djava.io.tmpdir=/usr
<br/>&gt;&gt;&gt;&gt;&gt; lib/apache-tomcat/temp org.apache.catalina.startup.Bootstrap start
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; There is no Java memory configuration included above (i.e. al defaults).
<br/>&gt;&gt;&gt;&gt; It might well be, that you have to explicitely set heap size, perm size
<br/>&gt;&gt;&gt;&gt; and if you like also eden and semi spaces.
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt;&gt; Can someone on this list please help me resolve this issue.
<br/>&gt;&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt;&gt; Thanks you,
<br/>&gt;&gt;&gt;&gt;&gt; Joe
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; Regards,
<br/>&gt;&gt;&gt;&gt;
<br/>&gt;&gt;&gt;&gt; Rainer
</div><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152471&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152471&i=3" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143">Rainer Jung-3</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152431" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152431',2152431)">Threaded</a>
	<div id="tooltip30923" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip30923'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152431"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152431", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152431', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152431\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152431', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152431\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152431', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152431\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152431', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152431)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152431', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152431)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152431', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152431\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152431', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152431\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152431', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152431.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152431', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152431\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152431');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152431' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152431)"/>
	<div id="tooltip54319" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip54319'), 'up', 400);
	</script>
					<span id="starB2152431">
		<img id="img-starB2152431" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip34414" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip34414'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152431" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254835500000-961"></span><script type="text/javascript">
		Nabble.get('d1254835500000-961').innerHTML= Nabble.formatDateLong(new Date(1254835500000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=102143" rel="nofollow" title="View profile of Rainer Jung-3" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/7ddfb840a4db40a01ac99d29e82267b0?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Rainer Jung-3" title="Rainer Jung-3"/><img src="/images/online.png" class="online102143 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count102143 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	<div class="weak-color" style="font-size:80%;padding-bottom:1em">
				In reply to <a href="http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152429.html" rel="nofollow">this post</a> by Joe Hansen-2
			</div>
	<div id="message2152431" class="message-text adbayes-content">
		On 05.10.2009 18:58, Joe Hansen wrote:
<div class='shrinkable-quote'><br/>&gt; Thank you so much for your tips, Rainer!
<br/>&gt; 
<br/>&gt; The websites went down yet again. Increasing the java heap size took
<br/>&gt; care of the OutOfMemoryError, but the number of httpd processes keep
<br/>&gt; increasing until the websites crash. I haven't added any new code in
<br/>&gt; the past few months, hence I am surprised why the requests are getting
<br/>&gt; stuck. Here's a link to the tomcat thread dumps:
<br/>&gt; <a href="http://pastebin.com/m17eea139" target="_top" rel="nofollow" link="external">http://pastebin.com/m17eea139</a><br/>&gt; 
<br/>&gt; Please let me know if you cannot view it and I will email the relevant
<br/>&gt; portion of the catalina.out file to you. Is there an easy way to find
<br/>&gt; out what code is causing the requests to get stuck?
</div><br/>The dump file contains three thread dumps.
<br/><br/>The things all dumps have in common:
<br/><br/>- 60 threads for the quartz scheduler, all idle
<br/>- 13 threads in the AJP connection pool, connected to Apache, but idle
<br/>waiting for the next request to be send (the same threads in all three
<br/>dumps)
<br/>- 6 store plus 6 expiry threads of the EHCache, seems idle
<br/>- 1 AJP + 1 HTTP(S) thread (port 8443) waiting to accept the next new
<br/>connection to come in
<br/>- 2 AJP + 3 HTTP(S) threads (port 8443) sitting idle the pool, waiting
<br/>for work
<br/>- a couple of other normal threads not directly related to request handling
<br/><br/>So the time you took the three dumps, this Tomcat was completely idle
<br/>and did not have a single request to handle.
<br/><br/>If you are completely sure, you took the dumps while there was a storm
<br/>of requests and your system couldn't cope the load, something has
<br/>prevented the requests to ever reach Tomcat.
<br/><br/>I don't have your Tomcat version at hand at the moment, but for some
<br/>time very special OutOfMemory errors (could not create native thread)
<br/>lead to a situation, where Tomcat simply wouldn't accept any new
<br/>connections. Although you report OutOfMemory errors, I'm not directly
<br/>suggesting that that is your problem here. There might still be a
<br/>relation though.
<br/><br/>Are you sure, that you took the dumps for the right Tomcat at the right
<br/>time?
<br/><br/>Regards,
<br/><br/>Rainer
<br/><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152431&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152431&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943">Joe Hansen-2</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152434" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152434',2152434)">Threaded</a>
	<div id="tooltip16114" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip16114'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152434"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152434", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152434', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152434\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152434', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152434\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152434', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152434\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152434', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152434)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152434', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152434)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152434', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152434\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152434', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152434\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152434', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152434.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152434', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152434\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152434');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152434' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152434)"/>
	<div id="tooltip41384" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip41384'), 'up', 400);
	</script>
					<span id="starB2152434">
		<img id="img-starB2152434" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip33232" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip33232'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152434" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254846212000-959"></span><script type="text/javascript">
		Nabble.get('d1254846212000-959').innerHTML= Nabble.formatDateLong(new Date(1254846212000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943" rel="nofollow" title="View profile of Joe Hansen-2" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/a375116adb0355cac9751a275da78243?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Joe Hansen-2" title="Joe Hansen-2"/><img src="/images/online.png" class="online111943 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count111943 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152434" class="message-text adbayes-content">
		Rainer,
<br/><br/>Thanks for looking at those long thread dumps for me!!
<br/><br/>I am sorry. I did NOT take these dumps at the right time (i.e. when
<br/>Tomcat was inundated with requests and couldn't cope with the load).
<br/>After I increased the heap size to 512MB (from 64MB default), I am not
<br/>getting the OutOfMemoryError(s) anymore. After I set KeepAlive On
<br/>(Thanks Andre!), the number httpd processes isn't increasing either.
<br/>The number of httpd processes increased from 8 to 21 and stayed there
<br/>for more than 16 hours now. If the number of httpd processes gets out
<br/>of control again, I will definitely take thread dumps once again.
<br/><br/>However, I doubt the issue is fixed because I should have seen this
<br/>issue long time ago (since I haven't changed any code nor the traffic
<br/>to our websites increased in a long while).
<br/><br/>Should I just wait and see or are there any tests that I can do?
<br/><br/>Your contribution to this forum is amazing, Rainer. I am grateful to
<br/>you and Andre for your efforts. Thank you!
<br/><br/>Regards,
<br/>Joe
<br/><br/><br/><br/>On Tue, Oct 6, 2009 at 7:25 AM, Rainer Jung &lt;<a href="/user/SendEmail.jtp?type=node&node=2152434&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<div class='shrinkable-quote'><br/>&gt; On 05.10.2009 18:58, Joe Hansen wrote:
<br/>&gt;&gt; Thank you so much for your tips, Rainer!
<br/>&gt;&gt;
<br/>&gt;&gt; The websites went down yet again. Increasing the java heap size took
<br/>&gt;&gt; care of the OutOfMemoryError, but the number of httpd processes keep
<br/>&gt;&gt; increasing until the websites crash. I haven't added any new code in
<br/>&gt;&gt; the past few months, hence I am surprised why the requests are getting
<br/>&gt;&gt; stuck. Here's a link to the tomcat thread dumps:
<br/>&gt;&gt; <a href="http://pastebin.com/m17eea139" target="_top" rel="nofollow" link="external">http://pastebin.com/m17eea139</a><br/>&gt;&gt;
<br/>&gt;&gt; Please let me know if you cannot view it and I will email the relevant
<br/>&gt;&gt; portion of the catalina.out file to you. Is there an easy way to find
<br/>&gt;&gt; out what code is causing the requests to get stuck?
<br/>&gt;
<br/>&gt; The dump file contains three thread dumps.
<br/>&gt;
<br/>&gt; The things all dumps have in common:
<br/>&gt;
<br/>&gt; - 60 threads for the quartz scheduler, all idle
<br/>&gt; - 13 threads in the AJP connection pool, connected to Apache, but idle
<br/>&gt; waiting for the next request to be send (the same threads in all three
<br/>&gt; dumps)
<br/>&gt; - 6 store plus 6 expiry threads of the EHCache, seems idle
<br/>&gt; - 1 AJP + 1 HTTP(S) thread (port 8443) waiting to accept the next new
<br/>&gt; connection to come in
<br/>&gt; - 2 AJP + 3 HTTP(S) threads (port 8443) sitting idle the pool, waiting
<br/>&gt; for work
<br/>&gt; - a couple of other normal threads not directly related to request handling
<br/>&gt;
<br/>&gt; So the time you took the three dumps, this Tomcat was completely idle
<br/>&gt; and did not have a single request to handle.
<br/>&gt;
<br/>&gt; If you are completely sure, you took the dumps while there was a storm
<br/>&gt; of requests and your system couldn't cope the load, something has
<br/>&gt; prevented the requests to ever reach Tomcat.
<br/>&gt;
<br/>&gt; I don't have your Tomcat version at hand at the moment, but for some
<br/>&gt; time very special OutOfMemory errors (could not create native thread)
<br/>&gt; lead to a situation, where Tomcat simply wouldn't accept any new
<br/>&gt; connections. Although you report OutOfMemory errors, I'm not directly
<br/>&gt; suggesting that that is your problem here. There might still be a
<br/>&gt; relation though.
<br/>&gt;
<br/>&gt; Are you sure, that you took the dumps for the right Tomcat at the right
<br/>&gt; time?
<br/>&gt;
<br/>&gt; Regards,
<br/>&gt;
<br/>&gt; Rainer
<br/>&gt;
<br/>&gt; ---------------------------------------------------------------------
<br/>&gt; To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152434&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt; For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152434&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt;
<br/>&gt;
</div><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152434&i=3" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152434&i=4" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			
				</td>
			</tr>
		</table>
	</div>
	<div class="classic-row">
		<div class="classic-header">
			<div class="classic-bar shaded-bg-color rounded-top">
				<div class="classic-author-name nowrap">
					<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943">Joe Hansen-2</a>
				</div>
				<div class="classic-right-menu shaded-bg-color weak-color">
					<a href="/template/NamlServlet.jtp?macro=reply&amp;node=2152437" rel="nofollow">Reply</a> |
					<a href="javascript:void(0)" onclick="Nabble.setView('threaded', '/java-lang-OutOfMemoryError-Java-heap-space-tt2152420.html#a2152437',2152437)">Threaded</a>
	<div id="tooltip22957" class="nabble-tooltip" use_title="false">
		Open this post in threaded view
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip22957'), 'up', 400);
	</script> |
					<span id="dd_postdropdown2152437"></span>
	<script type="text/javascript">
		var dropdown = new NabbleDropdown("postdropdown2152437", "More","Click for more options");
		
		dropdown.add('replyToAuthor2152437', '\x3Ca href\x3D\"/user/SendEmail.jtp?type\x3Dpm&amp;post\x3D2152437\" rel\x3D\"nofollow\"\x3EReply to author\x3C/a\x3E', 'display:none');
		dropdown.add('editPost2152437', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dedit_post&amp;node\x3D2152437\" rel\x3D\"nofollow\"\x3EEdit post\x3C/a\x3E', 'display:none');
		dropdown.add('movePost2152437', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dmove_node&amp;node\x3D2152437\" rel\x3D\"nofollow\"\x3EMove post\x3C/a\x3E', 'display:none');
		dropdown.add('deletePost2152437', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deletePost(2152437)\" rel\x3D\"nofollow\"\x3EDelete this post\x3C/a\x3E', 'display:none');
			dropdown.add('deleteRecursively2152437', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"Nabble.deleteFromSite(2152437)\" rel\x3D\"nofollow\"\x3EDelete this post and replies\x3C/a\x3E', 'display:none');
		dropdown.add('changePostDate2152437', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dchange_post_date&amp;node\x3D2152437\" rel\x3D\"nofollow\"\x3EChange post date\x3C/a\x3E', 'display:none');
		dropdown.add('print2152437', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Dprint_post&amp;node\x3D2152437\" rel\x3D\"nofollow\"\x3EPrint post\x3C/a\x3E');
		dropdown.add('permalink2152437', '\x3Ca href\x3D\"javascript: void(0)\" onclick\x3D\"prompt(\'Copy this:\',\'http://tomcat.10.x6.nabble.com/java-lang-OutOfMemoryError-Java-heap-space-tp2152420p2152437.html\')\"\x3EPermalink\x3C/a\x3E');
		dropdown.add('rawMail2152437', '\x3Ca href\x3D\"/template/NamlServlet.jtp?macro\x3Draw_mail&amp;node\x3D2152437\" rel\x3D\"nofollow\"\x3ERaw mail\x3C/a\x3E', 'display:none');
		dropdown.build('dd_postdropdown2152437');
		dropdown.loadOnClick('/template/NamlServlet.jtp?macro=post_dropdown_later&node=2152437' + Nabble.getClientID() + '&_=' + Math.floor(Math.random()*999999));
	</script>
					&nbsp;
					<img src="/images/flag_gray.png" class="report-flag" onclick="Nabble.reportContent(2152437)"/>
	<div id="tooltip91395" class="nabble-tooltip" use_title="false">
		Report Content as Inappropriate
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip91395'), 'up', 400);
	</script>
					<span id="starB2152437">
		<img id="img-starB2152437" src="/images/icon_unstarred.png" class="star" alt="star" title="Add this item to your favorites list"/>
		<div id="tooltip28661" class="nabble-tooltip" use_title="true">
		
		<div class="nabble-tooltip-arrow">
			<div class="d1">&diams;</div>
			<div class="d2">&diams;</div>
		</div>
	</div>
	<script type="text/javascript">
		Nabble.startTooltip(Nabble.get('tooltip28661'), 'up', 400);
	</script>
	</span>
	
				</div>
				<div class="classic-subject-line">
					<span id="red-arrow2152437" class="float-left invisible" style="margin-top:.2em">
		<img title="Selected post" width="15" height="15" src="/images/arrow.png" alt="Selected post"/>
	</span>
					<span class="post-date float-left">
		<span id="d1254851073000-225"></span><script type="text/javascript">
		Nabble.get('d1254851073000-225').innerHTML= Nabble.formatDateLong(new Date(1254851073000));
	</script>
	</span>
					<h2 class="post-subject float-left adbayes-content" style="width:30%;overflow:visible;font-family:inherit">
		Re: java.lang.OutOfMemoryError: Java heap space
	</h2>
				</div>
			</div>
		</div>
		<table class="classic-body">
			<tr>
				<td class="classic-author shaded-bg-color rounded-bottom">
					<div class="avatar-outer">
		<div class="avatar-inner">
			<a href="http://tomcat.10.x6.nabble.com/template/NamlServlet.jtp?macro=user_nodes&amp;user=111943" rel="nofollow" title="View profile of Joe Hansen-2" class="nowrap no-decoration"><img class="avatar medium-border-color" src="http://www.gravatar.com/avatar/a375116adb0355cac9751a275da78243?s=100&amp;r=pg&amp;d=http%3A%2F%2Fx6.nabble.com%2Fimages%2Favatar100.png" height="100" width="100" alt="Joe Hansen-2" title="Joe Hansen-2"/><img src="/images/online.png" class="online111943 online invisible" title="User is online" alt="online"/></a>

	
	
		</div>
	</div>
	
	
	<div class="post-count111943 avatar-label weak-color"></div>
	
				</td>
				<td class="classic-message">
					
	
	
	<div id="message2152437" class="message-text adbayes-content">
		Rainer,
<br/><br/>I spoke to soon! As I suspected, the problem isn't fixed yet and the
<br/>websites crashed again. This time I took three thread dumps at the
<br/>time tomcat was down. Here they are: <a href="http://pastebin.com/m2a7e1198" target="_top" rel="nofollow" link="external">http://pastebin.com/m2a7e1198</a><br/><br/>I will learn from your previous analysis of the thread dumps and I try
<br/>to understand what's happening.
<br/><br/>Thanks,
<br/>Joe
<br/><br/>On Tue, Oct 6, 2009 at 10:23 AM, Joe Hansen &lt;<a href="/user/SendEmail.jtp?type=node&node=2152437&i=0" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<div class='shrinkable-quote'><br/>&gt; Rainer,
<br/>&gt;
<br/>&gt; Thanks for looking at those long thread dumps for me!!
<br/>&gt;
<br/>&gt; I am sorry. I did NOT take these dumps at the right time (i.e. when
<br/>&gt; Tomcat was inundated with requests and couldn't cope with the load).
<br/>&gt; After I increased the heap size to 512MB (from 64MB default), I am not
<br/>&gt; getting the OutOfMemoryError(s) anymore. After I set KeepAlive On
<br/>&gt; (Thanks Andre!), the number httpd processes isn't increasing either.
<br/>&gt; The number of httpd processes increased from 8 to 21 and stayed there
<br/>&gt; for more than 16 hours now. If the number of httpd processes gets out
<br/>&gt; of control again, I will definitely take thread dumps once again.
<br/>&gt;
<br/>&gt; However, I doubt the issue is fixed because I should have seen this
<br/>&gt; issue long time ago (since I haven't changed any code nor the traffic
<br/>&gt; to our websites increased in a long while).
<br/>&gt;
<br/>&gt; Should I just wait and see or are there any tests that I can do?
<br/>&gt;
<br/>&gt; Your contribution to this forum is amazing, Rainer. I am grateful to
<br/>&gt; you and Andre for your efforts. Thank you!
<br/>&gt;
<br/>&gt; Regards,
<br/>&gt; Joe
<br/>&gt;
<br/>&gt;
<br/>&gt;
<br/>&gt; On Tue, Oct 6, 2009 at 7:25 AM, Rainer Jung &lt;<a href="/user/SendEmail.jtp?type=node&node=2152437&i=1" target="_top" rel="nofollow" link="external">[hidden email]</a>&gt; wrote:
<br/>&gt;&gt; On 05.10.2009 18:58, Joe Hansen wrote:
<br/>&gt;&gt;&gt; Thank you so much for your tips, Rainer!
<br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; The websites went down yet again. Increasing the java heap size took
<br/>&gt;&gt;&gt; care of the OutOfMemoryError, but the number of httpd processes keep
<br/>&gt;&gt;&gt; increasing until the websites crash. I haven't added any new code in
<br/>&gt;&gt;&gt; the past few months, hence I am surprised why the requests are getting
<br/>&gt;&gt;&gt; stuck. Here's a link to the tomcat thread dumps:
<br/>&gt;&gt;&gt; <a href="http://pastebin.com/m17eea139" target="_top" rel="nofollow" link="external">http://pastebin.com/m17eea139</a><br/>&gt;&gt;&gt;
<br/>&gt;&gt;&gt; Please let me know if you cannot view it and I will email the relevant
<br/>&gt;&gt;&gt; portion of the catalina.out file to you. Is there an easy way to find
<br/>&gt;&gt;&gt; out what code is causing the requests to get stuck?
<br/>&gt;&gt;
<br/>&gt;&gt; The dump file contains three thread dumps.
<br/>&gt;&gt;
<br/>&gt;&gt; The things all dumps have in common:
<br/>&gt;&gt;
<br/>&gt;&gt; - 60 threads for the quartz scheduler, all idle
<br/>&gt;&gt; - 13 threads in the AJP connection pool, connected to Apache, but idle
<br/>&gt;&gt; waiting for the next request to be send (the same threads in all three
<br/>&gt;&gt; dumps)
<br/>&gt;&gt; - 6 store plus 6 expiry threads of the EHCache, seems idle
<br/>&gt;&gt; - 1 AJP + 1 HTTP(S) thread (port 8443) waiting to accept the next new
<br/>&gt;&gt; connection to come in
<br/>&gt;&gt; - 2 AJP + 3 HTTP(S) threads (port 8443) sitting idle the pool, waiting
<br/>&gt;&gt; for work
<br/>&gt;&gt; - a couple of other normal threads not directly related to request handling
<br/>&gt;&gt;
<br/>&gt;&gt; So the time you took the three dumps, this Tomcat was completely idle
<br/>&gt;&gt; and did not have a single request to handle.
<br/>&gt;&gt;
<br/>&gt;&gt; If you are completely sure, you took the dumps while there was a storm
<br/>&gt;&gt; of requests and your system couldn't cope the load, something has
<br/>&gt;&gt; prevented the requests to ever reach Tomcat.
<br/>&gt;&gt;
<br/>&gt;&gt; I don't have your Tomcat version at hand at the moment, but for some
<br/>&gt;&gt; time very special OutOfMemory errors (could not create native thread)
<br/>&gt;&gt; lead to a situation, where Tomcat simply wouldn't accept any new
<br/>&gt;&gt; connections. Although you report OutOfMemory errors, I'm not directly
<br/>&gt;&gt; suggesting that that is your problem here. There might still be a
<br/>&gt;&gt; relation though.
<br/>&gt;&gt;
<br/>&gt;&gt; Are you sure, that you took the dumps for the right Tomcat at the right
<br/>&gt;&gt; time?
<br/>&gt;&gt;
<br/>&gt;&gt; Regards,
<br/>&gt;&gt;
<br/>&gt;&gt; Rainer
<br/>&gt;&gt;
<br/>&gt;&gt; ---------------------------------------------------------------------
<br/>&gt;&gt; To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152437&i=2" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt;&gt; For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152437&i=3" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>&gt;&gt;
<br/>&gt;&gt;
<br/>&gt;
</div><br/>---------------------------------------------------------------------
<br/>To unsubscribe, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152437&i=4" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/>For additional commands, e-mail: <a href="/user/SendEmail.jtp?type=node&node=2152437&i=5" target="_top" rel="nofollow" link="external">[hidden email]</a>
<br/><br/>

	
	
	
	</div>
	
			<script type="text/javascript">
				Nabble.ads('last_classic_message');
			</script>
				</td>
			</tr>
		</table>
	</div>
	
		<span class="pages" style="padding:1em .2em 0"><span class="current-page medium-border-color">1</span><span class="page"><a href="/java-lang-OutOfMemoryError-Java-heap-space-td2152420i20.html" title="Page 2">2</a></span></span>
	</div>
	</div>
			<div id="topic-footer" class="weak-color" style="padding-top:1em">
		&laquo;
		<a href="http://tomcat.10.x6.nabble.com/Tomcat-User-f1968778.html">Return to Tomcat - User</a>
		&nbsp;|&nbsp;
		<span id="v2152420" style="display:none">1 view|%1 views</span>
	
	
	</div>
			<div id="report-inappropriate-content" class="report-inappropriate-content rounded">
		<div id="report-inappropriate-content-inner" class="no-bg-color medium-border-color border2">
			<div class="big">Loading...</div>
		</div>
	</div>
				<script type="text/javascript">
				Nabble.ads('topic_bottom');
			</script>
	<script type="text/javascript">
	var infolinks_pid = 1480243;
	var infolinks_wsid = 0;
	</script>
	<script type="text/javascript" src="http://resources.infolinks.com/js/infolinks_main.js"></script>
			<table class="footer-table shaded-bg-color">
		<tr>
			<td class="footer-left weak-color">
				Powered by
				<a href="http://www.nabble.com/" target="_top">Nabble</a>
			</td>
			<td class="footer-right">
				<a href="/template/NamlServlet.jtp?macro=macro_viewer&amp;id=classic_forum_topic%21nabble%3Atopic.naml&amp;base=nabble.view.web.template.ServletNamespace" rel="nofollow">Edit this page</a>
			</td>
		</tr>
	</table>
	<!-- Ad.true -->
			<script type='text/javascript'>
var scriptUrl = '/template/NamlServlet.jtp?macro=js_page&searchSpecial=2152420&incViewCount=2152420&newsflash=&starB=2152420|2152423|2152425|2152473|2152493|2152426|2152474|2152429|2152476|2152478|2152480|2152484|2152486|2152491|2152490|2152487|2152471|2152431|2152434|2152437&visitorOnline=&avatarOnline=111943|102143|100297|100398&postCount=111943|102143|100297|100398&markVisited=2152437&views=2152420';
scriptUrl += '&_=' + Math.floor(Math.random()*9999) + Nabble.getClientID();
$.getScript(scriptUrl, function() { Nabble.resizeFrames(); });
</script>

					</div>
					<script type="text/javascript">
		$(document).ready(function() { Nabble.fixCookieClientID(); });
		(function(){ var sNew = document.createElement("script"); sNew.defer = true; sNew.src = "http://tag.crsspxl.com/s1.js?d=1294"; var s0 = document.getElementsByTagName('script')[0]; s0.parentNode.insertBefore(sNew, s0); })();
	</script>
					<!-- x6.nabble.com | Site ID = 10 -->
				</body>
			</html>
