<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
<head>
       <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
       <meta http-equiv="Content-Language" content="en">
       <link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.jroller.com/agileanswers/feed/entries/rss" />
       <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.jroller.com/agileanswers/rsd"/>
   <script type="text/javascript" src="/theme/scripts/roller.js"></script>
    <title>Preventing Java's java.lang.OutOfMemoryError: PermGen space failure | Eric's Agile Answers</title>

   <style type="text/css">
                      	/* Layout ----------------------------------------------*/
		#container {
			width: 960px;
			\width: 980px;
			w\idth: 960px;
			margin: 10px;
			margin-right: auto;
			padding: 10px;
			}
		#sidebar-a {
			float: left;
			width: 240px;
			\width: 250px;
			w\idth: 240px;
			margin: 0;
			margin-right: 5px;
			background: url(/themes/brushedmetal/images/metalLine.gif) top right repeat-y;
			padding: 0px 25px 0px 0px;
			}
		#content {
			padding: 5px 25px 5px 15px;
			margin-left: 275px;
			}
	/* General--------------------------------------------- */
		body {
			margin:0px 0px 30px 0px;
			font-size:12px;
			font-family:Geneva, Arial, Helvetica, san-serif;
			line-height:140%;
			color:#FFF;
			background:#848484 url(/themes/brushedmetal/images/metalBGBG.jpg) top left repeat-x;
			}
		#block {
			background: url(/themes/brushedmetal/images/metalBG.jpg) top left no-repeat;
			}
		A {
			text-decoration: underline;
			font-weight:bold;
			} 
		A:link {
			color: #FFF;
			font-weight:bold;
			} 
		A:visited {
			color: #FFF; 
			} 
		A:active {
			color: #920011;
			} 
		A:hover {
			color: #FDE006;
			font-weight:bold;
			}
	/*Banner--------------------------------------------- */
		#banner {
			margin-bottom: 155px;
			text-align:center;
			line-height:120%;
			}
		#banner a {
			text-align:center;
			text-decoration:none;
			}
		.tagline {
			color:#FFF;
			font-size:11px;
			text-shadow: 2px 2px 5px Black;
			line-height:120%;
			}      
	/* NewsItems--------------------------------------------- */
		.newsItemTitle {
			font-size:16px;
			font-weight:bold;
			padding:5px 0px 5px 0px;    
			margin:0px;
			} 
		.newsItemDesc {
			padding: 5px 0px 15px 0px;
			border-bottom:1px solid #ddd;
			margin-bottom:25px;
			}
		.newsItemFooter {
			text-align:right;
			font-size:10px;
			}
	/* Navigation--------------------------------------------- */
		.navLink {
			padding: 3px 8px 3px 8px;
			margin-bottom:8px;
			border:1px solid #A3A3A3;
			text-align:center;
			}
	/* Main Column--------------------------------------------- */
		.title  { 
			font-size: 18px; 
			line-height:150%;
			font-weight:bold; 
			text-align:left;
			color: #000; 
			padding-bottom:15px;
			}  
		.date  { 
			font-size:12px;
			font-weight:bold;
			text-align:left;
			line-height:120%;
			padding:3px 5px 4px 3px;
			margin-top:10px;
			margin-bottom:22px;
			color:#FFF;
			background:#5A5A5A;
			border:1px solid #A3A3A3;
			}
		#footer{
			font-size:10px;
			line-height:130%;
			font-weight:normal;
			padding-top:10px; 
			margin-top:26px; 
			border-top:1px solid #A3A3A3;
			}
	/* Calendar--------------------------------------------- */
		#calendar td {
			padding:0px;
			color:#FFF;
			text-align:center;
			font-size:12px;
			font-family:Geneva, Arial, Helvetica, san-serif;
			line-height:140%;
			color:#FFF;
			}
		#calendar a {
			font-weight:bold;
			color:#FFF;
			}
		.hCalendarMonthYearRow, .dCalendarMonthYearRow
			{ 
			font-size:12px;
			font-weight:bold;
			text-align:left;
			}
		.hCalendarDayNameRow, .dCalendarDayNameRow
			{
			font-weight:bold;
			}
		.hCalendarDayRow, .dCalendarDayRow
			{
			font-weight:normal;
			}
		.hCalendarDayLinked, .dCalendarDayLinked
			{
			background-color: #6F6F6F;
			}
		.hCalendarDayCurrent, .dCalendarDayCurrent
			{
			background-color:#5A5A5A;;
			}
	/* Discussion--------------------------------------------- */
		.dlHeader{
			padding:4px;
			}
		.dlCountReadsTitle, .dlSubjectTitle, .dlCountMessagesTitle, .dlPostedTitle, .dlMessageLinkTitle, .dlAuthorTitle
			{
			padding:4px;
			}
		.dlSubject, .dlCountMessages, .dlPosted, .dlCountReads, .dlAuthor, .dlMessageLink
			{
			padding:4px;
			}
		.discussHeader {
			font-weight:normal;
			line-height:120%;  
			}    
		.discussResponceList {
			padding:10px 10px 10px 10px;  
			margin-top:10px;
			border-top:1px dotted #999;  
			} 
	/* Misc--------------------------------------------- */
		hr {
			background:#A3A3A3;
			border-top:0px solid #A3A3A3;
			border-bottom:0px solid #A3A3A3;
			border-left:0px solid #A3A3A3;
			border-right:0px solid #A3A3A3;
			height:1px;
			}
		td {
			font-size:12px;
			font-family:Geneva, Arial, Helvetica, san-serif;
			line-height:140%;
			color:#FFF;
			}       </style>
</head>
<body>
<div style="width:100%;padding-left:15%;padding-top:5px;padding-bottom:5px;font-size:1.5em;background-color:#FFFFFF;color:#000000">
I've moved this blog to <a style="color:#333333" href="http://www.ericsimmerman.com/">http://www.ericsimmerman.com/</a> for all future posts. 1/12/09 
</div>
<div id="block">&nbsp;

   <div id="container">

      <div id="sidebar-a">

         <h1 id="banner">
            Eric's Agile Answers            <span class="tagline"><em>Posts on whatever your host, Eric Simmerman, deems relevant.</em></span>
         </h1>

         <div id="calendar">        <table cellspacing="0" border="0"  summary="Blog Archive Calendar" class="hCalendarTable"><tr><td colspan="7" align="center" class="hCalendarMonthYearRow"><a href="/agileanswers/date/201311" title="Prev" class="hCalendarNavBar">&laquo;</a> December 2013</td></tr><tr><th class="hCalendarDayNameRow" align="center">Sun</th><th class="hCalendarDayNameRow" align="center">Mon</th><th class="hCalendarDayNameRow" align="center">Tue</th><th class="hCalendarDayNameRow" align="center">Wed</th><th class="hCalendarDayNameRow" align="center">Thu</th><th class="hCalendarDayNameRow" align="center">Fri</th><th class="hCalendarDayNameRow" align="center">Sat</th></tr><tr><td class="hCalendarDay"><div class="hCalendarDayTitle">1</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">2</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">3</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">4</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">5</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">6</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">7</div></td></tr><tr><td class="hCalendarDay"><div class="hCalendarDayTitle">8</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">9</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">10</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">11</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">12</div></td><td class="hCalendarDayCurrent"><div class="hCalendarDayTitle">13</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">14</div></td></tr><tr><td class="hCalendarDay"><div class="hCalendarDayTitle">15</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">16</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">17</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">18</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">19</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">20</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">21</div></td></tr><tr><td class="hCalendarDay"><div class="hCalendarDayTitle">22</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">23</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">24</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">25</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">26</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">27</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">28</div></td></tr><tr><td class="hCalendarDay"><div class="hCalendarDayTitle">29</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">30</div></td><td class="hCalendarDay"><div class="hCalendarDayTitle">31</div></td><td class="hCalendarDayNotInMonth">&nbsp;</td><td class="hCalendarDayNotInMonth">&nbsp;</td><td class="hCalendarDayNotInMonth">&nbsp;</td><td class="hCalendarDayNotInMonth">&nbsp;</td></tr><tr><td class="hCalendarDayNotInMonth">&nbsp;</td><td class="hCalendarDayNotInMonth">&nbsp;</td><td class="hCalendarDayNotInMonth">&nbsp;</td><td class="hCalendarDayNotInMonth">&nbsp;</td><td class="hCalendarDayNotInMonth">&nbsp;</td><td class="hCalendarDayNotInMonth">&nbsp;</td><td class="hCalendarDayNotInMonth">&nbsp;</td></tr><tr class="hCalendarNextPrev"><td colspan="7" align="center"><a href="/agileanswers/" class="hCalendarNavBar">Today</a></td></tr></table>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-410289-11";
urchinTracker();
</script>
</div>
	 <hr />

         <h3>Relevant Links</h3>
                                <ul class="rFolder">
                    <li class="rFolderItem">
                    <a href="http://www.ericsimmerman.com/feed/"><img class="smrssbadge"
           src="/images/smrssbadge.gif"
           alt="URL of site's RSS feed"/></a>
                <a href="http://www.ericsimmerman.com"
           title=""
           class="rBookmark0">Eric Simmerman's Weblog</a>
        </li>
                <li class="rFolderItem">
                    <a href="http://www.tempeststrings.com"
           title=""
           class="rBookmark0">Tempest Strings</a>
        </li>
                   </ul>
        
         <h3>Newsfeeds</h3>
             <a href="http://www.jroller.com/agileanswers/feed/entries/rss"><img class="rssbadge"
        src="/images/rssbadge.gif" alt="XML" /></a>
<br />
                     <div class="rNavigationBar">
         <br />
    <a href="/">Front Page</a>             <br />
    <a href="http://www.jroller.com/agileanswers/">Weblog</a>                                                                                                                                                    
                                         <br />
    <a href="http://www.jroller.com/agileanswers/page/wpexport.xml">WordPress</a>                
                                                                                            
                                         <br />
    <a href="http://www.jroller.com/agileanswers/page/comments">comments</a>                
                        
                                <br />
    <a href="/roller-ui/login-redirect.jsp">Login</a>                </div >
<br />
<script type="text/javascript"><!--
google_ad_client = "pub-6551296073995582";
/* 200x90, created 3/24/09 */
google_ad_slot = "2480096507";
google_ad_width = 200;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
      </div> <!-- sidebar-a -->

      <div id="content">
             
            <div class="next-previous">
                                        &laquo; <a href="http://www.jroller.com/agileanswers/entry/hibernate_support_for_entities_that">Hibernate support...</a> |  
                <a href="/agileanswers/">Main</a>
                | <a href="http://www.jroller.com/agileanswers/entry/anonymous_access_of_appfuse_s">Anonymous access of...</a> &raquo;
            </div>
    
                <div class="date">
    <a href="http://www.jroller.com/agileanswers/date/20060623"><img
        class="daypermalink"
        src="/images/permalink.gif"
        title="Permanent link to this day"
        alt="20060623" /></a>
     Friday June 23, 2006     </div>
<div class="newsItems">
  <a name="preventing_java_s_java_lang" id="preventing_java_s_java_lang"></a>
  <h2>Preventing Java's java.lang.OutOfMemoryError: PermGen space failure</h2>
                             <p>The "OutOfMemoryError: PermGen space" message is normally encountered during development activites where a long-running JVM is asked to load/unload builds. However it can also be encountered in a recently spawned JVM under the "right" set of conditions. </p>

<p>The message is a symptom of an incomplete garbage collection sweep where resources are not properly released upon unload/restart. There is no shortage of debate (<a href="http://forum.hibernate.org/viewtopic.php?t=935948&start=180&postdays=0&postorder=asc&highlight=">Hibernate forum</a>, <a href="http://forum.java.sun.com/thread.jspa?threadID=661841&messageID=3880883">Sun forum</a>, <a href="http://forum.springframework.org/showthread.php?t=21383">Spring Framework forum</a> ) regarding which codebase is responsible for this symptom, but the finger of blame has been pointed at <a href="http://cglib.sourceforge.net/">CGLIB</a>, <a href="http://www.hibernate.org/">Hibernate</a>, <a href="http://tomcat.apache.org/">Tomcat</a>, and even <a href="http://java.sun.com/j2se/">Sun's JVM</a>. </p>

<p>Generally speaking, this is an interoperability issue and can be resolved by changing one of the components in your software stack. Some users have reported relief by upgrading to the latest Tomcat 5.5 release, others have simply opted for another webcontainer implementation (like <a href="http://jetty.mortbay.org/jetty/index.html">Jetty</a> or <a href="http://clk.about.com/?zi=1/XJ&sdn=java&zu=http%3A%2F%2Fwww.caucho.com%2Findex.xtp">Resin</a>) with varying degrees of success.</p>

<p>In my experience, the most pain-free method of resolving this issue is to switch from Sun's JDK implementation to BEA's freely available <a href="http://dev2dev.bea.com/jrockit/">JRockit</a> implementation.</p> 

<p>On a recent project utilizing Tomcat 5.5.12 with Hibernate, I was plagued with this PermGen error, at times even experiencing it during web-based unit testing. Since making the switch to JRockit, I have not encountered this issue even once. I attribute the "fix" to the differences between JRockit's and Sun's garbage collection implementations, but have no proof that this is indeed the reason that JRockit resolves the issue. In any case, WFM.</p>


           <br/>
<div style="text-align:center">
<script type="text/javascript"><!--
google_ad_client = "pub-6551296073995582";
google_ad_slot = "9973567290";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<br/>
  Posted by ets
  <span class="dateStamp">(     Jun 23 2006, 11:23:09 AM EDT     )</span>
      <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang"
        title="Permanent link to this weblog entry"
        class="entrypermalink">Permalink</a>
                  <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comments" class="entrycommentslink">Comments [40]</a>
    <br/><br/>
<img src="http://jroller.com/resources/a/agileanswers/tags.gif" usemap="#ff8080810bf14173010c0161de573aac" border="0" height="28" width="254">
        <map name="ff8080810bf14173010c0161de573aac">
<area shape="rect" coords="6,3,56,25" href="http://del.icio.us/post?url=http%3A%2F%2Fwww.jroller.com%2Fagileanswers%2Fentry%2Fpreventing_java_s_java_lang">
<area shape="rect" coords="67,3,120,25" href="http://digg.com/submit?phase=2&amp;url=http%3A%2F%2Fwww.jroller.com%2Fagileanswers%2Fentry%2Fpreventing_java_s_java_lang">
<area shape="rect" coords="129,4,174,24" href="http://furl.net/storeIt.jsp?t=Preventing Java's java.lang.OutOfMemoryError: PermGen space failure&amp;u=http%3A%2F%2Fwww.jroller.com%2Fagileanswers%2Fentry%2Fpreventing_java_s_java_lang">
<area shape="rect" coords="181,6,248,23" href="http://technorati.com/search/http%3A%2F%2Fwww.jroller.com%2Fagileanswers%2Fentry%2Fpreventing_java_s_java_lang">
                   </map> 
</div>    
                                    <a name="comments"></a>
    <div class="comments" id="comments">

            <div class="comments-head">Comments:</div>
            
    <br/>
                                                            
            <div class="comment odd" id="comment1">
                I also had these annoying Perm Gen Space OOMs when redeploying webapps. I'm using spring 1.2.8, Hibernate 3 (both with CGLIB 2.1_3), tomcat 5.5.17 and - now the problem: jdk1.5.0_06. After upgrading to jdk1.5.0_07 my Perm Gen Space gets gc'ed like it should be - no increase of Perm Gen Space, no code changes.
<br />
<br />There were however some learnings on the way:
<br />
<br />1. Put JDBC driver in common/lib (as tomcat doku says) and never ever in WEB-INF/lib - If you get No suitable driver Exception during redeploy use JNDI DB definition in META-INF/context.xml; not in server.xml and not in conf/Catalina/localhost/&lt;context&gt;.xml. This is how my META-INF/context.xml looks like:
<br />&lt;Context path=&quot;/ngc&quot; reloadable=&quot;true&quot; debug=&quot;1&quot;&gt;
<br />
<br />	&lt;Resource
<br />		name=&quot;jdbc/db&quot;
<br />		auth=&quot;Container&quot;
<br />		type=&quot;javax.sql.DataSource&quot;
<br />		maxActive=&quot;30&quot;
<br />		maxIdle=&quot;3&quot;
<br />		maxWait=&quot;10000&quot;
<br />		username=&quot;webapp&quot;
<br />		password=&quot;&quot;
<br />		driverClassName=&quot;net.sourceforge.jtds.jdbc.Driver&quot;
<br />		url=&quot;jdbc:jtds:sqlserver://dbdevel/ngc;tds=8.0;lastupdatecount=true&quot; /&gt;
<br />
<br />&lt;/Context&gt;
<br />
<br />2. Don't put commons-logging into WEB-INF/lib since tomcat already bootstraps it
<br />
<br />3. If you still run in Perm Gen Space OOM then you may have to increase Perm Gen Space or don't redeploy your webapps so fast! What was most irritating for me after thinking the issue is solved for me was that sometimes i did ran into Perm Gen Space OOM and sometimes not. It seems that gc cleans Perm Gen Space from time to time and not (!) if space is low or app explicitly requests gc. - But this I didn't fully understand (not to say not at all), but still there are reasonable arguments on sun bug database to increase this memory (see post above)
<br />
<br />Now I'm happy again after two (!) days of reading lots of forum threads, learning lots about class loader, tomcat, spring, hibernate, aop and class metadata and knowing that programming still can be very difficult!

                <p class="comment-details">
                Posted by
                                    <b>Yan Hackl-Feldbusch</b>
                
                on June 29, 2006 at 04:11 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1151568695000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment2">
                The problem is that Tomcat does not garbage collect the Classloader and the classes it loads. Each you reload the webapp context, more copies of these classes are loaded, and as these are stored in the permanent heap generation, it will eventually run out of memory.
<br />The same issue could affect (and affects) to any container. You just have to restart the container instead of restarting the context.
<br />It's easy to reproduce this problem by reloading the context over and over again until you get an OutOfMemoryError (10 times was enough for a simple app)
<br />
<br />Cheers

                <p class="comment-details">
                Posted by
                                    <b>Cheng Lee</b>
                
                on August 26, 2006 at 04:36 PM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1156624573000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment3">
                JRockit doesn't have generational garbage collection - in other words, it doesn't have permanent generation space. Therefore, it can't have PermGen errors. Ever.
<br />
<br />That's not to say that you won't / haven't got a memory leak, and that eventually it may bring the JVM down, but it isn't reliant on a separate little hived off area like the Sun's JVM.

                <p class="comment-details">
                Posted by
                                    <b>Graham Triggs</b>
                
                on November 08, 2006 at 09:13 AM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1162995225000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment4">
                These problems are not specific to Tomcat, Hibernate, or Spring. I am using Glassfish on JDK 6.1, and run into this error all too frequently. If there are solutions that don't require swapping out the JDK, then please post them.

                <p class="comment-details">
                Posted by
                                    <a rel="nofollow" href="http://www.hhartley.com"><b>ITVGuy2000</b></a>
                
                on August 06, 2007 at 01:02 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1186376570000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment5">
                -XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled

                <p class="comment-details">
                Posted by
                                    <b>orx</b>
                
                on October 12, 2007 at 12:45 PM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1192207521000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment6">
                ok

                <p class="comment-details">
                Posted by
                                    <b>203.197.25.11</b>
                
                on November 02, 2007 at 06:11 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1193998261000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment7">
                I've had large apps running on our server for more than a year now. They are built using JPOX for persistence and we've never once experienced an Out of memory, PermGen Space error. 
<br />
<br />Just recently we installed a third party app that uses Hibernate for persistence and now we get PermGen errors. I noticed that there are a number of articles pointing to PermGen memory problems/leaks with Hibernate when it is not using reflection as it burns up a bit too much memory via it's iteractions with CGLIB. The suggestion seems to be to run Hibernate in &quot;reflection&quot; mode but reflection is a very slow mode for any ORM to operate in.
<br />
<br />I'm not sure if our particular problem is with Hibernate or the application itself. It's a third party open source project that we use nearly everyday. I don't want to mention it's name in case this issue is related to the Hibernate framework that it ships with and not the application itself.
<br />
<br />It should be fairly quick to change the code to use JPOX like the rest of our apps use to see if the problem goes away. Both JPOX and Hibernate support transparent persistence so there shouldn't be any references to the any specific ORM stuff in the model code.
<br />
<br />Anyone had experience porting between different &quot;transparent&quot; persistence ORMs before?

                <p class="comment-details">
                Posted by
                                    <b>Golfman</b>
                
                on February 08, 2008 at 03:55 PM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1202504104000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment8">
                &gt;&gt;The problem is that Tomcat does not garbage &gt;&gt;collect the Classloader and the classes it &gt;&gt;loads. Each you reload the webapp context, &gt;&gt;more copies of these classes are loaded, and &gt;&gt;as these are stored in the permanent heap &gt;&gt;generation, it will eventually run out of &gt;&gt;memory. 
<br />&gt;&gt;The same issue could affect (and affects) to &gt;&gt;any container. You just have to restart the &gt;&gt;container instead of restarting the context. 
<br />&gt;&gt;It's easy to reproduce this problem by &gt;&gt;reloading the context over and over again &gt;&gt;until you get an OutOfMemoryError (10 times &gt;&gt;was enough for a simple app) 
<br />
<br />&gt;&gt;Cheers 
<br />&gt;&gt;Posted by Cheng Lee on August 26, 2006 at &gt;&gt;04:36 PM EDT # 
<br />
<br />Interesting and believing this is true. Question is how to avoid this happening

                <p class="comment-details">
                Posted by
                                    <b>134.178.63.3</b>
                
                on February 21, 2008 at 05:50 PM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1203634211000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment9">
                fjkfk

                <p class="comment-details">
                Posted by
                                    <b>122.168.26.172</b>
                
                on March 06, 2008 at 11:18 AM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1204820304000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment10">
                When I ran a profiler, I noticed that by default you have 96MB of non-heap memory limit. With BEA this raises up to 4GB, so of course you can redeploy thousands of times. But still, with each redeployment, the amount of allocated memory raises again :(

                <p class="comment-details">
                Posted by
                                    <b>Dunkelheit</b>
                
                on March 14, 2008 at 10:07 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1205503638000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment11">
                I encounter the same problem. I am using BEA Weblogic. I have removed the deployment of my application, and shutdown the managed server relating to the application. I am intending to redeploy the application, hoping to make a new clean start. But i encounter the message below.
<br />
<br />WARNING: The server has decided to close this client connection.
<br />&lt;27/03/2008 11:48:46 AM EST&gt; &lt;Warning&gt; &lt;Management&gt; &lt;BEA-141269&gt; &lt;The temporary
<br />bean tree updateDeploymentContext(Thu Mar 27 11:48:09 EST 2008) was allocated fo
<br />r an undo, get, or activate operation, but has not been garbage collected.&gt;
<br />
<br />How to clean up this garbage so that when i redeploy I don't encounter the same problem of OutOfMemoryError:PermGen space failure??
<br />

                <p class="comment-details">
                Posted by
                                    <b>Joni</b>
                
                on March 26, 2008 at 08:54 PM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1206579242000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment12">
                I came across this error very recently, and I haven't been able to pin point whether this is happening due to only Tomcat, Hibernate or the JVM mainly because we use both Tomcat and Hibernate.
<br />
<br />One sure way of avoiding this problem, I gather, is by restarting the container every time we re-deploy the app. It may not be practical when you have more than one app running on your server, but it works. I'm usually in the habit of restarting the server with each deployment, whereas some of my teammates are not. And until now, I've never experienced this problem, whereas my teammates have.
<br />
<br />All in all, a good thread, with good insights thrown in from some of the readers. Thanks.

                <p class="comment-details">
                Posted by
                                    <b>Satya</b>
                
                on April 25, 2008 at 10:31 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1209133875000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment13">
                I can confirm the solution by ITVGuy2000 perfectly works for me (1.6.0_05, Apache Tomcat 6.0.16):
<br />-XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled
<br />
<br />ITVGuy2000, Great thanks!!!

                <p class="comment-details">
                Posted by
                                    <b>Maxym</b>
                
                on June 18, 2008 at 11:29 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1213802987000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment14">
                sorry, seems like it was Posted by orx on October 12, 2007 at 12:45 PM EDT
<br />
<br />orx, huge THANK YOU!

                <p class="comment-details">
                Posted by
                                    <b>Maxym</b>
                
                on June 18, 2008 at 11:30 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1213803059000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment15">
                This error occurs when the JVM runs out of space in the permanent generation heap. Since the defaults for the JVM are quite low, the first step should be to increase the default using -XX:MaxPermSize.
<br />
<br />Put the below VM argument when starting program
<br />
<br />-XX:MaxPermSize=256m
<br />
<br />-------------------------------------------------
<br />
<br /> &lt;!-- verbose garbage collection --&gt;
<br /> &lt;jvm-arg&gt;-XX:MaxPermSize=256m&lt;/jvm-arg&gt; &lt;!-- sets the maximum size of the permanent heap (recommended) --&gt;
<br />
<br />
<br />

                <p class="comment-details">
                Posted by
                                    <b>xyz</b>
                
                on July 03, 2008 at 02:11 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1215065515000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment16">
                Your Comment:Your Comment:Your Comment:Your Comment:

                <p class="comment-details">
                Posted by
                                    <a rel="nofollow" href="http://Your Comment:"><b>Your Comment:</b></a>
                
                on July 07, 2008 at 06:51 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1215427877000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment17">
                Someone could tell me what exactly do these 2 options?
<br />
<br />-XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled 

                <p class="comment-details">
                Posted by
                                    <b>Marlon Patrick</b>
                
                on July 07, 2008 at 09:44 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1215438296000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment18">
                Java PermGen space out of memory error : 
<br />Steps to rectify this error :
<br />
<br />Hi Guys This is common error people get when they are using tomcat 
<br />for big web application .so following are the steps to rectify this error :
<br />1.0 click on tomcat start up 
<br />2.0 click on java tab in tomcat startup 
<br />3.0 Now add the following parameter in java option field :
<br />
<br />-XX:MaxPermSize=512m
<br />-verbose:gc
<br />-XX:+PrintClassHistogram
<br />
<br />4.0 assign intial pool memory 256 mb 
<br />
<br />5.0 assign maximum memory pool 1024mb 
<br />
<br />6.0 restart the server 
<br />
<br />This setting is applicable or this is an example when your system RAM is 2GB where the tomcat 
<br />
<br />is running .
<br />
<br />for other RAM size please make sure that memory division does not exceed to system 
<br />
<br />memory.otherwise tomcat server will not restart.
<br />
<br />
<br />after doing aforesaid setting if you still face this issue :
<br />
<br />please look at the tomcat server log file ,Parameter  PrintClassHistogram will 
<br />print the time life of each object .so now you have to optimized your code 
<br />where the object life is more .
<br />Hope aforesadi solution will workout your issue

                <p class="comment-details">
                Posted by
                                    <b>ram sahai </b>
                
                on July 17, 2008 at 12:27 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1216268860000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment19">
                I am also facing the same issue ([junit] Exception in thread &quot;Thread-0&quot; java.lang.OutOfMemoryError: PermGen space) when I run the junit testcases using ANT utility. Tried to solve the problem setting the JVM aguments ( -XX:PermSize=1024m -XX:MaxPermSize=1024m). But it didn't worked. Finally ran junit testcases with bea JROCKIT and it worked.

                <p class="comment-details">
                Posted by
                                    <b>Susanta Ghosh</b>
                
                on August 19, 2008 at 12:23 PM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1219163028000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment20">
                Thanks alot my problem also solved.

                <p class="comment-details">
                Posted by
                                    <b>KranthiGedela</b>
                
                on October 03, 2008 at 10:28 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1223044104000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment21">
                @ Susanta Ghosh
<br />how much RAM do you have?

                <p class="comment-details">
                Posted by
                                    <b>mdalangin</b>
                
                on October 05, 2008 at 11:34 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1223220871000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment22">
                Hi,
<br />I think this problem can also be due to a Leakage Class Loader.....
<br />
<br />Check Eclipse Memory Analyzer to see the details.......
<br />
<br />Thanks,
<br />Nirmal

                <p class="comment-details">
                Posted by
                                    <b>Nirmal Kumar</b>
                
                on October 15, 2008 at 12:13 PM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1224087201000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment23">
                add the following in Java-option under tomcar configuration and everything will be ok.
<br />
<br />-Xmx256m
<br />-Xms256m
<br />-XX:PermSize=512m
<br />-XX:MaxPermSize=512m
<br />-verbose:gc
<br />

                <p class="comment-details">
                Posted by
                                    <b>muzy</b>
                
                on November 04, 2008 at 09:31 AM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1225809092000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment24">
                Switched from jrockit to Sun JDK 1.5.0_16b02 on RH5, started getting the PermGen OOM error. Adding -XX:PermSize=256 cleared it up.

                <p class="comment-details">
                Posted by
                                    <a rel="nofollow" href="http://www.mikeinlondon.com"><b>Mike</b></a>
                
                on November 08, 2008 at 06:51 AM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1226145074000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment25">
                F

                <p class="comment-details">
                Posted by
                                    <b>59.145.67.121</b>
                
                on November 22, 2008 at 05:18 AM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1227349112000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment26">
                Hi everyone,
<br />
<br />I've tried with tomcat(6.0.18), glassfish(prelude v3) and hotspot(1.6.0_04-b12) + a simple spring hibernate app.
<br />
<br />I tried -XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled as well.
<br />
<br />In both cases after 10 redeploys I get OutOfMemoryError.
<br />
<br />Did someone managed at least to identify the problem? Is there a official bug report for sun guys?
<br />

                <p class="comment-details">
                Posted by
                                    <b>Dusan</b>
                
                on December 04, 2008 at 08:48 AM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1228398494000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment27">
                THIS IS MY ERROR: 
<br />12/17/2008 15:45:17   HTTP JVM: Unexpected error while executing java agent:JavaAgent
<br />12/17/2008 15:45:17   HTTP JVM: --&gt;java.lang.OutOfMemoryError: PermGen space
<br />12/17/2008 15:45:17   HTTP JVM: java.lang.OutOfMemoryError: PermGen space
<br />
<br />We have previously extend the mem space but it ended up crashing our domino server. If you have any other suggestions please send them. Kind regards.

                <p class="comment-details">
                Posted by
                                    <a rel="nofollow" href="http://Preventing Java's java.lang.OutOfMemoryError: PermGen space failure"><b>Adele</b></a>
                
                on December 17, 2008 at 09:54 AM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1229525666000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment28">
                Article provides gud information about JVM parameters

                <p class="comment-details">
                Posted by
                                    <b>Arun</b>
                
                on March 04, 2009 at 11:52 PM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1236228746000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment29">
                The article is good! And so does the comments. I learn a lot from both.
<br />
<br />I happen to &quot;hit&quot; this kind of error in someone else application. It uses 
<br />
<br />Hibernate+Spring+WebSphere. It's turn out that the problem is on the creation of application context EVERYTIME the application run several .Java file! Can you imagine how memory-consume it was.
<br />
<br />The solution is using the SingletonBeanFactoryLocator class.
<br />

                <p class="comment-details">
                Posted by
                                    <a rel="nofollow" href="http://putrichairina.wordpress.com"><b>pucha</b></a>
                
                on March 12, 2009 at 05:24 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1236849849000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment30">
                 -XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled
<br />
<br />These options only work if you are using CMS garbage collection, i.e. you must also have the JVM option:
<br />
<br />-XX:+UseConcMarkSweepGC

                <p class="comment-details">
                Posted by
                                    <b>vlad</b>
                
                on September 03, 2009 at 05:25 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1251969945000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment31">
                I new to this. I get the same error and I found good solutions and comments. Now I want to try
<br />
<br />Can you guide me that which file should I update with this :
<br />-XX:+CMSClassUnloadingEnabled -XX:+CMSPermGenSweepingEnabled 
<br />
<br />Im using Tomcat 5.5
<br />
<br />Many thanks

                <p class="comment-details">
                Posted by
                                    <b>Mike85</b>
                
                on October 08, 2009 at 11:40 PM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1255059644000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment32">
                In the case of Tomcat (Don't know how Glassfish orany other servlet container implements its undeploy) when a webapp is undeployed tomcat simply removes its reference to the WebAppClassLoader
<br />
<br />In theory this makes all objects in the webapp unreachable go the garbage collector will remove them.
<br />
<br />Two things can mess this up (possibly more):
<br />
<br />1: The webapp started a thread and this thread is still running. This becomes a garbage collector root, so anything it references will not be collected
<br />
<br />2: If a class loaded by the webapp classloader is referenced by a parent classloader that class is still reachable. All class objects contain a reference to their classloader, which make the WebAppClassLoader still reachable - and the entire webapp.
<br />
<br />There are known points in the JVM where this can happen. One is creating a subclass of java.util.logging.Level as its constructor will add the instance to a static field of the Level class, which is typically loaded by the bootstrap classloader
<br />
<br />There's more documents places in this class org.apache.catalina.core.JreMemoryLeakPreventionListener
<br />

                <p class="comment-details">
                Posted by
                                    <b>Chris</b>
                
                on December 08, 2009 at 05:18 PM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1260310732000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment33">
                Thanks for ur solution !!
<br />Had the same problem and it got fixed when I used -XX:MaxPermSize=512m :)
<br />

                <p class="comment-details">
                Posted by
                                    <b>tyt</b>
                
                on March 08, 2010 at 12:07 PM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1268068021000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment34">
                We are using glassfish, jdk 1.5. During redeployment it throws memory out of error.

                <p class="comment-details">
                Posted by
                                    <b>srinivas</b>
                
                on March 20, 2010 at 04:12 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1269072737000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment35">
                Exception in thread &quot;GroupChannel-Heartbeat-1&quot; java.lang.OutOfMemoryError: PermGen space
<br />
<br />any one know abt this error . i got this error and tomcat is  still loading the page for a long time

                <p class="comment-details">
                Posted by
                                    <b>kalasagar</b>
                
                on April 06, 2010 at 02:43 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1270536203000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment36">
                My problem was fixed by putting libraries in a shared location for the web server rather than the  deployed application library.

                <p class="comment-details">
                Posted by
                                    <b>Chris</b>
                
                on April 22, 2010 at 03:47 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1271922474000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment37">
                I have just downloaded a game and it cant play it says OutOfMemory, what should i do to play the game?

                <p class="comment-details">
                Posted by
                                    <a rel="nofollow" href="http://N/A"><b>Kagisho</b></a>
                
                on August 09, 2010 at 06:33 PM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1281393235000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment38">
                In my case we have around 90000 JSPs being used in application,When a crawler comes &amp; tries to access the JSPs then after a while we get the error &quot;Outofmemory : PermGen Spave failure&quot;
<br />
<br />I am using tomcat 5.
<br />Is this bug of sun JDK reported to sun java.

                <p class="comment-details">
                Posted by
                                    <b>Amit</b>
                
                on October 17, 2010 at 10:05 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1287324323000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment odd" id="comment39">
                Even after changing those properties, i am still getting these errors. i changed the size to maximum for XX:MaxPermSize. still not solved. may be we need to look for other soluations

                <p class="comment-details">
                Posted by
                                    <a rel="nofollow" href="http://www.cloudhadoop.com/2012/01/issues-with-outofmemoryerror-permgen.html"><b>Kiran</b></a>
                
                on January 16, 2012 at 02:01 AM EST

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1326697311000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                                                    
            <div class="comment even" id="comment40">
                @Kiran, its may be due to memory leak in PermGen area. check out this post http://javarevisited.blogspot.de/2011/09/javalangoutofmemoryerror-permgen-space.html , it contains some useful information   

                <p class="comment-details">
                Posted by
                                    <a rel="nofollow" href="http://javarevisited.blogspot.de/2011/09/javalangoutofmemoryerror-permgen-space.html"><b>Javadude</b></a>
                
                on June 14, 2012 at 03:47 AM EDT

                <a href="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang#comment-1339660070000"
                   class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                </div>
        
    <div class="comments-form">
    <div class="comments-head">Post a Comment:</div><br/>


        
    <form method="post" action="http://www.jroller.com/agileanswers/entry/preventing_java_s_java_lang" focus="name"
        name="form" onsubmit="fixURL(this); return validateComments(this)">
        
        
        <!-- is this a post or a preview -->
        <input type="hidden" name="method" value="post" />

        <table cellspacing="0" cellpadding="1" border="0" width="95%">
        <tr><th>Name:</th>
            <td><input type="text" name="name" value="" size="50" maxlength="255" /></td>
        </tr>

        <tr><th>E-Mail:</th>
            <td><input type="text" name="email" value="" size="50" maxlength="255" /></td>
        </tr>

        <tr><th>URL:</th>
            <td><input type="text" name="url" value="" size="50" maxlength="255" /></td>
        </tr>

                <tr>
            <td></td>
            <td>
                <input type="checkbox" id="notify" name="notify" />
                <label for="notify">Notify me by email of new comments</label>
            </td>
        </tr>
        
        <tr>
            <td></td>
            <td>
                <input type="checkbox" id="rememberInfo" name="rememberInfo" />
                <label for="rememberInfo">Remember Information?</label>
            </td>
        </tr>
        </table>
        <br/>

        <table>
        <tr><th style="text-align: left">Your Comment:</th></tr>
        <tr>
            <td>
            <textarea name="content" cols="50" rows="10"></textarea><br />
            <span class="comments-syntax-indicator">
            HTML Syntax:
                            <span class="disabled">NOT allowed</span>
                        </span>
            </td>
        </tr>
        </table>
        
        <script type="text/javascript" src="/theme/scripts/clientSideInclude.js"></script>
        <div id="commentAuthenticator"></div>
 
        <table cellspacing="0" cellpadding="1" border="0" width="95%">
        <tr>
            <td align="left" nowrap="nowrap">
               <input type="button" name="post" value="&nbsp;Preview&nbsp;"
                  onClick="this.form.method.value='preview';this.form.submit()" />
               <input type="submit" name="post" value="&nbsp;Post&nbsp;" />
            </td>
            <td align="right">
               <!-- <input type="button" value="&nbsp;Clear Info&nbsp;" /> -->
            </td>
        </tr>
        </table>

    </form>

    <script type="text/javascript" src="/theme/scripts/roller.js"></script>
    <script type="text/javascript">
    clientSideInclude('commentAuthenticator', '/CommentAuthenticatorServlet');

    var author = getCookie("commentAuthor");
    var email = getCookie("commentEmail");
    var url = getCookie("commentUrl");
    // check each field - IE will render "null"
    if (author) {
        document.form.name.value = author;
    }
    if (email) {
        document.form.email.value = email;
    }
    if (url) {
        document.form.url.value = url;
    }

    if (author || email || url) {
        document.form.rememberInfo.checked = true;
    }

    function fixURL(theForm) {
        if (theForm.url.value != "" &&
            theForm.url.value.indexOf("http://") == -1) { //prepend http://
            theForm.url.value = "http://"+theForm.url.value;
        }
        saveUserInformation(theForm);
    }

    function saveUserInformation(theForm) {
        if (theForm.rememberInfo.checked) {
            rememberUser(theForm);
        } else {
            forgetUser(theForm);
        }
    }

    function validateComments(theForm) {
        if (theForm.content.value == "") {
            alert("Please enter a comment.");
            theForm.content.focus();
            return false;
        }
    }
    </script>


    </div>
    <br/>
            <!-- 
   showNextPreviousLinks() is no longer needed as next/prev links are 
   built-into the  macro.
   -->
<!-- footer -->
      </div> <!-- content -->
   </div> <!-- container -->
</div> <!-- block -->
<link href='/agileanswers/resource/SyntaxHighlighter.css' rel='stylesheet' type='text/css'/>
<script type="text/javascript" src="/agileanswers/resource/shCore.js"></script>
<script type="text/javascript" src="/agileanswers/resource/shBrushPhp.js"></script>
<script type="text/javascript" src="/agileanswers/resource/shBrushJava.js"></script>
<script type="text/javascript">
 dp.SyntaxHighlighter.BloggerMode();  
 dp.SyntaxHighlighter.HighlightAll('code');  
</script>

</body>
</html>
