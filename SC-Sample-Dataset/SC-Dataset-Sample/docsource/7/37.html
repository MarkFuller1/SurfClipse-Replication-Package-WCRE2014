<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>ClojureDocs - clojure.core/doto</title>
	<meta name="description" content="Documentation and examples for Clojure." />
	<meta name="google-site-verification" content="XjzqkjEPtcgtLjhnqAvtnVSeveEccs-O_unFGGlbk4g" />
	<meta http-equiv="Content-Type" content="text/html" charset="utf-8"/>
	<link rel="search" type="application/opensearchdescription+xml" title="ClojureDocs" href="/opensearch.xml">
	<link href="/stylesheets/reset.css?1317195880" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/text.css?1317195880" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/grid.css?1317195880" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/common.css?1317195880" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/main.css?1317195880" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/shCore.css?1317195880" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/shThemeDefault.css?1317195880" media="screen" rel="stylesheet" type="text/css" />
	<script src="/javascripts/shCore.js?1317195880" type="text/javascript"></script>
<script src="/javascripts/shBrushClojure.js?1317195880" type="text/javascript"></script>
<script src="/javascripts/jquery-1.4.2.min.js?1317195880" type="text/javascript"></script>
<script src="/javascripts/jquery-ui-1.8.2.custom.min.js?1317195880" type="text/javascript"></script>
<script src="/javascripts/jquery.form.js?1317195880" type="text/javascript"></script>
<script src="/javascripts/jquery.qtip.min.js?1317195880" type="text/javascript"></script>
<script src="/javascripts/jquery.scrollTo-1.4.2-min.js?1317195880" type="text/javascript"></script>
<script src="/javascripts/showdown.js?1317195880" type="text/javascript"></script>
<script src="/javascripts/cd.js?1317195880" type="text/javascript"></script>

	<script type="text/javascript" charset="utf-8">
	// <![CDATA[
	
	CD.ROOT_URL = ""
	
	function setUpInternalNav() {
		$(".scroll").click(function(event){
			//prevent the default action for the click event
			event.preventDefault();

			//get the full url - like mysitecom/index.htm#home
			var full_url = this.href;

			//split the url by # and get the anchor target name - home in mysitecom/index.htm#home
			var parts = full_url.split("#");
			var trgt = parts[1];
			
			//get the top offset of the target anchor
			var target_offset = $("a[name="+trgt+"]").offset();
			var target_top = target_offset.top - 10;

			//goto that anchor by setting the body scroll top to anchor top
			$('html, body').animate({scrollTop:target_top}, 500);
		});
	}
	
	$(document).ready(function() {
		setUpInternalNav()
		var mainText = "Search";
		$("#main_search").makeFocusBlur(mainText, {setColorOnInit: true})

		var acUrl = "/ac_search";
		
		//acUrl = "/ac_search/clojure_core";
		
		
		$('#main_search').keydown(function(e) {
			if(e.ctrlKey && e.which == 13) {
				$(".search form").append("<input type='hidden' name='feeling_lucky' value='true' />")
			}
		})
			
		$(document).keydown(function(e) {
			if(e.ctrlKey && (e.which == 83)) {
				$('#main_search').focus()
			}
			
			e.stopPropagation();
		})
	})
	// ]]>	
	</script>

	<script type="text/javascript">
	/*** UserVoice ***/
	var uservoiceOptions = {
		/* required */
		key: 'clojuredocs',
		host: 'clojuredocs.uservoice.com', 
		forum: '64757',
		showTab: true,  
		/* optional */
		alignment: 'right',
		background_color:'#ccc', 
		text_color: 'white',
		hover_color: '#888',
		lang: 'en'
	};

	function _loadUserVoice() {
		var s = document.createElement('script');
		s.setAttribute('type', 'text/javascript');
		s.setAttribute('src', ("https:" == document.location.protocol ? "https://" : "http://") + "cdn.uservoice.com/javascripts/widgets/tab.js");
		document.getElementsByTagName('head')[0].appendChild(s);
	}
	_loadSuper = window.onload;
	window.onload = (typeof window.onload != 'function') ? _loadUserVoice : function() { _loadSuper(); _loadUserVoice();};
	</script>
	
	<script type="text/javascript">
	  /*** Google Analytics ***/
	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-17348828-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>

</head>

<body>
	<script type="text/javascript" charset="utf-8">
	$(document).ready(function() {
		$("#main_search").autocomplete({
			source: function(req, add) {
				$.getJSON("/search_autocomplete", req, function(data) {
					var out = []
					$.each(data, function(i, v) {
						var lbl = "<div class=\"ac_search_result\">"
						lbl += "<span class='name'>" + v.name + "</span>"
						lbl += "<span class='ns'>" + v.ns + "</span>"
						lbl += "<br />"
						lbl += "<span class='shortdoc'>" + v.shortdoc + "</span>"
						lbl += "</div>"
						out.push({label: lbl, value: v.name, href: v.href})
					})
					
					add(out)
				})
			},
			focus: function(event, ui) {
				return false
			},
			select: function(event, ui) {
				window.location.href = ui.item.href
				return false
			},
			dataType: "json"
		})
	})
</script>

<div class="header">
	<div class="container_16">
	<div class="header_content">
		<div class="user_area">
				<div class="grid_16">
            <span class="main_nav">
            <a href="http://api.clojuredocs.org">api</a>
            &nbsp;
            <a href="http://clojuredocs.wordpress.com">blog</a>
            &nbsp;
            <a href="http://github.com/zkim/clojuredocs">github</a>
            </span>
            &nbsp;
            &nbsp;
				  <span class="user_area_content">
				    
				      <a href="/login" id="login">login / sign up</a>
				      
				  </span>
				</div>
			<div class="clear"></div>
		</div>
		<div class="grid_1">
		  <img alt="Cd_logo" class="cd_logo" height="33" src="/images/cd_logo.png?1317195880" width="52" />
		</div>
		<div class="grid_7">
			<h1><a href="/">ClojureDocs</a><span class="version">(beta)</span></h1>
		</div>
		<div class="grid_8">
			<div class="search">
				<form action="/search" method="get">
					<input class="submit_image" height="20px" src="/images/magnifying_glass_alt_24x24.png?1317195880" type="image" width="20px" />
					<input id="main_search" class="text_field" name="q" type="text"  />
					
						<input type="hidden" name="lib" value="clojure_core" />
					
				</form>
			</div>
		</div>
		<div class="clear"></div>
	</div>
	</div>
	<div class="clear"></div>
</div>
<div class="header_filler"></div>
<div class="clear"></div>

	
	
	


<script type="text/javascript" charset="utf-8">


$(document).ready(function() {
	CD.VarPage.init({
		varId: 5479,
		library: "Clojure Core",
		version: "1.3.0",
		editExampleFormHTML: '<div class="edit_example"><form action="/clojure_core/clojure.core/doto" method="post"><div style="margin:0;padding:0;display:inline"><input name="authenticity_token" type="hidden" value="K7rZgSN1A5lR48FgruOisykFH5XZYBQ5SnfjxPieIBk=" /></div>Example Content <span class="instructions">(code only, do not wrap in &lt;pre&gt; tags. See <a href="/examples_style_guide">style guide</a> for more information.)</span><div class="examples_license">	Examples submitted to clojuredocs will be licensed under the <a href="http://creativecommons.org/publicdomain/zero/1.0/">Creative Commons CC 0</a>.</div><img alt="Ajax-loader" class="ajax_loader" height="20" src="/images/ajax-loader.gif?1317195880" width="20" /><textarea class="textarea" cols="40" id="example_body" name="example[body]" rows="20"></textarea><div style="text-align: right">	<a class="cancel" href="" style="float: left">Cancel</a>	<!-- <input class="preview_example" type="button" value="Preview" /> -->	<input id="example_submit" name="commit" type="submit" value="Update Example" />	<div class="clear"></div></div><input type="hidden" name="update_example" value="true" /><input type="hidden" name="example_id" value="-1" /><fieldset class="live_preview">	<legend>Live Preview</legend>	<div class="preview">	</div></fieldset></form>',
		editCommentFormHTML: '<div class="edit_comment"><form action="/clojure_core/clojure.core/doto" method="post"><div style="margin:0;padding:0;display:inline"><input name="authenticity_token" type="hidden" value="K7rZgSN1A5lR48FgruOisykFH5XZYBQ5SnfjxPieIBk=" /></div>Comment <span class="instructions">(markdown allowed, code in &lt;pre /&gt;)</span><br /><textarea class="textarea" cols="40" id="comment_body" name="comment[body]" rows="20"></textarea><div style="text-align: right">	<a class="cancel" href="" style="float: left">Cancel</a>	<!-- <input class="preview_comment" type="button" value="Preview" /> -->	<input id="comment_submit" name="commit" type="submit" value="Update Comment" />	<div class="clear"></div></div><input type="hidden" name="update_comment" value="true" /><input type="hidden" name="comment_id" value="-1" /><fieldset class="live_preview">	<legend>Live Preview</legend>	<div class="preview"></div></fieldset></form>',
	})
})
</script>
<div class="container_16">
<div class="grid_3">
	
<div class="lib_nav">
	<h2><a href="/clojure_core">Clojure Core</a></h2>
	
	<ul class="level_0">
		<li>
			<a href="/quickref/Clojure%20Core">Quick Ref</a>
			<ul>
				<li><a href="/quickref/shortdesc/Clojure%20Core">Short Descs</a></li>
				<li><a href="/quickref/varsonly/Clojure%20Core">Vars Only</a></li>
			</ul>
		</li>
		<li><a href="/clojure_core">Alphabetical</a></li>
	</ul>
	
</div>
	
<div class="namespaces">
	<h3>Namespaces</h3>
	
		<ul>
			

				
						<li>
							clojure
							
		<ul>
			

				
				<li>
					<span class="current_ns">
					<a href="/clojure_core/clojure.core">core</a>
					</span>
					
		<ul>
			

				
				<li>
					<span>
					<a href="/clojure_core/clojure.core.protocols">protocols</a>
					</span>
					
						</li>
					
				
		</ul>
	
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.data">data</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.inspector">inspector</a>
					</span>
					
						</li>
					
				

				
						<li>
							java
							
		<ul>
			

				
				<li>
					<span>
					<a href="/clojure_core/clojure.java.browse">browse</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.java.browse-ui">browse-ui</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.java.io">io</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.java.javadoc">javadoc</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.java.shell">shell</a>
					</span>
					
						</li>
					
				
		</ul>
	
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.main">main</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.pprint">pprint</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.reflect">reflect</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.repl">repl</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.set">set</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.stacktrace">stacktrace</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.string">string</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.template">template</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.test">test</a>
					</span>
					
		<ul>
			

				
				<li>
					<span>
					<a href="/clojure_core/clojure.test.junit">junit</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.test.tap">tap</a>
					</span>
					
						</li>
					
				
		</ul>
	
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.walk">walk</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.xml">xml</a>
					</span>
					
						</li>
					
				

				
				<li>
					<span>
					<a href="/clojure_core/clojure.zip">zip</a>
					</span>
					
						</li>
					
				
		</ul>
	
						</li>
					
				
		</ul>
	
</div>


	&nbsp;
</div>
<div class="grid_11">
	
	<a name="top"></a>
	<div class="function_links">
		<a href="#doc" class="scroll">doc</a>
		<a href="#source" class="scroll">source</a>
		<a href="#examples" class="scroll">examples</a>
		<a href="#comments" class="scroll">comments</a>
	</div>
	
	<script type="text/javascript" charset="utf-8">
		$(document).ready(function() {
			$(".versions_nav").click(function() {
				$(".versions_nav ul").toggle()
			})
		})
	</script>
	

	<div class="versions_nav">
		<span>
			1.3.0 
			
			<img alt="Arrow_down_16x16" height="16" src="/images/arrow_down_16x16.png?1317195880" width="16" />
		</span>
		<ul>
			<!--  -->
		
			
			<li>
				
					<a href="/clojure_core/1.2.0/clojure.core/doto" class="">1.2.0</a>
				
			</li>
		
			
			<li>
				
					<a href="/clojure_core/1.3.0/clojure.core/doto" class="selected stable">1.3.0 permalink</a>
				
			</li>
		
		</ul>
		<!-- <a href="/v/5479">short link to this var</a> -->
	</div>
	<div class="clear"></div>
	<div class="function_header">
	<h1>
		doto
	</h1>
	<h2>
		<span class="ns">
			<a href="/clojure_core/1.3.0/clojure.core">clojure.core</a>
		</span>
	</h2>
	
	<div class="clear"></div>
	</div>
	
	
	<div class="usage">
		<ul>
			
			<li>(doto x & forms)</li>
			
		</ul>
	</div>
	

	
	
	<div class="doc">
		<a class="internal_nav scroll" href="#doc" name="doc"></a>
		<div class="content">Evaluates x then calls all of the methods and functions with the<br />value of x supplied at the front of the given arguments.  The forms<br />are evaluated in order.  Returns x.<br /><br />(doto (new java.util.HashMap) (.put "a" 1) (.put "b" 2))</div>
		<div class="copyright_license">
			&copy Rich Hickey.  All rights reserved.
			
			<a href="http://www.eclipse.org/legal/epl-v10.html">Eclipse Public License 1.0</a>
		</div>
	</div>
	
	
	<div class="examples">
		<h3>
			<a class="internal_nav scroll" href="#examples" name="examples">
				<span id="examples_count">3</span> <span id="examples_desc">Examples</span>
			</a>
			<a class="top scroll" href="#top">top</a>
		</h3>
		
		<ul id="var_examples">
		
			<li>
				<div class="example" id="example_562">
	
	<div class="controls">
		<a class="permalink" name="example_562" href="#example_562">link</a>
		|
		<a href="/examples/view_changes/562" class="view_changes">changes</a>
		
	</div>
	
	<div class="clear"></div>
	<div class="content">
	<pre class="brush: clojure">;; Note that even though println returns nil, doto still returns the HashMap object
user&gt; (doto (java.util.HashMap.)
            (.put "a" 1)
            (.put "b" 2)
            (println))
#&lt;HashMap {b=2, a=1}&gt;
{"b" 2, "a" 1}
</pre>
	</div>
	<div class="hidden plain_content">;; Note that even though println returns nil, doto still returns the HashMap object
user&gt; (doto (java.util.HashMap.)
            (.put "a" 1)
            (.put "b" 2)
            (println))
#&lt;HashMap {b=2, a=1}&gt;
{"b" 2, "a" 1}
</div>
	<div class="clear"></div>
</div>

			</li>
		
			<li>
				<div class="example" id="example_721">
	
	<div class="controls">
		<a class="permalink" name="example_721" href="#example_721">link</a>
		|
		<a href="/examples/view_changes/721" class="view_changes">changes</a>
		
	</div>
	
	<div class="clear"></div>
	<div class="content">
	<pre class="brush: clojure">;; quick demonstration of using a Collections function on the resulting ArrayList

user=&gt; (def al (doto (java.util.ArrayList.) (.add 11) (.add 3)(.add 7)))
#'user/al
user=&gt; al
#&lt;ArrayList [11, 3, 7]&gt;
user=&gt; (java.util.Collections/sort al)
nil
user=&gt; al
#&lt;ArrayList [3, 7, 11]&gt;
user=&gt;</pre>
	</div>
	<div class="hidden plain_content">;; quick demonstration of using a Collections function on the resulting ArrayList

user=&gt; (def al (doto (java.util.ArrayList.) (.add 11) (.add 3)(.add 7)))
#'user/al
user=&gt; al
#&lt;ArrayList [11, 3, 7]&gt;
user=&gt; (java.util.Collections/sort al)
nil
user=&gt; al
#&lt;ArrayList [3, 7, 11]&gt;
user=&gt;</div>
	<div class="clear"></div>
</div>

			</li>
		
			<li>
				<div class="example" id="example_930">
	
	<div class="controls">
		<a class="permalink" name="example_930" href="#example_930">link</a>
		|
		<a href="/examples/view_changes/930" class="view_changes">changes</a>
		
	</div>
	
	<div class="clear"></div>
	<div class="content">
	<pre class="brush: clojure">;; careful when calling 'dotimes' from within a 'doto' statement
user=&gt; (doto (java.util.ArrayList.)
             (.add -2)
             (.add -1)
             (dotimes [i 3] (.add i)))
java.lang.IllegalArgumentException: dotimes requires a vector for its binding (NO_SOURCE_FILE:1)
; what has happened is that (java.util.ArrayList.) has secretly become the first argument to 'dotimes' and thus the exception informs us that it can't find the binding vector required for 'dotimes' to expand. You can cure this behaviour by simply using 'do' instead of 'doto' or by wrapping the call to 'dotimes' in a function. e.g:

;using 'let' with implicit 'do' instead of 'doto'
user=&gt; (let [al (java.util.ArrayList.)]
         (.add al -2)
         (.add al -1)
         (dotimes [i 3] (.add al i))
         al);return the ArrayList
#&lt;ArrayList [-2, -1, 0, 1, 2]&gt;  ;exactly what we intended

;wrapping 'dotimes' in a function literal
user=&gt;(doto (java.util.ArrayList.)
            (.add -2)
            (.add -1)
            (#(dotimes [i 3] (.add % i))))
#&lt;ArrayList [-2, -1, 0, 1, 2]&gt;  ;exactly what we intended again
</pre>
	</div>
	<div class="hidden plain_content">;; careful when calling 'dotimes' from within a 'doto' statement
user=&gt; (doto (java.util.ArrayList.)
             (.add -2)
             (.add -1)
             (dotimes [i 3] (.add i)))
java.lang.IllegalArgumentException: dotimes requires a vector for its binding (NO_SOURCE_FILE:1)
; what has happened is that (java.util.ArrayList.) has secretly become the first argument to 'dotimes' and thus the exception informs us that it can't find the binding vector required for 'dotimes' to expand. You can cure this behaviour by simply using 'do' instead of 'doto' or by wrapping the call to 'dotimes' in a function. e.g:

;using 'let' with implicit 'do' instead of 'doto'
user=&gt; (let [al (java.util.ArrayList.)]
         (.add al -2)
         (.add al -1)
         (dotimes [i 3] (.add al i))
         al);return the ArrayList
#&lt;ArrayList [-2, -1, 0, 1, 2]&gt;  ;exactly what we intended

;wrapping 'dotimes' in a function literal
user=&gt;(doto (java.util.ArrayList.)
            (.add -2)
            (.add -1)
            (#(dotimes [i 3] (.add % i))))
#&lt;ArrayList [-2, -1, 0, 1, 2]&gt;  ;exactly what we intended again
</div>
	<div class="clear"></div>
</div>

			</li>
		
		</ul>
		
		
		
		
			Log in to add / edit an example.
			
	</div>
	
	<div class="see_alsos">
		<h3>See Also <a class="top scroll" href="#top">top</a></h3>

		<ul>
			
		</ul>
		
		Log in to add a see also.
		
		<div class="clear"></div>
	</div>
	
	<div class="source">
		<h3 style="margin: 0px; padding: 0px;">
			<img alt="Plus_12x12" height="12" id="expand_source" src="/images/plus_12x12.png?1317195880" width="12" />
			<img alt="Minus_12x12" height="12" id="collapse_source" src="/images/minus_12x12.png?1317195880" width="12" />
			<a class="internal_nav scroll" href="#source" name="source">Source</a>
			
			<span class="file">
				
				clojure/core.clj:3395
				
			</span>
			
			<a class="top scroll" href="#top">top</a>

		</h3>
		<div class="source_content">
			<pre class="brush: clojure">(defmacro doto
  "Evaluates x then calls all of the methods and functions with the
  value of x supplied at the front of the given arguments.  The forms
  are evaluated in order.  Returns x.

  (doto (new java.util.HashMap) (.put \"a\" 1) (.put \"b\" 2))"
  {:added "1.0"}
  [x & forms]
    (let [gx (gensym)]
      `(let [~gx ~x]
         ~@(map (fn [f]
                  (if (seq? f)
                    `(~(first f) ~gx ~@(next f))
                    `(~f ~gx)))
                forms)
         ~gx)))</pre>
			<div class="copyright_license">
				&copy Rich Hickey.  All rights reserved.

				<a href="http://www.eclipse.org/legal/epl-v10.html">Eclipse Public License 1.0</a>
			</div>

			<div class="references">
				Vars in <span class="ns">clojure.core/</span>doto:
				
			</div>

			<div class="used_in">
				Used in 0 other vars
				
				
				
			</div>
		</div>
	</div>
	
	
	<div class="comments">
		<h3><a class="internal_nav scroll" href="#comments" name="comments">Comments</a> <a class="top scroll" href="#top">top</a></h3>
		
			<h4>
				No comments for <em>doto</em>.
				
					Log in to add a comment.
				
			</h4>
		
		
		
		
		<div class="hidden" id="preview_window">
		</div>
	</div>
</div>
<div class="grid_3">
	
	&nbsp;
</div>
</div>



	
	
	<div class="clear"></div>
	<div class="footer">
		ClojureDocs uses some elements of HTML5 / CSS3, and is best viewed in an up-to-date <a href="http://getfirefox.com">gecko</a> / <a href="http://www.google.com/chrome">webkit</a> -based browser.
		<br />
		<br />
		&copy; 2010 Zachary Kim <a href="http://zacharykim.com">http://zacharykim.com</a>
		<br />
		<br />
	</div>
</body>
</html>

